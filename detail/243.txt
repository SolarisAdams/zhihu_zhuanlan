{
    "title": "C# ç®€å•åº”ç”¨", 
    "description": "", 
    "followers": [
        "https://www.zhihu.com/people/MacForce", 
        "https://www.zhihu.com/people/ya-sen-7", 
        "https://www.zhihu.com/people/wu-di-94-62-98", 
        "https://www.zhihu.com/people/xiezhiije", 
        "https://www.zhihu.com/people/yang-cheng-kun-86", 
        "https://www.zhihu.com/people/alive-just", 
        "https://www.zhihu.com/people/xiao-wyao-yao-da", 
        "https://www.zhihu.com/people/yun-yin-81-1", 
        "https://www.zhihu.com/people/kan-bu-tou-ren-xin-52", 
        "https://www.zhihu.com/people/fei-xie-83-40", 
        "https://www.zhihu.com/people/tang-meng-95", 
        "https://www.zhihu.com/people/bailey-43", 
        "https://www.zhihu.com/people/chen-jun-li-90", 
        "https://www.zhihu.com/people/xian-yuan-tang-zhu-ren", 
        "https://www.zhihu.com/people/chl-48-26", 
        "https://www.zhihu.com/people/shbfeng", 
        "https://www.zhihu.com/people/lytry1064", 
        "https://www.zhihu.com/people/hanxu5760", 
        "https://www.zhihu.com/people/zhu-di-you-you", 
        "https://www.zhihu.com/people/cr7h", 
        "https://www.zhihu.com/people/xiong-bo-shi-mian-hua-tang", 
        "https://www.zhihu.com/people/mi-mang-de-lu-ren-85", 
        "https://www.zhihu.com/people/wang-zhen-xiao-hao", 
        "https://www.zhihu.com/people/xudongz", 
        "https://www.zhihu.com/people/zhang-ting-70-6-66", 
        "https://www.zhihu.com/people/dong-shuai-68-28-20", 
        "https://www.zhihu.com/people/liu-yu-jian-84", 
        "https://www.zhihu.com/people/xiao-bing-16-56", 
        "https://www.zhihu.com/people/hao-tian-26-36", 
        "https://www.zhihu.com/people/kong-kong-de-nao-dai-75", 
        "https://www.zhihu.com/people/watersp3", 
        "https://www.zhihu.com/people/ff-ff-68-1", 
        "https://www.zhihu.com/people/qi-cai-lei-3", 
        "https://www.zhihu.com/people/itxiao-sheng-53", 
        "https://www.zhihu.com/people/kasama1981", 
        "https://www.zhihu.com/people/wen-zhi-hong", 
        "https://www.zhihu.com/people/castiel-zhao", 
        "https://www.zhihu.com/people/qing-wen-15-63-10", 
        "https://www.zhihu.com/people/qing-qing-1994", 
        "https://www.zhihu.com/people/bie-qi-ma-yi", 
        "https://www.zhihu.com/people/zhang-xiong-46-98"
    ], 
    "article": [
        {
            "url": "https://zhuanlan.zhihu.com/p/35052524", 
            "userName": "å¤§ésb", 
            "userLink": "https://www.zhihu.com/people/9c5ffb79f07bb76c93142898396dcb04", 
            "upvote": 2, 
            "title": "C#åŸºç¡€çŸ¥è¯†-ç”¨è®°äº‹æœ¬å†™ä¸€ä¸ªWinformç¨‹åº", 
            "content": "<p><b>ç›®æ ‡ï¼š</b>ä¸ä½¿ç”¨Visual Studio æ‹–æ§ä»¶çš„æ–¹å¼ï¼Œåªç”¨ç³»ç»Ÿè‡ªå¸¦çš„è®°äº‹æœ¬å®Œæˆä¸€ä¸ªç®€å•çš„winformç¨‹åºï¼Œå®ç°å¸¦ä¸€ä¸ªbuttonæŒ‰é’®çš„çª—ä½“ï¼Œå•å‡»buttonï¼Œå…³é—­çª—ä½“ï¼›</p><p><b>æ€è·¯ï¼š</b></p><p>1.win7ä»¥ä¸Šç‰ˆæœ¬ï¼Œåœ¨ç”µè„‘C:\\Windows\\<a href=\"https://link.zhihu.com/?target=http%3A//Microsoft.NET\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Microsoft.NET</a>\\Framework é‡Œé€‰æ‹©å¯¹åº”çš„.netç‰ˆæœ¬ä¸‹çš„æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªcsc.exeçš„ç¨‹åºï¼Œå®ƒå¯ä»¥å°†åç¼€.csçš„æºä»£ç ç¼–è¯‘æˆå¯æ‰§è¡Œç¨‹åºã€‚</p><p>2.æˆ‘ä»¬çŸ¥é“C#çš„çª—ä½“å°±æ˜¯ä¸€ä¸ªç»§æ‰¿è‡³Formsçš„ç±»ï¼ŒFormsç±»å·²ç»å°è£…äº†çª—ä½“çš„å¾ˆå¤šåŸºç¡€åŠŸèƒ½ï¼Œ</p><p>æ‰€ä»¥æˆ‘ä»¬çš„ä»£ç å…¶å®ç‰¹åˆ«ç®€å•ã€‚</p><p><b>å®ç°æ–¹æ³•ï¼š</b></p><p>ç¬¬ä¸€æ­¥ï¼šå¼•å…¥åŸºç¡€çš„å‘½åç©ºé—´</p><div class=\"highlight\"><pre><code class=\"language-csharp\"><span class=\"k\">using</span> <span class=\"nn\">System</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Windows.Forms</span><span class=\"p\">;</span><span class=\"c1\">//çª—ä½“\n</span><span class=\"c1\"></span><span class=\"k\">using</span> <span class=\"nn\">System.Drawing</span><span class=\"c1\">//ç»˜å›¾\n</span></code></pre></div><p>ç¬¬äºŒæ­¥ï¼šæ–°å»ºä¸€ä¸ªçª—ä½“ç±»Form1ç»§æ‰¿Formï¼Œå¹¶å®šä¹‰ä¸€ä¸ªButtonï¼Œä¸ºbuttonè®¾ç½®ç®€å•çš„å¸ƒå±€ï¼Œç»‘å®šæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼›</p><div class=\"highlight\"><pre><code class=\"language-csharp\"><span class=\"k\">public</span> <span class=\"k\">class</span> <span class=\"nc\">Form1</span><span class=\"p\">:</span><span class=\"n\">Form</span>\n<span class=\"p\">{</span>\n\t<span class=\"k\">private</span> <span class=\"n\">Button</span> <span class=\"n\">btn</span><span class=\"p\">;</span>\n\t<span class=\"k\">public</span> <span class=\"n\">Form1</span><span class=\"p\">()</span>\n\t<span class=\"p\">{</span>   \n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">Text</span><span class=\"p\">=</span><span class=\"s\">&#34;æµ‹è¯•çª—ä½“&#34;</span><span class=\"p\">;</span>\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">=</span><span class=\"k\">new</span> <span class=\"n\">Button</span><span class=\"p\">();</span>\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">SuspendLayout</span><span class=\"p\">();</span><span class=\"c1\">//æŒ‚èµ·å¸ƒå±€\n</span><span class=\"c1\"></span>\t\t<span class=\"c1\">//å¼€å§‹å¸ƒå±€\n</span><span class=\"c1\"></span>\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Location</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">Point</span><span class=\"p\">(</span><span class=\"m\">82</span><span class=\"p\">,</span> <span class=\"m\">87</span><span class=\"p\">);</span><span class=\"c1\">//System.Drawing.Point\n</span><span class=\"c1\"></span>                <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Name</span> <span class=\"p\">=</span> <span class=\"s\">&#34;btn&#34;</span><span class=\"p\">;</span>\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Size</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">Size</span><span class=\"p\">(</span><span class=\"m\">75</span><span class=\"p\">,</span> <span class=\"m\">23</span><span class=\"p\">);</span><span class=\"c1\">//System.Drawing.Size\t\n</span><span class=\"c1\"></span>\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Text</span> <span class=\"p\">=</span> <span class=\"s\">&#34;button&#34;</span><span class=\"p\">;</span>\t\t\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Click</span><span class=\"p\">+=</span><span class=\"k\">new</span> <span class=\"n\">System</span><span class=\"p\">.</span><span class=\"n\">EventHandler</span><span class=\"p\">(</span><span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn_Click</span><span class=\"p\">);</span><span class=\"c1\">//è®¾ç½®å•å‡»äº‹ä»¶[æ³¨1]\t\t\n</span><span class=\"c1\"></span>\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">Controls</span><span class=\"p\">.</span><span class=\"n\">Add</span><span class=\"p\">(</span><span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">);</span><span class=\"c1\">//å°†æŒ‰é’®æ·»åŠ åˆ°çª—ä½“æ§ä»¶é›†\n</span><span class=\"c1\"></span>\t<span class=\"p\">}</span>\n\t<span class=\"k\">private</span> <span class=\"k\">void</span> <span class=\"n\">btn_Click</span><span class=\"p\">(</span><span class=\"kt\">object</span> <span class=\"n\">sender</span><span class=\"p\">,</span><span class=\"n\">EventArgs</span> <span class=\"n\">e</span><span class=\"p\">)</span>\n\t<span class=\"p\">{</span>\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">Close</span><span class=\"p\">();</span>\n\t<span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div><p>ç¬¬ä¸‰æ­¥ï¼šå®šä¹‰ç¨‹åºçš„å…¥å£å‡½æ•°ï¼šMain()</p><div class=\"highlight\"><pre><code class=\"language-csharp\"><span class=\"c1\">//å®šä¹‰ç¨‹åºçš„å…¥å£å‡½æ•°\n</span><span class=\"c1\"></span><span class=\"k\">public</span> <span class=\"k\">class</span> <span class=\"nc\">Program</span>\n<span class=\"p\">{</span>\n\t<span class=\"k\">public</span> <span class=\"k\">static</span> <span class=\"k\">void</span> <span class=\"n\">Main</span><span class=\"p\">()</span>\n\t<span class=\"p\">{</span>\n\t\t<span class=\"n\">Application</span><span class=\"p\">.</span><span class=\"n\">Run</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">Form1</span><span class=\"p\">());</span>\n\t<span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div><p>ç¬¬å››æ­¥ï¼šå°†å†™å¥½çš„ä»£ç æ–‡ä»¶åç¼€æ”¹ä¸º.csï¼Œè¿™é‡Œæˆ‘ä¿å­˜ä¸ºtest.csï¼Œæ‰“å¼€CMDå‘½ä»¤æç¤ºç¬¦ï¼ŒæŒ‰ä¸‹å›¾æŒ‡ä»¤ç¼–è¯‘ç¨‹åºã€‚ï¼ˆcsc.exeæ˜¯ä¸èƒ½ç›´æ¥ç‚¹å‡»è¿è¡Œçš„ï¼‰</p><figure data-size=\"normal\"><noscript><img src=\"https://pic2.zhimg.com/v2-b24505beaebae9bacc529e301015aa0d_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"815\" data-rawheight=\"530\" class=\"origin_image zh-lightbox-thumb\" width=\"815\" data-original=\"https://pic2.zhimg.com/v2-b24505beaebae9bacc529e301015aa0d_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;815&#39; height=&#39;530&#39;&gt;&lt;/svg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"815\" data-rawheight=\"530\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"815\" data-original=\"https://pic2.zhimg.com/v2-b24505beaebae9bacc529e301015aa0d_r.jpg\" data-actualsrc=\"https://pic2.zhimg.com/v2-b24505beaebae9bacc529e301015aa0d_b.jpg\"/></figure><p>æœ€åï¼Œæ‰“å¼€ç¼–è¯‘å¥½çš„EXEç¨‹åºï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š</p><figure data-size=\"normal\"><noscript><img src=\"https://pic4.zhimg.com/v2-f3ebcd5dbf70ca8a1448b3e5b1838d33_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"819\" data-rawheight=\"535\" class=\"origin_image zh-lightbox-thumb\" width=\"819\" data-original=\"https://pic4.zhimg.com/v2-f3ebcd5dbf70ca8a1448b3e5b1838d33_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;819&#39; height=&#39;535&#39;&gt;&lt;/svg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"819\" data-rawheight=\"535\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"819\" data-original=\"https://pic4.zhimg.com/v2-f3ebcd5dbf70ca8a1448b3e5b1838d33_r.jpg\" data-actualsrc=\"https://pic4.zhimg.com/v2-f3ebcd5dbf70ca8a1448b3e5b1838d33_b.jpg\"/></figure><p>[æ³¨1]ï¼š</p><div class=\"highlight\"><pre><code class=\"language-csharp\"><span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Click</span><span class=\"p\">+=</span><span class=\"k\">new</span> <span class=\"n\">System</span><span class=\"p\">.</span><span class=\"n\">EventHandler</span><span class=\"p\">(</span><span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn_Click</span><span class=\"p\">);</span>\n<span class=\"c1\">//è®¾ç½®å•å‡»äº‹ä»¶[æ³¨1]\n</span><span class=\"c1\">//EventHandleræ˜¯é¢„å®šä¹‰çš„åŸºç¡€å§”æ‰˜ï¼Œä¸€èˆ¬æ§ä»¶çš„äº‹ä»¶å¤šç”¨è¿™ä¸ªã€‚å…³äºå§”æ‰˜å’Œäº‹ä»¶è¯·å…³æ³¨å…¶ä»–æ–‡ç« \n</span></code></pre></div><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><div class=\"highlight\"><pre><code class=\"language-csharp\"><span class=\"k\">using</span> <span class=\"nn\">System</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Windows.Forms</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Drawing</span>\n<span class=\"k\">public</span> <span class=\"k\">class</span> <span class=\"nc\">Form1</span><span class=\"p\">:</span><span class=\"n\">Form</span>\n<span class=\"p\">{</span>\n\t<span class=\"k\">private</span> <span class=\"n\">Button</span> <span class=\"n\">btn</span><span class=\"p\">;</span>\n\t<span class=\"k\">public</span> <span class=\"n\">Form1</span><span class=\"p\">()</span>\n\t<span class=\"p\">{</span>   \n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">Text</span><span class=\"p\">=</span><span class=\"s\">&#34;æµ‹è¯•çª—ä½“&#34;</span><span class=\"p\">;</span>\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">=</span><span class=\"k\">new</span> <span class=\"n\">Button</span><span class=\"p\">();</span>\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">SuspendLayout</span><span class=\"p\">();</span><span class=\"c1\">//æŒ‚èµ·æ§ä»¶çš„å¸ƒå±€\n</span><span class=\"c1\"></span>\t\t<span class=\"c1\">//å¼€å§‹å¸ƒå±€\n</span><span class=\"c1\"></span>\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Location</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">Point</span><span class=\"p\">(</span><span class=\"m\">82</span><span class=\"p\">,</span> <span class=\"m\">87</span><span class=\"p\">);</span>\n        <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Name</span> <span class=\"p\">=</span> <span class=\"s\">&#34;btn&#34;</span><span class=\"p\">;</span>\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Size</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">Size</span><span class=\"p\">(</span><span class=\"m\">75</span><span class=\"p\">,</span> <span class=\"m\">23</span><span class=\"p\">);</span>\t\t\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Text</span> <span class=\"p\">=</span> <span class=\"s\">&#34;button&#34;</span><span class=\"p\">;</span>\t\t\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">.</span><span class=\"n\">Click</span><span class=\"p\">+=</span><span class=\"k\">new</span> <span class=\"n\">System</span><span class=\"p\">.</span><span class=\"n\">EventHandler</span><span class=\"p\">(</span><span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn_Click</span><span class=\"p\">);</span><span class=\"c1\">//è®¾ç½®å•å‡»äº‹ä»¶[æ³¨1]\t\t\n</span><span class=\"c1\"></span>\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">Controls</span><span class=\"p\">.</span><span class=\"n\">Add</span><span class=\"p\">(</span><span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">btn</span><span class=\"p\">);</span><span class=\"c1\">//å°†æŒ‰é’®æ·»åŠ åˆ°çª—ä½“æ§ä»¶é›†\n</span><span class=\"c1\"></span>\t<span class=\"p\">}</span>\n\t<span class=\"k\">private</span> <span class=\"k\">void</span> <span class=\"n\">btn_Click</span><span class=\"p\">(</span><span class=\"kt\">object</span> <span class=\"n\">sender</span><span class=\"p\">,</span><span class=\"n\">EventArgs</span> <span class=\"n\">e</span><span class=\"p\">)</span>\n\t<span class=\"p\">{</span>\n\t\t<span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">Close</span><span class=\"p\">();</span>\n\t<span class=\"p\">}</span>\n<span class=\"p\">}</span>\n<span class=\"c1\">//å®šä¹‰ç¨‹åºçš„å…¥å£å‡½æ•°\n</span><span class=\"c1\"></span><span class=\"k\">public</span> <span class=\"k\">class</span> <span class=\"nc\">Program</span>\n<span class=\"p\">{</span>\n\t<span class=\"k\">public</span> <span class=\"k\">static</span> <span class=\"k\">void</span> <span class=\"n\">Main</span><span class=\"p\">()</span>\n\t<span class=\"p\">{</span>\n\t\t<span class=\"n\">Application</span><span class=\"p\">.</span><span class=\"n\">Run</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">Form1</span><span class=\"p\">());</span>\n\t<span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div><p></p>", 
            "topic": [
                {
                    "tag": "C#", 
                    "tagLink": "https://api.zhihu.com/topics/19590712"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/32526818", 
            "userName": "å¤§ésb", 
            "userLink": "https://www.zhihu.com/people/9c5ffb79f07bb76c93142898396dcb04", 
            "upvote": 1, 
            "title": "AutoCAD.NET äºŒæ¬¡å¼€å‘--AutoCAD ä¸­æ·»åŠ è‡ªå®šä¹‰çš„çª—ä½“", 
            "content": "<p><b>1ã€éœ€æ±‚</b>ï¼šåœ¨CADä¸­è¾“å…¥æŒ‡ä»¤â€œaaaâ€ï¼Œå¼¹å‡ºä¸€ä¸ªçª—ä½“ï¼Œçª—ä½“ä¸­æœ‰ä¸€ä¸ªé€‰æ‹©å¤–éƒ¨Excelæ–‡ä»¶çš„æŒ‰é’®ï¼Œç”¨æ¥é€‰æ‹©è¦å¯¼å…¥çš„æ•°æ®æºï¼Œç‚¹å‡»ç¡®è®¤æŒ‰é’®åå…³é—­çª—ä½“ï¼Œåœ¨å‘½ä»¤æ æ˜¾ç¤ºå¯¼å…¥çš„æ•°æ®ï¼›</p><p><b>2ã€æ€è·¯</b>ï¼šæ–°å¢ä¸€ä¸ªwinformçª—ä½“ï¼Œä½¿ç”¨ShowModalDialog()å‡½æ•°åœ¨CADä¸­æ˜¾ç¤ºï¼›</p><p><b>3ã€ç¯å¢ƒ</b>ï¼šAutoCAD 2008/Office 2010/vs2010</p><p><b>4ã€æ­¥éª¤</b>ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šå°† <a href=\"https://zhuanlan.zhihu.com/p/32434945\" class=\"internal\">AutoCAD.NET äºŒæ¬¡å¼€å‘--CADä¸­å¯¼å…¥Excelæ•°æ®</a> æ–‡ç« ä¸­ExcelToolsç±»å•ç‹¬ç¼–è¯‘æˆdllï¼Œåœ¨æœ¬é¡¹ç›®å¦‚æ·»åŠ è¯¥dllçš„å¼•ç”¨ï¼Œå®ç°å¤–éƒ¨Excelå•å…ƒæ ¼æ•°æ®çš„è¯»å–ï¼›</p><p>æ³¨æ„ï¼šæµ‹è¯•ç¯å¢ƒä¸ºCAD 2008,<a href=\"https://link.zhihu.com/?target=http%3A//xn--dll-7w2eu41drhdtwbp9l391b1i0d.net/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">ç”Ÿæˆdllæ—¶åŠ¡å¿…é€‰æ‹©.NET</a> Framework 3.5æ¡†æ¶</p><p>ç¬¬äºŒæ­¥ï¼šåœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸€ä¸ªåä¸º NewFormçš„çª—ä½“ï¼Œå¦‚ä¸‹å›¾ï¼›</p><figure data-size=\"normal\"><noscript><img src=\"https://pic2.zhimg.com/v2-e7a84aa45207ae4d2698da4365a7b845_b.jpg\" data-size=\"normal\" data-rawwidth=\"400\" data-rawheight=\"186\" class=\"content_image\" width=\"400\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;400&#39; height=&#39;186&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"400\" data-rawheight=\"186\" class=\"content_image lazy\" width=\"400\" data-actualsrc=\"https://pic2.zhimg.com/v2-e7a84aa45207ae4d2698da4365a7b845_b.jpg\"/><figcaption>NewFormçª—ä½“</figcaption></figure><p>ç¬¬ä¸‰æ­¥: ä»¥ModalDialog æ¨¡æ€çš„æ–¹å¼åœ¨CADä¸­åŠ è½½NewFormçª—ä½“ã€‚&lt;å¤‡æ³¨1&gt;</p><p>ç¬¬å››æ­¥ï¼šå°†æ•°æ®æ˜¾ç¤ºåœ¨CADå‘½ä»¤æ ä¸­ï¼›</p><p class=\"ztext-empty-paragraph\"><br/></p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><div class=\"highlight\"><pre><code class=\"language-csharp\"><span class=\"c1\">//ä¸»ç¨‹åºä»£ç \n</span><span class=\"c1\"></span><span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.Runtime</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.ApplicationServices</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.EditorInput</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Windows.Forms</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">CadApp</span> <span class=\"p\">=</span> <span class=\"n\">Autodesk</span><span class=\"p\">.</span><span class=\"n\">AutoCAD</span><span class=\"p\">.</span><span class=\"n\">ApplicationServices</span><span class=\"p\">;</span>\n\n<span class=\"k\">namespace</span> <span class=\"nn\">NewFormInCAD</span>\n<span class=\"p\">{</span>\n    <span class=\"k\">public</span> <span class=\"k\">class</span> <span class=\"nc\">Class1</span>\n    <span class=\"p\">{</span><span class=\"na\">\n</span><span class=\"na\">        [CommandMethod(&#34;aaa&#34;)]</span>\n        <span class=\"k\">public</span> <span class=\"k\">void</span> <span class=\"n\">CteateForm</span><span class=\"p\">()</span>\n        <span class=\"p\">{</span>\n\n            <span class=\"n\">Document</span> <span class=\"n\">doc</span> <span class=\"p\">=</span> <span class=\"n\">CadApp</span><span class=\"p\">.</span><span class=\"n\">Application</span><span class=\"p\">.</span><span class=\"n\">DocumentManager</span><span class=\"p\">.</span><span class=\"n\">MdiActiveDocument</span><span class=\"p\">;</span><span class=\"c1\">//è·å–å½“å‰æ–‡æ¡£\n</span><span class=\"c1\"></span>            <span class=\"n\">Editor</span> <span class=\"n\">ed</span> <span class=\"p\">=</span> <span class=\"n\">doc</span><span class=\"p\">.</span><span class=\"n\">Editor</span><span class=\"p\">;</span><span class=\"c1\">//å½“å‰å‘½ä»¤æ \n</span><span class=\"c1\"></span>\n            <span class=\"k\">using</span> <span class=\"p\">(</span><span class=\"n\">NewForm</span> <span class=\"n\">form</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">NewForm</span><span class=\"p\">())</span>\n            <span class=\"p\">{</span>\n                <span class=\"n\">CadApp</span><span class=\"p\">.</span><span class=\"n\">Application</span><span class=\"p\">.</span><span class=\"n\">ShowModalDialog</span><span class=\"p\">(</span><span class=\"n\">form</span><span class=\"p\">);</span><span class=\"c1\">//æ¨¡æ€æ–¹å¼æ˜¾ç¤ºçª—ä½“\n</span><span class=\"c1\"></span>                <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">form</span><span class=\"p\">.</span><span class=\"n\">DialogResult</span> <span class=\"p\">==</span> <span class=\"n\">DialogResult</span><span class=\"p\">.</span><span class=\"n\">OK</span><span class=\"p\">)</span>\n                <span class=\"p\">{</span>\n                    <span class=\"n\">form</span><span class=\"p\">.</span><span class=\"n\">ShowInTaskbar</span> <span class=\"p\">=</span> <span class=\"k\">false</span><span class=\"p\">;</span>\n                    <span class=\"n\">ed</span><span class=\"p\">.</span><span class=\"n\">WriteMessage</span><span class=\"p\">(</span><span class=\"s\">&#34;è¯»å–çš„æ•°æ®ä¸ºï¼š&#34;</span> <span class=\"p\">+</span> <span class=\"n\">form</span><span class=\"p\">.</span><span class=\"n\">ImporData</span><span class=\"p\">);</span>\n                <span class=\"p\">}</span>               \n                \n            <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\">//NewFormä»£ç \n</span><span class=\"c1\"></span><span class=\"k\">using</span> <span class=\"nn\">System</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Collections.Generic</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.ComponentModel</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Data</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Drawing</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Linq</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Text</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Windows.Forms</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">DF.Helper.Common</span><span class=\"p\">;</span>\n\n<span class=\"k\">namespace</span> <span class=\"nn\">NewFormInCAD</span>\n<span class=\"p\">{</span>\n    <span class=\"k\">public</span> <span class=\"k\">partial</span> <span class=\"k\">class</span> <span class=\"nc\">NewForm</span> <span class=\"p\">:</span> <span class=\"n\">Form</span>\n    <span class=\"p\">{</span>\n        <span class=\"kt\">string</span> <span class=\"n\">excelName</span><span class=\"p\">;</span><span class=\"c1\">//è¡¨æ ¼å®Œæ•´è·¯å¾„\n</span><span class=\"c1\"></span>        <span class=\"kt\">string</span> <span class=\"n\">importData</span><span class=\"p\">;</span><span class=\"c1\">//è¯»å–çš„å•å…ƒæ ¼æ•°æ®\n</span><span class=\"c1\"></span>        <span class=\"k\">public</span> <span class=\"kt\">string</span> <span class=\"n\">ImporData</span>\n        <span class=\"p\">{</span>\n            <span class=\"k\">set</span> <span class=\"p\">{</span> <span class=\"k\">value</span> <span class=\"p\">=</span> <span class=\"n\">importData</span><span class=\"p\">;</span> <span class=\"p\">}</span>\n            <span class=\"k\">get</span> <span class=\"p\">{</span> <span class=\"k\">return</span> <span class=\"n\">importData</span><span class=\"p\">;</span> <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">public</span> <span class=\"n\">NewForm</span><span class=\"p\">()</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">InitializeComponent</span><span class=\"p\">();</span>\n\n        <span class=\"p\">}</span>\n        <span class=\"k\">private</span> <span class=\"k\">void</span> <span class=\"n\">NewForm_Load</span><span class=\"p\">(</span><span class=\"kt\">object</span> <span class=\"n\">sender</span><span class=\"p\">,</span> <span class=\"n\">EventArgs</span> <span class=\"n\">e</span><span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n\n        <span class=\"p\">}</span>\n        <span class=\"c1\">//æµè§ˆæ–‡ä»¶æŒ‰é’®\n</span><span class=\"c1\"></span>        <span class=\"k\">private</span> <span class=\"k\">void</span> <span class=\"n\">button_open_Click</span><span class=\"p\">(</span><span class=\"kt\">object</span> <span class=\"n\">sender</span><span class=\"p\">,</span> <span class=\"n\">EventArgs</span> <span class=\"n\">e</span><span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">OpenFileDialog</span> <span class=\"n\">dialog</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">OpenFileDialog</span><span class=\"p\">();</span><span class=\"c1\">//æ–°å¢æµè§ˆæ–‡ä»¶å¯¹è¯æ¡†\n</span><span class=\"c1\"></span>            <span class=\"n\">dialog</span><span class=\"p\">.</span><span class=\"n\">Filter</span> <span class=\"p\">=</span> <span class=\"s\">&#34;Excel file|*.xls;*.xlsx&#34;</span><span class=\"p\">;</span><span class=\"c1\">//ç­›é€‰xls,å’Œxlsxæ–‡ä»¶\n</span><span class=\"c1\"></span>            <span class=\"n\">dialog</span><span class=\"p\">.</span><span class=\"n\">RestoreDirectory</span> <span class=\"p\">=</span> <span class=\"k\">false</span><span class=\"p\">;</span>\n            <span class=\"k\">try</span>\n            <span class=\"p\">{</span>\n                <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">dialog</span><span class=\"p\">.</span><span class=\"n\">ShowDialog</span><span class=\"p\">()</span> <span class=\"p\">==</span> <span class=\"n\">DialogResult</span><span class=\"p\">.</span><span class=\"n\">OK</span><span class=\"p\">)</span>\n                <span class=\"p\">{</span>\n                    <span class=\"n\">textBox_fileName</span><span class=\"p\">.</span><span class=\"n\">Text</span> <span class=\"p\">=</span> <span class=\"n\">dialog</span><span class=\"p\">.</span><span class=\"n\">FileName</span><span class=\"p\">.</span><span class=\"n\">ToString</span><span class=\"p\">();</span>\n                <span class=\"p\">}</span>\n            <span class=\"p\">}</span>\n            <span class=\"k\">catch</span> <span class=\"p\">(</span><span class=\"n\">Exception</span> <span class=\"n\">ex</span><span class=\"p\">)</span>\n            <span class=\"p\">{</span>\n                <span class=\"n\">MessageBox</span><span class=\"p\">.</span><span class=\"n\">Show</span><span class=\"p\">(</span><span class=\"s\">&#34;æ‰“å¼€æ–‡ä»¶å‡ºé”™ï¼š&#34;</span><span class=\"p\">+</span><span class=\"n\">ex</span><span class=\"p\">.</span><span class=\"n\">Message</span><span class=\"p\">);</span>\n            <span class=\"p\">}</span>        \n        <span class=\"p\">}</span>\n        <span class=\"c1\">//ç¡®å®šæŒ‰é’®\n</span><span class=\"c1\"></span>        <span class=\"k\">private</span> <span class=\"k\">void</span> <span class=\"n\">button_Click</span><span class=\"p\">(</span><span class=\"kt\">object</span> <span class=\"n\">sender</span><span class=\"p\">,</span> <span class=\"n\">EventArgs</span> <span class=\"n\">e</span><span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">excelName</span> <span class=\"p\">=</span> <span class=\"n\">textBox_fileName</span><span class=\"p\">.</span><span class=\"n\">Text</span><span class=\"p\">;</span>\n            <span class=\"n\">ExcelTools</span> <span class=\"n\">excel</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">ExcelTools</span><span class=\"p\">();</span>\n            <span class=\"n\">excel</span><span class=\"p\">.</span><span class=\"n\">OpenExcel</span><span class=\"p\">(</span><span class=\"n\">excelName</span><span class=\"p\">);</span><span class=\"c1\">//æ‰“å¼€è¡¨æ ¼\n</span><span class=\"c1\"></span>            <span class=\"kt\">int</span> <span class=\"n\">sheetID</span> <span class=\"p\">=</span> <span class=\"n\">Convert</span><span class=\"p\">.</span><span class=\"n\">ToInt32</span><span class=\"p\">(</span><span class=\"n\">textBox_sheetName</span><span class=\"p\">.</span><span class=\"n\">Text</span><span class=\"p\">);</span>\n            <span class=\"kt\">int</span> <span class=\"n\">row</span> <span class=\"p\">=</span> <span class=\"n\">Convert</span><span class=\"p\">.</span><span class=\"n\">ToInt32</span><span class=\"p\">(</span><span class=\"n\">textBox_row</span><span class=\"p\">.</span><span class=\"n\">Text</span><span class=\"p\">);</span>\n            <span class=\"kt\">int</span> <span class=\"n\">col</span> <span class=\"p\">=</span> <span class=\"n\">Convert</span><span class=\"p\">.</span><span class=\"n\">ToInt32</span><span class=\"p\">(</span><span class=\"n\">textBox_col</span><span class=\"p\">.</span><span class=\"n\">Text</span><span class=\"p\">);</span>\n            <span class=\"n\">importData</span> <span class=\"p\">=</span> <span class=\"n\">excel</span><span class=\"p\">.</span><span class=\"n\">ReadCell</span><span class=\"p\">(</span><span class=\"n\">sheetID</span><span class=\"p\">,</span><span class=\"n\">row</span><span class=\"p\">,</span><span class=\"n\">col</span><span class=\"p\">);</span><span class=\"c1\">//è¯»å–å•å…ƒæ ¼\n</span><span class=\"c1\"></span>            <span class=\"n\">excel</span><span class=\"p\">.</span><span class=\"n\">ColseExcel</span><span class=\"p\">();</span><span class=\"c1\">//å…³é—­è¡¨æ ¼\n</span><span class=\"c1\"></span>            <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">DialogResult</span> <span class=\"p\">=</span> <span class=\"n\">DialogResult</span><span class=\"p\">.</span><span class=\"n\">OK</span><span class=\"p\">;</span>\n            <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"n\">Close</span><span class=\"p\">();</span>\n        <span class=\"p\">}</span>\n        \n       \n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div><p><b>&lt;å¤‡æ³¨1&gt;</b></p><p><b>CADä¸­åŠ è½½çª—ä½“çš„æ–¹å¼</b></p><p><a href=\"https://link.zhihu.com/?target=http%3A//xn--cad-x68dk4d062i.net/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">CADä¸­ä½¿ç”¨.NET</a> Formç±»çš„ShowDialog()å‡½æ•°æ¥æ˜¾ç¤ºçª—ä½“ä¼šå¸¦æ¥å¾ˆå¤šä¸å¯é¢„æ–™çš„é”™è¯¯ã€‚</p><p><a href=\"https://link.zhihu.com/?target=http%3A//autocad.net/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">AutoCAD.NET</a> APIæä¾›äº†ä¸¤ä¸ªä¸“é—¨çš„å‡½æ•°ç”¨æ¥æ›¿ä»£ShowDialog()ï¼›</p><p>ShowModalDialog Method(Form)å’ŒApplication.ShowModelessDialog (Form) </p><p>å‘½åç©ºé—´ï¼šAutodesk.AutoCAD.ApplicationServices </p><p>æ‰€å±ç±»ï¼šApplication</p><p>public static System.Windows.Forms.DialogResult ShowModalDialog(Form formToShow);//æ¨¡æ€æ–¹å¼ï¼Œçª—ä½“å’ŒCADé—´ä¸èƒ½åˆ‡æ¢</p><p>public static void ShowModelessDialog(Form formToShow);//éæ¨¡æ€æ–¹å¼ï¼Œçª—ä½“å’ŒCADé—´å¯ä»»æ„åˆ‡æ¢</p><p>æ³¨æ„ï¼šéå¿…é¡»çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ä½¿ç”¨æ¨¡æ€æ–¹å¼ï¼Œé˜²æ­¢å‡ºç°å„ç±»é—®é¢˜ï¼›</p>", 
            "topic": [
                {
                    "tag": "C#", 
                    "tagLink": "https://api.zhihu.com/topics/19590712"
                }
            ], 
            "comments": [
                {
                    "userName": "å–µå–µä¸åƒé±¼", 
                    "userLink": "https://www.zhihu.com/people/23f0105a60fe09c450392e6cde6d5f11", 
                    "content": "è¯·é—®æ¥¼ä¸»èƒ½ä¸èƒ½ç»™å¸®å¿™è¿™ä¸ªä»£ç ï¼Œvsé‡Œæ–°å»ºç±»åº“ï¼Œcadé‡Œè¾“å…¥ç›¸åº”æŒ‡ä»¤ï¼Œå¯ä»¥åœ¨cadé‡Œç›´æ¥å¼¹å‡ºä¹ä¹ä¹˜æ³•è¡¨ğŸ˜Šä¸‡åˆ†æ„Ÿè°¢ï¼", 
                    "likes": 0, 
                    "childComments": []
                }
            ]
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/32434945", 
            "userName": "å¤§ésb", 
            "userLink": "https://www.zhihu.com/people/9c5ffb79f07bb76c93142898396dcb04", 
            "upvote": 6, 
            "title": "AutoCAD.NET äºŒæ¬¡å¼€å‘--CADä¸­å¯¼å…¥Excelæ•°æ®", 
            "content": "<p><b>1ã€éœ€æ±‚</b>ï¼šå°†Excelè¡¨æ ¼ä¸­çš„æ•°æ®å¯¼å…¥åˆ°CADä¸­ï¼Œæ¼”ç¤ºä»£ç å®ç°è¯»å–è¡¨æ ¼å•å…ƒæ ¼çš„æ•°æ®ï¼Œç„¶ååœ¨å‘½ä»¤æ è¾“å‡º</p><p><b>2ã€æ€è·¯</b>ï¼šç”¨ä¸€ä¸ªExcelToolsç±»ï¼Œé€šè¿‡æ·»åŠ COMå¼•ç”¨æ“ä½œExcelè¡¨æ ¼ï¼Œç®€å•å®ç°è¡¨æ ¼è¯»å–çš„åŠŸèƒ½ï¼›</p><p><b>3ã€ç¯å¢ƒ</b>ï¼šAutoCAD 2008/Office 2010/vs2010</p><p><b>4ã€æ­¥éª¤</b>ï¼š</p><p><b>ç¬¬ä¸€æ­¥</b>ï¼šæ–°å»ºExcelToolsç±»ï¼Œæ·»åŠ COMå¼•ç”¨ï¼šMicroSoft Excel 14.0 Ojbect Library(Excel 2010)</p><p><b>ç¬¬äºŒæ­¥</b>ï¼šå¼•å…¥å‘½åç©ºé—´ï¼šMicrosoft.Office.Interop.Excel;</p><p><b>ç¬¬ä¸‰æ­¥</b>ï¼šå®ç°ä¸‰ä¸ªç®€å•æ–¹æ³•ï¼š</p><p>public void   OpenExcel(string fileName) //æ‰“å¼€è¡¨æ ¼</p><p>public string ReadCell(int sheetID, int row, int col)//æ ¹æ®å·¥ä½œç°¿çš„IDæ¥è¯»å–å•å…ƒæ ¼</p><p>public string ReadCell(string sheetName, int row, int col)//æ ¹æ®å·¥ä½œç°¿çš„åç§°æ¥è¯»å–å•å…ƒæ ¼</p><p>public void   ColseExcel()//å…³é—­è¡¨æ ¼</p><p><b>ç¬¬å››æ­¥</b>ï¼šè·å–å½“å‰CADæ–‡æ¡£çš„Editorå‘½ä»¤æ ï¼Œå°†è¯»å–çš„è¡¨æ ¼å•å…ƒæ ¼æ•°æ®è¾“å‡ºåˆ°å‘½ä»¤æ </p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><div class=\"highlight\"><pre><code class=\"language-csharp\"><span class=\"c1\">//ExcelToolsç±»ä»£ç \n</span><span class=\"c1\"></span><span class=\"k\">using</span> <span class=\"nn\">System</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Collections.Generic</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Linq</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Text</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Reflection</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Microsoft.Office.Interop.Excel</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">MyExcel</span> <span class=\"p\">=</span> <span class=\"n\">Microsoft</span><span class=\"p\">.</span><span class=\"n\">Office</span><span class=\"p\">.</span><span class=\"n\">Interop</span><span class=\"p\">.</span><span class=\"n\">Excel</span><span class=\"p\">;</span>\n\n<span class=\"k\">namespace</span> <span class=\"nn\">ImportExcelToCAD</span>\n<span class=\"p\">{</span>\n    <span class=\"k\">class</span> <span class=\"nc\">ExcelTools</span>\n    <span class=\"p\">{</span>\n        <span class=\"n\">MyExcel</span><span class=\"p\">.</span><span class=\"n\">Application</span> <span class=\"n\">excel</span><span class=\"p\">;</span>\n        <span class=\"n\">MyExcel</span><span class=\"p\">.</span><span class=\"n\">Workbook</span> <span class=\"n\">workbook</span><span class=\"p\">;</span>\n        <span class=\"n\">MyExcel</span><span class=\"p\">.</span><span class=\"n\">Worksheet</span> <span class=\"n\">worksheet</span><span class=\"p\">;</span>\n        <span class=\"kt\">object</span> <span class=\"n\">Nothing</span> <span class=\"p\">=</span> <span class=\"n\">Missing</span><span class=\"p\">.</span><span class=\"n\">Value</span><span class=\"p\">;</span>\n        <span class=\"c1\">/// &lt;summary&gt;\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// æ‰“å¼€å·¥ä½œç°¿\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// &lt;/summary&gt;\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// &lt;param name=&#34;fileName&#34;&gt;excelè¡¨æ ¼å®Œæ•´è·¯å¾„&lt;/param&gt;\n</span><span class=\"c1\"></span>        <span class=\"k\">public</span> <span class=\"k\">void</span> <span class=\"n\">OpenExcel</span><span class=\"p\">(</span><span class=\"kt\">string</span> <span class=\"n\">fileName</span><span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">excel</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">MyExcel</span><span class=\"p\">.</span><span class=\"n\">Application</span><span class=\"p\">();</span>\n            <span class=\"n\">workbook</span> <span class=\"p\">=</span> <span class=\"n\">excel</span><span class=\"p\">.</span><span class=\"n\">Workbooks</span><span class=\"p\">.</span><span class=\"n\">Open</span><span class=\"p\">(</span><span class=\"n\">fileName</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span>\n                <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">);</span>\n        <span class=\"p\">}</span>\n        <span class=\"c1\">/// &lt;summary&gt;\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// æ ¹æ®sheetIDæ¥è¯»å–æŒ‡å®šçš„å•å…ƒæ ¼\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// &lt;/summary&gt;\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// &lt;param name=&#34;sheetID&#34;&gt;&lt;/param&gt;\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// &lt;param name=&#34;row&#34;&gt;è¡Œ&lt;/param&gt;\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// &lt;param name=&#34;col&#34;&gt;åˆ—&lt;/param&gt;\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// &lt;returns&gt;&lt;/returns&gt;\n</span><span class=\"c1\"></span>        <span class=\"k\">public</span> <span class=\"kt\">string</span> <span class=\"n\">ReadCell</span><span class=\"p\">(</span><span class=\"kt\">int</span> <span class=\"n\">sheetID</span><span class=\"p\">,</span> <span class=\"kt\">int</span> <span class=\"n\">row</span><span class=\"p\">,</span> <span class=\"kt\">int</span> <span class=\"n\">col</span><span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">worksheet</span> <span class=\"p\">=</span> <span class=\"p\">(</span><span class=\"n\">Worksheet</span><span class=\"p\">)</span><span class=\"n\">workbook</span><span class=\"p\">.</span><span class=\"n\">Worksheets</span><span class=\"na\">[sheetID]</span><span class=\"p\">;</span>\n            <span class=\"kt\">string</span> <span class=\"k\">value</span> <span class=\"p\">=</span> <span class=\"p\">((</span><span class=\"n\">Range</span><span class=\"p\">)</span><span class=\"n\">worksheet</span><span class=\"p\">.</span><span class=\"n\">Cells</span><span class=\"na\">[row, col]</span><span class=\"p\">).</span><span class=\"n\">Text</span><span class=\"p\">.</span><span class=\"n\">ToString</span><span class=\"p\">();</span>\n            <span class=\"k\">return</span> <span class=\"k\">value</span><span class=\"p\">;</span>\n        <span class=\"p\">}</span>\n        <span class=\"c1\">//æ ¹æ®sheetNameæ¥è¯»å–æŒ‡å®šçš„å•å…ƒæ ¼\n</span><span class=\"c1\"></span>        <span class=\"k\">public</span> <span class=\"kt\">string</span> <span class=\"n\">ReadCell</span><span class=\"p\">(</span><span class=\"kt\">string</span> <span class=\"n\">sheetName</span><span class=\"p\">,</span> <span class=\"kt\">int</span> <span class=\"n\">row</span><span class=\"p\">,</span> <span class=\"kt\">int</span> <span class=\"n\">col</span><span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">worksheet</span> <span class=\"p\">=</span> <span class=\"p\">(</span><span class=\"n\">Worksheet</span><span class=\"p\">)</span><span class=\"n\">workbook</span><span class=\"p\">.</span><span class=\"n\">Worksheets</span><span class=\"na\">[sheetName]</span><span class=\"p\">;</span>\n            <span class=\"kt\">string</span> <span class=\"k\">value</span> <span class=\"p\">=</span> <span class=\"p\">((</span><span class=\"n\">Range</span><span class=\"p\">)</span><span class=\"n\">worksheet</span><span class=\"p\">.</span><span class=\"n\">Cells</span><span class=\"na\">[row, col]</span><span class=\"p\">).</span><span class=\"n\">Text</span><span class=\"p\">.</span><span class=\"n\">ToString</span><span class=\"p\">();</span>\n            <span class=\"k\">return</span> <span class=\"k\">value</span><span class=\"p\">;</span>\n        <span class=\"p\">}</span>\n        <span class=\"c1\">//å…³é—­è¡¨æ ¼\n</span><span class=\"c1\"></span>        <span class=\"k\">public</span> <span class=\"k\">void</span> <span class=\"n\">ColseExcel</span><span class=\"p\">()</span><span class=\"c1\">//å…³é—­è¡¨æ ¼\n</span><span class=\"c1\"></span>        <span class=\"p\">{</span>\n            <span class=\"n\">workbook</span><span class=\"p\">.</span><span class=\"n\">Close</span><span class=\"p\">(</span><span class=\"k\">false</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">,</span> <span class=\"n\">Nothing</span><span class=\"p\">);</span>\n            <span class=\"n\">workbook</span> <span class=\"p\">=</span> <span class=\"k\">null</span><span class=\"p\">;</span>\n            <span class=\"n\">excel</span><span class=\"p\">.</span><span class=\"n\">Quit</span><span class=\"p\">();</span>\n            <span class=\"n\">excel</span> <span class=\"p\">=</span> <span class=\"k\">null</span><span class=\"p\">;</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\">//ä¸»ç¨‹åºä»£ç \n</span><span class=\"c1\"></span><span class=\"k\">using</span> <span class=\"nn\">System</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Collections.Generic</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Linq</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Text</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.Runtime</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.ApplicationServices</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.EditorInput</span><span class=\"p\">;</span>\n\n<span class=\"k\">namespace</span> <span class=\"nn\">ImportExcelToCAD</span>\n<span class=\"p\">{</span>\n    <span class=\"k\">public</span> <span class=\"k\">class</span> <span class=\"nc\">Class1</span>\n    <span class=\"p\">{</span><span class=\"na\">\n</span><span class=\"na\">        [CommandMethod(&#34;aaa&#34;)]</span>\n        <span class=\"k\">public</span> <span class=\"k\">void</span> <span class=\"n\">ImportExcelData</span><span class=\"p\">()</span>\n        <span class=\"p\">{</span>\n            <span class=\"kt\">string</span> <span class=\"n\">excelPath</span> <span class=\"p\">=</span> <span class=\"s\">@&#34;C:\\Users\\Administrator\\Desktop\\æ–°å»ºæ–‡ä»¶å¤¹\\test.xlsx&#34;</span><span class=\"p\">;</span>  \n            <span class=\"n\">Document</span> <span class=\"n\">doc</span> <span class=\"p\">=</span> <span class=\"n\">Application</span><span class=\"p\">.</span><span class=\"n\">DocumentManager</span><span class=\"p\">.</span><span class=\"n\">MdiActiveDocument</span><span class=\"p\">;</span>\n            <span class=\"n\">Editor</span> <span class=\"n\">ed</span> <span class=\"p\">=</span> <span class=\"n\">doc</span><span class=\"p\">.</span><span class=\"n\">Editor</span><span class=\"p\">;</span>           \n            <span class=\"k\">try</span> \n            <span class=\"p\">{</span>\n                <span class=\"n\">ExcelTools</span> <span class=\"n\">tool</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">ExcelTools</span><span class=\"p\">();</span>\n                <span class=\"n\">tool</span><span class=\"p\">.</span><span class=\"n\">OpenExcel</span><span class=\"p\">(</span><span class=\"n\">excelPath</span><span class=\"p\">);</span><span class=\"c1\">//æ‰“å¼€è¡¨æ ¼\n</span><span class=\"c1\"></span>                <span class=\"kt\">string</span> <span class=\"n\">data</span> <span class=\"p\">=</span> <span class=\"n\">tool</span><span class=\"p\">.</span><span class=\"n\">ReadCell</span><span class=\"p\">(</span><span class=\"s\">&#34;Sheet1&#34;</span><span class=\"p\">,</span> <span class=\"m\">1</span><span class=\"p\">,</span> <span class=\"m\">1</span><span class=\"p\">);</span><span class=\"c1\">//è¯»å–sheet1ï¼Œç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—å•å…ƒæ ¼çš„å€¼\n</span><span class=\"c1\"></span>                <span class=\"n\">tool</span><span class=\"p\">.</span><span class=\"n\">ColseExcel</span><span class=\"p\">();</span><span class=\"c1\">//å…³é—­è¡¨æ ¼\n</span><span class=\"c1\"></span>                <span class=\"n\">ed</span><span class=\"p\">.</span><span class=\"n\">WriteMessage</span><span class=\"p\">(</span><span class=\"s\">&#34;ä»è¡¨æ ¼ä¸­è¯»å–çš„æ•°æ®ä¸ºï¼š&#34;</span> <span class=\"p\">+</span> <span class=\"n\">data</span><span class=\"p\">);</span><span class=\"c1\">//åœ¨å‘½ä»¤æ è¾“å‡º\n</span><span class=\"c1\"></span>            <span class=\"p\">}</span>\n            <span class=\"k\">catch</span><span class=\"p\">(</span><span class=\"n\">Autodesk</span><span class=\"p\">.</span><span class=\"n\">AutoCAD</span><span class=\"p\">.</span><span class=\"n\">Runtime</span><span class=\"p\">.</span><span class=\"n\">Exception</span> <span class=\"n\">ex</span><span class=\"p\">)</span>\n            <span class=\"p\">{</span>\n                <span class=\"n\">Application</span><span class=\"p\">.</span><span class=\"n\">ShowAlertDialog</span><span class=\"p\">(</span><span class=\"s\">&#34;é”™è¯¯ï¼š&#34;</span> <span class=\"p\">+</span> <span class=\"n\">ex</span><span class=\"p\">.</span><span class=\"n\">Message</span><span class=\"p\">);</span>\n            <span class=\"p\">}</span>                    \n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div><p><b>Excelæ“ä½œçŸ¥è¯†ç‚¹ï¼š</b></p><p>&lt;1&gt;</p><p><b>Workbooks.Openæ–¹æ³•</b></p><p>Open(FileName, UpdateLinks, ReadOnly, Format, Password, WriteResPassword, IgnoreReadOnlyRecommended, </p><p>Origin, Delimiter, Editable, Notify, Converter, AddToMru, Local, CorruptLoad)</p><p><b>æè¿°</b>ï¼šæ‰“å¼€ä¸€ä¸ªå·¥ä½œç°¿</p><p><b>å‚æ•°</b>ï¼šä¸€èˆ¬åªéœ€è¦å®šä¹‰FileNameå‚æ•°ï¼Œå…¶ä»–å‚æ•°å…¨éƒ¨ç¼ºçœï¼Œå‚æ•°å…·ä½“å«ä¹‰è¯·å‚è€ƒMicroSoft Excel å¼€å‘è€…æ–‡æ¡£</p><p>&lt;2&gt;</p><p><b>Workbook.Close æ–¹æ³•</b></p><p>Close(SaveChanges, Filename, RouteWorkbook)</p><p><b>æè¿°</b>ï¼šå…³é—­å·¥ä½œç°¿</p><p><b>å‚æ•°</b>ï¼š</p><p>SaveChangesï¼šæ˜¯å¦ä¿å­˜true/false</p><p>Filenameï¼šè¦ä¿å­˜çš„æ–‡ä»¶å</p><p>RouteWorkbookï¼šæ˜¯å¦å‘é€å·¥ä½œç°¿ã€‚ä¸€èˆ¬è®¾ç½®ç¼ºçœ</p><p></p>", 
            "topic": [
                {
                    "tag": "C#", 
                    "tagLink": "https://api.zhihu.com/topics/19590712"
                }
            ], 
            "comments": [
                {
                    "userName": "deeplycloud", 
                    "userLink": "https://www.zhihu.com/people/31ad8e95f15ee12b550cdc08022fdc5e", 
                    "content": "<p>å†™å¾—ä¸é”™ã€‚AUTOCADäºŒæ¬¡å¼€å‘å¯¹è®¾è®¡å¸ˆå¾ˆç®¡ç”¨ã€‚</p>", 
                    "likes": 1, 
                    "childComments": []
                }, 
                {
                    "userName": "å–µå–µä¸åƒé±¼", 
                    "userLink": "https://www.zhihu.com/people/23f0105a60fe09c450392e6cde6d5f11", 
                    "content": "è¯·é—®æ¥¼ä¸»èƒ½ä¸èƒ½ç»™å¸®å¿™è¿™ä¸ªä»£ç ï¼Œvsé‡Œæ–°å»ºç±»åº“ï¼Œcadé‡Œè¾“å…¥ç›¸åº”æŒ‡ä»¤ï¼Œå¯ä»¥åœ¨cadé‡Œç›´æ¥å¼¹å‡ºä¹ä¹ä¹˜æ³•è¡¨ğŸ˜Šä¸‡åˆ†æ„Ÿè°¢ï¼", 
                    "likes": 0, 
                    "childComments": []
                }
            ]
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/32393930", 
            "userName": "å¤§ésb", 
            "userLink": "https://www.zhihu.com/people/9c5ffb79f07bb76c93142898396dcb04", 
            "upvote": 0, 
            "title": "AutoCAD.NET äºŒæ¬¡å¼€å‘--æ’å…¥å¤–éƒ¨æ–‡ä»¶ä¸­çš„å—", 
            "content": "<h2>1ã€éœ€æ±‚</h2><p>æ’å…¥å¤–éƒ¨æ–‡ä»¶ä¸­æŒ‡å®šçš„å—ã€‚</p><h2>2ã€æ€è·¯</h2><p>å°†å¤–éƒ¨dwgæ–‡ä»¶åŠ è½½åˆ°ä¸´æ—¶æ•°æ®åº“ä¸­ï¼ŒæŠŠå¤–éƒ¨dwgæ–‡ä»¶ä¸­è‡ªå®šä¹‰çš„å‘½åå—å¤åˆ¶åˆ°å½“å‰æ–‡æ¡£çš„æ•°æ®åº“ä¸­ï¼›æ–°å»ºæŒ‡å®šå—çš„å—å‚ç…§åŠ å…¥åˆ°å½“å‰å—è¡¨è®°å½•ã€‚</p><h2>3ã€ç¯å¢ƒ</h2><p>AutoCAD 2008/vs2010</p><h2>4ã€æ­¥éª¤ï¼š</h2><p><b>(1) æ–°å»ºä¸€ä¸ªä¸´æ—¶å›¾å½¢æ•°æ®åº“ </b></p><p>Database tempDB = new Database(false, true);</p><p><b>(2) è°ƒç”¨Databaseç±»çš„ WblockCloneObjects()æ–¹æ³•å¤åˆ¶å—</b></p><p><b>(3) æ–°å»ºä¸€ä¸ªå—å‚ç…§ï¼šBlockReference</b></p><p>public BlockReference(Point3d position,  ObjectId blockTableRecord);</p><p><b>(4) æŠŠå—å‚ç…§æ·»åŠ åˆ°å—è¡¨è®°å½•ä¸­</b></p><p>BlockTableRecord.AppendEntity()</p><p>Transaction.AddNewlyCreatedDBObject();</p><p class=\"ztext-empty-paragraph\"><br/></p><p><b>æ–°å»ºä¸€ä¸ªCADToolsç±»ï¼Œå®ç°å¯¼å…¥å¤–éƒ¨dwgæ–‡ä»¶ä¸­çš„è‡ªå®šä¹‰å—</b></p><div class=\"highlight\"><pre><code class=\"language-csharp\"><span class=\"k\">using</span> <span class=\"nn\">System</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Collections.Generic</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Linq</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Text</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.ApplicationServices</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.Runtime</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.DatabaseServices</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.EditorInput</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.Geometry</span><span class=\"p\">;</span>\n<span class=\"k\">namespace</span> <span class=\"nn\">InsertBlock</span>\n<span class=\"p\">{</span>\n    <span class=\"k\">class</span> <span class=\"nc\">CADTools</span>\n    <span class=\"p\">{</span>\n        <span class=\"c1\">/// &lt;summary&gt;\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// å¯¼å…¥å¤–éƒ¨dwgæ–‡ä»¶ä¸­è‡ªå®šä¹‰çš„å—\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// &lt;/summary&gt;\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// &lt;param name=&#34;dwgFileName&#34;&gt;DWGæ–‡ä»¶è·¯å¾„&lt;/param&gt;\n</span><span class=\"c1\"></span>        <span class=\"c1\">/// &lt;param name=&#34;currentDB&#34;&gt;å½“å‰database&lt;/param&gt;\n</span><span class=\"c1\"></span>        <span class=\"k\">public</span> <span class=\"k\">static</span> <span class=\"k\">void</span> <span class=\"n\">ImportBlocksFromDWG</span><span class=\"p\">(</span><span class=\"kt\">string</span> <span class=\"n\">dwgFileName</span><span class=\"p\">,</span><span class=\"n\">Database</span> <span class=\"n\">currentDB</span><span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">Database</span> <span class=\"n\">tempDB</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">Database</span><span class=\"p\">(</span><span class=\"k\">false</span><span class=\"p\">,</span> <span class=\"k\">true</span><span class=\"p\">);</span><span class=\"c1\">//æ–°å»ºä¸€ä¸ªä¸´æ—¶å›¾å½¢æ•°æ®åº“&lt;1&gt;\n</span><span class=\"c1\"></span>            <span class=\"k\">try</span>\n            <span class=\"p\">{</span>\n                <span class=\"n\">tempDB</span><span class=\"p\">.</span><span class=\"n\">ReadDwgFile</span><span class=\"p\">(</span><span class=\"n\">dwgFileName</span><span class=\"p\">,</span> <span class=\"n\">System</span><span class=\"p\">.</span><span class=\"n\">IO</span><span class=\"p\">.</span><span class=\"n\">FileShare</span><span class=\"p\">.</span><span class=\"n\">Read</span><span class=\"p\">,</span> <span class=\"k\">true</span><span class=\"p\">,</span> <span class=\"k\">null</span><span class=\"p\">);</span><span class=\"c1\">//è¯»å–å¤–éƒ¨DWGåˆ°ä¸´æ—¶æ•°æ®åº“&lt;2&gt;\n</span><span class=\"c1\"></span>                <span class=\"n\">ObjectIdCollection</span> <span class=\"n\">ids</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">ObjectIdCollection</span><span class=\"p\">();</span><span class=\"c1\">//å­˜æ”¾å—OjbectIdçš„é›†åˆ\n</span><span class=\"c1\"></span>                <span class=\"k\">using</span> <span class=\"p\">(</span><span class=\"n\">Transaction</span> <span class=\"n\">trans</span> <span class=\"p\">=</span> <span class=\"n\">tempDB</span><span class=\"p\">.</span><span class=\"n\">TransactionManager</span><span class=\"p\">.</span><span class=\"n\">StartTransaction</span><span class=\"p\">())</span>\n                <span class=\"p\">{</span>\n                    <span class=\"n\">BlockTable</span> <span class=\"n\">bt</span> <span class=\"p\">=</span> <span class=\"n\">trans</span><span class=\"p\">.</span><span class=\"n\">GetObject</span><span class=\"p\">(</span><span class=\"n\">tempDB</span><span class=\"p\">.</span><span class=\"n\">BlockTableId</span><span class=\"p\">,</span> <span class=\"n\">OpenMode</span><span class=\"p\">.</span><span class=\"n\">ForRead</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">BlockTable</span><span class=\"p\">;</span>\n                    <span class=\"k\">foreach</span> <span class=\"p\">(</span><span class=\"n\">ObjectId</span> <span class=\"n\">item</span> <span class=\"k\">in</span> <span class=\"n\">bt</span><span class=\"p\">)</span>\n                    <span class=\"p\">{</span>\n                        <span class=\"n\">BlockTableRecord</span> <span class=\"n\">btr</span> <span class=\"p\">=</span> <span class=\"n\">trans</span><span class=\"p\">.</span><span class=\"n\">GetObject</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"p\">,</span> <span class=\"n\">OpenMode</span><span class=\"p\">.</span><span class=\"n\">ForRead</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">BlockTableRecord</span><span class=\"p\">;</span>\n                        <span class=\"k\">if</span> <span class=\"p\">(!</span><span class=\"n\">btr</span><span class=\"p\">.</span><span class=\"n\">IsAnonymous</span> <span class=\"p\">&amp;&amp;</span> <span class=\"p\">!</span><span class=\"n\">btr</span><span class=\"p\">.</span><span class=\"n\">IsLayout</span><span class=\"p\">)</span><span class=\"c1\">//ç­›é€‰è‡ªå®šä¹‰çš„å‘½åå—,å‰”é™¤åŒ¿åå—å’Œå¸ƒå±€å—\n</span><span class=\"c1\"></span>                        <span class=\"p\">{</span>\n                            <span class=\"n\">ids</span><span class=\"p\">.</span><span class=\"n\">Add</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"p\">);</span>\n                        <span class=\"p\">}</span>\n                    <span class=\"p\">}</span>\n                <span class=\"p\">}</span>\n                    <span class=\"c1\">//å¤åˆ¶ä¸´æ—¶æ•°æ®åº“ä¸­çš„å—åˆ°å½“å‰æ•°æ®åº“çš„å—è¡¨ä¸­&lt;3&gt;       \n</span><span class=\"c1\"></span>                    <span class=\"n\">tempDB</span><span class=\"p\">.</span><span class=\"n\">WblockCloneObjects</span><span class=\"p\">(</span><span class=\"n\">ids</span><span class=\"p\">,</span> <span class=\"n\">currentDB</span><span class=\"p\">.</span><span class=\"n\">BlockTableId</span><span class=\"p\">,</span> <span class=\"k\">new</span> <span class=\"n\">IdMapping</span><span class=\"p\">(),</span> <span class=\"n\">DuplicateRecordCloning</span><span class=\"p\">.</span><span class=\"n\">Replace</span><span class=\"p\">,</span> <span class=\"k\">false</span><span class=\"p\">);</span>\n            <span class=\"p\">}</span>\n            <span class=\"k\">catch</span> <span class=\"p\">(</span><span class=\"n\">Autodesk</span><span class=\"p\">.</span><span class=\"n\">AutoCAD</span><span class=\"p\">.</span><span class=\"n\">Runtime</span><span class=\"p\">.</span><span class=\"n\">Exception</span> <span class=\"n\">ex</span><span class=\"p\">)</span>\n            <span class=\"p\">{</span>\n                <span class=\"n\">Application</span><span class=\"p\">.</span><span class=\"n\">ShowAlertDialog</span><span class=\"p\">(</span><span class=\"s\">&#34;é”™è¯¯ï¼š&#34;</span><span class=\"p\">+</span><span class=\"n\">ex</span><span class=\"p\">.</span><span class=\"n\">Message</span><span class=\"p\">);</span>\n            <span class=\"p\">}</span>      \n            <span class=\"n\">tempDB</span><span class=\"p\">.</span><span class=\"n\">Dispose</span><span class=\"p\">();</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div><p><b>ä¸»ç¨‹åºä»£ç ï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-csharp\"><span class=\"p\">/</span><span class=\"err\">æ’å…¥å¤–éƒ¨æ–‡ä»¶ä¸­æŒ‡å®šçš„å—</span>\n<span class=\"k\">using</span> <span class=\"nn\">System</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Collections.Generic</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Linq</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">System.Text</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.ApplicationServices</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.Runtime</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.DatabaseServices</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.EditorInput</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.Geometry</span><span class=\"p\">;</span>\n\n<span class=\"k\">namespace</span> <span class=\"nn\">InsertBlock</span>\n<span class=\"p\">{</span>\n    <span class=\"k\">public</span> <span class=\"k\">class</span> <span class=\"nc\">Class1</span>       \n    <span class=\"p\">{</span><span class=\"na\">\n</span><span class=\"na\">        [CommandMethod(&#34;ib&#34;)]</span>\n        <span class=\"k\">public</span> <span class=\"k\">void</span> <span class=\"n\">InsertBlock</span><span class=\"p\">()</span>\n        <span class=\"p\">{</span>\n            <span class=\"kt\">string</span> <span class=\"n\">fileName</span><span class=\"p\">=</span><span class=\"s\">@&#34;F:\\å¤‡ä»½\\CADæ’ä»¶\\å·¥ä½œå—\\block.dwg&#34;</span><span class=\"p\">;</span>  <span class=\"c1\">//å¤–éƒ¨dwgæ–‡ä»¶çš„å®Œæ•´è·¯å¾„   ã€\n</span><span class=\"c1\"></span>            <span class=\"kt\">string</span> <span class=\"n\">insertBlockName</span> <span class=\"p\">=</span> <span class=\"s\">&#34;block1&#34;</span><span class=\"p\">;</span><span class=\"c1\">//è¦æ’å…¥çš„å—å\n</span><span class=\"c1\"></span>            <span class=\"n\">Document</span> <span class=\"n\">doc</span> <span class=\"p\">=</span> <span class=\"n\">Application</span><span class=\"p\">.</span><span class=\"n\">DocumentManager</span><span class=\"p\">.</span><span class=\"n\">MdiActiveDocument</span><span class=\"p\">;</span>\n            <span class=\"n\">Database</span> <span class=\"n\">db</span> <span class=\"p\">=</span> <span class=\"n\">doc</span><span class=\"p\">.</span><span class=\"n\">Database</span><span class=\"p\">;</span>\n            <span class=\"n\">Editor</span> <span class=\"n\">ed</span> <span class=\"p\">=</span> <span class=\"n\">doc</span><span class=\"p\">.</span><span class=\"n\">Editor</span><span class=\"p\">;</span>\n            <span class=\"n\">PromptPointResult</span> <span class=\"n\">getPoint</span> <span class=\"p\">=</span> <span class=\"n\">ed</span><span class=\"p\">.</span><span class=\"n\">GetPoint</span><span class=\"p\">(</span><span class=\"s\">&#34;è¯·é€‰æ‹©æ’å…¥ç‚¹&#34;</span><span class=\"p\">);</span>\n            <span class=\"n\">Point3d</span> <span class=\"n\">p</span> <span class=\"p\">=</span> <span class=\"n\">getPoint</span><span class=\"p\">.</span><span class=\"n\">Value</span><span class=\"p\">;</span>\n            <span class=\"n\">CADTools</span><span class=\"p\">.</span><span class=\"n\">ImportBlocksFromDWG</span><span class=\"p\">(</span><span class=\"n\">fileName</span><span class=\"p\">,</span><span class=\"n\">db</span><span class=\"p\">);</span> <span class=\"c1\">//å¯¼å…¥å¤–éƒ¨æ–‡ä»¶ä¸­çš„å—           \n</span><span class=\"c1\"></span>            <span class=\"k\">using</span> <span class=\"p\">(</span><span class=\"n\">Transaction</span> <span class=\"n\">trans</span> <span class=\"p\">=</span> <span class=\"n\">db</span><span class=\"p\">.</span><span class=\"n\">TransactionManager</span><span class=\"p\">.</span><span class=\"n\">StartTransaction</span><span class=\"p\">())</span>\n            <span class=\"p\">{</span>\n                <span class=\"n\">BlockTable</span> <span class=\"n\">bt</span> <span class=\"p\">=</span> <span class=\"n\">trans</span><span class=\"p\">.</span><span class=\"n\">GetObject</span><span class=\"p\">(</span><span class=\"n\">db</span><span class=\"p\">.</span><span class=\"n\">BlockTableId</span><span class=\"p\">,</span> <span class=\"n\">OpenMode</span><span class=\"p\">.</span><span class=\"n\">ForRead</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">BlockTable</span><span class=\"p\">;</span>\n                <span class=\"n\">BlockTableRecord</span> <span class=\"n\">btr</span> <span class=\"p\">=</span> <span class=\"n\">trans</span><span class=\"p\">.</span><span class=\"n\">GetObject</span><span class=\"p\">(</span><span class=\"n\">bt</span><span class=\"na\">[BlockTableRecord.ModelSpace]</span><span class=\"p\">,</span><span class=\"n\">OpenMode</span><span class=\"p\">.</span><span class=\"n\">ForWrite</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">BlockTableRecord</span><span class=\"p\">;</span>\n                <span class=\"k\">using</span> <span class=\"p\">(</span><span class=\"n\">BlockReference</span> <span class=\"n\">brf</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">BlockReference</span><span class=\"p\">(</span><span class=\"n\">p</span><span class=\"p\">,</span> <span class=\"n\">bt</span><span class=\"na\">[insertBlockName]</span><span class=\"p\">))</span><span class=\"c1\">//æ’å…¥å—&lt;4&gt;\n</span><span class=\"c1\"></span>                <span class=\"p\">{</span>\n                    <span class=\"n\">btr</span><span class=\"p\">.</span><span class=\"n\">AppendEntity</span><span class=\"p\">(</span><span class=\"n\">brf</span><span class=\"p\">);</span>\n                    <span class=\"n\">trans</span><span class=\"p\">.</span><span class=\"n\">AddNewlyCreatedDBObject</span><span class=\"p\">(</span><span class=\"n\">brf</span><span class=\"p\">,</span><span class=\"k\">true</span><span class=\"p\">);</span>   \n                <span class=\"p\">}</span>\n                <span class=\"n\">trans</span><span class=\"p\">.</span><span class=\"n\">Commit</span><span class=\"p\">();</span>\n            <span class=\"p\">}</span>               \n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n</code></pre></div><p><b>ç›¸å…³çŸ¥è¯†ç‚¹è¯´æ˜ï¼š</b></p><p>&lt;1&gt;</p><p>public Database(bool buildDefaultDrawing, bool noDocument);</p><p>æè¿°:</p><p>Databaseçš„æ„é€ å‡½æ•°</p><p>å‚æ•°ï¼š</p><p>buildDefaultDrawing ï¼štrue-ä¸ºç”Ÿæˆçš„æ•°æ®åº“æ·»åŠ åŸºæœ¬æ•°æ®ï¼ˆå¦‚åŸºæœ¬çš„ç¬¦å·è¡¨ç­‰ï¼‰ï¼›flase-ç©ºæ•°æ®åº“</p><p>noDocumentï¼štrue-åˆ›å»ºçš„æ•°æ®åº“ä¸å…³è”åˆ°å½“å‰æ–‡æ¡£ï¼›false-å…³è”</p><p>&lt;2&gt;</p><p>public void ReadDwgFile(IntPtr drawingFile, FileOpenMode mode, bool allowCPConversion,  string password);</p><p>æè¿°ï¼šè¯»å–DWGæ–‡ä»¶</p><p>å‚æ•°ï¼š</p><p>drawingFileï¼šæ–‡ä»¶å®Œæ•´è·¯å¾„å</p><p>modeï¼šæšä¸¾ç±»å‹Read,ReadWrite,Write</p><p>allowCPConversionï¼štrue-ç›´æ¥è½¬æ¢ç¼–ç ï¼Œfalse-å¼¹å‡ºå¯¹è¯æ¡†æç¤º</p><p>passwordï¼šdwgæ–‡ä»¶çš„å¯†ç ï¼Œæ²¡æœ‰åˆ™ä¸ºnull;</p><p class=\"ztext-empty-paragraph\"><br/></p><p>&lt;3&gt;</p><p>public void WblockCloneObjects(</p><p>   ObjectIdCollection identifiers, </p><p>   ObjectId id, ã€Š</p><p>   IdMapping mapping, </p><p>   DuplicateRecordCloning cloning, </p><p>   bool deferTranslation</p><p>);</p><p>æè¿°ï¼šå°†å¤–éƒ¨æ–‡ä»¶çš„å—å¤åˆ¶åˆ°å½“å‰æ•°æ®åº“</p><p>å‚æ•°ï¼š</p><p>identifiersï¼šå¤–éƒ¨æ–‡ä»¶ä¸­å—çš„ObjectIdçš„é›†åˆ</p><p>idï¼šå—å¤åˆ¶çš„ç›®æ ‡ç‚¹ï¼ˆå¦‚å½“å‰æ•°æ®åº“çš„å—è¡¨ï¼‰</p><p>mappingï¼šæºå¯¹è±¡å’Œå¤åˆ¶å¯¹è±¡çš„å¯¹åº”å…³ç³»</p><p>cloningï¼šæœ‰ç›¸åŒå¯¹è±¡åæ—¶çš„å¤åˆ¶æ–¹å¼ Ignore å¿½ç•¥ ï¼›Replace æ›¿æ¢</p><p>deferTranslationï¼šæ˜¯å¦è¿›è¡ŒIDè½¬ç§»ï¼Œä¸€èˆ¬è®¾ç½®ä¸º false</p><p>&lt;4&gt;</p><p>public BlockReference(Point3d position,  ObjectId blockTableRecord);</p><p>æè¿°:å—å‚ç…§çš„æ„é€ å‡½æ•°;å—å‚ç…§å¯ä»¥ç®€å•ç†è§£ä¸ºå—å®šä¹‰çš„å®ç°ï¼Œä¹Ÿå°±æ˜¯åœ¨æ–‡æ¡£ä¸­æ’å…¥çš„å—ï¼›å—å‚ç…§çš„æ“ä½œå’Œæ™®é€šå®ä½“ä¸€æ ·ï¼›</p><p>å‚æ•°ï¼š</p><p>positionï¼šæ’å…¥ç‚¹</p><p>blockTableRecordï¼šå—çš„ObjectId</p><p>&lt;è·å–æ’å…¥ç‚¹&gt;</p><p>PromptPointResult getPoint = ed.GetPoint(&#34;è¯·é€‰æ‹©æ’å…¥ç‚¹&#34;);</p><p>Point3d p = getPoint.Value;</p>", 
            "topic": [
                {
                    "tag": "C#", 
                    "tagLink": "https://api.zhihu.com/topics/19590712"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/32346882", 
            "userName": "å¤§ésb", 
            "userLink": "https://www.zhihu.com/people/9c5ffb79f07bb76c93142898396dcb04", 
            "upvote": 1, 
            "title": "AutoCAD.NET äºŒæ¬¡å¼€å‘--è·å–æŒ‡å®šç±»å‹çš„å®ä½“ï¼ˆå®ç°æ–‡æœ¬çš„æ‰¹é‡æ›¿æ¢ï¼‰", 
            "content": "<p><b>1ã€éœ€æ±‚ï¼š</b>è·å–ä¸€ä¸ªcadæ–‡æ¡£çš„æ‰€æœ‰å•è¡Œæ–‡æœ¬ã€‚ï¼ˆä»¥æ­¤å®ç°æ–‡æœ¬çš„æ‰¹é‡æ›¿æ¢ï¼‰</p><p><b>2ã€æ€è·¯ï¼š</b>éå†æ¨¡å‹ç©ºé—´å—è¡¨è®°å½•çš„æ‰€æœ‰å®ä½“ï¼Œåˆ¤å®šå…¶ç±»å‹ï¼Œå¦‚æœæ˜¯DBTextï¼Œåˆ™åœ¨å‘½ä»¤æ ä¸­è¾“å‡ºDBTextçš„æ–‡æœ¬å†…å®¹ã€‚(ç¨ä½œä¿®æ”¹å³å¯å®ç°æ‰¹é‡æ›¿æ¢)</p><p><b>3ã€ç¯å¢ƒï¼š</b>AutoCAD 2008ï¼ŒVS 2010</p><p><b>4ã€æ­¥éª¤ï¼š</b></p><p>1)ï¼šæ–°å»ºä¸€ä¸ªç±»åº“ï¼ŒNetFramework æ¡†æ¶é€‰æ‹©3.5,æ·»åŠ AutoCAD 2008çš„ä¸¤ä¸ªdllå¼•ç”¨ï¼šacmgd.dllï¼Œacdbmgd.dllã€‚ï¼ˆåœ¨å®‰è£…ç›®å½•ä¸‹èƒ½æ‰¾åˆ°ï¼‰</p><p>2)ï¼šæ·»åŠ å‘½åç©ºé—´</p><p>Autodesk.AutoCAD.ApplicationServices; //CADå®ä½“</p><p>Autodesk.AutoCAD.EditorInput;//å‘½ä»¤æ </p><p>Autodesk.AutoCAD.Runtime;//è¿è¡Œæ—¶ï¼Œå¦‚è®¾ç½® æŒ‡ä»¤</p><p>Autodesk.AutoCAD.DatabaseServices;//æ•°æ®åº“æœåŠ¡</p><p>3) è·å–å½“å‰æ–‡æ¡£ï¼Œæ•°æ®åº“ï¼Œå’Œå‘½ä»¤æ </p><p>4) å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œè·å–æ¨¡å‹ç©ºé—´çš„æ‰€æœ‰å—è¡¨è®°å½•ï¼›</p><p>5) éå†å—è¡¨è®°å½•çš„æ‰€æœ‰å¯¹è±¡ï¼Œåˆ¤å®šæ˜¯å¦ä¸ºå•è¡Œæ–‡æœ¬ï¼Œå¦‚æœæ˜¯åˆ™åœ¨å‘½ä»¤æ è¾“å‡ºæ–‡æœ¬å†…å®¹ã€‚</p><p>6) ç¼–è¯‘å’Œè¿è¡Œ</p><p> æ‰“å¼€CADï¼Œè¾“å…¥netload åŠ è½½ç¼–è¯‘çš„dllï¼Œè¾“å…¥æŒ‡ä»¤ï¼šsssï¼Œå³å¯çœ‹åˆ°è¿è¡Œæ•ˆæœ</p><div class=\"highlight\"><pre><code class=\"language-csharp\"><span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.ApplicationServices</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.EditorInput</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.Runtime</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"nn\">Autodesk.AutoCAD.DatabaseServices</span><span class=\"p\">;</span>\n<span class=\"k\">namespace</span> <span class=\"nn\">HelloWord</span>\n<span class=\"p\">{</span>\n    <span class=\"k\">public</span> <span class=\"k\">class</span> <span class=\"nc\">Class1</span>\n    <span class=\"p\">{</span><span class=\"na\">\n</span><span class=\"na\">        [CommandMethod(&#34;sss&#34;)]</span>\n        <span class=\"k\">public</span> <span class=\"k\">void</span> <span class=\"n\">Hello</span><span class=\"p\">()</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">Document</span> <span class=\"n\">doc</span> <span class=\"p\">=</span> <span class=\"n\">Application</span><span class=\"p\">.</span><span class=\"n\">DocumentManager</span><span class=\"p\">.</span><span class=\"n\">MdiActiveDocument</span><span class=\"p\">;</span><span class=\"c1\">//è·å–å½“å‰æ–‡æ¡£\n</span><span class=\"c1\"></span>            <span class=\"n\">Database</span> <span class=\"n\">db</span> <span class=\"p\">=</span> <span class=\"n\">doc</span><span class=\"p\">.</span><span class=\"n\">Database</span><span class=\"p\">;</span><span class=\"c1\">//è·å–å½“å‰æ•°æ®åº“\n</span><span class=\"c1\"></span>            <span class=\"n\">Editor</span> <span class=\"n\">ed</span><span class=\"p\">=</span><span class=\"n\">doc</span><span class=\"p\">.</span><span class=\"n\">Editor</span><span class=\"p\">;</span><span class=\"c1\">//è·å–å‘½ä»¤æ \n</span><span class=\"c1\"></span>            <span class=\"n\">using</span><span class=\"p\">(</span><span class=\"n\">Transaction</span> <span class=\"n\">trans</span><span class=\"p\">=</span><span class=\"n\">db</span><span class=\"p\">.</span><span class=\"n\">TransactionManager</span><span class=\"p\">.</span><span class=\"n\">StartTransaction</span><span class=\"p\">())</span><span class=\"c1\">//å¼€å¯äº‹åŠ¡\n</span><span class=\"c1\"></span>            <span class=\"p\">{</span>\n                <span class=\"n\">BlockTable</span> <span class=\"n\">bt</span> <span class=\"p\">=</span> <span class=\"n\">trans</span><span class=\"p\">.</span><span class=\"n\">GetObject</span><span class=\"p\">(</span><span class=\"n\">db</span><span class=\"p\">.</span><span class=\"n\">BlockTableId</span><span class=\"p\">,</span><span class=\"n\">OpenMode</span><span class=\"p\">.</span><span class=\"n\">ForRead</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">BlockTable</span><span class=\"p\">;</span><span class=\"c1\">//è·å–å—è¡¨\n</span><span class=\"c1\"></span>                <span class=\"n\">BlockTableRecord</span> <span class=\"n\">btr</span> <span class=\"p\">=</span> <span class=\"n\">trans</span><span class=\"p\">.</span><span class=\"n\">GetObject</span><span class=\"p\">(</span><span class=\"n\">bt</span><span class=\"na\">[BlockTableRecord.ModelSpace]</span><span class=\"p\">,</span><span class=\"n\">OpenMode</span><span class=\"p\">.</span><span class=\"n\">ForRead</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">BlockTableRecord</span><span class=\"p\">;</span><span class=\"c1\">//è·å–æ¨¡å‹ç©ºé—´çš„å—è¡¨è®°å½•\n</span><span class=\"c1\"></span>                <span class=\"n\">ed</span><span class=\"p\">.</span><span class=\"n\">WriteMessage</span><span class=\"p\">(</span><span class=\"s\">&#34;\\nç½—åˆ—æ‰€æœ‰å•è¡Œæ–‡æœ¬ï¼š&#34;</span><span class=\"p\">);</span>               \n                <span class=\"k\">foreach</span> <span class=\"p\">(</span><span class=\"n\">ObjectId</span> <span class=\"n\">item</span> <span class=\"k\">in</span> <span class=\"n\">btr</span><span class=\"p\">)</span>\n                <span class=\"p\">{</span>\n                    <span class=\"n\">Entity</span> <span class=\"n\">ent</span> <span class=\"p\">=</span> <span class=\"n\">trans</span><span class=\"p\">.</span><span class=\"n\">GetObject</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"p\">,</span><span class=\"n\">OpenMode</span><span class=\"p\">.</span><span class=\"n\">ForRead</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">Entity</span><span class=\"p\">;</span>\n                    <span class=\"k\">if</span><span class=\"p\">(</span><span class=\"n\">ent</span><span class=\"p\">.</span><span class=\"n\">GetType</span><span class=\"p\">()==</span><span class=\"k\">typeof</span><span class=\"p\">(</span><span class=\"n\">DBText</span><span class=\"p\">))</span><span class=\"c1\">//åˆ¤å®šæ˜¯å¦ä¸ºå•è¡Œæ–‡æœ¬\n</span><span class=\"c1\"></span>                    <span class=\"p\">{</span>\n                        <span class=\"n\">DBText</span> <span class=\"n\">text</span><span class=\"p\">=</span><span class=\"n\">ent</span> <span class=\"k\">as</span> <span class=\"n\">DBText</span><span class=\"p\">;</span>\n                        <span class=\"n\">ed</span><span class=\"p\">.</span><span class=\"n\">WriteMessage</span><span class=\"p\">(</span><span class=\"s\">&#34;\\n&#34;</span><span class=\"p\">+</span><span class=\"n\">text</span><span class=\"p\">.</span><span class=\"n\">TextString</span><span class=\"p\">);</span>\n                    <span class=\"p\">}</span>                   \n                <span class=\"p\">}</span>\n            <span class=\"p\">}</span>            \n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div><p></p>", 
            "topic": [
                {
                    "tag": "C#", 
                    "tagLink": "https://api.zhihu.com/topics/19590712"
                }
            ], 
            "comments": []
        }
    ], 
    "url": "https://zhuanlan.zhihu.com/c_147277590"
}
