{
    "title": "æˆ‘çš„æœºå™¨å­¦ä¹ ç¬”è®°", 
    "description": "åˆ†äº«ä¸€äº›æœ€æ–°åœ¨çœ‹çš„è®ºæ–‡ä»¥åŠæ­£åœ¨å­¦ä¹ çš„ç®—æ³•ã€‚æ–‡ç« å‡ä¸ºæœ¬äººåŸåˆ›ï¼Œä¸¥ç¦æŠ„è¢­ï¼Œå¦‚éœ€è½¬è½½è¯·è”ç³»æœ¬äººã€‚", 
    "followers": [
        "https://www.zhihu.com/people/edward-77-20", 
        "https://www.zhihu.com/people/chen-wei-94-11", 
        "https://www.zhihu.com/people/liu-yang-guang-zi", 
        "https://www.zhihu.com/people/hanbei-wei", 
        "https://www.zhihu.com/people/guo-yuan-tao-22", 
        "https://www.zhihu.com/people/cao-ji-49-42", 
        "https://www.zhihu.com/people/xi-huo-69-9", 
        "https://www.zhihu.com/people/wei-yuan-88-25", 
        "https://www.zhihu.com/people/gu-yu-71-65", 
        "https://www.zhihu.com/people/ren-hui-kang", 
        "https://www.zhihu.com/people/ke-eric", 
        "https://www.zhihu.com/people/ding-lao-guai-96", 
        "https://www.zhihu.com/people/tang-bao-59-49", 
        "https://www.zhihu.com/people/alahlll", 
        "https://www.zhihu.com/people/hu-tao-58", 
        "https://www.zhihu.com/people/liao-xuan-79-79", 
        "https://www.zhihu.com/people/li-lin-da-4-62", 
        "https://www.zhihu.com/people/liu-wei-ming-37-41", 
        "https://www.zhihu.com/people/shawn-young-4", 
        "https://www.zhihu.com/people/ma-chen-14-42", 
        "https://www.zhihu.com/people/da-hai-de-tong-kong-51", 
        "https://www.zhihu.com/people/litn2008", 
        "https://www.zhihu.com/people/Certified-Stimulater", 
        "https://www.zhihu.com/people/abrams-25", 
        "https://www.zhihu.com/people/miao-dong-long", 
        "https://www.zhihu.com/people/li-qian-yong-60", 
        "https://www.zhihu.com/people/duan-ya-jun", 
        "https://www.zhihu.com/people/lingche-24", 
        "https://www.zhihu.com/people/xiao-fang-yao-jia-you", 
        "https://www.zhihu.com/people/xin-ling-ji-shi-49", 
        "https://www.zhihu.com/people/xiao-sa-di-fei", 
        "https://www.zhihu.com/people/quxiaofeng", 
        "https://www.zhihu.com/people/mel-tor", 
        "https://www.zhihu.com/people/mao-lan-mao-lu", 
        "https://www.zhihu.com/people/tian-cai-jian-sheng", 
        "https://www.zhihu.com/people/rachel-yeung", 
        "https://www.zhihu.com/people/txa0515", 
        "https://www.zhihu.com/people/wu-li-xi-78", 
        "https://www.zhihu.com/people/zhang-hang-70", 
        "https://www.zhihu.com/people/bai-yan-xiao-56", 
        "https://www.zhihu.com/people/pei-hao-lei", 
        "https://www.zhihu.com/people/ming-zhi-4-69", 
        "https://www.zhihu.com/people/liu-yu-xuan-3-67", 
        "https://www.zhihu.com/people/playmaker-64", 
        "https://www.zhihu.com/people/cao-guo-wei-69", 
        "https://www.zhihu.com/people/shu-yu-mu-ge-31", 
        "https://www.zhihu.com/people/liu-lei-83-67-15", 
        "https://www.zhihu.com/people/chi-xian-sheng-25", 
        "https://www.zhihu.com/people/zzx-47-7", 
        "https://www.zhihu.com/people/bian-ze-ying-38", 
        "https://www.zhihu.com/people/niu-zhuang-qun", 
        "https://www.zhihu.com/people/sheng-lai-bo-wei-ci", 
        "https://www.zhihu.com/people/fang-gao-97", 
        "https://www.zhihu.com/people/xiao-jj-4", 
        "https://www.zhihu.com/people/wang-ruo-cun", 
        "https://www.zhihu.com/people/bang-di-70", 
        "https://www.zhihu.com/people/sushupro", 
        "https://www.zhihu.com/people/li-peng-41-64", 
        "https://www.zhihu.com/people/dong-sheng-99-63", 
        "https://www.zhihu.com/people/yunzhongke", 
        "https://www.zhihu.com/people/luo-wei-bin-35", 
        "https://www.zhihu.com/people/mrtian-11-90", 
        "https://www.zhihu.com/people/augustus-74", 
        "https://www.zhihu.com/people/rainbow_jjh", 
        "https://www.zhihu.com/people/long-yixiang", 
        "https://www.zhihu.com/people/liu-bo-11-42-89", 
        "https://www.zhihu.com/people/myluo", 
        "https://www.zhihu.com/people/ding-ding-14-48-13", 
        "https://www.zhihu.com/people/an-du-65", 
        "https://www.zhihu.com/people/mou-shan-lei-51", 
        "https://www.zhihu.com/people/bian-shu-qing", 
        "https://www.zhihu.com/people/lihongyuers", 
        "https://www.zhihu.com/people/yooyoo2004", 
        "https://www.zhihu.com/people/zhang-bai-zheng", 
        "https://www.zhihu.com/people/jason-ding-28", 
        "https://www.zhihu.com/people/hu-lin-2", 
        "https://www.zhihu.com/people/li-xiang-73-34", 
        "https://www.zhihu.com/people/li-yang-zhong-86", 
        "https://www.zhihu.com/people/liu-lin-qi-78", 
        "https://www.zhihu.com/people/begeekmyfriend", 
        "https://www.zhihu.com/people/hong-alex", 
        "https://www.zhihu.com/people/go-ro-87", 
        "https://www.zhihu.com/people/duan-xing-99", 
        "https://www.zhihu.com/people/nan-yang-wu-hao", 
        "https://www.zhihu.com/people/ai-meng-meng-de-guai-qiao-ge", 
        "https://www.zhihu.com/people/mr-lin-82-68", 
        "https://www.zhihu.com/people/pang-yu-long", 
        "https://www.zhihu.com/people/kyle-chen-15", 
        "https://www.zhihu.com/people/xi-ze-wen", 
        "https://www.zhihu.com/people/fan-fan-26-41", 
        "https://www.zhihu.com/people/qian-qing-he", 
        "https://www.zhihu.com/people/alex-48-90", 
        "https://www.zhihu.com/people/xue-gao-24-65", 
        "https://www.zhihu.com/people/qiu-xian-sheng-69-64", 
        "https://www.zhihu.com/people/chevson", 
        "https://www.zhihu.com/people/zou-xiao-dong-59", 
        "https://www.zhihu.com/people/dong-dong-46-64", 
        "https://www.zhihu.com/people/1111112222", 
        "https://www.zhihu.com/people/zhong-er-cheng-xu-yuan", 
        "https://www.zhihu.com/people/chen-bo-86-42", 
        "https://www.zhihu.com/people/wei-zhang-52-25", 
        "https://www.zhihu.com/people/zhilingth", 
        "https://www.zhihu.com/people/gogo-30-43", 
        "https://www.zhihu.com/people/ykp-41", 
        "https://www.zhihu.com/people/frcskoh", 
        "https://www.zhihu.com/people/yang-ye-79", 
        "https://www.zhihu.com/people/liu-fei-94-95", 
        "https://www.zhihu.com/people/shuai-qi-de-da-ge-ge-5", 
        "https://www.zhihu.com/people/alex-45-44-1", 
        "https://www.zhihu.com/people/zhan-xun-lin", 
        "https://www.zhihu.com/people/cheng-guang-lei-40", 
        "https://www.zhihu.com/people/meng-bi-you-si-53", 
        "https://www.zhihu.com/people/sirice", 
        "https://www.zhihu.com/people/vincent-chong-40", 
        "https://www.zhihu.com/people/guang1991", 
        "https://www.zhihu.com/people/yue-liang-yu-liu-bian-shi-29-61", 
        "https://www.zhihu.com/people/windisrising", 
        "https://www.zhihu.com/people/qinlibo_nlp", 
        "https://www.zhihu.com/people/hwanji", 
        "https://www.zhihu.com/people/4recommend", 
        "https://www.zhihu.com/people/dgjk1010", 
        "https://www.zhihu.com/people/da-qi-85-21", 
        "https://www.zhihu.com/people/tian-ma-72xiao-shi", 
        "https://www.zhihu.com/people/wht-buaa", 
        "https://www.zhihu.com/people/niceworld-49-6", 
        "https://www.zhihu.com/people/zhang-jia-yi-6-82", 
        "https://www.zhihu.com/people/wang-lang-96-64", 
        "https://www.zhihu.com/people/zhairui", 
        "https://www.zhihu.com/people/li-sheng-38-23", 
        "https://www.zhihu.com/people/ni-wei-tai-yang", 
        "https://www.zhihu.com/people/k_liu007", 
        "https://www.zhihu.com/people/xpxpx", 
        "https://www.zhihu.com/people/boney-62", 
        "https://www.zhihu.com/people/yu-ji-shi-17", 
        "https://www.zhihu.com/people/an-ran-57", 
        "https://www.zhihu.com/people/wx31eac9e634f9147b", 
        "https://www.zhihu.com/people/sun-peng-fei-45", 
        "https://www.zhihu.com/people/summer-82-63-57", 
        "https://www.zhihu.com/people/tc-yi", 
        "https://www.zhihu.com/people/ni-hui-51-23", 
        "https://www.zhihu.com/people/wu-ye-nan-30", 
        "https://www.zhihu.com/people/she-liang", 
        "https://www.zhihu.com/people/ltt-60-73", 
        "https://www.zhihu.com/people/constantine-6-2", 
        "https://www.zhihu.com/people/zipoki", 
        "https://www.zhihu.com/people/lzwujun-78", 
        "https://www.zhihu.com/people/tkmeng-pie-huan-zai"
    ], 
    "article": [
        {
            "url": "https://zhuanlan.zhihu.com/p/85768094", 
            "userName": "Ivan Yan", 
            "userLink": "https://www.zhihu.com/people/3677a61f41a4d1cd630d63e270524c07", 
            "upvote": 196, 
            "title": "å›¾ç¥ç»ç½‘ç»œï¼šThe Graph Neural Network Model", 
            "content": "<p>å›¾ç¥ç»ç½‘ç»œï¼ˆGNNï¼‰æœ€è¿‘å¾ˆç«ï¼Œå¾ˆå¤šè‡ªç„¶è¯­è¨€çš„è®ºæ–‡éƒ½ç”¨ä¸Šäº†GNNç½‘ç»œã€‚æ­£å¥½å‡‘ç©ºå­¦ä¹ ä¸€ä¸‹å…³äºGNNç½‘ç»œçš„çŸ¥è¯†ã€‚å¯¹äºä¸ç†Ÿæ‚‰GNNçš„æœ‹å‹ï¼Œå¯ä»¥å…ˆçœ‹[1]ï¼Œæ²¿ç€å›¾ç¥ç»ç½‘ç»œçš„å†å²è„‰ç»œï¼Œä»‹ç»äº†ç»å…¸çš„å›¾ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚è¿™ç¯‡æ–‡ç« çš„ä¸»è¦ç›®çš„æ˜¯ç»“åˆpythonä»£ç æ¥è®²è§£Graph Neural Network Modelå¦‚ä½•å®ç°ï¼Œä»£ç ä¸»è¦å‚è€ƒ[2]ã€‚</p><h2>1ã€è®ºæ–‡å†…å®¹ç®€ä»‹</h2><p>å›¾ç¥ç»ç½‘ç»œæœ€æ—©çš„æ¦‚å¿µåº”è¯¥èµ·æºäºä»¥ä¸‹ä¸¤ç¯‡è®ºæ–‡ã€‚</p><a href=\"https://link.zhihu.com/?target=https%3A//link.springer.com/chapter/10.1007/978-3-540-27868-9_4\" data-draft-node=\"block\" data-draft-type=\"link-card\" data-image=\"https://pic1.zhimg.com/v2-dad5c7906f642df4a7352bf2939bdc38_120x160.jpg\" data-image-width=\"153\" data-image-height=\"232\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Graphical-Based Learning Environments for Pattern Recognition</a><a href=\"https://link.zhihu.com/?target=https%3A//ieeexplore.ieee.org/document/4700287\" data-draft-node=\"block\" data-draft-type=\"link-card\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">The Graph Neural Network Model</a><p>09å¹´è¿™ç¯‡è®ºæ–‡å¯¹04å¹´è¿™ç¯‡è¿›è¡Œäº†è¡¥å……ï¼Œå†…å®¹å¤§è‡´å·®ä¸å¤šã€‚å¦‚æœè¦é˜…è¯»åŸæ–‡çš„æœ‹å‹ï¼Œç›´æ¥è¯»ç¬¬äºŒç¯‡å°±å¯ä»¥äº†ã€‚</p><p>ç¥ç»ç½‘ç»œæœ€å¸¸è§çš„åº”ç”¨é¢†åŸŸå°±æ˜¯å›¾ç‰‡ï¼Œè€Œå›¾ç¥ç»ç½‘ç»œä¸»è¦ç”¨äºå¤„ç†å›¾è®ºä¸­çš„å›¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå›¾ç‰‡å¼•ç”¨è‡ª[3]ï¼š</p><figure data-size=\"normal\"><noscript><img src=\"https://pic3.zhimg.com/v2-fabefb9beb674fd7bc3241481487d566_b.jpg\" data-size=\"normal\" data-rawwidth=\"2782\" data-rawheight=\"1426\" class=\"origin_image zh-lightbox-thumb\" width=\"2782\" data-original=\"https://pic3.zhimg.com/v2-fabefb9beb674fd7bc3241481487d566_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;2782&#39; height=&#39;1426&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"2782\" data-rawheight=\"1426\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"2782\" data-original=\"https://pic3.zhimg.com/v2-fabefb9beb674fd7bc3241481487d566_r.jpg\" data-actualsrc=\"https://pic3.zhimg.com/v2-fabefb9beb674fd7bc3241481487d566_b.jpg\"/><figcaption>å›¾1 å·¦å›¾æ˜¯ä¼ ç»Ÿç¥ç»ç½‘ç»œå¯ä»¥å¤„ç†çš„å›¾ç‰‡ç±»å‹ï¼Œç¬¦åˆæ¬§å¼ç©ºé—´çš„è¦æ±‚ã€‚å³å›¾æ˜¯å›¾è®ºä¸­çš„å›¾ï¼Œéæ¬§å¼ç©ºé—´ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨ä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œè¿›è¡Œå¤„ç†ã€‚</figcaption></figure><p>ä¹‹å‰çš„æ–¹æ³•éƒ½æ˜¯å…ˆå°†å›¾é¢„å¤„ç†æˆèƒ½è¢«ç¥ç»ç½‘ç»œå¤„ç†çš„æ ¼å¼ï¼Œä¾‹å¦‚å°†å›¾è¡¨ç¤ºæˆç»“ç‚¹åºåˆ—ï¼Œä½†è¿™ä¼šä¸¢å¤±å¾ˆå¤šæ‹“æ‰‘ä¿¡æ¯ã€‚GNNå¯ä»¥ç›´æ¥å¤„ç†å›¾ï¼Œå°†å›¾æˆ–è€…å›¾ä¸­çš„ç»“ç‚¹æ˜ å°„ä¸ºå‘é‡ã€‚æ–‡ç« çš„å…·ä½“å†…å®¹ä¸ç»†è®²äº†ï¼Œå¯ä»¥å‚è€ƒåŸæ–‡ï¼Œå¤§è‡´ç®—æ³•æµç¨‹å¦‚ä¸‹[5]ï¼š</p><figure data-size=\"normal\"><noscript><img src=\"https://pic3.zhimg.com/v2-172afe24dc85337cb100132dd89f230e_b.jpg\" data-size=\"normal\" data-rawwidth=\"1652\" data-rawheight=\"606\" class=\"origin_image zh-lightbox-thumb\" width=\"1652\" data-original=\"https://pic3.zhimg.com/v2-172afe24dc85337cb100132dd89f230e_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1652&#39; height=&#39;606&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"1652\" data-rawheight=\"606\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1652\" data-original=\"https://pic3.zhimg.com/v2-172afe24dc85337cb100132dd89f230e_r.jpg\" data-actualsrc=\"https://pic3.zhimg.com/v2-172afe24dc85337cb100132dd89f230e_b.jpg\"/><figcaption>å›¾2 GNNç®—æ³•æµç¨‹</figcaption></figure><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œç®—æ³•ä¸»è¦åˆ†æˆä¸¤ä¸ªæ­¥éª¤ï¼šforward, backwardã€‚è·Ÿä¼ ç»Ÿç¥ç»ç½‘ç»œçš„forwardã€backwardç±»ä¼¼ã€‚forwardè®¡ç®—ç»“æœï¼Œbackwardæ±‚æ¢¯åº¦ï¼Œç”¨äºç½‘ç»œè®­ç»ƒã€‚</p><p>Forwardè¿‡ç¨‹ï¼Œå…¶å®æ˜¯åšäº†è¿™æ ·ä¸€ä»¶äº‹æƒ…ï¼šå¦‚ä¸‹å›¾[5]æ‰€ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªç¯çƒƒåŒ–åˆç‰©çš„åˆ†å­ç»“æ„ï¼Œå›¾ä¸­çš„ç»“ç‚¹è¡¨ç¤ºåŸå­ï¼Œè¾¹è¡¨ç¤ºåŸå­é”®ï¼Œéœ€è¦åˆ¤æ–­å…¶æ˜¯å¦æœ‰å®³ã€‚å›¾ä¸­æ¯ä¸ªç»“ç‚¹éƒ½åŒ…å«äº†ä¸€ç³»åˆ—ç‰¹å¾ï¼ˆè®ºæ–‡ä¸­å†™æˆlabelï¼Œæˆ‘æ„Ÿè§‰ç¿»è¯‘æˆç‰¹å¾æ›´åˆé€‚ï¼‰ï¼Œä¾‹å¦‚æ¯ä¸ªåŸå­çš„ç±»å‹ã€åŸå­è‡ªèº«çš„å±æ€§ï¼ˆAtom propertiesï¼‰ã€åŒ–åˆç‰©çš„ä¸€äº›ç‰¹å¾ï¼ˆGlobal propertiesï¼‰ã€‚è¿™é‡Œå°†supervised nodeçš„è¡¨ç¤ºä½œä¸ºæ•´ä¸ªå›¾çš„è¡¨ç¤ºã€‚ä½†æ˜¯ï¼Œsupervised nodeå¹¶ä¸åŒ…å«æ•´ä¸ªå›¾çš„ä¿¡æ¯ã€‚æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯å°†æ‰€æœ‰çš„ç»“ç‚¹çš„ç‰¹å¾ç›¸åŠ ï¼Œä½œä¸ºæ•´ä¸ªå›¾çš„è¡¨ç¤ºï¼Œä½†æ˜¯è¿™æ ·å¹¶æ²¡æœ‰è€ƒè™‘å›¾çš„æ‹“æ‰‘ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥å‡è®¾ç»“ç‚¹çš„ä¿¡æ¯ä¼šæ²¿ç€è¾¹ä¼ é€’ç»™ç›¸é‚»çš„ç»“ç‚¹ã€‚è¿™æ ·ï¼Œåœ¨è¿­ä»£tæ¬¡ä¹‹åï¼Œåˆ°è¾¾ç¨³å®šçŠ¶æ€ä¹‹åï¼Œsupervised nodeå°±åŒ…å«äº†æ•´ä¸ªå›¾çš„ä¿¡æ¯ã€‚è¿™é‡Œï¼Œåªè¦æ„å»ºçš„ <img src=\"https://www.zhihu.com/equation?tex=F_w\" alt=\"F_w\" eeimg=\"1\"/> æ»¡è¶³å›ºå®šç‚¹ç†è®ºçš„è¦æ±‚ï¼Œç»“ç‚¹çš„çŠ¶æ€æœ€ç»ˆä¼šè¾¾åˆ°ä¸€ä¸ªç¨³å®šçŠ¶æ€ã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic2.zhimg.com/v2-c5bc9dc8f7f18bd359d85f23ce122dc9_b.jpg\" data-size=\"normal\" data-rawwidth=\"565\" data-rawheight=\"374\" class=\"origin_image zh-lightbox-thumb\" width=\"565\" data-original=\"https://pic2.zhimg.com/v2-c5bc9dc8f7f18bd359d85f23ce122dc9_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;565&#39; height=&#39;374&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"565\" data-rawheight=\"374\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"565\" data-original=\"https://pic2.zhimg.com/v2-c5bc9dc8f7f18bd359d85f23ce122dc9_r.jpg\" data-actualsrc=\"https://pic2.zhimg.com/v2-c5bc9dc8f7f18bd359d85f23ce122dc9_b.jpg\"/><figcaption>å›¾3 GNNä¸¾ä¾‹ï¼šåˆ¤æ–­ç¯çƒƒåŒ–åˆç‰©æ˜¯å¦æœ‰å®³</figcaption></figure><p>Forwardçš„å…·ä½“è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾[4]æ‰€ç¤ºï¼Œ <img src=\"https://www.zhihu.com/equation?tex=F_w\" alt=\"F_w\" eeimg=\"1\"/> æ ¹æ®å½“å‰çˆ¶ç»“ç‚¹ï¼Œç›¸é‚»å­ç»“ç‚¹ï¼Œç›¸è¿çš„è¾¹çš„ç‰¹å¾åŠçŠ¶æ€å¯¹å½“å‰çˆ¶ç»“ç‚¹çš„çŠ¶æ€è¿›è¡Œæ›´æ–°ï¼Œç„¶åè¿­ä»£tæ¬¡ï¼Œè¾¾åˆ°ç¨³å®šçŠ¶æ€ä¹‹åï¼ˆè¿™é‡Œçš„åˆ¤æ–­æ¡ä»¶æ˜¯ç»“ç‚¹çŠ¶æ€çš„å˜åŒ–å°äº <img src=\"https://www.zhihu.com/equation?tex=%5Cvarepsilon_f\" alt=\"\\varepsilon_f\" eeimg=\"1\"/> ï¼‰ï¼Œ <img src=\"https://www.zhihu.com/equation?tex=G_w\" alt=\"G_w\" eeimg=\"1\"/> æ ¹æ®å½“å‰ç»“ç‚¹çš„çŠ¶æ€ï¼Œè¾“å‡ºç»“ç‚¹çš„outputã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic3.zhimg.com/v2-90945baf5e09e78c26df1916c71ed772_b.jpg\" data-size=\"normal\" data-rawwidth=\"1151\" data-rawheight=\"500\" class=\"origin_image zh-lightbox-thumb\" width=\"1151\" data-original=\"https://pic3.zhimg.com/v2-90945baf5e09e78c26df1916c71ed772_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1151&#39; height=&#39;500&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"1151\" data-rawheight=\"500\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1151\" data-original=\"https://pic3.zhimg.com/v2-90945baf5e09e78c26df1916c71ed772_r.jpg\" data-actualsrc=\"https://pic3.zhimg.com/v2-90945baf5e09e78c26df1916c71ed772_b.jpg\"/><figcaption>å›¾4 å›¾ä»¥åŠå®ƒå¯¹åº”çš„ç¼–ç ç½‘ç»œ</figcaption></figure><p>ä»ä¸Šè¿°çš„æè¿°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™ä¸ªè¿‡ç¨‹å’ŒRNNçš„è¿‡ç¨‹éå¸¸ç›¸ä¼¼ï¼Œå› æ­¤è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå¯ä»¥è¡¨ç¤ºæˆRNNçš„å½¢å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º[4]ï¼š</p><figure data-size=\"normal\"><noscript><img src=\"https://pic1.zhimg.com/v2-7030b07d89aeaeda2429bdf04fba31fc_b.jpg\" data-size=\"normal\" data-rawwidth=\"1109\" data-rawheight=\"419\" class=\"origin_image zh-lightbox-thumb\" width=\"1109\" data-original=\"https://pic1.zhimg.com/v2-7030b07d89aeaeda2429bdf04fba31fc_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1109&#39; height=&#39;419&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"1109\" data-rawheight=\"419\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1109\" data-original=\"https://pic1.zhimg.com/v2-7030b07d89aeaeda2429bdf04fba31fc_r.jpg\" data-actualsrc=\"https://pic1.zhimg.com/v2-7030b07d89aeaeda2429bdf04fba31fc_b.jpg\"/><figcaption>å›¾5 å›¾ç¼–ç ç½‘ç»œå±•å¼€æˆRNNçš„å½¢å¼</figcaption></figure><p>Backwardè¿‡ç¨‹çš„ç›®çš„åœ¨äºæ±‚è§£ <img src=\"https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+e_w%7D%7B%5Cpartial+w%7D\" alt=\"\\frac{\\partial e_w}{\\partial w}\" eeimg=\"1\"/> ï¼Œè¿™é‡Œ <img src=\"https://www.zhihu.com/equation?tex=e_w\" alt=\"e_w\" eeimg=\"1\"/> æ˜¯æŸå¤±å‡½æ•°ã€‚è·Ÿforwardè¿‡ç¨‹ç±»å‹ï¼Œä¹Ÿæ˜¯æ‰¾åˆ°tæ—¶åˆ»ä½¿å¾—æ¢¯åº¦å¤„äºä¸€ä¸ªç¨³å®šçŠ¶æ€ã€‚ç„¶åæ±‚è§£tæ—¶åˆ»çš„æ¢¯åº¦ <img src=\"https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+e_w%7D%7B%5Cpartial+w%7D\" alt=\"\\frac{\\partial e_w}{\\partial w}\" eeimg=\"1\"/> ã€‚</p><h2>2ã€åŸºäºçŸ©é˜µå½¢å¼çš„GNNæ¨¡å‹å®ç°</h2><p>Forwardçš„çŸ©é˜µå®ç°å‚è€ƒäº†[6]ï¼Œä¸ºäº†æ–¹ä¾¿åé¢çš„ä»£ç ä»‹ç»ï¼Œæˆ‘åœ¨è¿™é‡Œç®€å•æè¿°ä¸€ä¸‹ï¼Œè¿™é‡Œç”¨çš„å›¾ç‰‡ä¹Ÿæ˜¯æ¥è€…[6]ã€‚</p><p>å¯¹äºæ¯ä¸ªå›¾ï¼Œè½¬åŒ–æˆå›¾6ä¸­é—´çš„çŸ©é˜µå½¢å¼ï¼Œç¬¬ä¸€åˆ—è¡¨ç¤ºçˆ¶ç»“ç‚¹idï¼Œç¬¬äºŒåˆ—è¡¨ç¤ºå­ç»“ç‚¹idï¼Œç¬¬ä¸‰åˆ—è¡¨ç¤ºçˆ¶ç»“ç‚¹æ ‡ç­¾ï¼Œç¬¬å››åˆ—è¡¨ç¤ºå­ç»“ç‚¹æ ‡ç­¾ï¼Œç¬¬äº”åˆ—è¡¨ç¤ºè¾¹çš„æ ‡ç­¾ï¼Œç¬¬å…­åˆ—è¡¨ç¤ºå­ç»“ç‚¹ <img src=\"https://www.zhihu.com/equation?tex=t-1\" alt=\"t-1\" eeimg=\"1\"/> æ—¶åˆ»çš„çŠ¶æ€ã€‚è¿™é‡Œçš„æ ‡ç­¾ç†è§£æˆç‰¹å¾æ›´åŠ åˆé€‚ï¼Œä¸ç„¶å®¹æ˜“å’Œåé¢éœ€è¦é¢„æµ‹çš„ç»“ç‚¹æ ‡ç­¾å¼„æ··ã€‚å› æ­¤ï¼Œæ¯ä¸€è¡Œå¯¹åº”ä¸€æ¡è¾¹ã€‚é€šè¿‡å‡½æ•°få¾—åˆ°æ¯æ¡è¾¹åœ¨ <img src=\"https://www.zhihu.com/equation?tex=t\" alt=\"t\" eeimg=\"1\"/> æ—¶åˆ»å¯¹çˆ¶ç»“ç‚¹çŠ¶æ€çš„è´¡çŒ®ï¼Œå³çˆ¶ç»“ç‚¹ç›¸è¿çš„å­ç»“ç‚¹å¯¹çˆ¶ç»“ç‚¹çŠ¶æ€çš„è´¡çŒ®ï¼Œå¦‚å›¾6å³ä¾§çš„çŸ©é˜µæ‰€ç¤ºã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic2.zhimg.com/v2-e336ea0c8508deb9f263928048043841_b.jpg\" data-size=\"normal\" data-rawwidth=\"1255\" data-rawheight=\"385\" class=\"origin_image zh-lightbox-thumb\" width=\"1255\" data-original=\"https://pic2.zhimg.com/v2-e336ea0c8508deb9f263928048043841_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1255&#39; height=&#39;385&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"1255\" data-rawheight=\"385\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1255\" data-original=\"https://pic2.zhimg.com/v2-e336ea0c8508deb9f263928048043841_r.jpg\" data-actualsrc=\"https://pic2.zhimg.com/v2-e336ea0c8508deb9f263928048043841_b.jpg\"/><figcaption>å›¾6 è®¡ç®—æ¯æ¡è¾¹åœ¨ t æ—¶åˆ»å¯¹çˆ¶ç»“ç‚¹çŠ¶æ€çš„è´¡çŒ®</figcaption></figure><p>åŒæ—¶ï¼Œä¸ºäº†èšåˆå­ç»“ç‚¹å¯¹çˆ¶ç»“ç‚¹çš„çŠ¶æ€ï¼Œéœ€è¦æ„é€ å›¾7æ‰€ç¤ºçš„ä¸€ä¸ªçŸ©é˜µï¼Œè¡Œè¡¨ç¤ºè¾¹ï¼Œåˆ—è¡¨ç¤ºç»“ç‚¹ï¼Œæ•°å€¼1è¡¨ç¤ºæ˜¯å¦ä»¥è¯¥ç»“ç‚¹ä½œä¸ºè¾¹çš„çˆ¶ç»“ç‚¹ã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic4.zhimg.com/v2-c092292466238aeef3dc8092ce647647_b.jpg\" data-size=\"normal\" data-rawwidth=\"903\" data-rawheight=\"502\" class=\"origin_image zh-lightbox-thumb\" width=\"903\" data-original=\"https://pic4.zhimg.com/v2-c092292466238aeef3dc8092ce647647_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;903&#39; height=&#39;502&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"903\" data-rawheight=\"502\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"903\" data-original=\"https://pic4.zhimg.com/v2-c092292466238aeef3dc8092ce647647_r.jpg\" data-actualsrc=\"https://pic4.zhimg.com/v2-c092292466238aeef3dc8092ce647647_b.jpg\"/><figcaption>å›¾7 è¾¹å’Œçˆ¶ç»“ç‚¹çš„å…³ç³»çŸ©é˜µ</figcaption></figure><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šé¢å¾—åˆ°çš„ä¸¤ä¸ªçŸ©é˜µï¼ŒåšçŸ©é˜µä¹˜æ³•å¾—åˆ°èšåˆçš„çˆ¶ç»“ç‚¹çŠ¶æ€è¡¨ç¤ºï¼Œå¦‚å›¾8æ‰€ç¤ºã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic3.zhimg.com/v2-3c797ca74fcfd0e1203a97b1cbcb70ee_b.jpg\" data-size=\"normal\" data-rawwidth=\"1365\" data-rawheight=\"514\" class=\"origin_image zh-lightbox-thumb\" width=\"1365\" data-original=\"https://pic3.zhimg.com/v2-3c797ca74fcfd0e1203a97b1cbcb70ee_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1365&#39; height=&#39;514&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"1365\" data-rawheight=\"514\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1365\" data-original=\"https://pic3.zhimg.com/v2-3c797ca74fcfd0e1203a97b1cbcb70ee_r.jpg\" data-actualsrc=\"https://pic3.zhimg.com/v2-3c797ca74fcfd0e1203a97b1cbcb70ee_b.jpg\"/><figcaption>å›¾8 èšåˆæ¯æ¡è¾¹åœ¨ t æ—¶åˆ»å¯¹çˆ¶ç»“ç‚¹çŠ¶æ€çš„è´¡çŒ®ï¼Œå¾—åˆ°çˆ¶ç»“ç‚¹çš„çŠ¶æ€</figcaption></figure><h2>3ã€GNNæ¨¡å‹çš„pythonä»£ç å®ç°</h2><p>ä¸‹é¢ï¼Œé€šè¿‡ä¸€ä¸ªä¾‹å­è®²è§£å¦‚ä½•ä½¿ç”¨pythonï¼Œtensorflowå®ç°GNNã€‚ä»»åŠ¡æ˜¯å°†å›¾åˆ†å‰²æˆ2éƒ¨åˆ†ï¼Œå³å°†å›¾ä¸­çš„ç»“ç‚¹åˆ†æˆä¸¤ç±»ã€‚ä»£ç æ¥è‡ª[2]ï¼Œä¸ºäº†æ˜“è¯»æ€§ï¼Œæˆ‘ç®€åŒ–äº†ä»£ç ï¼Œå®Œæ•´çš„ä»£ç è¯·è§<a href=\"https://link.zhihu.com/?target=https%3A//github.com/Ivan0131/gnn_demo\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">github.com/Ivan0131/gnn</span><span class=\"invisible\">_demo</span><span class=\"ellipsis\"></span></a>ã€‚</p><div class=\"highlight\"><pre><code class=\"language-python3\"><span class=\"c1\"># reading train, validation dataset</span>\n<span class=\"n\">data_path</span> <span class=\"o\">=</span> <span class=\"s2\">&#34;./data&#34;</span>\n<span class=\"n\">set_name</span> <span class=\"o\">=</span> <span class=\"s2\">&#34;sub_15_7_200&#34;</span>\n<span class=\"c1\">############# training set ################</span>\n<span class=\"n\">inp</span><span class=\"p\">,</span> <span class=\"n\">arcnode</span><span class=\"p\">,</span> <span class=\"n\">nodegraph</span><span class=\"p\">,</span> <span class=\"n\">nodein</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">_</span> <span class=\"o\">=</span> <span class=\"n\">gnn_utils</span><span class=\"o\">.</span><span class=\"n\">set_load_general</span><span class=\"p\">(</span><span class=\"n\">data_path</span><span class=\"p\">,</span> <span class=\"s2\">&#34;train&#34;</span><span class=\"p\">,</span> <span class=\"n\">set_name</span><span class=\"o\">=</span><span class=\"n\">set_name</span><span class=\"p\">)</span>\n<span class=\"n\">inp</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">a</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">:]</span> <span class=\"k\">for</span> <span class=\"n\">a</span> <span class=\"ow\">in</span> <span class=\"n\">inp</span><span class=\"p\">]</span>\n<span class=\"c1\">############ validation set #############</span>\n<span class=\"n\">inp_val</span><span class=\"p\">,</span> <span class=\"n\">arcnode_val</span><span class=\"p\">,</span> <span class=\"n\">nodegraph_val</span><span class=\"p\">,</span> <span class=\"n\">nodein_val</span><span class=\"p\">,</span> <span class=\"n\">labels_val</span><span class=\"p\">,</span> <span class=\"n\">_</span> <span class=\"o\">=</span> <span class=\"n\">gnn_utils</span><span class=\"o\">.</span><span class=\"n\">set_load_general</span><span class=\"p\">(</span><span class=\"n\">data_path</span><span class=\"p\">,</span> <span class=\"s2\">&#34;validation&#34;</span><span class=\"p\">,</span> <span class=\"n\">set_name</span><span class=\"o\">=</span><span class=\"n\">set_name</span><span class=\"p\">)</span>\n<span class=\"n\">inp_val</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">a</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">:]</span> <span class=\"k\">for</span> <span class=\"n\">a</span> <span class=\"ow\">in</span> <span class=\"n\">inp_val</span><span class=\"p\">]</span></code></pre></div><p>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œç›´æ¥ä½¿ç”¨äº†[3]çš„æ•°æ®è¯»å–ï¼Œé‡ç‚¹è®²è§£GNNçš„å®ç°ã€‚å…¶ä¸­inpæ˜¯å‰é¢æåˆ°çš„å›¾6ä¸­çš„çŸ©é˜µï¼Œarcnodeæ˜¯å›¾7ä¸­çŸ©é˜µã€‚inpå’Œå›¾6ä¸­çš„çŸ©é˜µç•¥æœ‰ä¸åŒï¼Œå‰2åˆ—è¿˜æ˜¯çˆ¶ç»“ç‚¹å’Œå­ç»“ç‚¹çš„idï¼Œåé¢4åˆ—æ˜¯çˆ¶ç»“ç‚¹å’Œå­ç»“ç‚¹çš„å››ä¸ªç‰¹å¾ï¼Œè¿™é‡Œæˆ‘ä»¬å»é™¤ç¬¬ä¸€åˆ—ï¼ˆçˆ¶ç»“ç‚¹id)ï¼Œå› ä¸ºåé¢è®¡ç®—ç”¨ä¸åˆ°ã€‚nodegraphè¡¨ç¤ºå„ä¸ªç»“ç‚¹å±äºå“ªä¸ªå›¾ï¼Œå¯¹æ•´ä¸ªå›¾åšé¢„æµ‹çš„æ—¶å€™ç”¨çš„åˆ°ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ä¸åˆ°ï¼Œnodeinæ˜¯å›¾ç»“ç‚¹æ•°é‡ï¼Œlabelsæ˜¯æˆ‘ä»¬è¦é¢„æµ‹çš„æ¯ä¸ªç»“ç‚¹çš„æ ‡ç­¾ã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\">def f_w(inp):\n    with tf.variable_scope(&#39;State_net&#39;):\n        layer1 = tf.layers.dense(inp, 5, activation=tf.nn.sigmoid)\n        layer2 = tf.layers.dense(layer1, state_dim, activation=tf.nn.sigmoid)\n        return layer2\ndef g_w(inp):\n    with tf.variable_scope(&#39;Output_net&#39;):\n        layer1 = tf.layers.dense(inp, 5, activation=tf.nn.sigmoid)\n        layer2 = tf.layers.dense(layer1, output_dim, activation=None)\n        return layer2</code></pre></div><p>å®šä¹‰f<i>wå’Œ g_w</i>å‡½æ•°ï¼Œéƒ½ç”±ä¸¤å±‚å…¨è¿æ¥ç»„æˆã€‚è¿™é‡Œf_wå‡½æ•°å®ç°çš„æ˜¯è®¡ç®—æ¯æ¡è¾¹å¯¹çˆ¶ç»“ç‚¹çŠ¶æ€çš„è´¡çŒ®ï¼Œè§å›¾6ï¼Œè¿˜éœ€è¦åŠ ä¸Šå›¾8èšåˆçš„è¿‡ç¨‹æ‰æ˜¯ <img src=\"https://www.zhihu.com/equation?tex=f_w\" alt=\"f_w\" eeimg=\"1\"/> ã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\">#init input placeholder\ncomp_inp = tf.placeholder(tf.float32, shape=(None, input_dim), name=&#34;input&#34;)\ny = tf.placeholder(tf.float32, shape=(None, output_dim), name=&#34;target&#34;)\n\n# state(t) &amp; state(t-1)\nstate = tf.placeholder(tf.float32, shape=(None, state_dim), name=&#34;state&#34;)\nstate_old = tf.placeholder(tf.float32, shape=(None, state_dim), name=&#34;old_state&#34;)\n\n# arch-node conversion matrix\nArcNode = tf.sparse_placeholder(tf.float32, name=&#34;ArcNode&#34;)</code></pre></div><p>å®šä¹‰tensorflowçš„palceholderç”¨äºæ•°æ®è¾“å…¥ã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\">def convergence(a, state, old_state, k):\n    with tf.variable_scope(&#39;Convergence&#39;):\n        # assign current state to old state\n        old_state = state\n        \n        # è·å–å­ç»“ç‚¹ä¸Šä¸€ä¸ªæ—¶åˆ»çš„çŠ¶æ€\n        # grub states of neighboring node \n        gat = tf.gather(old_state, tf.cast(a[:, 0], tf.int32))\n        \n        # å»é™¤ç¬¬ä¸€åˆ—ï¼Œå³å­ç»“ç‚¹çš„id\n        # slice to consider only label of the node and that of it&#39;s neighbor \n        # sl = tf.slice(a, [0, 1], [tf.shape(a)[0], tf.shape(a)[1] - 1])\n        # equivalent code\n        sl = a[:, 1:]\n        \n        # å°†å­ç»“ç‚¹ä¸Šä¸€ä¸ªæ—¶åˆ»çš„çŠ¶æ€æ”¾åˆ°æœ€åä¸€åˆ—\n        # concat with retrieved state\n        inp = tf.concat([sl, gat], axis=1)\n\n        # evaluate next state and multiply by the arch-node conversion matrix to obtain per-node states\n        #è®¡ç®—å­ç»“ç‚¹å¯¹çˆ¶ç»“ç‚¹çŠ¶æ€çš„è´¡çŒ®\n        layer1 = f_w(inp)\n        #èšåˆå­ç»“ç‚¹å¯¹çˆ¶ç»“ç‚¹çŠ¶æ€çš„è´¡çŒ®ï¼Œå¾—åˆ°å½“å‰æ—¶åˆ»çš„çˆ¶ç»“ç‚¹çš„çŠ¶æ€\n        state = tf.sparse_tensor_dense_matmul(ArcNode, layer1)\n\n        # update the iteration counter\n        k = k + 1\n    return a, state, old_state, k</code></pre></div><p>è¿™é‡Œå®ç°çš„æ˜¯å®Œæ•´çš„ <img src=\"https://www.zhihu.com/equation?tex=f_w\" alt=\"f_w\" eeimg=\"1\"/> å‡½æ•°ï¼Œå¯ä»¥åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šæ„å»ºå›¾6ä¸­çš„çŸ©é˜µï¼ˆè·å–å­ç»“ç‚¹ <img src=\"https://www.zhihu.com/equation?tex=t-1\" alt=\"t-1\" eeimg=\"1\"/> æ—¶åˆ»çš„çŠ¶æ€ï¼Œç„¶ååŠ å…¥åˆ°æœ€åä¸€åˆ—ï¼Œå¹¶å»æ‰ç¬¬ä¸€åˆ—ï¼Œå­ç»“ç‚¹idï¼‰ï¼›æ ¹æ®çˆ¶ç»“ç‚¹ç›¸è¿çš„å­ç»“ç‚¹å¯¹çˆ¶ç»“ç‚¹çŠ¶æ€çš„è´¡çŒ®ï¼Œåšç´¯åŠ ï¼Œèšåˆå¾—åˆ°çˆ¶ç»“ç‚¹ <img src=\"https://www.zhihu.com/equation?tex=t\" alt=\"t\" eeimg=\"1\"/> æ—¶åˆ»çš„çŠ¶æ€ï¼Œè¿™é‡Œä½¿ç”¨çŸ©é˜µä¹˜æ³•è®¡ç®—ã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\">def condition(a, state, old_state, k):\n    # evaluate condition on the convergence of the state\n    with tf.variable_scope(&#39;condition&#39;):\n        # æ£€æŸ¥å½“å‰çŠ¶æ€å’Œä¸Šä¸€ä¸ªæ—¶åˆ»çš„çŠ¶æ€çš„æ¬§å¼è·ç¦»æ˜¯å¦å°äºé˜ˆå€¼\n        # evaluate distance by state(t) and state(t-1)\n        outDistance = tf.sqrt(tf.reduce_sum(tf.square(tf.subtract(state, old_state)), 1) + 1e-10)\n        # vector showing item converged or not (given a certain threshold)\n        checkDistanceVec = tf.greater(outDistance, state_threshold)\n        \n        c1 = tf.reduce_any(checkDistanceVec)\n        \n        # æ˜¯å¦è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°\n        c2 = tf.less(k, max_iter)\n\n    return tf.logical_and(c1, c2)\n\n# è¿­ä»£è®¡ç®—ï¼Œç›´åˆ°çŠ¶æ€è¾¾åˆ°ç¨³å®šçŠ¶æ€\n# compute state\nwith tf.variable_scope(&#39;Loop&#39;):\n    k = tf.constant(0)\n    res, st, old_st, num = tf.while_loop(condition, convergence,\n                                         [comp_inp, state, state_old, k])\n    # è®¡ç®—ç»“ç‚¹çš„output\n    out = g_w(st)\n</code></pre></div><p>å‰é¢è®²è¿‡ï¼ŒGNNä¸­ç»“ç‚¹çš„stateéœ€è¦è¿­ä»£ï¼Œç›´åˆ°è¾¾åˆ°ä¸€ä¸ªç¨³å®šçŠ¶æ€ã€‚ä¸Šè¿°ä»£ç å°±æ˜¯è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹ï¼Œconditionå‡½æ•°æ˜¯åˆ¤æ–­çŠ¶æ€æ˜¯å¦è¾¾åˆ°ç¨³å®šçŠ¶æ€æˆ–è€…è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œconditionå‡½æ•°ä¸‹é¢ä¸€æ®µä»£ç æ˜¯å¯¹ç»“ç‚¹çš„stateè¿›è¡Œå¾ªç¯è¿­ä»£ï¼Œç›´è‡³æ»¡è¶³conditionæ¡ä»¶ã€‚åˆ°è¾¾ç¨³å®šçŠ¶æ€ä¹‹åï¼Œä½¿ç”¨g_wå‡½æ•°è®¡ç®—ç»“ç‚¹çš„outputã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\">loss = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits_v2(labels=y, logits=out))\naccuracy = tf.reduce_mean(tf.cast(tf.equal(tf.argmax(out, 1), tf.argmax(y, 1)), dtype=tf.float32))\noptimizer = tf.train.AdamOptimizer(0.001)\ngrads = optimizer.compute_gradients(loss)\ntrain_op = optimizer.apply_gradients(grads, name=&#39;train_op&#39;)</code></pre></div><p>è¿™é‡Œä½¿ç”¨äº¤å‰ç†µä½œä¸ºæ¨¡å‹çš„æŸå¤±å‡½æ•°ï¼Œå‡†ç¡®ç‡ä½œä¸ºè¯„æµ‹ç»“æœçš„æŒ‡æ ‡ã€‚è¿™é‡Œç›´æ¥æ ¹æ®lossè®¡ç®—æ¢¯åº¦ï¼Œå¯¹å˜é‡è¿›è¡Œæ›´æ–°ï¼Œæ²¡æœ‰åƒè®ºæ–‡ä¸­é‚£æ ·è®¡ç®—æ¢¯åº¦çš„ç¨³å®šçŠ¶æ€tï¼Œç„¶åæ±‚tæ—¶åˆ»çš„æ¢¯åº¦ã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\">###train model####\nnum_epoch = 5000\n# è®­ç»ƒé›†placeholderè¾“å…¥\narcnode_train = tf.SparseTensorValue(indices=arcnode[0].indices, values=arcnode[0].values,\n                                    dense_shape=arcnode[0].dense_shape)\nfd_train = {comp_inp: inp[0], state: np.zeros((arcnode[0].dense_shape[0], state_dim)),\n          state_old: np.ones((arcnode[0].dense_shape[0], state_dim)),\n          ArcNode: arcnode_train, y: labels}\n#éªŒè¯é›†placeholderè¾“å…¥\narcnode_valid = tf.SparseTensorValue(indices=arcnode_val[0].indices, values=arcnode_val[0].values,\n                                dense_shape=arcnode_val[0].dense_shape)\nfd_valid = {comp_inp: inp_val[0], state: np.zeros((arcnode_val[0].dense_shape[0], state_dim)),\n      state_old: np.ones((arcnode_val[0].dense_shape[0], state_dim)),\n      ArcNode: arcnode_valid, y: labels_val}\n\nwith tf.Session() as sess:\n    sess.run(tf.global_variables_initializer())\n    sess.run(tf.local_variables_initializer())\n    for i in range(0, num_epoch):\n        _, loss_val, accuracy_val = sess.run(\n                    [train_op, loss, accuracy],\n                    feed_dict=fd_train)\n        if i % 100 == 0:\n\n            loss_valid_val, accuracy_valid_val = sess.run(\n                    [loss, accuracy],\n                    feed_dict=fd_valid)\n            print(&#34;iter %s\\t training loss: %s,\\t training accuracy: %s,\\t validation loss: %s,\\t validation accuracy: %s&#34; % \n                  (i, loss_val, accuracy_val, loss_valid_val, accuracy_valid_val))</code></pre></div><p>è¿™æ˜¯æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼Œè¿­ä»£è®­ç»ƒ5000æ¬¡ã€‚å¯ä»¥çœ‹å‡ºæ¨¡å‹æ¯æ¬¡è¿­ä»£çš„è®­ç»ƒé›†è¾“å…¥å’ŒéªŒè¯é›†è¾“å…¥éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºè¿™é‡Œç”¨åˆ°çš„æ•°æ®é›†åªæœ‰ä¸€ä¸ªå›¾ã€‚æ¨¡å‹è®­ç»ƒçš„è¾“å‡ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure data-size=\"normal\"><noscript><img src=\"https://pic4.zhimg.com/v2-b5a5193bc5f1e1ace2e8bdb1b8c4c1f7_b.jpg\" data-size=\"normal\" data-rawwidth=\"999\" data-rawheight=\"348\" class=\"origin_image zh-lightbox-thumb\" width=\"999\" data-original=\"https://pic4.zhimg.com/v2-b5a5193bc5f1e1ace2e8bdb1b8c4c1f7_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;999&#39; height=&#39;348&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"999\" data-rawheight=\"348\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"999\" data-original=\"https://pic4.zhimg.com/v2-b5a5193bc5f1e1ace2e8bdb1b8c4c1f7_r.jpg\" data-actualsrc=\"https://pic4.zhimg.com/v2-b5a5193bc5f1e1ace2e8bdb1b8c4c1f7_b.jpg\"/><figcaption>å›¾9 æ¨¡å‹è®­ç»ƒçš„ç»“æœ</figcaption></figure><h2>4ã€æ€»ç»“</h2><p>GNNæ¨¡å‹å¯ä»¥ä½¿ç”¨çƒ­æ‰©æ•£çš„åŸç†å»ç†è§£å®ƒã€‚ä¾‹å¦‚ï¼Œåœ¨ <img src=\"https://www.zhihu.com/equation?tex=t_0\" alt=\"t_0\" eeimg=\"1\"/> æ—¶åˆ»ï¼Œä¼ é€’ç»™å›¾ä¸­æŸäº›ç»“ç‚¹ä¸€äº›çƒ­é‡ï¼Œä½¿å¾—è¿™äº›ç»“ç‚¹çš„æ¸©åº¦å‡é«˜ï¼Œè¿™äº›ç»“ç‚¹ä¼šé€šè¿‡ç›¸è¿çš„è¾¹å‘ç›¸é‚»çš„ç»“ç‚¹ä¼ å¯¼çƒ­é‡ã€‚å› æ­¤ï¼Œä¸‹ä¸€ä¸ªæ—¶åˆ»ï¼ŒæŸä¸ªç»“ç‚¹çš„çƒ­é‡çš„æµå…¥ä¸ºç›¸é‚»ç»“ç‚¹ä¼ é€’çƒ­é‡çš„ç´¯åŠ å’Œã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ¯ä¸ªç»“ç‚¹çš„çƒ­é‡æµå…¥ä¼šè¾¾åˆ°ä¸€ä¸ªç¨³å®šçŠ¶æ€ã€‚GNNæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å­˜åœ¨ä¸€ä¸ªç¨³å®šçŠ¶æ€ï¼Œå› æ­¤ <img src=\"https://www.zhihu.com/equation?tex=f_w\" alt=\"f_w\" eeimg=\"1\"/> éœ€è¦æ»¡è¶³å›ºå®šç‚¹çš„ç†è®ºã€‚åé¢ä¸€äº›å›¾ç½‘ç»œï¼Œä¸éœ€è¦æ»¡è¶³è¿™ä¸€æ¡ä»¶ï¼Œä¾‹å¦‚GCNï¼ŒGGNNã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>[1] ä»å›¾(Graph)åˆ°å›¾å·ç§¯(Graph Convolution)ï¼šæ¼«è°ˆå›¾ç¥ç»ç½‘ç»œæ¨¡å‹ <a href=\"https://link.zhihu.com/?target=https%3A//www.cnblogs.com/SivilTaram/p/graph_neural_network_1.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://www.</span><span class=\"visible\">cnblogs.com/SivilTaram/</span><span class=\"invisible\">p/graph_neural_network_1.html</span><span class=\"ellipsis\"></span></a></p><p>[2] Graph Neural Network Model <a href=\"https://link.zhihu.com/?target=https%3A//github.com/mtiezzi/gnn\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">github.com/mtiezzi/gnn</span><span class=\"invisible\"></span></a></p><p>[3] Graph Neural Networks: A Review of Methods and Applications <a href=\"https://link.zhihu.com/?target=https%3A//arxiv.org/abs/1812.08434\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">arxiv.org/abs/1812.0843</span><span class=\"invisible\">4</span><span class=\"ellipsis\"></span></a></p><p>[4] Graphical-Based Learning Environments for Pattern Recognition <a href=\"https://link.zhihu.com/?target=https%3A//link.springer.com/chapter/10.1007/978-3-540-27868-9_4\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">link.springer.com/chapt</span><span class=\"invisible\">er/10.1007/978-3-540-27868-9_4</span><span class=\"ellipsis\"></span></a></p><p>[5] The Graph Neural Network Model <a href=\"https://link.zhihu.com/?target=https%3A//ieeexplore.ieee.org/document/4700287\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">ieeexplore.ieee.org/doc</span><span class=\"invisible\">ument/4700287</span><span class=\"ellipsis\"></span></a></p><p>[6] Graph Neural Network Mode <a href=\"https://link.zhihu.com/?target=https%3A//mtiezzi.github.io/gnn_site/GNN/software.html%23matrix-based-implementation\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">mtiezzi.github.io/gnn_s</span><span class=\"invisible\">ite/GNN/software.html#matrix-based-implementation</span><span class=\"ellipsis\"></span></a></p><p></p>", 
            "topic": [
                {
                    "tag": "å›¾ç¥ç»ç½‘ç»œï¼ˆGNNï¼‰", 
                    "tagLink": "https://api.zhihu.com/topics/20747184"
                }
            ], 
            "comments": [
                {
                    "userName": "gogo", 
                    "userLink": "https://www.zhihu.com/people/2e580259486f34a71db05c15c3d2859c", 
                    "content": "è®²å¾—å¾ˆé€å½»ï¼Œå¤§èµğŸ‘ğŸ‘", 
                    "likes": 1, 
                    "childComments": []
                }, 
                {
                    "userName": "å°å´”", 
                    "userLink": "https://www.zhihu.com/people/5cac8da02977d33435493f819d2dedf6", 
                    "content": "<p>å›ºå®šç‚¹ï¼Œæ•°å­¦é‡Œä¸€èˆ¬è¯´ä¸åŠ¨ç‚¹ï¼</p>", 
                    "likes": 1, 
                    "childComments": [
                        {
                            "userName": "Ivan Yan", 
                            "userLink": "https://www.zhihu.com/people/3677a61f41a4d1cd630d63e270524c07", 
                            "content": "è¿™æ ·å‘€ï¼Œå­¦åˆ°äº†ã€‚", 
                            "likes": 0, 
                            "replyToAuthor": "å°å´”"
                        }, 
                        {
                            "userName": "æ— äººçš„åŸå¸‚", 
                            "userLink": "https://www.zhihu.com/people/4e07657da81fe75bd1ef63df6d44329c", 
                            "content": "Fixed point ç¿»è¯‘é—®é¢˜è€Œå·²", 
                            "likes": 1, 
                            "replyToAuthor": "å°å´”"
                        }
                    ]
                }, 
                {
                    "userName": "zhuangAnjun", 
                    "userLink": "https://www.zhihu.com/people/2532ab585f590ccbb4ad1dcb0c744728", 
                    "content": "è¿™ä¸ªåˆå§‹åŒ–çš„0/1çŸ©é˜µåœ¨å›¾å¾ˆå¤§çš„æ—¶å€™å°±ä¸é€‚ç”¨äº†ã€‚åœ¨å¾ˆå¤§çš„ä¸€ä¸ªæ‹“æ‰‘å›¾ä¸­ï¼Œæˆ‘è§‰å¾—å¯ä»¥å°†å­å›¾æŠ½å‡ºï¼Œç”¨w2vçš„æ–¹æ³•æ¥è®­ç»ƒï¼Œè¿™æ ·åº”è¯¥ä¹Ÿå¯ä»¥è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæœ", 
                    "likes": 1, 
                    "childComments": []
                }, 
                {
                    "userName": "èŠ±å¼€æ— å£°", 
                    "userLink": "https://www.zhihu.com/people/9270f33b727d5d947ea4bde2d4ee90cf", 
                    "content": "è®²å¾—å¾ˆæ£’ï¼Œå¤§ä½¬å¸¦æˆ‘å­¦AI", 
                    "likes": 0, 
                    "childComments": []
                }
            ]
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/82845443", 
            "userName": "Ivan Yan", 
            "userLink": "https://www.zhihu.com/people/3677a61f41a4d1cd630d63e270524c07", 
            "upvote": 5, 
            "title": "Queryæ¨èâ€”RIN: Reformulation Inference Network", 
            "content": "<p>æœ€è¿‘åœ¨çœ‹Queryæ¨èçš„ç›¸å…³è®ºæ–‡ï¼Œå‰å‡ å¹´çš„æ–‡ç« åŸºæœ¬éƒ½æ˜¯åŸºäºå›¾çš„ï¼Œä¾‹å¦‚query flow graph, query url bigraphã€‚æœ€è¿‘å‡ å¹´ï¼Œè¿™ä¸€é¢†åŸŸä¹ŸåŸºæœ¬è¢«æ·±åº¦å­¦ä¹ å é¢†äº†ã€‚å…ˆç®€å•ä»‹ç»ä¸€ä¸‹Queryæ¨èï¼šç”¨æˆ·å»æœä¸€ä¸ªä¸œè¥¿çš„æ—¶å€™ï¼Œå¯èƒ½æœç´¢ç»“æœä¸å¤§æ»¡æ„ï¼Œä»–ä¼šå»ä¸æ–­ä¿®æ”¹è¿™ä¸ªQueryï¼Œç›´åˆ°æ‰¾åˆ°æ»¡æ„çš„ç»“æœã€‚å› æ­¤ï¼Œç°åœ¨çš„æœç´¢å¼•æ“å¾€å¾€ä¼šæœ‰Queryæ¨èåŠŸèƒ½ï¼Œå»é¢„æµ‹ç”¨æˆ·æƒ³è¦çš„queryï¼Œç„¶åæ¨èç»™ç”¨æˆ·ã€‚æ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸‹â€œRIN: Reformulation Inference Network for Context-AwareQuery Suggestionâ€è¿™ç¯‡æ–‡ç« ï¼Œå‘è¡¨åœ¨CIKM 2018ä¸Šã€‚</p><a href=\"https://link.zhihu.com/?target=https%3A//jyunyu.csie.org/docs/pubs/cikm2018paper.pdf\" data-draft-node=\"block\" data-draft-type=\"link-card\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">RIN: Reformulation Inference Network for Context-AwareQuery Suggestion</a><h2>åŠ¨æœº</h2><p>ç”¨æˆ·çš„æœç´¢æ„å›¾å¾€å¾€æ¯”è¾ƒå¤æ‚ï¼Œè€ŒæŸ¥è¯¢çš„queryå¾€å¾€æ¯”è¾ƒçŸ­ä¸”å¯èƒ½å…·æœ‰æ­§ä¹‰ã€‚å› æ­¤ï¼Œä¸ºäº†æ‰¾åˆ°éœ€è¦çš„ä¿¡æ¯ï¼Œç”¨æˆ·ä¼šä¸æ–­å»ä¿®æ”¹queryï¼Œç›´åˆ°æ‰¾åˆ°æ»¡æ„çš„å†…å®¹ã€‚è¿™ä¸¥é‡å½±å“äº†ç”¨æˆ·ä½“éªŒã€‚å› æ­¤ï¼Œç°åœ¨æœç´¢å¼•æ“ä¼šæ¨èä¸‹ä¸€æ¡queryä»¥åŠqueryè¡¥å…¨ã€‚</p><p>ä¸ºäº†æ•è·ç”¨æˆ·çš„æœç´¢æ„å›¾ï¼Œç›´è§‚çš„æƒ³æ³•æ˜¯ç›´æ¥ä½¿ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŒä¸€ä¸ªsearch sessionä¸­çš„ä¹‹å‰çš„querieså’Œç‚¹å‡»ä¿¡æ¯ã€‚ä¹‹å‰çš„åŸºäºå›¾çš„æ–¹æ³•ï¼Œå¾€å¾€åŸºäºqueryçš„ç›¸ä¼¼æ€§å’Œå…±ç°å…³ç³»ã€‚ä½†æ˜¯ï¼Œè¿™æ ·æ„å»ºçš„å›¾ä¼šå¾ˆç¨€ç–ï¼Œè€Œå½±å“æœ€ç»ˆçš„æ¨èç»“æœã€‚</p><p>æ ¹æ®ä¹‹å‰çš„ç ”ç©¶ç»“æœï¼Œä½œè€…æŠŠqueryçš„ä¿®æ”¹åˆ†æˆï¼šå¥æ³•ä¿®æ”¹å’Œè¯­ä¹‰ä¿®æ”¹ã€‚å¥æ³•ä¿®æ”¹åŒ…æ‹¬å¢åŠ å•è¯ã€åˆ é™¤å•è¯ã€ç¼©å†™è¯æ‹“å±•ã€‚è¯­ä¹‰ä¿®æ”¹ï¼ŒæŒ‡ä¿®æ”¹queryçš„å«ä¹‰ï¼ŒåŒ…æ‹¬æ³›åŒ–å’Œç‰¹è‰²åŒ–ã€‚ä¹‹å‰çš„åŸºäºquery reformulationçš„æ–¹æ³•ï¼Œå¾€å¾€å—é™äºé¢„å…ˆå®šä¹‰å¥½çš„reformulationç­–ç•¥æˆ–è€…çŸ¥è¯†å›¾è°±çš„å¸®åŠ©ï¼Œæ— æ³•è§£å†³èŒƒå›´å¤–çš„reformulationç­–ç•¥å’Œæ­§ä¹‰çš„queriesã€‚</p><p>éšç€æ·±åº¦å­¦ä¹ çš„å…´èµ·ï¼Œç‰¹åˆ«æ˜¯RNNç½‘ç»œï¼Œæä¾›äº†ä¸€äº›æ–°çš„æ€è·¯æ¥å­¦ä¹ æ€»ç»“query reformulationçš„è§„å¾‹ã€‚ä½†æ˜¯ï¼Œä¹‹å‰çš„åŸºäºRNNçš„æ–¹æ³•æœ‰ä¸€ä¸‹å‡ ä¸ªç¼ºç‚¹ï¼šç¼ºä¹å¯¹ä¹‹å‰query reformulationçš„ç†è§£ï¼›å¯¹äºä¸€äº›å¤æ‚çš„query reformulationï¼Œå¾ˆéš¾å­¦ä¹ å¾—åˆ°ï¼›queryç›´æ¥çš„è½¬æ¢å¾ˆç¨€ç–ï¼Œå› æ­¤RNNå¾ˆéš¾å­¦åˆ°query reformulationçš„è§„å¾‹ï¼Œç°æœ‰çš„æ–¹æ³•å¾€å¾€ä¾èµ–é¢å¤–çš„ç‰¹å¾ã€‚</p><p>é’ˆå¯¹ä»¥ä¸Šé—®é¢˜ï¼Œä½œè€…æå‡ºäº†Reformulation Inference Network(RIN)ï¼Œè´¡çŒ®åº¦å¦‚ä¸‹ï¼š</p><ol><li>æå‡ºäº†ä½¿ç”¨homomorphicç¼–ç ï¼Œå¯ä»¥åŒæ—¶ä¿æŒå¥æ³•å’Œè¯­ä¹‰å±æ€§ã€‚æ›´é€šç”¨å’Œçµæ´»çš„è¡¨ç¤ºï¼Œå¯ä»¥å¸®åŠ©ç½‘ç»œå­¦ä¹ query reformulationã€‚</li><li>æå‡ºäº†RINç½‘ç»œæ¥è§£å†³æ•°æ®ç¨€ç–çš„é—®é¢˜ã€‚</li><li>é€šè¿‡å®éªŒæ¥è¯æ˜RINç½‘ç»œçš„æœ‰ç”¨æ€§ã€‚</li></ol><h2>é—®é¢˜æè¿°</h2><p>ä¸€ä¸ªsearch sessionå¯ä»¥å†™æˆqueryçš„åºåˆ— <img src=\"https://www.zhihu.com/equation?tex=%3Cq_1%2C+q_2%2C...%2Cq_L%3E\" alt=\"&lt;q_1, q_2,...,q_L&gt;\" eeimg=\"1\"/> ï¼Œæ¯ä¸€æ¡query <img src=\"https://www.zhihu.com/equation?tex=q\" alt=\"q\" eeimg=\"1\"/> éƒ½ç”±ä¸€ç»„å•è¯ç»„æˆï¼Œè®°ä¸º <img src=\"https://www.zhihu.com/equation?tex=T%28q%29\" alt=\"T(q)\" eeimg=\"1\"/> ï¼Œå¹¶å¯¹åº”ç›¸åº”çš„ç‚¹å‡»ä¿¡æ¯ï¼Œè®°ä¸º <img src=\"https://www.zhihu.com/equation?tex=u\" alt=\"u\" eeimg=\"1\"/> ï¼ˆä¸€ç»„ç‚¹å‡»çš„urlsï¼‰ã€‚å› æ­¤ï¼Œæ–‡ç« çš„ç›®æ ‡å®šä¹‰å¦‚ä¸‹ï¼š</p><ul><li>ç»™å®šä¸€ç»„å€™é€‰çš„queriesï¼Œç»™å‡ºç›¸åº”çš„è¯„åˆ†ï¼Œä½¿å¾— <img src=\"https://www.zhihu.com/equation?tex=q_%7BL%2B1%7D\" alt=\"q_{L+1}\" eeimg=\"1\"/> çš„åˆ†å€¼å°½å¯èƒ½é«˜ã€‚</li><li>ç”Ÿæˆä¸€æ¡ <img src=\"https://www.zhihu.com/equation?tex=q_%7BL%2B1%7D%5E%60\" alt=\"q_{L+1}^`\" eeimg=\"1\"/> ï¼Œä½¿å¾— <img src=\"https://www.zhihu.com/equation?tex=q_%7BL%2B1%7D%5E%60\" alt=\"q_{L+1}^`\" eeimg=\"1\"/> å’Œ <img src=\"https://www.zhihu.com/equation?tex=q_%7BL%2B1%7D\" alt=\"q_{L+1}\" eeimg=\"1\"/> å°½å¯èƒ½ç›¸ä¼¼ã€‚</li></ul><h2>RINç½‘ç»œ</h2><figure data-size=\"normal\"><noscript><img src=\"https://pic4.zhimg.com/v2-7cd4033d043776b906382169fa9ed667_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1187\" data-rawheight=\"397\" class=\"origin_image zh-lightbox-thumb\" width=\"1187\" data-original=\"https://pic4.zhimg.com/v2-7cd4033d043776b906382169fa9ed667_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1187&#39; height=&#39;397&#39;&gt;&lt;/svg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1187\" data-rawheight=\"397\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1187\" data-original=\"https://pic4.zhimg.com/v2-7cd4033d043776b906382169fa9ed667_r.jpg\" data-actualsrc=\"https://pic4.zhimg.com/v2-7cd4033d043776b906382169fa9ed667_b.jpg\"/></figure><p>ä¸Šå›¾æ˜¾ç¤ºäº†RINç½‘ç»œçš„æ¶æ„ï¼Œä¸»è¦ç”±4éƒ¨åˆ†ç»„æˆï¼šquery session encoderï¼Œreformulation inferencerï¼Œquery discriminatorå’Œquery generatorã€‚è¿™é‡Œquery session encoderçš„è¾“å…¥æ˜¯ä½œè€…æå‡ºçš„Homomorphic Query Embeddingï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=v_q%3D+%5Csum_%7Bt+%5Cin+T%28q%29%7D+v_t\" alt=\"v_q= \\sum_{t \\in T(q)} v_t\" eeimg=\"1\"/> </p><p>è¿™é‡Œ <img src=\"https://www.zhihu.com/equation?tex=T%28q%29\" alt=\"T(q)\" eeimg=\"1\"/> æ˜¯queryåŒ…å«çš„å•è¯ï¼Œè€Œ <img src=\"https://www.zhihu.com/equation?tex=v_t\" alt=\"v_t\" eeimg=\"1\"/> æ˜¯æ¯ä¸ªå•è¯çš„å‘é‡ï¼Œåé¢è§£é‡Šå¦‚ä½•å¾—åˆ°ï¼Œ <img src=\"https://www.zhihu.com/equation?tex=v_q\" alt=\"v_q\" eeimg=\"1\"/> å°±æ˜¯queryå¯¹åº”çš„Homomorphic Query Embeddingã€‚ä½œè€…è®¤ä¸ºä»»ä½•query reformulationéƒ½å¯ä»¥è®¤ä¸ºæ˜¯å•è¯çš„æ·»åŠ å’Œåˆ é™¤ï¼Œå› æ­¤ç›´æ¥å¯¹queryåŒ…å«çš„å•è¯å‘é‡è¿›è¡Œæ±‚å’Œï¼Œæ¥è¡¨ç¤ºqueryã€‚è¿™æ ·åšçš„å¥½å¤„æœ‰ï¼šå¥æ³•å…³ç³»ï¼ˆæ·»åŠ å’Œåˆ é™¤å•è¯ï¼‰è¢«ä¿ç•™äº†ï¼›embeddingçš„æ½œåœ¨ç©ºé—´å¯ä»¥è¡¨ç¤ºqueryçš„è¯­ä¹‰ä¿¡æ¯ï¼›queryçš„çº¿æ€§ç»“æ„å¯ä»¥å¸®åŠ©ç†è§£query reformulationçš„è¯­ä¹‰ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œâ€Japan travel&#34;-&gt;&#34;Tokyo travelâ€œå¯ä»¥è¢«è¡¨ç¤ºæˆ <img src=\"https://www.zhihu.com/equation?tex=v_%7BTokyo%7D-v_%7Bjapan%7D\" alt=\"v_{Tokyo}-v_{japan}\" eeimg=\"1\"/> ï¼Œå’Œ&#34;Italy hotel&#34;-&gt;&#34;Rome hotel&#34;çš„ <img src=\"https://www.zhihu.com/equation?tex=v_%7BRome%7D-v_%7BItaly%7D\" alt=\"v_{Rome}-v_{Italy}\" eeimg=\"1\"/> ç±»ä¼¼ï¼Œéƒ½æ˜¯å›½å®¶ä¿®æ”¹æˆé¦–éƒ½ã€‚</p><p>è¿™é‡Œï¼Œæ¯ä¸ªå•è¯çš„å‘é‡ <img src=\"https://www.zhihu.com/equation?tex=v_t\" alt=\"v_t\" eeimg=\"1\"/> è·Ÿä¹‹å‰çš„æ–‡ç« æœ‰æ‰€ä¸åŒã€‚ä¹‹å‰çš„ç½‘ç»œçš„è¯å‘é‡ä¸€èˆ¬éƒ½æ˜¯æ¥è‡ªäºword2vecæˆ–è€…gloveï¼Œæ ¹æ®æ–‡ç« ä¸­å•è¯çš„å…±ç°å…³ç³»è®¡ç®—å¾—åˆ°ã€‚è¿™é‡Œï¼Œä½œè€…æ„é€ äº†å¦‚ä¸‹æ‰€ç¤ºçš„ä¸€ä¸ªå›¾ï¼Œç„¶åé€šè¿‡graph embeddingç®—æ³•ï¼Œå¾—åˆ°æ¯ä¸ªå•è¯çš„å‘é‡ã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic3.zhimg.com/v2-f52ff1cd7e1e5557688668c7bc1dccf2_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"558\" data-rawheight=\"339\" class=\"origin_image zh-lightbox-thumb\" width=\"558\" data-original=\"https://pic3.zhimg.com/v2-f52ff1cd7e1e5557688668c7bc1dccf2_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;558&#39; height=&#39;339&#39;&gt;&lt;/svg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"558\" data-rawheight=\"339\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"558\" data-original=\"https://pic3.zhimg.com/v2-f52ff1cd7e1e5557688668c7bc1dccf2_r.jpg\" data-actualsrc=\"https://pic3.zhimg.com/v2-f52ff1cd7e1e5557688668c7bc1dccf2_b.jpg\"/></figure><p>ä¸Šå›¾ä¸­æœ‰ä¸‰ç§èŠ‚ç‚¹ï¼šterm, query, websiteã€‚æ¯æ¡queryæŒ‡å‘ç¬¬ä¸€ä¸ªå•è¯ï¼Œç„¶åæ¯ä¸ªå•è¯æŒ‡å‘åç»­å•è¯ã€‚åŒæ—¶ï¼Œæ¯æ¡queryè¿˜æŒ‡å‘ç”¨æˆ·ç‚¹å‡»çš„websiteï¼Œå’Œreformulatedqueryã€‚å¦‚æœåªçœ‹termèŠ‚ç‚¹ï¼Œå®ƒè¡¨è¾¾çš„æ˜¯å•è¯çš„å…±ç°å…³ç³»ï¼Œç­‰ä»·äºword2vecã€‚æ­¤å¤–è¿˜åŠ å…¥äº†query reformulationå’Œç‚¹å‡»è¿™ä¸¤ä¸ªé¢å¤–ä¿¡æ¯ã€‚</p><p><b>query session encoder</b>æ˜¯ä¸€ä¸ªå¸¦attentionçš„åŒå‘RNNã€‚RNNçš„è¾“å…¥ä¸º <img src=\"https://www.zhihu.com/equation?tex=x_i%3D%5Bv_%7Bq_i%7D%3Br_%7Bi-1%7D%5D\" alt=\"x_i=[v_{q_i};r_{i-1}]\" eeimg=\"1\"/> ï¼Œè¿™é‡Œ <img src=\"https://www.zhihu.com/equation?tex=r_%7Bi-1%7D%3Dv_%7Bq_i%7D-v_%7Bq_%7Bi-1%7D%7D\" alt=\"r_{i-1}=v_{q_i}-v_{q_{i-1}}\" eeimg=\"1\"/> ï¼Œ <img src=\"https://www.zhihu.com/equation?tex=r_0\" alt=\"r_0\" eeimg=\"1\"/> ä¸ºé›¶å‘é‡ã€‚RNNè¿™é‡Œä½œè€…é‡‡ç”¨åŒå‘GRUã€‚ç„¶åç»è¿‡ä¸€å±‚attention poolingå¾—åˆ°context vector <img src=\"https://www.zhihu.com/equation?tex=c\" alt=\"c\" eeimg=\"1\"/> ã€‚</p><p><b>Reformulation Inferencerï¼š</b>è¦é¢„æµ‹ <img src=\"https://www.zhihu.com/equation?tex=q_%7BL%2B1%7D\" alt=\"q_{L+1}\" eeimg=\"1\"/> ç­‰ä»·äºé¢„æµ‹ <img src=\"https://www.zhihu.com/equation?tex=r_L\" alt=\"r_L\" eeimg=\"1\"/> ï¼Œå¹¶ä¸” <img src=\"https://www.zhihu.com/equation?tex=r_L\" alt=\"r_L\" eeimg=\"1\"/> æ›´å®¹æ˜“é¢„æµ‹ä¸€äº›ï¼Œå› ä¸ºä¸åŒçš„queryè½¬æ¢ä¹‹é—´ï¼Œä»–ä»¬çš„reformulationå¯èƒ½æ˜¯ç›¸åŒçš„ã€‚è¿™é‡Œç›´æ¥é€šè¿‡2å±‚çš„MLPé¢„æµ‹ <img src=\"https://www.zhihu.com/equation?tex=r_L\" alt=\"r_L\" eeimg=\"1\"/> ï¼Œå…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=u_r%3DReLU%28F_%7Bh_r%7D%28c%29%29+%5C%5C+%5Cbar%7Br_L%7D+%3D+W_ru_r%2Bb_r\" alt=\"u_r=ReLU(F_{h_r}(c)) \\\\ \\bar{r_L} = W_ru_r+b_r\" eeimg=\"1\"/> </p><p> è¿™é‡Œ <img src=\"https://www.zhihu.com/equation?tex=F_%7Bh_r%7D\" alt=\"F_{h_r}\" eeimg=\"1\"/> æ˜¯å…¨è¿æ¥å±‚ï¼Œ <img src=\"https://www.zhihu.com/equation?tex=ReLU\" alt=\"ReLU\" eeimg=\"1\"/> æ˜¯çº¿æ€§æ•´æµå‡½æ•°ï¼Œ<img src=\"https://www.zhihu.com/equation?tex=%5Cbar%7Br_L%7D\" alt=\"\\bar{r_L}\" eeimg=\"1\"/> æ˜¯é¢„æµ‹çš„reformulationã€‚</p><p>ç”±äºæœ€ç»ˆçš„ç»“æœæ˜¯å¯¹å€™é€‰queryè¿›è¡Œæ‰“åˆ†æˆ–è€…ç”Ÿæˆæ¨èçš„queryã€‚å› æ­¤è¿˜éœ€è¦query discriminatorå’Œquery generatorè¿™ä¸¤ä¸ªæ¨¡å—ã€‚</p><p><b>query discriminator</b>çš„åšæ³•ç±»ä¼¼äºæ–‡æœ¬åŒ¹é…ï¼Œå°†å€™é€‰query <img src=\"https://www.zhihu.com/equation?tex=q_%7Bcan%7D\" alt=\"q_{can}\" eeimg=\"1\"/> å’Œcontext vector <img src=\"https://www.zhihu.com/equation?tex=c\" alt=\"c\" eeimg=\"1\"/> æ‹¼åœ¨ä¸€èµ·å¾—åˆ° <img src=\"https://www.zhihu.com/equation?tex=x_d+%3D+%5Bv_%7Bq_%7Bcan%7D%7D%3Bc%5D\" alt=\"x_d = [v_{q_{can}};c]\" eeimg=\"1\"/> ï¼Œç„¶åç»è¿‡åŒå±‚MLPï¼Œå…·ä½“å¦‚ä¸‹:</p><p><img src=\"https://www.zhihu.com/equation?tex=u_d%3DReLU%28F_%7Bh_d%7D%28x_d%29%29%2C++%5C%5C+%5Cbar%7By%7D%3D%5Csigma%28F_%7Bh_d%7D%28u_d%29%29\" alt=\"u_d=ReLU(F_{h_d}(x_d)),  \\\\ \\bar{y}=\\sigma(F_{h_d}(u_d))\" eeimg=\"1\"/> </p><p>è¿™é‡Œ <img src=\"https://www.zhihu.com/equation?tex=%5Csigma\" alt=\"\\sigma\" eeimg=\"1\"/> æ˜¯sigmoidå‡½æ•°ï¼Œ <img src=\"https://www.zhihu.com/equation?tex=%5Cbar%7By%7D\" alt=\"\\bar{y}\" eeimg=\"1\"/> æ˜¯å¯¹å€™é€‰queryçš„è¯„åˆ†ã€‚</p><p><b>query generator </b>å°±æ˜¯å†æ¥ä¸€ä¸ªRNNåšdecoderï¼Œç”Ÿæˆç›¸åº”çš„queryï¼Œç±»ä¼¼äºæœºå™¨ç¿»è¯‘ã€‚è¦ç”Ÿæˆç¬¬ <img src=\"https://www.zhihu.com/equation?tex=t\" alt=\"t\" eeimg=\"1\"/> ä¸ªå•è¯ <img src=\"https://www.zhihu.com/equation?tex=w_t\" alt=\"w_t\" eeimg=\"1\"/> ï¼ŒRNNçš„hidden stateè®¡ç®—å¦‚ä¸‹ï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=s_t%3DRNN%28s_%7Bt-1%7D%2C%5Bw_%7Bt-1%7D%3Bc_t%5D%29\" alt=\"s_t=RNN(s_{t-1},[w_{t-1};c_t])\" eeimg=\"1\"/> </p><p>è¿™é‡Œ <img src=\"https://www.zhihu.com/equation?tex=c_t\" alt=\"c_t\" eeimg=\"1\"/> æ˜¯ç¬¬ <img src=\"https://www.zhihu.com/equation?tex=t\" alt=\"t\" eeimg=\"1\"/> ä¸ªå•è¯çš„context vecotrï¼Œç”±äºæ¯ä¸ªå•è¯éœ€è¦çš„ä¸Šä¸‹æ–‡ä¿¡æ¯æ˜¯ä¸åŒçš„ï¼Œå› æ­¤é‡æ–°å¯¹query session contextä¸­çš„RNN hidden stateåšattention poolingå¾—åˆ° <img src=\"https://www.zhihu.com/equation?tex=c_t\" alt=\"c_t\" eeimg=\"1\"/> ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=u_%7Bt%2Ci%7D%3Dtanh%28F_g%28%5Bs_%7Bt-1%7D%3Bh_i%5D%29%29%2C+%5C%5C+a_%7Bt%2Ci%7D%3D%5Cfrac%7Bexp%28u_%7Bt%2Ci%7D%5ETu_g%29%7D%7B%5Csum_%7Bi%5E%60%7D%7Bexp%28u_%7Bt%2Ci%5E%60%7D%5ETu_g%29%7D%7D+%5C%5C+c_t%3D%5Csum_%7Bi%7D%7Ba_%7Bt%2Ci%7D%7Dh_i\" alt=\"u_{t,i}=tanh(F_g([s_{t-1};h_i])), \\\\ a_{t,i}=\\frac{exp(u_{t,i}^Tu_g)}{\\sum_{i^`}{exp(u_{t,i^`}^Tu_g)}} \\\\ c_t=\\sum_{i}{a_{t,i}}h_i\" eeimg=\"1\"/> </p><p>ç„¶åæ ¹æ® <img src=\"https://www.zhihu.com/equation?tex=s_t\" alt=\"s_t\" eeimg=\"1\"/> è®¡ç®—å­—å…¸ä¸­æ¯ä¸ªå•è¯çš„æ¡ä»¶æ¦‚ç‡ï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=P%28w_t%7Cw_1%2C...%2Cw_%7Bt-1%7D%2Cc%29%3Df%28s_t%29\" alt=\"P(w_t|w_1,...,w_{t-1},c)=f(s_t)\" eeimg=\"1\"/> </p><p><img src=\"https://www.zhihu.com/equation?tex=f%28%5Ccdot%29\" alt=\"f(\\cdot)\" eeimg=\"1\"/> æ˜¯projection layerã€‚</p><h2>æ¨¡å‹è®­ç»ƒ</h2><p>reformulation inferenceréƒ¨åˆ†çš„æŸå¤±å‡½æ•°å°±æ˜¯çœŸå®çš„ <img src=\"https://www.zhihu.com/equation?tex=r_L\" alt=\"r_L\" eeimg=\"1\"/> ä¸é¢„æµ‹çš„ <img src=\"https://www.zhihu.com/equation?tex=%5Cbar%7Br_L%7D\" alt=\"\\bar{r_L}\" eeimg=\"1\"/> ä¹‹é—´çš„è·ç¦»ï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=loss_R%3D%5Cfrac%7B1%7D%7B2%7D%5C%7C+r_L+-+%5Cbar%7Br_L%7D%5C%7C_F%5E2\" alt=\"loss_R=\\frac{1}{2}\\| r_L - \\bar{r_L}\\|_F^2\" eeimg=\"1\"/> </p><p>è¿™é‡Œ <img src=\"https://www.zhihu.com/equation?tex=%5C%7C%5Ccdot%5C%7C\" alt=\"\\|\\cdot\\|\" eeimg=\"1\"/> æ˜¯Frobenius normã€‚</p><p>å¯¹äºdiscriminativeä»»åŠ¡ï¼Œquery discriminatorçš„æŸå¤±å‡½æ•°å°±æ˜¯çœŸå®æ ‡ç­¾ <img src=\"https://www.zhihu.com/equation?tex=y\" alt=\"y\" eeimg=\"1\"/> å’Œé¢„æµ‹æ ‡ç­¾ <img src=\"https://www.zhihu.com/equation?tex=%5Cbar%7By%7D\" alt=\"\\bar{y}\" eeimg=\"1\"/> ä¹‹é—´çš„äº¤å‰ç†µï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=loss_D%3D-%28ylog%28%5Cbar%7By%7D%29%2B%281-y%29log%281-%5Cbar%7By%7D%29%29\" alt=\"loss_D=-(ylog(\\bar{y})+(1-y)log(1-\\bar{y}))\" eeimg=\"1\"/> </p><p>å¯¹äºgenerativeä»»åŠ¡ï¼Œquery generatorçš„æŸå¤±å‡½æ•°æ˜¯å®é™…çš„queryå’Œç”Ÿæˆçš„queryä¹‹é—´çš„äº¤å‰ç†µï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=loss_G%3D-%5Csum_%7Bw_t%7D%7Blog+P%28w_t%7CS_t%29%7D\" alt=\"loss_G=-\\sum_{w_t}{log P(w_t|S_t)}\" eeimg=\"1\"/> </p><p>è¿™é‡Œ <img src=\"https://www.zhihu.com/equation?tex=w_t\" alt=\"w_t\" eeimg=\"1\"/> æ˜¯å®é™…çš„queryçš„ç¬¬tä¸ªå•è¯ï¼Œ <img src=\"https://www.zhihu.com/equation?tex=S_t\" alt=\"S_t\" eeimg=\"1\"/> æ˜¯ <img src=\"https://www.zhihu.com/equation?tex=w_t\" alt=\"w_t\" eeimg=\"1\"/> ä¹‹å‰çš„å•è¯ã€‚</p><p>æœ€ç»ˆçš„æŸå¤±å‡½æ•°ä¸ºï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=loss%3Dloss_R%2Bloss_%7Btask%7D\" alt=\"loss=loss_R+loss_{task}\" eeimg=\"1\"/> </p><p><img src=\"https://www.zhihu.com/equation?tex=loss_%7Btask%7D\" alt=\"loss_{task}\" eeimg=\"1\"/> ä¸º <img src=\"https://www.zhihu.com/equation?tex=loss_D\" alt=\"loss_D\" eeimg=\"1\"/> æˆ–è€… <img src=\"https://www.zhihu.com/equation?tex=loss_G\" alt=\"loss_G\" eeimg=\"1\"/>  ã€‚</p><h2>å®éªŒç»“æœ</h2><p>è¿™é‡Œç®€å•å†™ä¸€ä¸‹ï¼Œå…·ä½“çš„ç»“æœè¯·å‚è€ƒåŸå§‹è®ºæ–‡ã€‚å¯¹äºdiscriminativeä»»åŠ¡ï¼Œä½¿ç”¨<a href=\"https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Mean_reciprocal_rank\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">MRRï¼ˆmean reciprocal rankï¼‰</a>ä½œä¸ºè¯„ä»·æŒ‡æ ‡ï¼Œå¯¹äºgenerativeä»»åŠ¡ï¼Œä½¿ç”¨<a href=\"https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Word_error_rate\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">PERï¼ˆposition independent word error rateï¼‰</a>ä½œä¸ºè¯„ä»·æŒ‡æ ‡ã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic1.zhimg.com/v2-69315469182e0532ffd78989143f0f3c_b.png\" data-size=\"normal\" data-rawwidth=\"1497\" data-rawheight=\"217\" class=\"origin_image zh-lightbox-thumb\" width=\"1497\" data-original=\"https://pic1.zhimg.com/v2-69315469182e0532ffd78989143f0f3c_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1497&#39; height=&#39;217&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"1497\" data-rawheight=\"217\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1497\" data-original=\"https://pic1.zhimg.com/v2-69315469182e0532ffd78989143f0f3c_r.jpg\" data-actualsrc=\"https://pic1.zhimg.com/v2-69315469182e0532ffd78989143f0f3c_b.png\"/><figcaption>ä¸åŒæ¨¡å‹MRRçš„ç»“æœã€‚å¯ä»¥çœ‹å‡ºRINåœ¨rerankæ•ˆæœä¸Šæ˜æ˜¾å¥½äºå…¶ä»–å‡ ä¸ªæ¨¡å‹ã€‚</figcaption></figure><figure data-size=\"normal\"><noscript><img src=\"https://pic2.zhimg.com/v2-0f39770c557658a0d78214d036b01c81_b.jpg\" data-size=\"normal\" data-rawwidth=\"704\" data-rawheight=\"217\" class=\"origin_image zh-lightbox-thumb\" width=\"704\" data-original=\"https://pic2.zhimg.com/v2-0f39770c557658a0d78214d036b01c81_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;704&#39; height=&#39;217&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"704\" data-rawheight=\"217\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"704\" data-original=\"https://pic2.zhimg.com/v2-0f39770c557658a0d78214d036b01c81_r.jpg\" data-actualsrc=\"https://pic2.zhimg.com/v2-0f39770c557658a0d78214d036b01c81_b.jpg\"/><figcaption>ç”±äºgenerateä»»åŠ¡åªæœ‰æ·±åº¦æ¨¡å‹ï¼Œå› æ­¤åªå¯¹æ¯”äº†ä¸¤ä¸ªæ·±åº¦æ¨¡å‹ã€‚ç»“æœç•¥å¥½äºæœ€æ–°çš„æ¨¡å‹ACGï¼Œæ˜æ˜¾å¥½äºHREDã€‚</figcaption></figure><p>æ­¤å¤–ï¼Œä½œè€…åˆ†æäº†Homomorphic Embeddingçš„ä½œç”¨ã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic3.zhimg.com/v2-1a4b8bda22603faa4d36399f205ce292_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"754\" data-rawheight=\"541\" class=\"origin_image zh-lightbox-thumb\" width=\"754\" data-original=\"https://pic3.zhimg.com/v2-1a4b8bda22603faa4d36399f205ce292_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;754&#39; height=&#39;541&#39;&gt;&lt;/svg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"754\" data-rawheight=\"541\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"754\" data-original=\"https://pic3.zhimg.com/v2-1a4b8bda22603faa4d36399f205ce292_r.jpg\" data-actualsrc=\"https://pic3.zhimg.com/v2-1a4b8bda22603faa4d36399f205ce292_b.jpg\"/></figure><p>Qè¡¨ç¤ºè¾“å…¥homomorphic query embeddingï¼ŒRè¡¨ç¤ºè¾“å…¥embeddings of reformulationsã€‚å¯ä»¥çœ‹å‡ºï¼Œåªè¾“å…¥Qæ•ˆæœæ¯”ACGè¿˜å·®ï¼Œè¾“å…¥Ræ¨¡å‹çš„ç»“æœæ¥è¿‘äºQ+Rã€‚å¯ä»¥çœ‹å‡ºembeddings of reformulationså¯¹äºæ¨¡å‹é¢„æµ‹æ¨èqueryæ›´åŠ æœ‰ç”¨ã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic4.zhimg.com/v2-32ce1588be8258bb8810e3983e9a497b_b.jpg\" data-size=\"normal\" data-rawwidth=\"751\" data-rawheight=\"527\" class=\"origin_image zh-lightbox-thumb\" width=\"751\" data-original=\"https://pic4.zhimg.com/v2-32ce1588be8258bb8810e3983e9a497b_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;751&#39; height=&#39;527&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"751\" data-rawheight=\"527\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"751\" data-original=\"https://pic4.zhimg.com/v2-32ce1588be8258bb8810e3983e9a497b_r.jpg\" data-actualsrc=\"https://pic4.zhimg.com/v2-32ce1588be8258bb8810e3983e9a497b_b.jpg\"/><figcaption>åŠ å’Œä¸åŠ reformulation inferenceçš„åŒºåˆ«ã€‚RIN(-Iï¼‰è¡¨ç¤ºä¸åŠ reformulation inferenceã€‚å¯ä»¥çœ‹å‡ºåŠ å…¥reformulation inferenceå¯¹æ¨¡å‹ç»“æœç•¥å¾®çš„æå‡ã€‚</figcaption></figure><p class=\"ztext-empty-paragraph\"><br/></p><h2>æ€»ç»“</h2><p>è¿™ç¯‡æ–‡ç« çš„ä¸»è¦è´¡çŒ®å¯ä»¥åˆ†æˆä¸¤ä¸ªå§ã€‚</p><ol><li>æå‡ºäº†homomorphic embeddingï¼Œä½¿ç”¨è¿™ç§æ–¹å¼ç›¸å½“äºå°†ç”¨æˆ·æ”¹å†™queryå’Œç‚¹å‡»ä¿¡æ¯ä¹Ÿç¼–ç è¿›äº†å•è¯å‘é‡ã€‚å¯¹äºå®é™…åº”ç”¨ï¼Œè¿™ä¸ªå›¾ä¼šéå¸¸å¤§ï¼Œéœ€è¦åˆ†å¸ƒå¼å¹³å°æŠ€æœ¯ã€‚</li><li>åŠ å…¥äº†embeddings of reformulationsï¼Œä»¥åŠreformulation inferenceã€‚ç”±äºç”¨æˆ·è¾“å…¥çš„queryçš„æ•°é‡éå¸¸å¤šï¼Œè€Œä¸”é•¿å°¾éå¸¸ä¸¥é‡ã€‚å¦‚æœä»æ”¹å†™è§„åˆ™çš„è§’åº¦å»çœ‹queryä¹‹é—´çš„è½¬æ¢ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šç¡®å®å¯ä»¥è§£å†³æ•°æ®ç¨€ç–çš„é—®é¢˜ã€‚</li></ol>", 
            "topic": [
                {
                    "tag": "queryåˆ†æ", 
                    "tagLink": "https://api.zhihu.com/topics/19611289"
                }, 
                {
                    "tag": "æ·±åº¦å­¦ä¹ ï¼ˆDeep Learningï¼‰", 
                    "tagLink": "https://api.zhihu.com/topics/19813032"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/82129871", 
            "userName": "Ivan Yan", 
            "userLink": "https://www.zhihu.com/people/3677a61f41a4d1cd630d63e270524c07", 
            "upvote": 3, 
            "title": "çŸ¥è¯†è’¸é¦ï¼ˆKnowledge Distillationï¼‰ç®€è¿°ï¼ˆäºŒï¼‰", 
            "content": "<h2>ç®€ä»‹</h2><p>è¿™ä¸¤å¹´BERTå¤ªç«äº†ï¼Œä½†æ˜¯BERTæ¨¡å‹æ˜¯çœŸçš„å¤§ï¼Œè®¡ç®—èµ·æ¥å¤ªæ…¢äº†ã€‚çŸ¥è¯†è’¸é¦å¯ä»¥å¯¹æ¨¡å‹è¿›è¡Œå‹ç¼©ï¼Œè¿ç§»åˆ°å°çš„æ¨¡å‹ã€‚æ‰¾äº†ä¸‹æ˜¯å¦æœ‰å…³äºBERTçš„çŸ¥è¯†è’¸é¦çš„è®ºæ–‡ï¼Œç„¶åçœ‹åˆ°äº†ä¸‹é¢è¿™ç¯‡è®ºæ–‡ï¼Œâ€œDistilling Task-Specific Knowledge from BERT into Simple Neural Networksâ€ã€‚åšæ³•å¾ˆç®€å•ï¼Œå°±æ˜¯ç”¨çŸ¥è¯†è’¸é¦çš„æ–¹æ³•ï¼ŒæŠŠBERTæ¨¡å‹è¿ç§»åˆ°BiLSTMæ¨¡å‹ä¸Šã€‚</p><a data-draft-node=\"block\" data-draft-type=\"link-card\" href=\"https://link.zhihu.com/?target=https%3A//arxiv.org/abs/1903.12136\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Distilling Task-Specific Knowledge from BERT into Simple Neural Networks</a><h2>æ¨¡å‹</h2><p>è¿™ç¯‡æ–‡ç« çš„teacherç½‘ç»œæ˜¯BERTæ¨¡å‹ã€‚BERTæ¨¡å‹çš„è¾“å…¥å¯ä»¥æ˜¯ä¸€å¥è¯ï¼Œåšåˆ†ç±»ï¼›æˆ–è€…ä¸¤å¥è¯ï¼ŒåšåŒ¹é…ï¼›å› æ­¤ï¼Œé’ˆå¯¹è¿™ä¸¤ç§æƒ…å†µæ–‡ç« æå‡ºäº†2ä¸ªæ¨¡å‹ï¼Œä½œä¸ºstudentç½‘ç»œã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure data-size=\"normal\"><noscript><img src=\"https://pic2.zhimg.com/v2-8df2b7f5e7418205a62c2c21b035d171_b.jpg\" data-rawwidth=\"461\" data-rawheight=\"437\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb\" width=\"461\" data-original=\"https://pic2.zhimg.com/v2-8df2b7f5e7418205a62c2c21b035d171_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;461&#39; height=&#39;437&#39;&gt;&lt;/svg&gt;\" data-rawwidth=\"461\" data-rawheight=\"437\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"461\" data-original=\"https://pic2.zhimg.com/v2-8df2b7f5e7418205a62c2c21b035d171_r.jpg\" data-actualsrc=\"https://pic2.zhimg.com/v2-8df2b7f5e7418205a62c2c21b035d171_b.jpg\"/></figure><p>è¿™ä¸ªæ¨¡å‹å°±æ˜¯ä¼ ç»Ÿçš„biLSTMæ¨¡å‹ï¼Œè¾“å…¥è¯å‘é‡åˆ°biLSTMå±‚ï¼Œç„¶åå–æœ€åä¸€æ­¥çš„hidden stateså–‚ç»™å…¨è¿æ¥å±‚ï¼Œæ¥softmaxåšåˆ†ç±»ã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic1.zhimg.com/v2-9e8f68d0e076cd878eb801440e2c5da8_b.jpg\" data-rawwidth=\"532\" data-rawheight=\"587\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb\" width=\"532\" data-original=\"https://pic1.zhimg.com/v2-9e8f68d0e076cd878eb801440e2c5da8_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;532&#39; height=&#39;587&#39;&gt;&lt;/svg&gt;\" data-rawwidth=\"532\" data-rawheight=\"587\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"532\" data-original=\"https://pic1.zhimg.com/v2-9e8f68d0e076cd878eb801440e2c5da8_r.jpg\" data-actualsrc=\"https://pic1.zhimg.com/v2-9e8f68d0e076cd878eb801440e2c5da8_b.jpg\"/></figure><p> å¯¹äºæ–‡æœ¬åŒ¹é…ï¼Œæ–‡ç« ä½œè€…ç”¨çš„æ¨¡å‹ä¹Ÿå¾ˆç®€å•ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨ç‰¹åˆ«å¤æ‚çš„æ–‡æœ¬åŒ¹é…æ¨¡å‹ä½œä¸ºstudentç½‘ç»œã€‚å–ä¸¤ä¸ªå¥å­æœ€åä¸€æ­¥çš„biLSTMçš„hidden states <img src=\"https://www.zhihu.com/equation?tex=h_%7Bs1%7D%2C+h_%7Bs2%7D\" alt=\"h_{s1}, h_{s2}\" eeimg=\"1\"/> ï¼Œç„¶åæ‹¼æ¥æˆ <img src=\"https://www.zhihu.com/equation?tex=%5Bh_%7Bs1%7D%2C+h_%7Bs2%7D%2C+h_%7Bs1%7D%5Codot+h_%7Bs2%7D%2C+%5Cleft%7C+h_%7Bs1%7D+-+h_%7Bs2%7D+%5Cright%7C%5D\" alt=\"[h_{s1}, h_{s2}, h_{s1}\\odot h_{s2}, \\left| h_{s1} - h_{s2} \\right|]\" eeimg=\"1\"/> ä½œä¸ºå…¨è¿æ¥å±‚çš„è¾“å…¥ï¼Œç„¶åç»è¿‡softmaxå¾—åˆ°åŒ¹é…ç»“æœã€‚ <img src=\"https://www.zhihu.com/equation?tex=%5Codot\" alt=\"\\odot\" eeimg=\"1\"/> è¡¨ç¤ºç‚¹ä¹˜ã€‚ </p><h2>Distillationç›®æ ‡å‡½æ•°</h2><p>æ¨¡å‹å·²ç»ä»‹ç»å®Œäº†ï¼Œä¸‹é¢ä»‹ç»å¦‚ä½•å°†BERTæ¨¡å‹çš„çŸ¥è¯†è¿ç§»åˆ°biLSTMä¸­ã€‚è¿™é‡Œç›´æ¥ä½¿ç”¨äº†teacherç½‘ç»œlogitsçš„è¾“å‡ºï¼Œæ¥ä½œä¸ºstudentç½‘ç»œçš„distillation objectiveï¼Œè€Œä¸æ˜¯ä½¿ç”¨è®ºæ–‡ â€œDistilling the Knowledge in a Neural Networkâ€ä¸­çš„soft targetsã€‚å…·ä½“å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=y%3Dsoftmax%28z%29+%5C%5C+L_%7Bdistill%7D%3D%5Cleft%7C%7C+z%5E%7B%28B%29%7D+-+z%5E%7B%28S%29%7D+%5Cright%7C%7C_2%5E2+%5C%5C+L+%3D+%5Calpha+%5Ccdot+L_%7BCE%7D+%2B+%281-%5Calpha%29%5Ccdot+L_%7Bdistill%7D+%5C%5C+%3D+-%5Calpha%5Csum_%7Bi%7D%7Bt_i+log+y_i%5E%7B%28S%29%7D%7D+-+%281-%5Calpha%29%5Cleft%7C%7C+z%5E%7B%28B%29%7D+-+z%5E%7B%28S%29%7D+%5Cright%7C%7C_2%5E2\" alt=\"y=softmax(z) \\\\ L_{distill}=\\left|| z^{(B)} - z^{(S)} \\right||_2^2 \\\\ L = \\alpha \\cdot L_{CE} + (1-\\alpha)\\cdot L_{distill} \\\\ = -\\alpha\\sum_{i}{t_i log y_i^{(S)}} - (1-\\alpha)\\left|| z^{(B)} - z^{(S)} \\right||_2^2\" eeimg=\"1\"/> </p><p>è¿™é‡Œ <img src=\"https://www.zhihu.com/equation?tex=z%5E%7B%28B%29%7D\" alt=\"z^{(B)}\" eeimg=\"1\"/>å’Œ <img src=\"https://www.zhihu.com/equation?tex=z%5E%7B%28S%29%7D\" alt=\"z^{(S)}\" eeimg=\"1\"/>æ˜¯teacherå’Œstudentç½‘ç»œçš„logitsï¼Œä½¿ç”¨MSEï¼ˆmean-squared-errorï¼‰æ¥ä½œä¸º <img src=\"https://www.zhihu.com/equation?tex=L_%7Bdistill%7D\" alt=\"L_{distill}\" eeimg=\"1\"/> çš„æŸå¤±å‡½æ•°ã€‚tæ˜¯çœŸå®æ ‡ç­¾ã€‚</p><p>åœ¨distillationè¿‡ç¨‹ä¸­ï¼Œå°æ•°æ®é›†å¯èƒ½æ— æ³•å®Œå…¨çš„è¡¨è¾¾teacherç½‘ç»œçš„çŸ¥è¯†ã€‚å› æ­¤ï¼Œæ–‡ä¸­æå‡ºäº†ä¸‰ç§æ•°æ®å¢å¼ºçš„æ–¹æ³•æ¥äººä¸ºçš„æ‰©å……æ•°æ®é›†ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p><ol><li><b>Masking </b>ä½¿ç”¨[mask]æ ‡ç­¾æ¥éšæœºæ›¿æ¢ä¸€ä¸ªå•è¯ï¼Œä¾‹å¦‚â€œI love the comedy&#34;æ›¿æ¢ä¸ºâ€ I [mask] the comedy&#34;ã€‚</li><li><b>POS-guided word replacement</b> å°†ä¸€ä¸ªå•è¯æ›¿æ¢ä¸ºç›¸åŒPOSæ ‡ç­¾çš„éšæœºå•è¯ã€‚ä¾‹å¦‚ï¼Œâ€œWhat do pigs eat?&#34;æ›¿æ¢ä¸º&#34;How do pigs eat?&#34;ã€‚</li><li><b>n-gram sampling</b> éšæœºé‡‡ç”¨n-gramï¼Œnä»1åˆ°5ï¼Œå¹¶ä¸¢å¼ƒå…¶å®ƒå•è¯ã€‚</li></ol><h2>å®éªŒç»“æœ</h2><figure data-size=\"normal\"><noscript><img src=\"https://pic3.zhimg.com/v2-c636f71818a1a36f47764a69de708a6a_b.jpg\" data-rawwidth=\"1092\" data-rawheight=\"528\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb\" width=\"1092\" data-original=\"https://pic3.zhimg.com/v2-c636f71818a1a36f47764a69de708a6a_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1092&#39; height=&#39;528&#39;&gt;&lt;/svg&gt;\" data-rawwidth=\"1092\" data-rawheight=\"528\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1092\" data-original=\"https://pic3.zhimg.com/v2-c636f71818a1a36f47764a69de708a6a_r.jpg\" data-actualsrc=\"https://pic3.zhimg.com/v2-c636f71818a1a36f47764a69de708a6a_b.jpg\"/></figure><p>ä¸Šè¡¨æ˜¾ç¤ºäº†æ¨¡å‹çš„ç»“æœï¼Œå¯ä»¥çœ‹å‡ºåŠ å…¥çŸ¥è¯†è’¸é¦ä¹‹åï¼Œæ¨¡å‹çš„ç»“æœç¡®å®æ¯”å•çº¯åœ°ä½¿ç”¨BiLSTMçš„ç»“æœå¥½ï¼Œåœ¨SST-2å’ŒQQPä¸Šå±…ç„¶æ¯”ELMoè¦å¥½ã€‚å¯ä»¥ç¡®å®šçš„æ˜¯è¿™æ ·åšç¡®å®å¯ä»¥å°†BERTä¸­çš„çŸ¥è¯†è¿ç§»åˆ°BiLSTMä¸­ã€‚ä½†æ˜¯BiLSTMæ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›æ¯”BERTå¼±å¾ˆå¤šã€‚æ˜¾ç„¶æœ‰äº›çŸ¥è¯†æ˜¯æ— æ³•ä»BERTä¸­è¿ç§»åˆ°BiLSTMä¸­çš„ï¼Œä¾‹å¦‚ä¸¤ä¸ªå¥å­ä¹‹é—´çš„co-attentionä¿¡æ¯å’Œé•¿è·ç¦»ä¾èµ–ä¿¡æ¯ã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic2.zhimg.com/v2-e26aa8f051e4c45acee3c9f5cf101f05_b.jpg\" data-rawwidth=\"970\" data-rawheight=\"346\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb\" width=\"970\" data-original=\"https://pic2.zhimg.com/v2-e26aa8f051e4c45acee3c9f5cf101f05_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;970&#39; height=&#39;346&#39;&gt;&lt;/svg&gt;\" data-rawwidth=\"970\" data-rawheight=\"346\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"970\" data-original=\"https://pic2.zhimg.com/v2-e26aa8f051e4c45acee3c9f5cf101f05_r.jpg\" data-actualsrc=\"https://pic2.zhimg.com/v2-e26aa8f051e4c45acee3c9f5cf101f05_b.jpg\"/></figure><p>ä¸Šå›¾æ˜¾ç¤ºäº†ç½‘ç»œçš„inferenceæ—¶é—´ï¼Œå¯ä»¥çœ‹åˆ°ç›¸æ¯”äºBERTå‚æ•°å‡å°‘äº†98å€ï¼Œé€Ÿåº¦åŠ å¿«äº†434å€ã€‚</p><p>è¿™ç¯‡æ–‡ç« å±•ç¤ºäº†å¦‚ä½•å°†BERTçš„çŸ¥è¯†è¿ç§»åˆ°å…¶å®ƒç½‘ç»œä¸­ï¼ˆBiLSTMï¼‰ã€‚å¯¹ä¸ç¦»çº¿çš„æ•°æ®å¤„ç†ï¼Œç”±äºæ—¶é—´è¦æ±‚ä¸é«˜ï¼Œç°åœ¨ä¸€èˆ¬ä¼šé‡‡ç”¨BERTæ¨¡å‹ï¼Œæˆ–è€…BERTçš„æ”¹è¿›æ¨¡å‹ï¼Œå› ä¸ºæ•ˆæœç¡®å®æ¯”å…¶å®ƒæ¨¡å‹æœ‰å¾ˆå¤§çš„æå‡ï¼ŒåŸºæœ¬å¯ä»¥æ— è„‘ä¸ŠBERTã€‚å¯¹äºçº¿ä¸Šçš„ä»»åŠ¡ï¼ŒBERTçš„inferenceç¡®å®å¤ªæ…¢äº†ã€‚è¿™ç¯‡æ–‡ç« çš„æ€è·¯å¯ä»¥å€Ÿé‰´ä¸€ä¸‹ï¼Œå®ç°ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯åŠ ä¸€ä¸ª <img src=\"https://www.zhihu.com/equation?tex=L_%7Bdistill%7D\" alt=\"L_{distill}\" eeimg=\"1\"/> æŸå¤±ã€‚è¿™ç¯‡æ–‡ç« çš„æ•ˆæœï¼Œæˆ‘è‡ªå·±è¿˜æ²¡è¯•è¿‡ï¼Œå…·ä½“æ•ˆæœæ˜¯å¦æœ‰æ–‡ç« è¿™ä¹ˆå¥½ï¼Œè¿˜ä¸çŸ¥é“ã€‚ä½†å¯¹æ²¡æœ‰é¢„è®­ç»ƒçš„ç½‘ç»œï¼Œåº”è¯¥ä¼šæœ‰ä¸€å®šçš„æ•ˆæœæå‡ã€‚</p>", 
            "topic": [], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/81467832", 
            "userName": "Ivan Yan", 
            "userLink": "https://www.zhihu.com/people/3677a61f41a4d1cd630d63e270524c07", 
            "upvote": 87, 
            "title": "çŸ¥è¯†è’¸é¦ï¼ˆKnowledge Distillationï¼‰ç®€è¿°ï¼ˆä¸€ï¼‰", 
            "content": "<p>æœ€æ–°åœ¨çœ‹çŸ¥è¯†è’¸é¦çš„æ–‡ç« ï¼Œä¸»è¦æ˜¯ç°åœ¨çš„æ·±åº¦å­¦ä¹ æ¨¡å‹è¶Šæ¥è¶Šå¤§ï¼Œä¾‹å¦‚BERTã€‚åœ¨çº¿ä¸‹å¤„ç†æ•°æ®ï¼Œå¯¹æ—¶é—´è¦æ±‚ä¸é«˜çš„è¯ï¼Œè¿˜èƒ½æ¥å—ï¼Œèƒ½è·‘å®Œå°±å¥½ã€‚ä½†æ˜¯çº¿ä¸Šè¿è¡Œï¼Œå¯¹å»¶è¿Ÿè¦æ±‚é«˜çš„è¯ï¼ŒåƒBERTè¿™æ ·çš„å¤§æ¨¡å‹ï¼Œå°±å¾ˆéš¾æ»¡è¶³è¦æ±‚ã€‚å› æ­¤ï¼Œå°±æ‰¾äº†æ‰¾æ¨¡å‹å‹ç¼©çš„æ–¹æ³•ã€‚</p><p>çŸ¥è¯†è’¸é¦è¢«å¹¿æ³›çš„ç”¨äºæ¨¡å‹å‹ç¼©å’Œè¿ç§»å­¦ä¹ å½“ä¸­ã€‚å¼€å±±ä¹‹ä½œåº”è¯¥æ˜¯<a href=\"https://link.zhihu.com/?target=https%3A//arxiv.org/abs/1503.02531\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">â€Distilling the Knowledge in a Neural Networkâ€œ</a>ã€‚è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä½œè€…çš„motivationæ˜¯æ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼ŒæŠŠå¤šä¸ªæ¨¡å‹çš„çŸ¥è¯†æç‚¼ç»™å•ä¸ªæ¨¡å‹ã€‚</p><p>æ–‡ç« çš„æ ‡é¢˜æ˜¯Distilling the Knowledge in a Neural Networkï¼Œé‚£ä¹ˆè¯´æ˜æ˜¯ç¥ç»ç½‘ç»œçš„çŸ¥è¯†å‘¢ï¼Ÿä¸€èˆ¬è®¤ä¸ºæ¨¡å‹çš„å‚æ•°ä¿ç•™äº†æ¨¡å‹å­¦åˆ°çš„çŸ¥è¯†ï¼Œå› æ­¤æœ€å¸¸è§çš„è¿ç§»å­¦ä¹ çš„æ–¹å¼å°±æ˜¯åœ¨ä¸€ä¸ªå¤§çš„æ•°æ®é›†ä¸Šå…ˆåšé¢„è®­ç»ƒï¼Œç„¶åä½¿ç”¨é¢„è®­ç»ƒå¾—åˆ°çš„å‚æ•°åœ¨ä¸€ä¸ªå°çš„æ•°æ®é›†ä¸Šåšå¾®è°ƒï¼ˆä¸¤ä¸ªæ•°æ®é›†å¾€å¾€é¢†åŸŸä¸åŒæˆ–è€…ä»»åŠ¡ä¸åŒï¼‰ã€‚ä¾‹å¦‚å…ˆåœ¨Imagenetä¸Šåšé¢„è®­ç»ƒï¼Œç„¶ååœ¨COCOæ•°æ®é›†ä¸Šåšæ£€æµ‹ã€‚åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…è®¤ä¸ºå¯ä»¥å°†æ¨¡å‹çœ‹æˆæ˜¯é»‘ç›’å­ï¼Œé’ˆå¯¹ç‰¹å®šæ¨¡å‹çš„è¾“å…¥ï¼Œå¾—åˆ°çš„è¾“å‡ºç»“æœå°±æ˜¯çŸ¥è¯†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè®­ç»ƒå¥½ä¸€ä¸ªteacherç½‘ç»œï¼Œç„¶åå°†teacherçš„ç½‘ç»œçš„è¾“å‡ºç»“æœ <img src=\"https://www.zhihu.com/equation?tex=q\" alt=\"q\" eeimg=\"1\"/> ä½œä¸ºstudentç½‘ç»œçš„ç›®æ ‡ï¼Œè®­ç»ƒstudentç½‘ç»œï¼Œä½¿å¾—studentç½‘ç»œçš„ç»“æœ <img src=\"https://www.zhihu.com/equation?tex=p\" alt=\"p\" eeimg=\"1\"/> æ¥è¿‘ <img src=\"https://www.zhihu.com/equation?tex=q\" alt=\"q\" eeimg=\"1\"/> ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†æŸå¤±å‡½æ•°å†™æˆ <img src=\"https://www.zhihu.com/equation?tex=L%3DCE%28y%2C+p%29%2B%5Calpha+CE%28q%2C+p%29\" alt=\"L=CE(y, p)+\\alpha CE(q, p)\" eeimg=\"1\"/> ã€‚è¿™é‡ŒCEæ˜¯äº¤å‰ç†µï¼ˆCross Entropyï¼‰ï¼Œyæ˜¯çœŸå®æ ‡ç­¾çš„onehotç¼–ç ï¼Œqæ˜¯teacherç½‘ç»œçš„è¾“å‡ºç»“æœï¼Œpæ˜¯studentç½‘ç»œçš„è¾“å‡ºç»“æœã€‚</p><p>ä½†æ˜¯ï¼Œç›´æ¥ä½¿ç”¨teacherç½‘ç»œçš„softmaxçš„è¾“å‡ºç»“æœ <img src=\"https://www.zhihu.com/equation?tex=q\" alt=\"q\" eeimg=\"1\"/> ï¼Œå¯èƒ½ä¸å¤§åˆé€‚ã€‚å› æ­¤ï¼Œä¸€ä¸ªç½‘ç»œè®­ç»ƒå¥½ä¹‹åï¼Œå¯¹äºæ­£ç¡®çš„ç­”æ¡ˆä¼šæœ‰ä¸€ä¸ªå¾ˆé«˜çš„ç½®ä¿¡åº¦ã€‚ä¾‹å¦‚ï¼Œåœ¨MNISTæ•°æ®ä¸­ï¼Œå¯¹äºæŸä¸ª2çš„è¾“å…¥ï¼Œå¯¹äº2çš„é¢„æµ‹æ¦‚ç‡ä¼šå¾ˆé«˜ï¼Œè€Œå¯¹äº2ç±»ä¼¼çš„æ•°å­—ï¼Œä¾‹å¦‚3å’Œ7çš„é¢„æµ‹æ¦‚ç‡ä¸º <img src=\"https://www.zhihu.com/equation?tex=10%5E%7B-6%7D\" alt=\"10^{-6}\" eeimg=\"1\"/> å’Œ <img src=\"https://www.zhihu.com/equation?tex=10%5E%7B-9%7D\" alt=\"10^{-9}\" eeimg=\"1\"/> ã€‚è¿™æ ·çš„è¯ï¼Œteacherç½‘ç»œå­¦åˆ°æ•°æ®çš„ç›¸ä¼¼ä¿¡æ¯ï¼ˆä¾‹å¦‚æ•°å­—2å’Œ3ï¼Œ7å¾ˆç±»ä¼¼ï¼‰å¾ˆéš¾ä¼ è¾¾ç»™studentç½‘ç»œã€‚ç”±äºå®ƒä»¬çš„æ¦‚ç‡å€¼æ¥è¿‘0ã€‚å› æ­¤ï¼Œæ–‡ç« æå‡ºäº†soft targetï¼Œå…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://www.zhihu.com/equation?tex=q_i%3D%5Cfrac%7Bexp%28z_i%2FT%29%7D%7B%5Csum_j+exp%28z_j%2FT%29%7D\" alt=\"q_i=\\frac{exp(z_i/T)}{\\sum_j exp(z_j/T)}\" eeimg=\"1\"/> </p><p>è¿™é‡Œ <img src=\"https://www.zhihu.com/equation?tex=z_i\" alt=\"z_i\" eeimg=\"1\"/> æ˜¯ç¥ç»ç½‘ç»œsoftmaxå‰çš„è¾“å‡ºlogitã€‚å¦‚æœå°†Tå–1ï¼Œè¿™ä¸ªå…¬å¼å°±æ˜¯softmaxï¼Œæ ¹æ®logitè¾“å‡ºå„ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚å¦‚æœTæ¥è¿‘äº0ï¼Œåˆ™æœ€å¤§çš„å€¼ä¼šè¶Šè¿‘1ï¼Œå…¶å®ƒå€¼ä¼šæ¥è¿‘0ï¼Œè¿‘ä¼¼äºonehotç¼–ç ã€‚å¦‚æœTè¶Šå¤§ï¼Œåˆ™è¾“å‡ºçš„ç»“æœçš„åˆ†å¸ƒè¶Šå¹³ç¼“ï¼Œç›¸å½“äºå¹³æ»‘çš„ä¸€ä¸ªä½œç”¨ï¼Œèµ·åˆ°ä¿ç•™ç›¸ä¼¼ä¿¡æ¯çš„ä½œç”¨ã€‚å¦‚æœTç­‰äºæ— ç©·ï¼Œå°±æ˜¯ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒã€‚</p><p>æœ€ç»ˆæ–‡ç« æ ¹æ®ä¸Šè¿°çš„æŸå¤±å‡½æ•°å¯¹ç½‘ç»œè¿›è¡Œè®­ç»ƒã€‚</p><ol><li>åœ¨MNISTè¿™ä¸ªæ•°æ®é›†ä¸Šï¼Œå…ˆä½¿ç”¨å¤§çš„ç½‘ç»œè¿›è¡Œè®­ç»ƒï¼Œæµ‹è¯•é›†é”™è¯¯67ä¸ªï¼Œå°ç½‘ç»œè®­ç»ƒï¼Œæµ‹è¯•é›†é”™è¯¯146ä¸ªã€‚åŠ å…¥soft targetsåˆ°ç›®æ ‡å‡½æ•°ä¸­ï¼Œç›¸å½“äºæ­£åˆ™é¡¹ï¼Œæµ‹è¯•é›†çš„é”™è¯¯é™ä½åˆ°äº†74ä¸ªã€‚è¿™è¯æ˜äº†teacherç½‘ç»œç¡®å®æŠŠçŸ¥è¯†è½¬ç§»åˆ°äº†studentç½‘ç»œï¼Œä½¿å¾—ç»“æœå˜å¥½äº†ã€‚</li><li>ç¬¬äºŒä¸ªå®éªŒæ˜¯åœ¨speech recognitioné¢†åŸŸï¼Œä½¿ç”¨ä¸åŒçš„å‚æ•°è®­ç»ƒäº†10ä¸ªDNNï¼Œå¯¹è¿™10ä¸ªæ¨¡å‹çš„é¢„æµ‹ç»“æœæ±‚å¹³å‡ä½œä¸ºemsembleçš„ç»“æœï¼Œç›¸æ¯”äºå•ä¸ªæ¨¡å‹æœ‰ä¸€å®šçš„æå‡ã€‚ç„¶åå°†è¿™10ä¸ªæ¨¡å‹ä½œä¸ºteacherç½‘ç»œï¼Œè®­ç»ƒstudentç½‘ç»œã€‚å¾—åˆ°çš„Distilled Single modelç›¸æ¯”äºç›´æ¥çš„å•ä¸ªç½‘ç»œï¼Œä¹Ÿæœ‰ä¸€å®šçš„æå‡ï¼Œç»“æœè§ä¸‹è¡¨ï¼š</li></ol><figure data-size=\"normal\"><noscript><img src=\"https://pic1.zhimg.com/v2-ff90976f717e2ad6378ba92f881f8604_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"515\" data-rawheight=\"123\" class=\"origin_image zh-lightbox-thumb\" width=\"515\" data-original=\"https://pic1.zhimg.com/v2-ff90976f717e2ad6378ba92f881f8604_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;515&#39; height=&#39;123&#39;&gt;&lt;/svg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"515\" data-rawheight=\"123\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"515\" data-original=\"https://pic1.zhimg.com/v2-ff90976f717e2ad6378ba92f881f8604_r.jpg\" data-actualsrc=\"https://pic1.zhimg.com/v2-ff90976f717e2ad6378ba92f881f8604_b.jpg\"/></figure><p><b>ç»“è®º</b></p><p>çŸ¥è¯†è’¸é¦ï¼Œå¯ä»¥å°†ä¸€ä¸ªç½‘ç»œçš„çŸ¥è¯†è½¬ç§»åˆ°å¦ä¸€ä¸ªç½‘ç»œï¼Œä¸¤ä¸ªç½‘ç»œå¯ä»¥æ˜¯åŒæ„æˆ–è€…å¼‚æ„ã€‚åšæ³•æ˜¯å…ˆè®­ç»ƒä¸€ä¸ªteacherç½‘ç»œï¼Œç„¶åä½¿ç”¨è¿™ä¸ªteacherç½‘ç»œçš„è¾“å‡ºå’Œæ•°æ®çš„çœŸå®æ ‡ç­¾å»è®­ç»ƒstudentç½‘ç»œã€‚çŸ¥è¯†è’¸é¦ï¼Œå¯ä»¥ç”¨æ¥å°†ç½‘ç»œä»å¤§ç½‘ç»œè½¬åŒ–æˆä¸€ä¸ªå°ç½‘ç»œï¼Œå¹¶ä¿ç•™æ¥è¿‘äºå¤§ç½‘ç»œçš„æ€§èƒ½ï¼›ä¹Ÿå¯ä»¥å°†å¤šä¸ªç½‘ç»œçš„å­¦åˆ°çš„çŸ¥è¯†è½¬ç§»åˆ°ä¸€ä¸ªç½‘ç»œä¸­ï¼Œä½¿å¾—å•ä¸ªç½‘ç»œçš„æ€§èƒ½æ¥è¿‘emsembleçš„ç»“æœã€‚</p><p>å‚è€ƒæ–‡çŒ®ï¼š</p><ol><li>Hinton, Geoffrey, Oriol Vinyals, and Jeff Dean. &#34;Distilling the knowledge in a neural network.&#34;<i>arXiv preprint arXiv:1503.02531</i>(2015).</li><li>Prakhar Ganesh. &#34;Knowledge Distillation : Simplified&#34;. <a href=\"https://link.zhihu.com/?target=https%3A//towardsdatascience.com/knowledge-distillation-simplified-dd4973dbc764\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">towardsdatascience.com/</span><span class=\"invisible\">knowledge-distillation-simplified-dd4973dbc764</span><span class=\"ellipsis\"></span></a>, 2019.</li></ol><p></p>", 
            "topic": [
                {
                    "tag": "æ·±åº¦å­¦ä¹ ï¼ˆDeep Learningï¼‰", 
                    "tagLink": "https://api.zhihu.com/topics/19813032"
                }, 
                {
                    "tag": "è¿ç§»å­¦ä¹  (Transfer Learning)", 
                    "tagLink": "https://api.zhihu.com/topics/20079475"
                }
            ], 
            "comments": []
        }
    ], 
    "url": "https://zhuanlan.zhihu.com/c_1155064304431783936"
}
