{
    "title": "è¿ç»´å®è·µ", 
    "description": "", 
    "followers": [
        "https://www.zhihu.com/people/ta-ge-xing-60-59", 
        "https://www.zhihu.com/people/conan-qzhong", 
        "https://www.zhihu.com/people/sailfishc", 
        "https://www.zhihu.com/people/xu-xin-yu-14-25", 
        "https://www.zhihu.com/people/song-wen-30", 
        "https://www.zhihu.com/people/quan-bo-mian", 
        "https://www.zhihu.com/people/zhou-peng-21-71", 
        "https://www.zhihu.com/people/qu-shi-qiang-74", 
        "https://www.zhihu.com/people/xiao-jie-32", 
        "https://www.zhihu.com/people/hlhl", 
        "https://www.zhihu.com/people/neowu0", 
        "https://www.zhihu.com/people/ying-zi-40-52", 
        "https://www.zhihu.com/people/huang-bo-20-36", 
        "https://www.zhihu.com/people/zi-mo-heng", 
        "https://www.zhihu.com/people/dong-bin-75", 
        "https://www.zhihu.com/people/du-xiao-ya-18", 
        "https://www.zhihu.com/people/ming-yu-69-3", 
        "https://www.zhihu.com/people/pop-sz-49", 
        "https://www.zhihu.com/people/yan-huaming", 
        "https://www.zhihu.com/people/fei-wo-fu-kua", 
        "https://www.zhihu.com/people/cnxobo", 
        "https://www.zhihu.com/people/jiang-fei-80", 
        "https://www.zhihu.com/people/harry-shen-3", 
        "https://www.zhihu.com/people/zacharyzhao", 
        "https://www.zhihu.com/people/marsgt", 
        "https://www.zhihu.com/people/xiaohinata", 
        "https://www.zhihu.com/people/fanyu83", 
        "https://www.zhihu.com/people/ly-lyrids", 
        "https://www.zhihu.com/people/mikoto-misaka-3", 
        "https://www.zhihu.com/people/yi-wen-53-56-60", 
        "https://www.zhihu.com/people/li-xiao-xian-er-34-30", 
        "https://www.zhihu.com/people/kome", 
        "https://www.zhihu.com/people/amazing_cat", 
        "https://www.zhihu.com/people/yetone", 
        "https://www.zhihu.com/people/ampxe", 
        "https://www.zhihu.com/people/jia-chen-83-19", 
        "https://www.zhihu.com/people/haitialdy", 
        "https://www.zhihu.com/people/programmer_song", 
        "https://www.zhihu.com/people/peter-wang-18", 
        "https://www.zhihu.com/people/rainmanx", 
        "https://www.zhihu.com/people/yimeng.ch", 
        "https://www.zhihu.com/people/lizhenyu", 
        "https://www.zhihu.com/people/xiao-xiao-zi-64-63", 
        "https://www.zhihu.com/people/veryl", 
        "https://www.zhihu.com/people/megabyte875", 
        "https://www.zhihu.com/people/shen-tu-hai-san", 
        "https://www.zhihu.com/people/lihaoquan", 
        "https://www.zhihu.com/people/xingshao-84", 
        "https://www.zhihu.com/people/shen-yu-bao", 
        "https://www.zhihu.com/people/zheng-zhen-yi", 
        "https://www.zhihu.com/people/luo-xiao-qi-39", 
        "https://www.zhihu.com/people/lane-97", 
        "https://www.zhihu.com/people/bu-yi-mi-ya", 
        "https://www.zhihu.com/people/cai-long-67", 
        "https://www.zhihu.com/people/coffeeb", 
        "https://www.zhihu.com/people/huan-xiang-shu", 
        "https://www.zhihu.com/people/wei-zhu-16", 
        "https://www.zhihu.com/people/ling-89-78", 
        "https://www.zhihu.com/people/gu-yu-98", 
        "https://www.zhihu.com/people/pandadefish", 
        "https://www.zhihu.com/people/bu-ke-zhi-82", 
        "https://www.zhihu.com/people/jiong-te-man", 
        "https://www.zhihu.com/people/tiaonmmn-33", 
        "https://www.zhihu.com/people/mx1014-95", 
        "https://www.zhihu.com/people/yu-sheng-87-52", 
        "https://www.zhihu.com/people/pw-young", 
        "https://www.zhihu.com/people/zhao-qing-50", 
        "https://www.zhihu.com/people/tianren", 
        "https://www.zhihu.com/people/shuitianyise", 
        "https://www.zhihu.com/people/TAT_hanxiao", 
        "https://www.zhihu.com/people/wang-dong-shi-90", 
        "https://www.zhihu.com/people/yang-ze-kai-25", 
        "https://www.zhihu.com/people/leon-more", 
        "https://www.zhihu.com/people/wang-xin-68-33", 
        "https://www.zhihu.com/people/wang-liao-52", 
        "https://www.zhihu.com/people/bo-zhang-51", 
        "https://www.zhihu.com/people/cdr1", 
        "https://www.zhihu.com/people/feng-wan-qing", 
        "https://www.zhihu.com/people/LuckyZpc", 
        "https://www.zhihu.com/people/liao-ming-73-60", 
        "https://www.zhihu.com/people/xu-xiao-sheng-18", 
        "https://www.zhihu.com/people/banbu_lee", 
        "https://www.zhihu.com/people/missing_r", 
        "https://www.zhihu.com/people/lightbluer", 
        "https://www.zhihu.com/people/oliver-76-84", 
        "https://www.zhihu.com/people/seven-cool", 
        "https://www.zhihu.com/people/li-de-jian-97", 
        "https://www.zhihu.com/people/zhang-lin-60-11", 
        "https://www.zhihu.com/people/psmortal", 
        "https://www.zhihu.com/people/yao-hao-23", 
        "https://www.zhihu.com/people/bu-cha-dian-81-98", 
        "https://www.zhihu.com/people/wang-yu-ming-24-81", 
        "https://www.zhihu.com/people/li-cheng-seven", 
        "https://www.zhihu.com/people/gu-yi-ji-hua", 
        "https://www.zhihu.com/people/ou-yang-kang-87", 
        "https://www.zhihu.com/people/halfer53", 
        "https://www.zhihu.com/people/ai-bo-te-3-8", 
        "https://www.zhihu.com/people/jia-wen-quan-53", 
        "https://www.zhihu.com/people/altkatz", 
        "https://www.zhihu.com/people/fan-fan-7-39", 
        "https://www.zhihu.com/people/fgsoap", 
        "https://www.zhihu.com/people/xie-yun-peng", 
        "https://www.zhihu.com/people/yu-zhe-47-84", 
        "https://www.zhihu.com/people/vroach", 
        "https://www.zhihu.com/people/wang-yang-8-54", 
        "https://www.zhihu.com/people/patrick-simon-78", 
        "https://www.zhihu.com/people/zhang-xuan-63-65", 
        "https://www.zhihu.com/people/yang-li-1", 
        "https://www.zhihu.com/people/web-13", 
        "https://www.zhihu.com/people/fen-di-73", 
        "https://www.zhihu.com/people/jee-23-34", 
        "https://www.zhihu.com/people/saber-5-66-87", 
        "https://www.zhihu.com/people/lei-zi-78-60", 
        "https://www.zhihu.com/people/yin-jiang-56-52", 
        "https://www.zhihu.com/people/halfbloodrock", 
        "https://www.zhihu.com/people/rongyangxu", 
        "https://www.zhihu.com/people/tongsu", 
        "https://www.zhihu.com/people/tim-yang", 
        "https://www.zhihu.com/people/9527chu", 
        "https://www.zhihu.com/people/rubix-lai", 
        "https://www.zhihu.com/people/cui-xiao-chen-82", 
        "https://www.zhihu.com/people/ji-kang", 
        "https://www.zhihu.com/people/lan-lan-lan-lan-96-82", 
        "https://www.zhihu.com/people/fanngyuan", 
        "https://www.zhihu.com/people/mwhi", 
        "https://www.zhihu.com/people/ning-meng-xin-73-58", 
        "https://www.zhihu.com/people/kikipedia", 
        "https://www.zhihu.com/people/zhihugexingyuming2", 
        "https://www.zhihu.com/people/SWAYing", 
        "https://www.zhihu.com/people/chybeta", 
        "https://www.zhihu.com/people/hurryport-11", 
        "https://www.zhihu.com/people/rikuh", 
        "https://www.zhihu.com/people/er-wa-13-7-20", 
        "https://www.zhihu.com/people/D0n9", 
        "https://www.zhihu.com/people/newcfg", 
        "https://www.zhihu.com/people/ivon-lee", 
        "https://www.zhihu.com/people/xia-hou-feng", 
        "https://www.zhihu.com/people/lou-kai-56-98", 
        "https://www.zhihu.com/people/ma-zei-lao", 
        "https://www.zhihu.com/people/cao-xin-58-59", 
        "https://www.zhihu.com/people/long-deng-long", 
        "https://www.zhihu.com/people/xiao-tai-yang-81-18", 
        "https://www.zhihu.com/people/linuxcpp", 
        "https://www.zhihu.com/people/zhuzhu-zhuzhu", 
        "https://www.zhihu.com/people/kaizener-74", 
        "https://www.zhihu.com/people/qian-yun-qing-40", 
        "https://www.zhihu.com/people/reader2018", 
        "https://www.zhihu.com/people/gangbj-gangbj", 
        "https://www.zhihu.com/people/yue-guo-shuai-68", 
        "https://www.zhihu.com/people/deng-liu-yan-76", 
        "https://www.zhihu.com/people/liu-xiao-yao-12", 
        "https://www.zhihu.com/people/tranch", 
        "https://www.zhihu.com/people/riskers", 
        "https://www.zhihu.com/people/jiang-ye-15", 
        "https://www.zhihu.com/people/goodlooks-com-cn", 
        "https://www.zhihu.com/people/rick-10", 
        "https://www.zhihu.com/people/feng-kai-yu-98", 
        "https://www.zhihu.com/people/vtan-89", 
        "https://www.zhihu.com/people/vl22swF-SUK_-K0crFui", 
        "https://www.zhihu.com/people/zhang-yifeng", 
        "https://www.zhihu.com/people/eta-100a"
    ], 
    "article": [
        {
            "url": "https://zhuanlan.zhihu.com/p/75450799", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 2, 
            "title": "é­”æ”¹äº†ä¸‹ MariaDB æ”¯æŒ JSON binary", 
            "content": "<p>Oracle MySQL çš„ JSON æ•°æ®ç±»å‹åœ¨å­˜å‚¨æ—¶ç”¨çš„ç´§å‡‘çš„äºŒè¿›åˆ¶æ ¼å¼ï¼ŒMariaDB åˆ™å‚²å¨‡çš„ç›´æ¥å­˜åŸå§‹çš„ JSON æ–‡æœ¬ä¸²ï¼Œä» <a href=\"https://link.zhihu.com/?target=https%3A//mariadb.com/kb/en/library/mariadb-vs-mysql-compatibility/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">MariaDB 10.2 å¼€å§‹å…¼å®¹  MySQL 5.7</a>ï¼Œå¦‚ä»Š MariaDB 10.4 ç¨³å®šç‰ˆéƒ½å‘å¸ƒäº†ï¼Œä¾ç„¶è¿˜æ˜¯ä¸æ”¯æŒ Oracle MySQL çš„ JSON ç±»å‹ï¼š</p><ul><li>ä½¿ç”¨ row based replication æ—¶ï¼Œä¸æ”¯æŒä» MySQL 5.7 å¤åˆ¶åŒ…å« JSON åˆ—çš„ binlog</li><li>ä¸æ”¯æŒå°±åœ°è¯»å–åŒ…å« MySQL JSON åˆ—çš„æ•°æ®æ–‡ä»¶</li></ul><p>MariaDB ä»  10.2 å¼€å§‹å¤§çˆ†å‘ï¼š</p><ul><li><a href=\"https://link.zhihu.com/?target=https%3A//mariadb.com/kb/en/library/incompatibilities-and-feature-differences-between-mariadb-102-and-mysql-57/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">10.2</a>:   </li><ul><li>Window function</li><li>Recursive Common Table Expressions</li><li>WITH statement</li><li>CHECK CONSTRAINT</li><li>DML-only flashback</li></ul><li><a href=\"https://link.zhihu.com/?target=https%3A//mariadb.com/kb/en/library/changes-improvements-in-mariadb-103/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">10.3</a>:</li><ul><li>System-versioned tables (ä¹Ÿè¢«ç§°ä¸º Temporal table)</li><li>Sequence</li></ul><li><a href=\"https://link.zhihu.com/?target=https%3A//mariadb.com/kb/en/library/changes-improvements-in-mariadb-104/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">10.4</a>:</li><ul><li>System-versioned table æ”¯æŒ application-time period</li><li>Galera 4</li><li>é™æ€é“¾æ¥ WolfSSL (åºŸäº† OpenSSL çœŸå¥½ğŸ˜„ï¼‰</li></ul><li>10.5 (è¿˜æœªæ­£å¼å‘å¸ƒ):</li><ul><li>S3 storage engine</li></ul></ul><p>ç›¸æ¯”ä¹‹ä¸‹ MySQL 8.0 çš„æ­¥å­çœŸæ˜¯å¤ªæ…¢äº†ï¼Œä½†æ˜¯ä¸¤å®¶å¯¹äº JSON æ•°æ®ç±»å‹çš„å®ç°ï¼Œææ€•æ˜¯ä¸æŒ‡æœ›åŒæ–¹ä¸»åŠ¨åšå…¼å®¹å±‚äº†ã€‚</p><p>ç”±äºéå¸¸é¦‹ MariaDB çš„ <a href=\"https://link.zhihu.com/?target=https%3A//mariadb.com/kb/en/library/temporal-data-tables/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">system-versioned table</a> åŠŸèƒ½ä»¥æ”¯æŒå®¡è®¡ã€è°ƒè¯•ã€æ•°æ®å›æ»šã€æ—¶åºåˆ†æï¼Œå› æ­¤é­”æ”¹äº†ä¸‹ MariaDB 10.4 åˆ†æ”¯ï¼Œè®©å…¶å¯ä»¥è§£æ MySQL 5.7 binlog é‡Œçš„ MYSQL_TYPE_JSON ç±»å‹ï¼Œè¿™æ­¥ä¾è‘«èŠ¦ç”»ç“¢è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ï¼Œå°±æ˜¯ç¬¬ä¸€æ¬¡çœ‹ MariaDB ä»£ç ï¼Œæ™•äº†å¥½ä¸€é˜µå­ï¼Œè¿˜å¥½æœ‰ GDBã€LLDB è°ƒè¯•å™¨åœ¨æ‰‹ï¼Œä»¥åŠåœ¨ Wine é‡Œè·‘ Source Insight 4(æ„Ÿè°¢è¿™ä¹ˆå¥½çš„æºç é˜…è¯»è½¯ä»¶ï¼ï¼‰ï¼Œè·Œè·Œç»Šç»Šçœ‹æ˜ç™½äº†ã€‚</p><p>è¿™ä¸€æ­¥æå®šåï¼Œå¿½ç„¶æƒ³ä¸ºå•¥ä¸æ”¯æŒä¸‹å°±åœ°è¯»å–åŒ…å« JSON åˆ—çš„ MySQL æ•°æ®æ–‡ä»¶å‘¢ï¼Ÿ æ“èµ·è°ƒè¯•å™¨å¤§æ³•ï¼Œè¯•éªŒäº†å‡ ä¸ªå°æ—¶ï¼Œå‘ç°æå®šäº†ï¼Œè¿˜æŒºç®€å•ã€‚ã€‚ã€‚ç„¶ååˆè´ªå¿ƒä¸è¶³ï¼Œèƒ½ä¸èƒ½æ”¯æŒå°±åœ°å†™åŒ…å« JSON åˆ—çš„ MySQL æ•°æ®æ–‡ä»¶äº†ï¼ŸèŠ±äº†ååˆ†é’Ÿ hack äº†ä¸‹ï¼Œå±…ç„¶ä¹Ÿå¯ä»¥äº†ğŸ˜‚</p><p>MariaDB ä»£ç é‡Œä¸å°‘åœ°æ–¹æœ‰ä¸€äº›ç–‘é—®çš„æ³¨é‡Šï¼Œçœ‹çš„å‡ºæ¥åæ¥çš„ä»£ç ç»´æŠ¤è€…å·²ç»ä¸çŸ¥é“ä¸ºå•¥å‰äººé‚£ä¹ˆå†™äº†ğŸ˜“ï¼Œä½†æ€»çš„æ¥è¯´ï¼ŒMariaDB ä»£ç åšäº†äº›æŠ½è±¡å’Œé‡æ„ï¼Œæ¯” MySQL çš„æºä»£ç è¿˜æ˜¯è¦è§„æ•´äº›ã€‚</p><p>åœ¨ macOS ä¸‹å¾ˆå®¹æ˜“ç¼–è¯‘ MariaDB çš„ä»£ç ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">mkdir builddir &amp;&amp;\n    cd builddir &amp;&amp;\n    cmake -DCMAKE_BUILD_TYPE=RelWithDebInfo -DWITH_SSL=bundled -DWITH_PCRE=bundled \\\n          -DWITH_UNIT_TESTS=OFF -DDEFAULT_CHARSET=utf8mb4  -DDEFAULT_COLLATION=utf8mb4_general_ci \\\n          -DPLUGIN_TOKUDB=NO .. &amp;&amp;\n    make &amp;&amp;\n    make install DESTDIR=$HOME/tmp/mariadb</code></pre></div><p>ç„¶åè¿è¡Œ MariaDB:</p><div class=\"highlight\"><pre><code class=\"language-text\">cd $HOME/tmp/mariadb/usr/local/mysql\nbin/mysqld_safe --datadir=./data</code></pre></div><p>macOS ä¸‹ clang æœ‰ä¸ªå¥‡æ€ªçš„è¡Œä¸ºï¼Œå¦‚æœä¸€æ¬¡æ€§çš„ç¼–è¯‘å‡ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‚£ä¹ˆ clang ä¼šè‡ªåŠ¨ç”Ÿäº§  xxx.dSYM è°ƒè¯•ç¬¦å·ï¼Œè€Œå¦‚æœæ˜¯å…ˆç¼–è¯‘å‡º .o å†é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨çš„æä¸€ä¸‹ï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\">dsymutil <span class=\"nv\">$HOME</span>/tmp/mariadb/usr/local/mysql/bin/mysqld</code></pre></div><p>ç„¶åå°±å¯ä»¥ lldb è°ƒè¯•äº†ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">cd sources/mariadb-server\nlldb -p PID\n(lldb) breakpoint set -n FUNCTION\n(lldb) continue</code></pre></div><p>MySQL 8.0 åŠ å…¥äº† JSON çš„ partial updateï¼Œé»˜è®¤æ²¡æœ‰å¼€å¯ï¼Œå¦‚æœå¼€å¯åï¼Œå¯èƒ½ binlog æ ¼å¼æœ‰ç‚¹å˜åŒ–ï¼Œç›®å‰è¿™ä¸ªé­”æ”¹çš„ MariaDB ç‰ˆæœ¬æ²¡è€ƒè™‘è¿™ç§æƒ…å†µï¼Œæ‰€ä»¥ï¼ŒMySQL 5.7 å¤§æ³•å¥½ï¼MariaDB å¤§æ³•å¥½ï¼â€”â€” å“¦ï¼ŒPercona æ˜¯è°å•Šï¼ŸğŸ˜„</p>", 
            "topic": [
                {
                    "tag": "MySQL", 
                    "tagLink": "https://api.zhihu.com/topics/19554128"
                }, 
                {
                    "tag": "MariaDB", 
                    "tagLink": "https://api.zhihu.com/topics/19997537"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/60247018", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 4, 
            "title": "ProxySQL æ•´æ•°æº¢å‡º", 
            "content": "<p>æœ€è¿‘å­¦ä¹ äº†ä¸‹ <a href=\"https://link.zhihu.com/?target=https%3A//proxysql.com/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">ProxySQL</a>ï¼Œåœ¨éç”Ÿäº§ç¯å¢ƒå¤§è‡´ä½“éªŒäº†ä¸‹ï¼Œæ„Ÿè§‰ä¸é”™ï¼Œäºæ˜¯å°æµé‡ä¸Šäº†ç”Ÿäº§ç¯å¢ƒï¼Œç„¶è€Œå±…ç„¶å‘ç°æœ‰ä¸ªå¥‡æ€ªçš„ç°è±¡ï¼Œå®¢æˆ·ç«¯å¤§æ¦‚ç‡è¿ä¸ä¸Š MySQL æœåŠ¡å™¨ï¼ŒæŠ¥å‘Šå¦‚ä¸‹é”™è¯¯ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">Max connect timeout reached while reaching hostgroup 3034 after 10000ms</code></pre></div><p>éå¸¸éƒé—·ï¼Œç½‘ä¸Šæœç´¢äº†ä¸‹ï¼Œè·Ÿæˆ‘é‡åˆ°çš„æƒ…å†µéƒ½ä¸ç¬¦åˆï¼Œæˆ‘ç¡®è®¤äº† <code>runtime_mysql_servers</code> è¡¨ä¸­æ‰€æœ‰ server éƒ½æ˜¯ ONLINE çŠ¶æ€ï¼Œåœ¨ <code>monitor.mysql_server_connect_log</code>, <code>monitor.mysql_server_ping_log</code> å’Œ <code>monitor.mysql_server_replication_lag_log</code> å‡ ä¸ªè¡¨ä¸­çš„æ£€æŸ¥éƒ½éå¸¸æ­£å¸¸ï¼Œç›´è¿ MySQL ä¹Ÿéå¸¸å¿«ã€‚</p><p>è¯•éªŒäº†å¢åŠ ä¸‹é¢å‡ ä¸ªå‚æ•°ï¼Œä¹Ÿæ²¡æ•ˆæœï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">SET mysql-connect_retries_delay = 500;  -- default 1ms\nSET mysql-connect_timeout_server = 5000;\t -- default 3000ms\nSET mysql-connect_timeout_server_max = 35000; -- default 10000ms\n\nSET mysql-connection_delay_multiplex_ms = 100; -- default 0ms\n\n-- result in &#34;Aborted connection&#34; warnings\nSET mysql-connection_max_age_ms = 900000; -- default 0ms</code></pre></div><p>æ²¡åŠæ³•ï¼Œåªèƒ½å»çœ‹ä»£ç ï¼Œæ ¹æ®é”™è¯¯ä¿¡æ¯ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°äº†<a href=\"https://link.zhihu.com/?target=https%3A//github.com/sysown/proxysql/blob/6da427f55873d19b61ac29a2a36a54dfb1364448/lib/MySQL_HostGroups_Manager.cpp%23L1289\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">ä»£ç ä½ç½®</a>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">MySrvC *MyHGC::get_random_MySrvC() {\n  MySrvC *mysrvc=NULL;\n\tunsigned int j;\n\tunsigned int sum=0;\n\tunsigned int TotalUsedConn=0;\n\tunsigned int l=mysrvs-&gt;cnt();\n\n  ...\n\n    if ((len * sum) &lt;= (TotalUsedConn * mysrvc-&gt;weight * 1.5 + 1)) {\n \n  ...\n}</code></pre></div><p>è¿™é‡Œ <code>len</code> è¡¨ç¤ºå½“å‰ host group éå†åˆ°çš„ä¸€ä¸ª MySQL server ä¸Šé¢æœ‰å¤šå°‘æ­£åœ¨ä½¿ç”¨çš„TCPé“¾æ¥ï¼Œ<code>sum</code> æ˜¯æ‰€æœ‰ ONLINE çŠ¶æ€çš„ MySQL server çš„æƒé‡ä¹‹å’Œï¼Œ<code>TotalUsedConn</code> æ˜¯æ­¤ host group ä¸€å…±æœ‰å¤šå°‘æ­£åœ¨ä½¿ç”¨çš„ TCP é“¾æ¥ï¼Œ<code>mysrvc-&gt;weight</code> æ˜¯å½“å‰éå†åˆ°çš„è¿™ä¸ª MySQL server çš„æƒé‡ï¼Œè¿™å››ä¸ªå˜é‡ç±»å‹éƒ½æ˜¯ <code>unsigned int</code>ï¼Œè¿™ä¸ªé»˜è®¤æ˜¯å››å­—èŠ‚ï¼Œç›¸ä¹˜éå¸¸å®¹æ˜“æ•´æ•°æº¢å‡ºï¼Œå¾ˆå€¼å¾—æ€€ç–‘ã€‚</p><p>æŸ¥äº†ä¸‹ç›‘æ§æ•°æ®ï¼Œæ•…éšœå‘ç”Ÿæ—¶ï¼Œç°åœºæ˜¯è¿™æ ·çš„ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">db-1  weight=99999999 conn=22\ndb-2  weight=99999999 conn=20\ndb-3  weight=1        conn=1</code></pre></div><p>è¿™é‡Œ db-3 æ˜¯ä¸»åº“ï¼Œæ”¾è¿› readonly host group é‡Œæƒé‡ä¸º 1ï¼Œç›®çš„æ˜¯åœ¨ä»åº“å¤åˆ¶å»¶è¿Ÿè¶…è¿‡é™åˆ¶ï¼Œè¢«è¸¢å‡º host group ä¹‹åï¼Œè¿˜æœ‰ä¸ªå¤‡ç”¨çš„ä¸»åº“ï¼Œè€Œå¹³æ—¶ä»åº“æ­£å¸¸æ—¶ï¼Œä¸»åº“å°½å¯èƒ½å°‘çš„æ‰¿æ‹…è¯»å‹åŠ›ã€‚</p><p>ä»¿ç…§ç€ ProxySQL å†™äº†æ®µä»£ç éªŒè¯ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">#include &lt;cstdio&gt;\n#include &lt;cstdlib&gt;\n\n__thread unsigned int g_seed;\n\ninline int fastrand() {\n    g_seed = (214013*g_seed+2531011);\n    return (g_seed&gt;&gt;16)&amp;0x7FFF;\n}\n\nint main(int argc, char** argv) {\n    unsigned int usedConns[] = { 22,       20,       1};\n    unsigned int weights[]   = { 99999999, 99999999, 1};\n\n    unsigned int sum = 0;\n    unsigned int TotalUsedConn = 0;\n    unsigned int l = 3;\n    unsigned int j;\n\n    for (j = 0; j &lt; l; j++) {\n        sum += weights[j];\n        TotalUsedConn += usedConns[j];\n        printf(&#34;j=%u weight=%u usedConn=%u sum=%u TotalUsedConn=%u\\n&#34;, j, weights[j], usedConns[j], sum, TotalUsedConn);\n    }\n    printf(&#34;\\n&#34;);\n\n    unsigned int New_sum=0;\n    unsigned int New_TotalUsedConn=0;\n\n    for (j = 0; j &lt; l; j++) {\n        unsigned int len = usedConns[j];\n        unsigned int weight = weights[j];\n        printf(&#34;\\nj=%u len=%u weight=%u TotalUsedConn=%u sum=%u\\n&#34;, j, len, weight, TotalUsedConn, sum);\n        printf(&#34;        len*sum=%u TotalUsedConn*weight=%u TotalUsedConn*weight*1.5+1=%lf\\n&#34;,\n                len * sum, TotalUsedConn * weight, TotalUsedConn * weight * 1.5 + 1);\n\n        if ((len * sum) &lt;= (TotalUsedConn * weight * 1.5 + 1)) {\n            printf(&#34;j=%u old New_sum=%u New_TotalUsedConn=%u\\n&#34;, j, New_sum, New_TotalUsedConn);\n            New_sum += weight;\n            New_TotalUsedConn += len;\n            printf(&#34;j=%u now New_sum=%u New_TotalUsedConn=%u\\n&#34;, j, New_sum, New_TotalUsedConn);\n        } else {\n            printf(&#34; !!! NOT\\n&#34;);\n        }\n    }\n\n    printf(&#34;\\nNew_sum=%u New_TotalUsedConn=%u\\n&#34;, New_sum, New_TotalUsedConn);\n    if (New_sum == 0) {\n        printf(&#34;ERROR\\n&#34;);\n        return 0;\n    }\n\n    unsigned int k;\n    if (New_sum &gt; 32768) {\n        k = rand() % New_sum;\n    } else {\n        k = fastrand() % New_sum;\n    }\n\n    New_sum = 0;\n    for (j = 0; j &lt; l; j++) {\n        unsigned int len = usedConns[j];\n        unsigned int weight = weights[j];\n\n        printf(&#34;\\nj=%u len=%u weight=%u k=%u\\n&#34;, j, len, weight, k);\n        if ((len * sum) &lt;= (TotalUsedConn * weight * 1.5 + 1)) {\n            New_sum += weight;\n            if (k &lt;= New_sum) {\n                printf(&#34;got %u\\n because k(%u) &lt; New_sum(%u)!!!&#34;, j, k, New_sum);\n                break;\n            } else {\n                printf(&#34; !!! NOT ENOUGH\\n&#34;);\n            }\n        } else {\n            printf(&#34; !!! NOT\\n&#34;);\n        }\n    }\n\n    return 0;\n}</code></pre></div><p>è¿è¡Œä¹‹ï¼Œæœä¸å…¶ç„¶ï¼Œæ•´æ•°æº¢å‡ºäº†ï¼Œå¯¼è‡´åˆ¤æ–­å¤±è¯¯ï¼Œä¸‰ä¸ª server éƒ½è¢«æ’é™¤æ‰äº†ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">$ clang -o a a.cpp\n$ ./a\nj=0 weight=99999999 usedConn=22 sum=99999999 TotalUsedConn=22\nj=1 weight=99999999 usedConn=20 sum=199999998 TotalUsedConn=42\nj=2 weight=1 usedConn=1 sum=199999999 TotalUsedConn=43\n\n\nj=0 len=22 weight=99999999 TotalUsedConn=43 sum=199999999\n        len*sum=105032682 TotalUsedConn*weight=5032661 TotalUsedConn*weight*1.5+1=7548992.500000\n !!! NOT\n\nj=1 len=20 weight=99999999 TotalUsedConn=43 sum=199999999\n        len*sum=3999999980 TotalUsedConn*weight=5032661 TotalUsedConn*weight*1.5+1=7548992.500000\n !!! NOT\n\nj=2 len=1 weight=1 TotalUsedConn=43 sum=199999999\n        len*sum=199999999 TotalUsedConn*weight=43 TotalUsedConn*weight*1.5+1=65.500000\n !!! NOT\n\nNew_sum=0 New_TotalUsedConn=0\nERROR</code></pre></div><p>å¯æ€œçš„ C/C++ è¯­è¨€ï¼å¯æ€œçš„ C/C++ ç¨‹åºå‘˜ï¼å¯æ€œçš„æŒæœ‰æ€§èƒ½ç¬¬ä¸€ã€æ­£ç¡®ç¬¬äºŒè§‚å¿µçš„è¯­è¨€è®¾è®¡è€…ã€ç¨‹åºç¼–å†™è€…ï¼</p><p>åœ¨ ProxySQL å®˜æ–¹ä»£ç ä¿®æ­£è¿™ä¸ªé—®é¢˜å‰ï¼Œè®¾ç½®å¤šå¤§çš„ weight æ‰æ˜¯å®‰å…¨çš„å‘¢ï¼Ÿä¸Šé¢çš„ä¸¤ä¸ªä¹˜æ³•è¿ç®—ï¼Œä¸€ä¸ªæ˜¯ <code>connUsed * total_weight</code>ï¼Œä¸€ä¸ªæ˜¯ <code>totalConnUsed * weight</code>ï¼Œå‡å®šå•ä¸ªMySQL server æŒæœ‰æœ€å¤š 1w é“¾æ¥ï¼Œ100 å° MySQL serverï¼Œé‚£ä¹ˆ:</p><div class=\"highlight\"><pre><code class=\"language-text\">connUsed*total_weight=10000 * (100 * weight) &lt;= 2^32-1\n totalConnUsed * weight = (10000 * 100) * weight &lt;= 2^32-1</code></pre></div><p>é‚£ä¹ˆ weight çš„ä¸Šé™åœ¨ 4000 å¤šä¸€ç‚¹ï¼Œè€ƒè™‘åˆ°æˆ‘ä»¬çš„ç¯å¢ƒæ²¡æœ‰é‚£ä¹ˆå¤š MySQL æœåŠ¡å™¨ï¼Œæ‰€ä»¥å¯ä»¥è®¾ç½®åˆ° 10000ï¼Œä¹Ÿå¯ä»¥ä¿å®ˆç‚¹è®¾ç½®åˆ° 1000ï¼Œæ¯”èµ·ä¸»åº“çš„ <code>weight=1</code>ï¼Œä¹Ÿè¶³å¤Ÿè®©ä¸»åº“æ‰¿æ‹…å°½é‡å°‘çš„è¯»å‹åŠ›äº†ã€‚</p>", 
            "topic": [
                {
                    "tag": "MySQL", 
                    "tagLink": "https://api.zhihu.com/topics/19554128"
                }, 
                {
                    "tag": "é«˜å¯ç”¨", 
                    "tagLink": "https://api.zhihu.com/topics/19671201"
                }, 
                {
                    "tag": "è´Ÿè½½å‡è¡¡", 
                    "tagLink": "https://api.zhihu.com/topics/19596611"
                }
            ], 
            "comments": [
                {
                    "userName": "lyrids", 
                    "userLink": "https://www.zhihu.com/people/317a02085c9a1228a23242220c82a248", 
                    "content": "æ·±å‘å•Š ä¹Ÿè¯´æ˜ C/C++ä»£ç æƒ³å†™å®‰å…¨äº†æœ‰å¤šä¹ˆå›°éš¾", 
                    "likes": 0, 
                    "childComments": []
                }
            ]
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/59230042", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 5, 
            "title": "å‡å°‘ InfluxDB å†…å­˜å ç”¨", 
            "content": "<p>Kubernetes 1.12 <a href=\"https://link.zhihu.com/?target=https%3A//github.com/kubernetes-retired/heapster/blob/master/docs/deprecation.md\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">ä»¥å‰</a>ä½¿ç”¨ Heapster åšé›†ç¾¤ç›‘æ§ï¼Œä»¥æä¾›æ•°æ®ç»™ <code>kubectl top</code> å‘½ä»¤ä»¥åŠ kubernetes-dashboard çš„ Web UI æŸ¥çœ‹ã€‚Heapster é»˜è®¤ä½¿ç”¨ InfluxDBï¼Œè€Œ InfluxDB é»˜è®¤è®¾ç½®çš„ retention policy æ˜¯ä¸ƒå¤©ä¸€ä¸ª shardï¼Œæ— é™ä¿ç•™ï¼Œä½¿ç”¨å†…å­˜ç´¢å¼•ï¼Œæ‰€ä»¥æ—¶é—´ä¹…äº†å InfluxDB ä¼šæ¶ˆè€—æ¥è¿‘ 10GB å†…å­˜ã€‚</p><p>InfluxDB è¿™ä¸ª default retention policy æ— æ³•åœ¨ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶é‡Œä¿®æ”¹ï¼Œåªèƒ½åœ¨ <code>CRETE DATABASE WITH DURATION m REPLICATION 1 SHARD DURATION n</code> æˆ–è€…åˆ›å»ºæ•°æ®åº“åç”¨ <code>ALTER RETENTION POLICY autogen ON db DURATION m REPLICATION 1 SHARD DURATION n</code>ä¿®æ”¹ã€‚å…¶å‘˜å·¥ <a href=\"https://link.zhihu.com/?target=https%3A//www.linkedin.com/in/michael-desa-b3ab9823\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Michael Desa</a> åœ¨ stackoverflow ä¸Š<a href=\"https://link.zhihu.com/?target=https%3A//stackoverflow.com/questions/41620595/how-to-set-default-retention-policy-and-duration-for-influxdb-via-configuration\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">è§£é‡Š</a>äº†ä¸‹:</p><blockquote>Unfortunately there is no way to set the default retention policy via the configuration. The reason for this is that typically retention policy duration is defined during database creation.<br/>If users were allowed to set a default retention duration via the configuration, the results of the command <code>CREATE DATABASE mydb</code> would vary from instance to instance. While this isnâ€™t necessarily problematic, it isnâ€™t ideal either.</blockquote><p>ä¸ªäººè§‰å¾—è¿™ä¸ªè§£é‡Šå¾ˆç‰µå¼ºï¼Œå¯ä»¥ç±»ä¼¼ InfluxDB çš„ <a href=\"https://link.zhihu.com/?target=https%3A//docs.influxdata.com/influxdb/v1.7/administration/config/%23configuration-settings\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Graphite listener</a> é‚£æ ·ï¼Œæä¾›å¤šä¸ªç¯å¢ƒå˜é‡æ¯”å¦‚ <code>INFLUXDB_RETENTION_POLICY_&lt;db&gt;_&lt;policy&gt;=&#34;DURATION 30d REPLICATION 1 SHARD DURATION 30m&#34;</code> è¿™æ ·é…ç½®å˜›ï¼Œå…¶ä¸­ <code>INFLUXDB_RETENTION_POLICY_DEFAULT</code> æ˜¯ç‰¹æ®Šçš„é»˜è®¤è®¾ç½®ã€‚</p><p>ä¸è¿‡ä¸ç®¡æ€æ ·ï¼Œä¸æ”¹ä»£ç çš„è¯åªèƒ½äº‹åå»ä¿®æ”¹ RETENTION POLICY äº†ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\"># kubectl exec -it è¿›å…¥ä¸€ä¸ªå¸¦ curl å‘½ä»¤çš„ pod\n\ncurl -s monitoring-influxdb.kube-system:8086/query?pretty=true --data-urlencode &#39;q=alter retention policy default on k8s duration 1d replication 1 shard duration 30m&#39;\n\ncurl -s monitoring-influxdb.kube-system:8086/query?pretty=true --data-urlencode &#39;q=alter retention policy monitor on _internal duration 1d replication 1 shard duration 30m&#39;\n\n\ncurl -s monitoring-influxdb.kube-system:8086/query?pretty=true --data-urlencode &#39;q=show retention policies on k8s&#39;\n\ncurl -s monitoring-influxdb.kube-system:8086/query?pretty=true --data-urlencode &#39;q=show retention policies on _internal&#39;\n\ncurl -s monitoring-influxdb.kube-system:8086/query?pretty=true --data-urlencode &#39;q=show shards&#39;\n\n# è¿™é‡Œ N æ˜¯ shard idï¼Œå¯ä»¥ä»ä¸Šä¸€æ¡å‘½ä»¤ä¸­è§£æå¾—åˆ°å¹¶æ‰¹é‡å¤„ç†\ncurl -s monitoring-influxdb.kube-system:8086/query?pretty=true --data-urlencode &#39;q=drop shard N&#39;\n\n# ç„¶å kubectl exec -it è¿›å…¥ kube-system namespace çš„ monitoring-influxdb-xxxxx å®¹å™¨\n# æ‰§è¡Œ kill 1 è®© pod é‡å¯\n\n# ä½¿ç”¨ä¸Šé¢çš„ show shards å’Œ show retention polices å‘½ä»¤æŸ¥çœ‹ç”Ÿæ•ˆä¸å¦ï¼Œè¿™æ˜¯ä¸ºäº†é¿å… K8S æŠŠ\n# influxdb è°ƒåº¦åˆ°å¦å¤–ä¸€å°æœºå™¨ä¸Šï¼Œé‡æ–°åˆå§‹åŒ–äº† /data/ ç›®å½•ã€‚</code></pre></div><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ <code>kubectl edit -n kube-system deploy/monitoring-influxdb</code> åŠ å‡ ä¸ªç¯å¢ƒå˜é‡ä»¥é™åˆ¶ InfluxDB çš„èµ„æºæ¶ˆè€—ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">GOMAXPROCS=2\nINFLUXDB_DATA_INDEX_VERSION=tsi1\nINFLUXDB_DATA_MAX_CONCURRENT_COMPACTIONS=1</code></pre></div><p></p>", 
            "topic": [
                {
                    "tag": "Kubernetes", 
                    "tagLink": "https://api.zhihu.com/topics/20018384"
                }, 
                {
                    "tag": "InfluxDB", 
                    "tagLink": "https://api.zhihu.com/topics/20062289"
                }
            ], 
            "comments": [
                {
                    "userName": "lyrids", 
                    "userLink": "https://www.zhihu.com/people/317a02085c9a1228a23242220c82a248", 
                    "content": "<p>èµ! æ­£æ˜¯è¿™äº›ç‚¹ç‚¹æ»´æ»´çš„ä½“ä¼šæ‰å½¢æˆçœŸæ­£\"åƒé€\"ä¸€ä¸ªå¤æ‚çš„ç³»ç»Ÿ, ä¹Ÿå°±æ‰€è°“çš„ Know How -- å¦‚æœæ²¡æœ‰è¿™äº›å®é™…çš„é‡åˆ°é—®é¢˜æ€è€ƒå¹¶è§£å†³çš„ä¸æ–­è¿­ä»£, å¯¹ä¸€ä¸ªäº§å“/ç³»ç»Ÿçš„ç†è§£å¯èƒ½åªèƒ½åœç•™åœ¨PPT/äº§å“è¯´æ˜/ç®€å•Demoçš„å±‚é¢, æ— æ³•æ·±å…¥ä¸‹å». å¯èƒ½å’Œæ½œæ°´ä¸€ä¸ªé“ç†, åœ¨æ°´é¢å’Œå²¸ä¸Šåªèƒ½å¬åˆ«äººä»‹ç»æ°´ä¸‹æœ‰å¤šç¾, ä½†åªæœ‰è‡ªå·±æ½œä¸‹å»æ‰èƒ½çœŸæ­£ä½“ä¼šåˆ°ç¾, ä»¥åŠç¾ä¹‹å¤–çš„å‘å‘åå.</p>", 
                    "likes": 1, 
                    "childComments": []
                }, 
                {
                    "userName": "Ryan", 
                    "userLink": "https://www.zhihu.com/people/080f9a8b1394da17594f1d63ed6184c6", 
                    "content": "<p>å½±å“InfluxDBå†…å­˜å ç”¨çš„å› ç´ å¾ˆå¤šï¼Œæ´»è·ƒçš„shardæ•°é‡ã€æ¯ä¸ªshardçš„cacheçš„å†…å­˜ä¸Šä¸‹é™ã€æŸ¥è¯¢çš„é™åˆ¶ç­‰ç­‰éƒ½æœ‰ç›´æ¥å…³ç³»ã€‚</p>", 
                    "likes": 0, 
                    "childComments": []
                }
            ]
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/52622856", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 165, 
            "title": "é˜¿é‡Œäº‘å®‰å…¨ç»„ä¹‹é™é»˜ä¸¢åŒ…", 
            "content": "<h2>ä¸€ã€å¼•å­ï¼šRedis client library è¿æ¥ Redis server è¶…æ—¶</h2><p>å·®ä¸å¤šä¸€ä¸¤å¹´å‰ï¼Œåœ¨é˜¿é‡Œäº‘ä¸Šé‡åˆ°ä¸€ä¸ªå¥‡æ€ªçš„ Redis è¿æ¥é—®é¢˜ï¼Œæ¯éš”åæ¥åˆ†é’Ÿï¼ŒæœåŠ¡é‡Œçš„ Redis client åº“å°±æŠ¥å‘Šè¿æ¥ Redis server è¶…æ—¶ï¼Œå½“æ—¶èŠ±äº†å¾ˆå¤§åŠŸå¤«ï¼Œå‘ç°æ˜¯é˜¿é‡Œäº‘ä¼šæ–­å¼€é•¿æ—¶é—´é—²ç½®çš„ TCP è¿æ¥ï¼Œä¸ç»™ä¸¤å¤´å‘ FIN or RST åŒ…ï¼Œè€Œå½“æ—¶æˆ‘ä»¬çš„ Redis server æ²¡æœ‰æ‰“å¼€ tcp_keepalive é€‰é¡¹ï¼Œäºæ˜¯ Redis server ä¾§é‚£ä¸ªè¿æ¥è¿˜å­˜åœ¨äº Linux conntrack table é‡Œï¼Œè€Œ Redis client ä¾§ç”±äºè¿æ¥æ± é‡ç”¨è¿æ¥è¿›è¡Œ getã€set å‘ç°è¿æ¥åæ‰å°±å…³é—­äº†ï¼Œæ‰€ä»¥ client ä¾§çš„å¯¹åº” local port å›æ”¶äº†ï¼Œå½“æ¥ä¸‹æ¥ Redis é‡ç”¨è¿™ä¸ª local port å‘ Redis server å‘èµ·è¿æ¥æ—¶ï¼Œç”±äº Redis server ä¾§çš„ conntrack table é‡Œ &lt;client_ip, client_port,  redis-server, 6379&gt; å››å…ƒç»„å¯¹åº”çŠ¶æ€æ˜¯ ESTABLISHEDï¼Œæ‰€ä»¥è‡ªç„¶å®¢æˆ·ç«¯å‘æ¥çš„ TCP SYN packet è¢«ä¸¢å¼ƒï¼ŒRedis client çœ‹åˆ°çš„ç°è±¡å°±æ˜¯è¿æ¥è¶…æ—¶ã€‚</p><p>è§£å†³è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ï¼Œæ‰“å¼€ Redis server çš„  tcp_keepalive  é€‰é¡¹å°±è¡Œã€‚ <b>ç„¶è€Œå½“æ—¶æ²¡æƒ³åˆ°ï¼Œè¿™ä¸ªé—®é¢˜æ·±å±‚æ¬¡çš„åŸå› å½±å“å¾ˆé‡å¤§ï¼Œåæœå¾ˆä¸¥é‡ï¼</b></p><hr/><h2>äºŒã€å­½å€ºï¼š&#34;SELECT 1&#34; è§¦å‘çš„ jdbc4.CommunicationsException</h2><p>æœ€è¿‘ç”Ÿäº§ç¯å¢ƒçš„ Java æœåŠ¡å‡ ä¹æ¯åˆ†é’Ÿéƒ½æŠ¥å‘Šç±»ä¼¼ä¸‹é¢è¿™ç§é”™è¯¯ï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\"><span class=\"o\">[</span>main<span class=\"o\">]</span> ERROR jdbc.audit - <span class=\"m\">2</span>. Statement.execute<span class=\"o\">(</span><span class=\"k\">select</span> <span class=\"m\">1</span><span class=\"o\">)</span> <span class=\"k\">select</span> <span class=\"m\">1</span> \n\ncom.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n\nThe last packet successfully received from the server was <span class=\"m\">576</span>,539 milliseconds ago.  The last packet sent successfully to the server was <span class=\"m\">5</span> milliseconds ago.\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0<span class=\"o\">(</span>Native Method<span class=\"o\">)</span>\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance<span class=\"o\">(</span>NativeConstructorAccessorImpl.java:62<span class=\"o\">)</span>\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance<span class=\"o\">(</span>DelegatingConstructorAccessorImpl.java:45<span class=\"o\">)</span>\n        at java.lang.reflect.Constructor.newInstance<span class=\"o\">(</span>Constructor.java:423<span class=\"o\">)</span>\n        at com.mysql.jdbc.Util.handleNewInstance<span class=\"o\">(</span>Util.java:425<span class=\"o\">)</span>\n        at com.mysql.jdbc.SQLError.createCommunicationsException<span class=\"o\">(</span>SQLError.java:990<span class=\"o\">)</span>\n        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket<span class=\"o\">(</span>MysqlIO.java:3559<span class=\"o\">)</span>\n        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket<span class=\"o\">(</span>MysqlIO.java:3459<span class=\"o\">)</span>\n        at com.mysql.jdbc.MysqlIO.checkErrorPacket<span class=\"o\">(</span>MysqlIO.java:3900<span class=\"o\">)</span>\n        at com.mysql.jdbc.MysqlIO.sendCommand<span class=\"o\">(</span>MysqlIO.java:2527<span class=\"o\">)</span>\n        at com.mysql.jdbc.MysqlIO.sqlQueryDirect<span class=\"o\">(</span>MysqlIO.java:2680<span class=\"o\">)</span>\n        at com.mysql.jdbc.ConnectionImpl.execSQL<span class=\"o\">(</span>ConnectionImpl.java:2480<span class=\"o\">)</span>\n        at com.mysql.jdbc.ConnectionImpl.execSQL<span class=\"o\">(</span>ConnectionImpl.java:2438<span class=\"o\">)</span>\n        at com.mysql.jdbc.StatementImpl.executeInternal<span class=\"o\">(</span>StatementImpl.java:845<span class=\"o\">)</span>\n        at com.mysql.jdbc.StatementImpl.execute<span class=\"o\">(</span>StatementImpl.java:745<span class=\"o\">)</span>\n        at net.sf.log4jdbc.StatementSpy.execute<span class=\"o\">(</span>StatementSpy.java:842<span class=\"o\">)</span>\n        at com.zaxxer.hikari.pool.PoolBase.isConnectionAlive<span class=\"o\">(</span>PoolBase.java:158<span class=\"o\">)</span>\n        at com.zaxxer.hikari.pool.HikariPool.getConnection<span class=\"o\">(</span>HikariPool.java:172<span class=\"o\">)</span>\n        at com.zaxxer.hikari.pool.HikariPool.getConnection<span class=\"o\">(</span>HikariPool.java:148<span class=\"o\">)</span>\n        at com.zaxxer.hikari.HikariDataSource.getConnection<span class=\"o\">(</span>HikariDataSource.java:100<span class=\"o\">)</span>\n        at cn.yingmi.hikari.Main.main<span class=\"o\">(</span>Main.java:30<span class=\"o\">)</span>\nCaused by: java.io.EOFException: Can not <span class=\"nb\">read</span> response from server. Expected to <span class=\"nb\">read</span> <span class=\"m\">4</span> bytes, <span class=\"nb\">read</span> <span class=\"m\">0</span> bytes before connection was unexpectedly lost.\n        at com.mysql.jdbc.MysqlIO.readFully<span class=\"o\">(</span>MysqlIO.java:3011<span class=\"o\">)</span>\n        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket<span class=\"o\">(</span>MysqlIO.java:3469<span class=\"o\">)</span>\n        ... <span class=\"m\">14</span> more</code></pre></div><p class=\"ztext-empty-paragraph\"><br/></p><p>ç”±äºæœ‰ä¹‹å‰è°ƒæŸ¥ Redis è¿æ¥è¢«é˜¿é‡Œäº‘å¼‚å¸¸ä¸­æ–­çš„å…ˆä¾‹ï¼Œæ‰€ä»¥æ€€ç–‘æ˜¯ç±»ä¼¼é—®é¢˜ï¼ŒèŠ±äº†å¤§é‡æ—¶é—´æ¯”å¯¹å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ conntrack tableï¼Œç„¶è€Œå¹¶æ²¡æœ‰å¼•å­ä¸­æè¿°çš„é—®é¢˜ï¼Œç„¶ååˆå»æ¯”å¯¹å¤šä¸ª MySQL æœåŠ¡å™¨çš„ sysctl è®¾ç½®ï¼Œç ”ç©¶ iptables TRACEï¼Œç ”ç©¶ tcpdump æŠ“åˆ°çš„æŠ¥æ–‡ï¼Œè¯•éªŒ tw_reuse, tw_recyle ç­‰å‚æ•°ï¼Œè°ƒæ•´ Aliyun è´Ÿè½½å‡è¡¡å™¨åé¢æŒ‚è½½çš„ MySQL æœåŠ¡å™¨ä¸ªæ•°ï¼Œéƒ½æ²¡æ•ˆæœï¼Œ åè€Œæ„å¤–å‘ç°ä¸€ä¸ª<b>**æ–°é—®é¢˜**</b>ï¼Œåœ¨ç”¨å¦‚ä¸‹å‘½ä»¤<b>ä¸ç»è¿‡</b>é˜¿é‡Œäº‘ SLB <b>ç›´æ¥è¿æ¥</b>æ•°æ®åº“æ—¶ï¼Œæœ‰çš„æ•°æ®åº“å¯ä»¥åœ¨ 600s æ—¶è¿”å›ï¼Œæœ‰çš„åˆ™å®¢æˆ·ç«¯ä¸€ç›´æŒ‚ç€ï¼ŒåŠä¸ªå¤šå°æ—¶äº†éƒ½é€€ä¸å‡ºæ¥ï¼ŒæŒ‰ ctrl-c ä¸­æ–­éƒ½ä¸è¡Œã€‚</p><div class=\"highlight\"><pre><code class=\"language-bash\">mysql -h mysql-server-ip -u mysql-user -p -e <span class=\"s1\">&#39;SELECT sleep(1000)&#39;</span></code></pre></div><p>å½“æ—¶æ£€æŸ¥äº†ä¸€ä¸ªæ­£å¸¸çš„æ•°æ®åº“å’Œä¸€ä¸ªä¸æ­£å¸¸çš„æ•°æ®åº“ï¼Œå‘ç°ä¸¤è€…çš„ wait_timeout å’Œ interactive_timeout éƒ½æ˜¯ 600sï¼Œæ€ç´¢è‰¯è‹¦ï¼Œæ²¡æ˜ç™½æ€ä¹ˆå›äº‹ï¼Œç„¶åå¶ç„¶å‘ç°å¦å¤–ä¸€ä¸ªæ•°æ®åº“çš„ wait_timeout=<b>60</b>sï¼Œå´ä¸€ä¸‹å­æ˜ç™½äº†åŸå§‹çš„ &#34;select 1&#34; é—®é¢˜æ€ä¹ˆå›äº‹ã€‚</p><p>æˆ‘ä»¬çš„æœåŠ¡ä½¿ç”¨äº†  <a href=\"https://link.zhihu.com/?target=https%3A//github.com/brettwooldridge/HikariCP\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Hikari JDBC è¿æ¥æ± </a>ï¼Œå®ƒçš„ idleTimeout é»˜è®¤æ˜¯ 600s, maxLifetime é»˜è®¤æ˜¯ 1800sï¼Œå‰è€…è¡¨ç¤º idle JDBC connection æ•°é‡è¶…è¿‡ minimumIdle æ•°ç›®å¹¶ä¸”é—²ç½®æ—¶é—´è¶…è¿‡ idleTimeout åˆ™å…³é—­æ­¤ idle connectionï¼Œåè€…è¡¨ç¤ºè¿æ¥æ± é‡Œçš„ connection å…¶ç”Ÿå­˜æ—¶é—´ä¸èƒ½è¶…è¿‡ maxLifetimeï¼Œåˆ°ç‚¹äº†ä¼šè¢«å…³æ‰ã€‚</p><p>åœ¨å‘ç° &#34;select 1&#34; é—®é¢˜åï¼Œæˆ‘ä»¬ä»¥ä¸ºæ˜¯è¿™ä¿©å‚æ•°æ¯”æ•°æ®åº“çš„ wait_timeout=600s å¤§çš„ç¼˜æ•…ï¼Œæ‰€ä»¥æŠŠè¿™ä¸¤ä¸ªå‚æ•°ç¼©å°äº†ï¼ŒidleTimeout=570s,  maxLifetime=585sï¼Œå¹¶ä¸”è®¾ç½®äº† minimumIdle=5ã€‚ä½†è¿™ä¸¤ä¸ªæ—¶é—´è®¾ç½®ä¾ç„¶å¤§äºå…¶ä¸­ä¸€ä¸ªæ•°æ®åº“<b>å¤±è¯¯</b>è®¾ç½®çš„ wait_timeout=60sï¼Œæ‰€ä»¥é—²ç½®è¿æ¥åœ¨ 60s åè¢« MySQL server ä¸»åŠ¨å…³é—­ï¼Œè€Œ JDBC å¹¶æ²¡æœ‰ä»€ä¹ˆäº‹ä»¶è§¦å‘å›è°ƒæœºåˆ¶å»å…³é—­ JDBC connectionï¼Œæ—¶é—´ä¸Šä¹Ÿä¸å¤Ÿ Hikari è§¦å‘ idleTimeout å’Œ maxLifetime æ¸…ç†é€»è¾‘ï¼Œæ‰€ä»¥ Hikari æ‹¿ç€è¿™ä¸ªâ€œå·²ç»å…³é—­â€çš„è¿æ¥ï¼Œå‘äº† &#34;select 1&#34; SQL ç»™æœåŠ¡å™¨æ£€æŸ¥è¿æ¥æœ‰æ•ˆæ€§ï¼Œäºæ˜¯è§¦å‘äº†ä¸Šé¢çš„å¼‚å¸¸ã€‚</p><p>è§£å†³åŠæ³•å¾ˆç®€å•ï¼ŒæŠŠé‚£ä¸ªé”™è¯¯é…ç½®çš„æ•°æ®åº“é‡Œ wait_timeout ä» 60s ä¿®æ­£æˆ 600s å°±è¡Œäº†ã€‚ <b>ä¸‹é¢ç»§ç»­è®²è¿° &#34;SELECT  sleep(1000)&#34; ä¼šæŒ‚ä½é€€ä¸å‡ºæ¥çš„é—®é¢˜ã€‚</b></p><hr/><h2>ä¸‰ã€ç¼˜èµ·ï¼šé˜¿é‡Œäº‘å®‰å…¨ç»„ä¸ TCP KeepAlive</h2><p class=\"ztext-empty-paragraph\"><br/></p><p>æœ€è¿‘çœ‹äº†ä¸€ç‚¹ä½›æ•™å¸¸è¯†ï¼Œå¯¹â€è¯¸æ³•ç”±å› ç¼˜è€Œèµ·â€œçš„ç¼˜èµ·è®ºå¾ˆæ˜¯æ„Ÿæ…¨ï¼Œåœ¨è°ƒæŸ¥ &#34;SELECT sleep(1000)&#34; é—®é¢˜ä¸­ï¼ŒçœŸå®æ„Ÿå—åˆ°äº†â€œç”±å› ç¼˜è€Œèµ·â€ çš„æ„æ€ğŸ˜„</p><p>é¦–å…ˆè§£é‡Šä¸‹ï¼Œä¸ºä»€ä¹ˆæœ‰çš„æ•°æ®åº“æœåŠ¡å™¨å¯¹ &#34;SELECT sleep(1000)&#34; å¯ä»¥è¿”å›ï¼Œæœ‰çš„å´æŒ‚ç€é€€ä¸å‡ºæ¥ã€‚ å…¶å® wait_timeout å’Œ interactive_timeout ä¸¤ä¸ªå‚æ•°åªå¯¹ â€œé—²ç½®â€ çš„æ•°æ®åº“è¿æ¥ï¼Œä¹Ÿå³æ²¡æœ‰ SQL æ­£åœ¨æ‰§è¡Œçš„è¿æ¥ç”Ÿæ•ˆï¼Œå¯¹äº &#34;SELECT sleep(1000)&#34;ï¼Œè¿™æ˜¯æœ‰ä¸€ä¸ªæ­£åœ¨æ‰§è¡Œçš„ SQLï¼Œå…¶æœ€å¤§æ‰§è¡Œæ—¶é—´å— MySQL Server çš„ max_execution_time é™åˆ¶ï¼Œè¿™ä¸ªå‚æ•°åœ¨æˆ‘å¸ä¸€èˆ¬è®¾ç½®ä¸º 600sï¼Œè¿™å°±æ˜¯ â€œæ­£å¸¸çš„æ•°æ®åº“&#34; åœ¨ 600s æ—¶ &#34;SELECT sleep(1000)&#34; ä¸­æ–­æ‰§è¡Œè€Œé€€å‡ºäº†ã€‚</p><p>ä½†ä¸èµ°è¿çš„æ˜¯ï¼ˆå¯ä»¥è¯´åˆæ˜¯ä¸ªå¤±è¯¯é…ç½®ğŸ˜“ï¼‰ï¼Œæˆ‘ä»¬æœ‰çš„æ•°æ®åº“ max_execution_time æ˜¯ 6000sï¼Œæ‰€ä»¥ &#34;SELECT sleep(1000)&#34; åœ¨ MySQL server æœåŠ¡ç«¯ä¼šåœ¨ 1000s æ—¶æ­£å¸¸æ‰§è¡Œç»“æŸâ€”â€”ä½†é—®é¢˜æ˜¯ï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾ä»¥åŠ tcpdumpã€iptables TRACEï¼Œå‘ç°<b>é˜¿é‡Œäº‘ä¼šâ€é™é»˜â€œä¸¢å¼ƒ &gt;=910s idle TCP connectionï¼Œä¸ç»™å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯å‘é€ FIN or RST ä»¥å¼ºè¡Œæ–­æ‰è¿æ¥</b>ï¼Œäºæ˜¯ MySQL server åœ¨ 1000s ç»“æŸæ—¶å‘ç»™å®¢æˆ·ç«¯çš„ ACK+PSH TCP packet åˆ°è¾¾ä¸äº†å®¢æˆ·ç«¯ï¼Œç„¶åå†è¿‡ wait_timeout=600sï¼ŒMySQL server å°±æ–­å¼€äº†è¿™ä¸ªé—²ç½®è¿æ¥â€”â€”å¯æ€œçš„æ˜¯ï¼Œmysql client è¿™ä¸ªå‘½ä»¤è¡Œç¨‹åºè¿˜ä¸€æ— æ‰€çŸ¥ï¼Œå®ƒå¾ˆæ‰§ç€çš„ç­‰å¾… MySQL server è¿”å›ï¼ŒLinux å†…æ ¸çš„ conntrack table æ˜¾ç¤ºè¿™ä¸ªè¿æ¥ä¸€ç›´æ˜¯ ESTABLISHEDï¼Œå“ªæ€• MySQL server ç«¯å·²ç»å…³é—­å¯¹åº”çš„è¿æ¥äº†ï¼Œåªæ˜¯è¿™ä¸ªå…³é—­åŠ¨ä½œçš„ FIN TCP packet åˆ°ä¸äº†å®¢æˆ·ç«¯ï¼</p><p>ä¸‹é¢æ˜¯ iptables TRACE æ—¥å¿—å¯¹è¿™ä¸ªé—®é¢˜çš„å®é”¤è¯æ˜ã€‚</p><p>mysql å‘½ä»¤è¡Œæ‰€åœ¨æœºå™¨çš„ iptables TRACE æ—¥å¿—è¡¨æ˜ï¼Œmysql client åœ¨ 23:58:25 è¿æ¥ä¸Šäº† mysql serverï¼Œå¼€å§‹æ‰§è¡Œ SELECT sleep(1000)ï¼Œç„¶åä¸€ç›´æ”¶ä¸åˆ°æœåŠ¡å™¨æ¶ˆæ¯ï¼Œæœ€ååœ¨ 00:41:20 çš„æ—¶å€™æˆ‘æ‰‹åŠ¨ kill äº† mysql å®¢æˆ·ç«¯å‘½ä»¤è¡Œè¿›ç¨‹ï¼Œmysql å®¢æˆ·ç«¯ç»™ mysql server å‘ FIN åŒ…ä½†æ”¶ä¸åˆ°å“åº”ï¼ˆæ­¤æ—¶ mysql server ç«¯æ—©å…³é—­è¿æ¥äº†ï¼‰ã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\">Dec 14 23:58:25 client-host kernel: [3156060.500323] TRACE: raw:OUTPUT:policy:3 IN= OUT=eth0 SRC=10.66.94.67 DST=10.31.76.36 LEN=60 TOS=0x00 PREC=0x00 TTL=64 ID=43069 DF PROTO=TCP SPT=38870 DPT=3306 SEQ=2419961697 ACK=0 WINDOW=29200 RES=0x00 SYN URGP=0 OPT (020405B40402080A2F06075C0000000001030307) UID=0 GID=0 \nDec 14 23:58:25 client-host kernel: [3156060.500334] TRACE: nat:OUTPUT:rule:1 IN= OUT=eth0 SRC=10.66.94.67 DST=10.31.76.36 LEN=60 TOS=0x00 PREC=0x00 TTL=64 ID=43069 DF PROTO=TCP SPT=38870 DPT=3306 SEQ=2419961697 ACK=0 WINDOW=29200 RES=0x00 SYN URGP=0 OPT (020405B40402080A2F06075C0000000001030307) UID=0 GID=0 \nDec 14 23:58:25 client-host kernel: [3156060.500419] TRACE: nat:KUBE-SERVICES:return:86 IN= OUT=eth0 SRC=10.66.94.67 DST=10.31.76.36 LEN=60 TOS=0x00 PREC=0x00 TTL=64 ID=43069 DF PROTO=TCP SPT=38870 DPT=3306 SEQ=2419961697 ACK=0 WINDOW=29200 RES=0x00 SYN URGP=0 OPT (020405B40402080A2F06075C0000000001030307) UID=0 GID=0 \n....\nDec 14 23:58:25 client-host kernel: [3156060.539844] TRACE: filter:KUBE-FIREWALL:return:2 IN=eth0 OUT= MAC=00:16:3e:12:09:f0:44:6a:2e:94:ef:00:08:00 SRC=10.31.76.36 DST=10.66.94.67 LEN=52 TOS=0x00 PREC=0x00 TTL=61 ID=9283 DF PROTO=TCP SPT=3306 DPT=38870 SEQ=2025462702 ACK=2419961951 WINDOW=235 RES=0x00 ACK URGP=0 OPT (0101080AFF6B3EAF2F06075D) UID=0 GID=0 \nDec 14 23:58:25 client-host kernel: [3156060.539849] TRACE: filter:INPUT:policy:3 IN=eth0 OUT= MAC=00:16:3e:12:09:f0:44:6a:2e:94:ef:00:08:00 SRC=10.31.76.36 DST=10.66.94.67 LEN=52 TOS=0x00 PREC=0x00 TTL=61 ID=9283 DF PROTO=TCP SPT=3306 DPT=38870 SEQ=2025462702 ACK=2419961951 WINDOW=235 RES=0x00 ACK URGP=0 OPT (0101080AFF6B3EAF2F06075D) UID=0 GID=0 \n\nDec 15 00:41:20 client-host kernel: [3158634.985792] TRACE: raw:OUTPUT:policy:3 IN= OUT=eth0 SRC=10.66.94.67 DST=10.31.76.36 LEN=52 TOS=0x00 PREC=0x00 TTL=64 ID=43075 DF PROTO=TCP SPT=38870 DPT=3306 SEQ=2419961951 ACK=2025462702 WINDOW=237 RES=0x00 ACK FIN URGP=0 OPT (0101080A2F0FD975FF6B3EAF) UID=0 GID=0 \nDec 15 00:41:20 client-host kernel: [3158634.985805] TRACE: filter:OUTPUT:rule:1 IN= OUT=eth0 SRC=10.66.94.67 DST=10.31.76.36 LEN=52 TOS=0x00 PREC=0x00 TTL=64 ID=43075 DF PROTO=TCP SPT=38870 DPT=3306 SEQ=2419961951 ACK=2025462702 WINDOW=237 RES=0x00 ACK FIN URGP=0 OPT (0101080A2F0FD975FF6B3EAF) UID=0 GID=0 \nDec 15 00:41:20 client-host kernel: [3158634.985812] TRACE: filter:KUBE-SERVICES:return:5 IN= OUT=eth0 SRC=10.66.94.67 DST=10.31.76.36 LEN=52 TOS=0x00 PREC=0x00 TTL=64 ID=43075 DF PROTO=TCP SPT=38870 DPT=3306 SEQ=2419961951 ACK=2025462702 WINDOW=237 RES=0x00 ACK FIN URGP=0 OPT (0101080A2F0FD975FF6B3EAF) UID=0 GID=0 \n....\nDec 15 00:42:13 client-host kernel: [3158688.341777] TRACE: filter:KUBE-FIREWALL:return:2 IN= OUT=eth0 SRC=10.66.94.67 DST=10.31.76.36 LEN=52 TOS=0x00 PREC=0x00 TTL=64 ID=43084 DF PROTO=TCP SPT=38870 DPT=3306 SEQ=2419961951 ACK=2025462702 WINDOW=237 RES=0x00 ACK FIN URGP=0 OPT (0101080A2F100D90FF6B3EAF) \nDec 15 00:42:13 client-host kernel: [3158688.341782] TRACE: filter:OUTPUT:policy:3 IN= OUT=eth0 SRC=10.66.94.67 DST=10.31.76.36 LEN=52 TOS=0x00 PREC=0x00 TTL=64 ID=43084 DF PROTO=TCP SPT=38870 DPT=3306 SEQ=2419961951 ACK=2025462702 WINDOW=237 RES=0x00 ACK FIN URGP=0 OPT (0101080A2F100D90FF6B3EAF) \n\n</code></pre></div><p>MySQL server åœ¨ 00:15:05 æ—¶æ‰§è¡Œ SELECT sleep(1000) ç»“æŸï¼Œç»™ mysql å®¢æˆ·ç«¯å›é€ç»“æœï¼Œä½† mysql å®¢æˆ·ç«¯æ— å“åº”ï¼ˆè¢«é˜¿é‡Œäº‘ä¸¢åŒ…äº†ï¼Œmysql å®¢æˆ·ç«¯å‹æ ¹æ”¶ä¸åˆ°ï¼‰ï¼Œåœ¨ 00:25:05 æ—¶ï¼Œç”±äº wait_timeout=600sï¼Œæ‰€ä»¥ MySQL server ç»™ mysql å®¢æˆ·ç«¯å‘ FIN åŒ…ä»¥æ–­å¼€è¿æ¥ï¼Œè‡ªç„¶ï¼Œmysql å®¢æˆ·ç«¯æ”¶ä¸åˆ°ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰å›åº”ï¼Œç»“å±€æ˜¯ MySQL server ä¸€ä¾§çš„ Linux å†…æ ¸åæ­£è‡ªè¡Œå…³é—­ TCP è¿æ¥äº†ï¼Œmysql client ä¸€ä¾§çš„ Linux å†…æ ¸è¿˜åœ¨å‚»ä¹ä¹çš„åœ¨ conntrack table ç»´æŒç€ ESTABLISHED çŠ¶æ€çš„ TCP è¿æ¥ï¼Œmysql client å‘½ä»¤è¡Œè¿˜åœ¨å‚»ä¹ä¹çš„ recv() ç­‰ç€æœåŠ¡ç«¯è¿”å›æˆ–è€…å…³é—­é“¾æ¥ã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\">Dec 15 00:15:05 mysql-server kernel: [34321950.128215] TRACE: raw:OUTPUT:policy:3 IN= OUT=eth0 SRC=10.31.76.36 DST=10.66.94.67 LEN=111 TOS=0x00 PREC=0x00 TTL=64 ID=9284 DF PROTO=TCP SPT=3306 DPT=38870 SEQ=2025462702 ACK=2419961951 WINDOW=235 RES=0x00 ACK PSH URGP=0 OPT (0101080AFF6F0F362F06075D) UID=999 GID=999 \nDec 15 00:15:05 mysql-server kernel: [34321950.128225] TRACE: filter:OUTPUT:policy:1 IN= OUT=eth0 SRC=10.31.76.36 DST=10.66.94.67 LEN=111 TOS=0x00 PREC=0x00 TTL=64 ID=9284 DF PROTO=TCP SPT=3306 DPT=38870 SEQ=2025462702 ACK=2419961951 WINDOW=235 RES=0x00 ACK PSH URGP=0 OPT (0101080AFF6F0F362F06075D) UID=999 GID=999 \n....\nDec 15 00:24:36 mysql-server kernel: [34322520.278151] TRACE: raw:OUTPUT:policy:3 IN= OUT=eth0 SRC=10.31.76.36 DST=10.66.94.67 LEN=111 TOS=0x00 PREC=0x00 TTL=64 ID=9298 DF PROTO=TCP SPT=3306 DPT=38870 SEQ=2025462702 ACK=2419961951 WINDOW=235 RES=0x00 ACK PSH URGP=0 OPT (0101080AFF713C002F06075D) UID=999 GID=999 \nDec 15 00:24:36 mysql-server kernel: [34322520.278188] TRACE: filter:OUTPUT:policy:1 IN= OUT=eth0 SRC=10.31.76.36 DST=10.66.94.67 LEN=111 TOS=0x00 PREC=0x00 TTL=64 ID=9298 DF PROTO=TCP SPT=3306 DPT=38870 SEQ=2025462702 ACK=2419961951 WINDOW=235 RES=0x00 ACK PSH URGP=0 OPT (0101080AFF713C002F06075D) UID=999 GID=999 \n\nDec 15 00:25:05 mysql-server kernel: [34322550.135731] TRACE: raw:OUTPUT:policy:3 IN= OUT=eth0 SRC=10.31.76.36 DST=10.66.94.67 LEN=52 TOS=0x00 PREC=0x00 TTL=64 ID=9299 DF PROTO=TCP SPT=3306 DPT=38870 SEQ=2025462761 ACK=2419961951 WINDOW=235 RES=0x00 ACK FIN URGP=0 OPT (0101080AFF7159282F06075D) UID=999 GID=999 \nDec 15 00:25:05 mysql-server kernel: [34322550.135742] TRACE: filter:OUTPUT:policy:1 IN= OUT=eth0 SRC=10.31.76.36 DST=10.66.94.67 LEN=52 TOS=0x00 PREC=0x00 TTL=64 ID=9299 DF PROTO=TCP SPT=3306 DPT=38870 SEQ=2025462761 ACK=2419961951 WINDOW=235 RES=0x00 ACK FIN URGP=0 OPT (0101080AFF7159282F06075D) UID=999 GID=999 </code></pre></div><p class=\"ztext-empty-paragraph\"><br/></p><p>Okï¼Œç°åœ¨çŸ¥é“æ˜¯é˜¿é‡Œäº‘å¯¹ &gt;= 910s æ²¡æœ‰å‘ç”Ÿ TCP packet ä¼ è¾“çš„<b>è™šæ‹Ÿæœºä¹‹é—´ç›´è¿</b>é—²ç½® TCP è¿æ¥ä¼šâ€œé™é»˜â€ä¸¢åŒ…ï¼Œé‚£ä¹ˆæ˜¯ä»»æ„è™šæ‹Ÿæœºä¹‹é—´å—ï¼Ÿæ˜¯ä»»æ„ç«¯å£å—ï¼Ÿè¦æ±‚æœåŠ¡å™¨æŒ‚åˆ°è´Ÿè½½å‡è¡¡å™¨åé¢å—ï¼Ÿè¦æ±‚å¯¹åº”ç«¯å£çš„å¹¶å‘è¿æ¥åˆ°ä¸€å®šæ•°ç›®å—ï¼Ÿ</p><p>åœ¨é˜¿é‡Œäº‘æäº¤å·¥å•è¯¢é—®åï¼Œæ²¡å¾—åˆ°ä»€ä¹ˆæœ‰ä»·å€¼ä¿¡æ¯ï¼Œåœ¨ç»è¿‡è‰°è‹¦å“ç»çš„è¯•éªŒåâ€”â€”æ¯ä¸€æ¬¡è¯•éªŒè¦ç­‰è¿‘äºŒååˆ†é’Ÿå•Šâ€”â€”ç»ˆäºåŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œæˆ‘å‘ç°ä¸€ä¸ªç¨³å®šå¤ç°é—®é¢˜çš„è§„å¾‹äº†ï¼š</p><ol><li>ä¸¤å°è™šæ‹Ÿæœºåˆ†åˆ«å¤„äºä¸åŒå®‰å…¨ç»„ï¼Œæ²¡æœ‰å…±åŒå®‰å…¨ç»„ï¼›</li><li>æœåŠ¡ç«¯çš„å®‰å…¨ç»„å¼€æ”¾ç«¯å£ P å…è®¸å®¢æˆ·ç«¯çš„å®‰å…¨ç»„è¿æ¥ï¼Œå®¢æˆ·ç«¯ä¸å¼€æ”¾ç«¯å£ç»™æœåŠ¡ç«¯ï¼ˆæŒ‰ç…§ä¸€èˆ¬<b>æœ‰çŠ¶æ€</b>é˜²ç«å¢™çš„é…ç½®è§„åˆ™ï¼Œéƒ½æ˜¯åªå¼€æœåŠ¡ç«¯ç«¯å£ï¼Œä¸ç”¨å¼€å®¢æˆ·ç«¯ç«¯å£ï¼‰ï¼›</li><li>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿æ¥ä¸Šåï¼Œé—²ç½® &gt;= 910sï¼Œä¸ä¼ è¾“ä»»ä½•æ•°æ®ï¼Œä¹Ÿä¸ä¼ è¾“æœ‰ keep alive ç”¨é€”çš„ ack åŒ…ï¼›</li><li>ç„¶åæœåŠ¡ç«¯åœ¨æ­¤é•¿è¿æ¥ä¸Šå‘ç»™å®¢æˆ·ç«¯çš„ TCP åŒ…ä¼šåœ¨ç½‘ç»œä¸Šä¸¢å¼ƒï¼Œåˆ°ä¸äº†å®¢æˆ·ç«¯ï¼›</li><li>ä½†å¦‚æœå®¢æˆ·ç«¯æ­¤æ—¶ç»™æœåŠ¡ç«¯å‘ç‚¹æ•°æ®ï¼Œé‚£ä¹ˆä¼šé‡æ–°â€œæ¿€æ´»â€è¿™æ¡é•¿é“¾æ¥ï¼Œä½†æ­¤æ—¶è¿˜æ˜¯<b>å•å·¥</b>çŠ¶æ€ï¼Œå®¢æˆ·ç«¯èƒ½ç»™æœåŠ¡ç«¯å‘åŒ…ï¼ŒæœåŠ¡ç«¯çš„åŒ…è¿˜åˆ°ä¸äº†å®¢æˆ·ç«¯ï¼ˆå¤§æ¦‚æ˜¯åœ¨æœåŠ¡ç«¯ OS å†…æ ¸é‡Œé‡è¯•ä¸­ï¼‰ï¼›</li><li>æ¿€æ´»åï¼ŒæœåŠ¡ç«¯å†ç»™å®¢æˆ·ç«¯å‘æ•°æ®æ—¶ï¼Œä¹‹å‰å‘é€ä¸å‡ºå»çš„æ•°æ®ï¼ˆå¦‚æœè¿˜åœ¨å†…æ ¸é‡Œçš„ TCP/IP  åè®®æ ˆé‡è¯•ä¸­ï¼‰ï¼ŒåŠ ä¸Šæ–°å‘çš„æ•°æ®ï¼Œä¼šä¸€èµ·åˆ°è¾¾å®¢æˆ·ç«¯ï¼Œæ­¤åè¿™æ¡é•¿è¿æ¥è¿›å…¥æ­£å¸¸çš„<b>åŒå·¥</b>å·¥ä½œçŠ¶æ€ï¼›</li></ol><p>ä¸‹å›¾æ˜¯ç”¨ nc è¯•éªŒçš„ç»“æœã€‚</p><figure data-size=\"normal\"><noscript><img src=\"https://pic2.zhimg.com/v2-be139525f4cbede2cec1491f75521f89_b.jpg\" data-size=\"normal\" data-rawwidth=\"834\" data-rawheight=\"406\" class=\"origin_image zh-lightbox-thumb\" width=\"834\" data-original=\"https://pic2.zhimg.com/v2-be139525f4cbede2cec1491f75521f89_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;834&#39; height=&#39;406&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"834\" data-rawheight=\"406\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"834\" data-original=\"https://pic2.zhimg.com/v2-be139525f4cbede2cec1491f75521f89_r.jpg\" data-actualsrc=\"https://pic2.zhimg.com/v2-be139525f4cbede2cec1491f75521f89_b.jpg\"/><figcaption>æœåŠ¡ç«¯</figcaption></figure><figure data-size=\"normal\"><noscript><img src=\"https://pic1.zhimg.com/v2-22c69e339f290933bdb7451ba57a96b8_b.jpg\" data-size=\"normal\" data-rawwidth=\"870\" data-rawheight=\"380\" class=\"origin_image zh-lightbox-thumb\" width=\"870\" data-original=\"https://pic1.zhimg.com/v2-22c69e339f290933bdb7451ba57a96b8_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;870&#39; height=&#39;380&#39;&gt;&lt;/svg&gt;\" data-size=\"normal\" data-rawwidth=\"870\" data-rawheight=\"380\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"870\" data-original=\"https://pic1.zhimg.com/v2-22c69e339f290933bdb7451ba57a96b8_r.jpg\" data-actualsrc=\"https://pic1.zhimg.com/v2-22c69e339f290933bdb7451ba57a96b8_b.jpg\"/><figcaption>å®¢æˆ·ç«¯</figcaption></figure><p>åœ¨è·Ÿç½‘å‹è®¨è®ºåï¼Œè®¤è¯†åˆ°è¿™åº”è¯¥æ˜¯é˜¿é‡Œäº‘å®‰å…¨ç»„åŸºäºâ€œé›†ä¸­å¼é˜²ç«å¢™â€å®ç°å¯¼è‡´çš„ï¼Œå› ä¸ºé›†ä¸­å¼é˜²ç«å¢™å¤„äºç½‘ç»œä¸­å¿ƒæ¢çº½ï¼Œå®ƒè¦åº”ä»˜æµ·é‡è¿æ¥ï¼Œå› æ­¤å…¶å†…å­˜é‡Œçš„ conntrack table éœ€è¦æ¯”è¾ƒçŸ­çš„ idle timeoutï¼ˆç›®å‰æ˜¯ 910sï¼‰ï¼Œä»¥æŠŠé•¿æ—¶é—´æ²¡æ´»è·ƒçš„ conntrack record æ¸…ç†æ‰èŠ‚çº¦å†…å­˜ï¼Œæ‰€ä»¥ä¸Šé¢é—®é¢˜çš„æ ¹æºå°±æ¸…æ™°äº†ï¼š</p><ol><li>client è¿æ¥ serverï¼Œå®‰å…¨ç»„ï¼ˆå…¶å®æ˜¯é˜²ç«å¢™ï¼‰å‘ç°è§„åˆ™å…è®¸ï¼Œäºæ˜¯åŠ å…¥ä¸€ä¸ªè®°å½•åˆ° conntrack tableï¼›</li><li>client å’Œ server åˆ°äº† 910s è¿˜æ²¡æ•°æ®å¾€æ¥ï¼Œæ‰€ä»¥å®‰å…¨ç»„æŠŠ conntrack é‡Œé‚£æ¡è®°å½•å»æ‰äº†ï¼›</li><li>server åœ¨ 910s ä¹‹åç»™ client å‘æ•°æ®ï¼Œæ•°æ®åŒ…åˆ°äº†å®‰å…¨ç»„é‚£é‡Œï¼Œå®ƒä¸€çœ‹ conntrack table é‡Œæ²¡è®°å½•ï¼Œè€Œ client ä¾§å®‰å…¨ç»„åˆä¸å…è®¸è¿™ä¸ªç«¯å£çš„åŒ…é€šè¿‡ï¼Œæ‰€ä»¥ä¸¢åŒ…äº†ï¼Œäºæ˜¯ server -&gt; client ä¸é€šï¼›</li><li>client åœ¨åŒä¸€ä¸ªé•¿è¿æ¥ä¸Šç»™ server å‘ç‚¹æ•°æ®ï¼Œå®‰å…¨ç»„ä¸€çœ‹è§„åˆ™å…è®¸ï¼Œäºæ˜¯åŠ å…¥ conntrack table é‡Œï¼›</li><li>server é‡è¯•çš„æ•°æ®åŒ…ï¼Œæˆ–è€…æ–°æ•°æ®åŒ…ï¼Œé€šè¿‡å®‰å…¨ç»„æ—¶ï¼Œç”±äºå·²ç»æœ‰ conntrack record äº†ï¼Œæ‰€ä»¥æ”¾è¡Œï¼Œäºæ˜¯èƒ½åˆ°è¾¾å®¢æˆ·ç«¯äº†ã€‚</li></ol><hr/><p>åŸå› çŸ¥é“äº†ï¼Œæ€ä¹ˆç»•è¿‡è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿé˜¿é‡Œäº‘ç»™äº†æˆ‘ä¸¤ä¸ªæ— æ³•æ¥å—çš„ workaroundï¼š</p><ol><li>æŠŠ serverã€client æ”¾è¿›åŒä¸€ä¸ªå®‰å…¨ç»„ï¼›</li><li>ä¿®æ”¹ client æ‰€åœ¨å®‰å…¨ç»„ï¼Œå¼€æ”¾æ‰€æœ‰ç«¯å£ç»™ server æ‰€åœ¨å®‰å…¨ç»„ï¼›</li></ol><p>å†ç¢ç£¨ä¸‹ï¼Œé€šè¿‡ netstat -o å‘ç°æˆ‘ä»¬çš„ Java æœåŠ¡ä½¿ç”¨çš„ Jedis åº“å’Œ mysql JDBC åº“éƒ½å¯¹ socket æ–‡ä»¶å¥æŸ„æ‰“å¼€äº† <a href=\"https://link.zhihu.com/?target=http%3A//www.tldp.org/HOWTO/TCP-Keepalive-HOWTO/usingkeepalive.html\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">SO_KEEPALIVE é€‰é¡¹</a>ï¼š</p><figure data-size=\"normal\"><noscript><img src=\"https://pic1.zhimg.com/v2-dd488310b20a1bad8e1c5fbb4b53ab68_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"2566\" data-rawheight=\"390\" class=\"origin_image zh-lightbox-thumb\" width=\"2566\" data-original=\"https://pic1.zhimg.com/v2-dd488310b20a1bad8e1c5fbb4b53ab68_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;2566&#39; height=&#39;390&#39;&gt;&lt;/svg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"2566\" data-rawheight=\"390\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"2566\" data-original=\"https://pic1.zhimg.com/v2-dd488310b20a1bad8e1c5fbb4b53ab68_r.jpg\" data-actualsrc=\"https://pic1.zhimg.com/v2-dd488310b20a1bad8e1c5fbb4b53ab68_b.jpg\"/></figure><p>è€Œ MySQL server ä¹Ÿå¯¹å…¶æ‰“å¼€çš„ socket æ–‡ä»¶å¥æŸ„æ‰“å¼€äº† SO_KEEPALIVE é€‰é¡¹ï¼Œæ‰€ä»¥æˆ‘åªç”¨ä¿®æ”¹ä¸‹æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯è‡³å°‘å…¶ä¸­ä¸€ä¾§çš„å¯¹åº” sysctl é€‰é¡¹å³å¯ï¼Œä¸‹é¢æ˜¯æˆ‘å¸æœåŠ¡ç«¯çš„é»˜è®¤é…ç½®ï¼Œè¡¨ç¤º TCP è¿æ¥é—²ç½® 1800s åï¼Œæ¯éš” 30s ç»™å¯¹æ–¹å‘ä¸€ä¸ª ACK åŒ…ï¼Œæœ€å¤šå‘ 3 æ¬¡ï¼Œå¦‚æœåœ¨æ­¤æœŸé—´å¯¹æ–¹å›å¤äº†ï¼Œåˆ™è®¡æ—¶å™¨é‡ç½®ï¼Œå†ç­‰ 1800s é—²ç½®æ¡ä»¶ï¼Œå¦‚æœå‘äº† 3 æ¬¡åå¯¹æ–¹æ²¡ååº”ï¼Œé‚£ä¹ˆä¼šç»™å¯¹ç«¯å‘ RST åŒ…åŒæ—¶å…³é—­æœ¬åœ°çš„ socket æ–‡ä»¶å¥æŸ„ï¼Œä¹Ÿå³å…³é—­è¿™æ¡é•¿è¿æ¥ã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\">net.ipv4.tcp_keepalive_intvl = 30\nnet.ipv4.tcp_keepalive_probes = 3\nnet.ipv4.tcp_keepalive_time = 1800</code></pre></div><p>ç”±äºé˜¿é‡Œäº‘è·¨å®‰å…¨ç»„çš„ 910s idle timeout é™åˆ¶ï¼Œæ‰€ä»¥éœ€è¦æŠŠ net.ipv4.tcp_keepalive_time è®¾ç½®æˆå°äº 910sï¼Œæ¯”å¦‚ 300sã€‚</p><p>é»˜è®¤çš„ tcp_keepalive_time ç‰¹åˆ«å¤§ï¼Œè¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆå½“åˆ Redis client è®¾ç½®äº† SO_KEEPALIVE é€‰é¡¹åè¿˜æ˜¯è¢«é˜¿é‡Œäº‘é™é»˜æ–­å¼€ã€‚</p><p>å¦‚æœæŸäº›ç½‘ç»œåº“å°è£…ä¹‹åæ²¡æœ‰æä¾› setsockopt() è°ƒç”¨çš„æœºä¼šï¼Œé‚£ä¹ˆéœ€è¦ç”¨ LD_PRELOAD ä¹‹ç±»çš„é»‘ç§‘æŠ€å¼ºè¡Œè®¾ç½®äº†ï¼Œ<b>åªæœ‰æ‰“å¼€äº† socket æ–‡ä»¶å¥æŸ„çš„ SO_KEEPALIVE é€‰é¡¹ï¼Œä¸Šé¢ä¸‰ä¸ª sysctl æ‰å¯¹è¿™ä¸ª socket æ–‡ä»¶å¥æŸ„ç”Ÿæ•ˆ</b>ï¼Œå½“ç„¶ï¼Œä»£ç é‡Œå¯ä»¥ç”¨ setsockopt() å‡½æ•°è¿›ä¸€æ­¥è®¾ç½® keep_alive_intvl å’Œ keepalive_probesï¼Œä¸ç”¨ Linux å†…æ ¸çš„å…¨å±€é»˜è®¤è®¾ç½®ã€‚</p><p>æœ€åï¼Œé™¤äº† Java å®¶å¯¹ SO_KEEPALIVE å¤„ç†çš„å¾ˆå¥½ï¼Œåˆ©ç”¨ netstat -o æ£€æŸ¥å¾—çŸ¥ï¼Œå¯¹é—¨çš„ NodeJS å®¶ï¼Œå…¶è‘—å Redis client library å¼€äº† SO_KEEPALIVE ä½†å…¶è‘—å mysql client library <b>å¹¶æ²¡æœ‰å¼€</b>ï¼Œè€Œ Go lang å®¶åˆ™ä¸¥è°¨å¤šäº†ï¼Œä¸¤ä¸ªåº“éƒ½å¼€äº† SO_KEEPALIVEã€‚ <b>ä¸ºä»€ä¹ˆå¼•å­é‡Œè¯´è¿™ä¸ªé—®é¢˜å¾ˆä¸¥é‡å‘¢ï¼Ÿå› ä¸ºä½†å‡¡æœåŠ¡ç«¯å¤„ç†çš„æ…¢ç‚¹ï¼Œæ¯”å¦‚ OLAP åœºæ™¯ï¼Œä¸ç»è¿‡é˜¿é‡Œäº‘ SLB ç›´è¿æœåŠ¡ç«¯åœ¨ 910s ä¹‹å†…æ²¡è¿”å›æ•°æ®çš„è¯ï¼Œå°±æœ‰å¯èƒ½æ²¡æœºä¼šè¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯äº†å•Šï¼Œè¿™ä¸ªé—®é¢˜æŸ¥æ­»äººæœ‰æ²¡æœ‰ï¼ </b>ä½ å¯èƒ½é—®æˆ‘ä¸ºå•¥ä¸é€šè¿‡é˜¿é‡Œäº‘ SLB ä¸­è½¬ï¼ŒSLB ä¸ä¼šé™é»˜ä¸¢åŒ…å•Šâ€”â€”ä½†å®ƒçš„ idle timeout ä¸Šé™æ˜¯ 900s å•Šï¼ï¼ï¼</p>", 
            "topic": [
                {
                    "tag": "é˜¿é‡Œäº‘", 
                    "tagLink": "https://api.zhihu.com/topics/19560108"
                }, 
                {
                    "tag": "MySQL", 
                    "tagLink": "https://api.zhihu.com/topics/19554128"
                }, 
                {
                    "tag": "Java", 
                    "tagLink": "https://api.zhihu.com/topics/19561132"
                }
            ], 
            "comments": [
                {
                    "userName": "å›æ«", 
                    "userLink": "https://www.zhihu.com/people/ea8ebdafe5ac562d0a4a1c0698117b9f", 
                    "content": "<p>èµï¼Œè™½ä¸æ˜¯é˜¿é‡Œäº‘ï¼Œä½†ä¹Ÿé‡åˆ°äº†ä¸€æ ·çš„é—®é¢˜ï¼Œåœ¨æˆ‘ä»¬åº”ç”¨å’Œæ•°æ®ä¹‹é—´æœ‰é˜²ç«å¢™ï¼Œä¸€å®šæ—¶é—´å†…æ— æ•°æ®ä¼ è¾“ä¼šè‡ªåŠ¨æ–­å¼€è¿æ¥ï¼Œä½†æ˜¯åº”ç”¨å±‚æ— æ„ŸçŸ¥ï¼Œé€ æˆé¡µé¢å¡æ­»ã€‚</p><p></p>", 
                    "likes": 5, 
                    "childComments": []
                }, 
                {
                    "userName": "å°‘å¹´æ€’äº†", 
                    "userLink": "https://www.zhihu.com/people/8bbd171219c75100290bfa08c68c86a7", 
                    "content": "<p>ç‰¹æ„è·‘åˆ°çŸ¥ä¹æ¥æ„Ÿè°¢æ‚¨çš„åˆ¨å‘ï¼Œæˆ‘ä»¬ä¹Ÿé‡åˆ°äº†ï¼Œä½†æ˜¯åªå½“æ˜¯çµå¼‚é—®é¢˜ï¼Œæ²¡ç»†ç©¶ã€‚</p>", 
                    "likes": 2, 
                    "childComments": []
                }, 
                {
                    "userName": "åµ‡åº·", 
                    "userLink": "https://www.zhihu.com/people/962e31a50c18f3124b02037307e161e0", 
                    "content": "<p>æ–‡ç« ä¸­ï¼Œæœ€åç»“å°¾è¯´çš„ mysql client library æ˜¯å•¥ï¼Ÿ mysqå‘½ä»¤è¡Œå®¢æˆ·ç«¯ä¹ˆ?</p>", 
                    "likes": 0, 
                    "childComments": [
                        {
                            "userName": "çŸ¥ä¹ç”¨æˆ·", 
                            "userLink": "https://www.zhihu.com/people/0", 
                            "content": "æŒ‡å„ä¸ªç¼–ç¨‹è¯­è¨€çš„mysqlå®¢æˆ·ç«¯åº“ï¼Œæ¯”å¦‚mysql-connector-javaã€‚", 
                            "likes": 0, 
                            "replyToAuthor": "åµ‡åº·"
                        }
                    ]
                }, 
                {
                    "userName": "å“å™¹å“å™¹", 
                    "userLink": "https://www.zhihu.com/people/588c1e0e9f4aa4ee9965171499b2fc16", 
                    "content": "åˆ†æçš„å¤ªå¥½äº†  ä¸èµä¸€ä¸ªå¯¹ä¸èµ·ä»¥åé‡‡çš„å‘", 
                    "likes": 1, 
                    "childComments": [
                        {
                            "userName": "çŸ¥ä¹ç”¨æˆ·", 
                            "userLink": "https://www.zhihu.com/people/0", 
                            "content": "æ„Ÿè°¢ï¼ğŸ™", 
                            "likes": 0, 
                            "replyToAuthor": "å“å™¹å“å™¹"
                        }
                    ]
                }, 
                {
                    "userName": "å´æ˜Š", 
                    "userLink": "https://www.zhihu.com/people/fdd8d8414b276f736d7561cf853f27fb", 
                    "content": "è¿™ä¸ªé—®é¢˜æ’æŸ¥ä¸å®¹æ˜“ï¼Œå¾—å¯¹tcpåè®®éå¸¸äº†è§£æ‰è¡Œï¼Œèµä¸€ä¸ª", 
                    "likes": 0, 
                    "childComments": []
                }, 
                {
                    "userName": "çŸ¥ä¹ç”¨æˆ·", 
                    "userLink": "https://www.zhihu.com/people/0", 
                    "content": "<p>è¿™ä½ éƒ½èƒ½æŸ¥å‡ºæ¥</p><a class=\"comment_sticker\" href=\"https://pic4.zhimg.com/v2-db92f653a2ec17ea3ff309d6d56e8507.gif\" data-width=\"\" data-height=\"\">[åƒç“œ]</a>", 
                    "likes": 0, 
                    "childComments": []
                }, 
                {
                    "userName": "jacarrichan", 
                    "userLink": "https://www.zhihu.com/people/db963c1bb377f7ed7839dc77ec19c184", 
                    "content": "<p>æˆ‘è¿™ä»£ç å›æ»šçš„æ—¶å€™å‡ºç°è¿™æ ·çš„é—®é¢˜ ï¼Œè¿˜æ˜¯åœ¨æŠ¢è´­çš„æ—¶å€™ï¼ŒçœŸæ˜¯çƒ¦æ­»äº†ã€‚</p><p><br></p><p><br></p><p>com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Communications link failure during rollback(). Transaction resolution unknown.</p><p><br></p><p>Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.</p><p>        at com.mysql.jdbc.MysqlIO.readFully(<a href=\"http://link.zhihu.com/?target=http%3A//MysqlIO.java%3A3161\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">MysqlIO.java:3161</a>)</p><p>        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(<a href=\"http://link.zhihu.com/?target=http%3A//MysqlIO.java%3A3615\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">MysqlIO.java:3615</a>)</p><p>        ... 89 common frames omitted</p><p></p><p></p>", 
                    "likes": 1, 
                    "childComments": []
                }, 
                {
                    "userName": "å•æ™“é˜³", 
                    "userLink": "https://www.zhihu.com/people/b8cae6bbcb447719c9981eaaded9e68d", 
                    "content": "<p>æœåŠ¡å™¨è¿æ¥æ•°æ®åº“ï¼Œæ˜¯å…¸å‹çš„å®‰å…¨ç»„å†…ç½‘äº’é€šåœºæ™¯ã€‚è§„è§„çŸ©çŸ©çš„ç”¨å®‰å…¨ç»„äº’é€šï¼Œé¿å…ä¸å¿…è¦çš„éº»çƒ¦ã€‚Pls do not fuck yourself, OK?</p>", 
                    "likes": 0, 
                    "childComments": [
                        {
                            "userName": "çŸ¥ä¹ç”¨æˆ·", 
                            "userLink": "https://www.zhihu.com/people/0", 
                            "content": "è¯·é—®å®¢æˆ·ç«¯è¿æ¥æ•°æ®åº“çš„3306ç«¯å£æ—¶ï¼Œå®¢æˆ·ç«¯ç”¨çš„ä»€ä¹ˆç«¯å£ï¼Ÿå¦‚æœåœ¨å®‰å…¨ç»„æ‰“å¼€å®¢æˆ·ç«¯è¿™ä¸ªç«¯å£ï¼Œé‚£ä¹ˆè¿›å…¥è¿™ä¸ªå®¢æˆ·ç«¯ç«¯å£çš„SYNåŒ…è¦æ”¾è¡Œå—ï¼Ÿ", 
                            "likes": 1, 
                            "replyToAuthor": "å•æ™“é˜³"
                        }
                    ]
                }, 
                {
                    "userName": "çŸ¥ä¹ç”¨æˆ·", 
                    "userLink": "https://www.zhihu.com/people/0", 
                    "content": "é˜¿é‡Œäº‘é‚£å±‚åº”è¯¥æ˜¯åœ¨IPï¼Œä¸å‘finæ˜¯å¯¹çš„ã€‚", 
                    "likes": 1, 
                    "childComments": [
                        {
                            "userName": "çŸ¥ä¹ç”¨æˆ·", 
                            "userLink": "https://www.zhihu.com/people/0", 
                            "content": "ä¸æ˜¯æƒ³è®©å®ƒå‘FINï¼Œè€Œæ˜¯åˆ«é™é»˜ä¸¢åŒ…ã€‚", 
                            "likes": 0, 
                            "replyToAuthor": "çŸ¥ä¹ç”¨æˆ·"
                        }, 
                        {
                            "userName": "çŸ¥ä¹ç”¨æˆ·", 
                            "userLink": "https://www.zhihu.com/people/0", 
                            "content": "<p>ä¸æ˜¯é™é»˜ä¸¢åŒ…, åªæ˜¯å¤±æ•ˆäº†ä¹‹å‰çš„natè½¬å‘è®°å½•.äº‘é‚£è¾¹æœ¬èº«æ²¡æœ‰é—®é¢˜.åº”ç”¨å±‚çš„é—®é¢˜.</p>", 
                            "likes": 0, 
                            "replyToAuthor": "çŸ¥ä¹ç”¨æˆ·"
                        }
                    ]
                }, 
                {
                    "userName": "jacarrichan", 
                    "userLink": "https://www.zhihu.com/people/db963c1bb377f7ed7839dc77ec19c184", 
                    "content": "<p>ã€mysql å‘½ä»¤è¡Œæ‰€åœ¨æœºå™¨çš„ iptables TRACE æ—¥å¿—è¡¨æ˜ã€‘  è¯·é—®LZçš„iptable rawè¡¨æ˜¯æ€ä¹ˆè®¾ç½®çš„å•Šï¼Ÿ  æˆ‘ä¹Ÿæƒ³å¾—åˆ°é‚£ä¸ªTRACEæ—¥å¿—ã€‚</p>", 
                    "likes": 0, 
                    "childComments": [
                        {
                            "userName": "çŸ¥ä¹ç”¨æˆ·", 
                            "userLink": "https://www.zhihu.com/people/0", 
                            "content": "ä¸ŠBingæœç´¢ä¸‹iptables traceå™»â€¦â€¦", 
                            "likes": 0, 
                            "replyToAuthor": "jacarrichan"
                        }
                    ]
                }, 
                {
                    "userName": "å´å¤©é¾™", 
                    "userLink": "https://www.zhihu.com/people/1813ba49e9eac9046893bb6bde305b48", 
                    "content": "ä¸åªæ˜¯å®‰å…¨ç»„ï¼Œclient-serverä¸­é—´çš„è¯¸å¤šç½‘ç»œè®¾å¤‡éƒ½æœ‰å¯èƒ½ä¼šä¸¢å¼ƒé•¿æ—¶é—´æ²¡æœ‰æ´»åŠ¨çš„è¿æ¥ã€‚å¦‚æœæœ‰è¿™ç§é•¿æ—¶é—´çš„é€šä¿¡ï¼Œä¹–ä¹–å¼€keepaliveå°±å¥½äº†ã€‚", 
                    "likes": 1, 
                    "childComments": []
                }, 
                {
                    "userName": "å¹»å½±ç«æªæ‰‹", 
                    "userLink": "https://www.zhihu.com/people/d49a7145330e0d3f0d7e549892833a05", 
                    "content": "<p>ä¸­é—´ä»»ä½•é˜²ç«å¢™å’ŒNATã€ç½‘ç»œè®¾å¤‡éƒ½æœ‰å¯èƒ½ä¸¢å¼ƒè¿æ¥ï¼Œè¦ä¿è¯è¿æ¥ç¨³å®šï¼Œseverç«¯å¼€å¯keepaliveï¼Œè°ƒæ•´ä¸‹å†…æ ¸å‚æ•°å°±å¥½äº†ã€‚</p>", 
                    "likes": 0, 
                    "childComments": []
                }
            ]
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50811605", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 4, 
            "title": "å¯¹ SaltStack å¤±æœ›äº†", 
            "content": "<p>ã€è¿ç§»ã€‘å¯¹ SaltStack å¤±æœ›äº†</p><p>Puppet çš„DSLè¯­æ³•åƒæ˜¯ç¼–ç¨‹ï¼ŒChef æ›´èƒœï¼Œç›´æ¥ Ruby  ç¼–ç¨‹äº†ï¼Œéƒ½æ˜¯å¤æ‚çš„ä¸€å¨å¨ï¼ŒçœŸæƒ³ä¸æ‡‚è¿ç»´å†™ä»£ç ç´¯ä¸ç´¯æ”¾å¿ƒä¸æ”¾å¿ƒï¼SaltStack å’Œ Ansible  éƒ½æ˜¯å£°æ˜å¼é…ç½®è€Œéå‘½ä»¤å¼ï¼Œä¸ªäººå–œæ¬¢è¿™ä¸ªè·¯æ•°ï¼Œæœ€è¿‘èŠ±äº†ä¸¤å¤©åŠŸå¤«è€å¿ƒä»”ç»†çœ‹äº†ä¸‹ SaltStack  æ‰‹å†Œï¼Œå…¶æ‰‹å†Œçš„æ•™ç¨‹éƒ¨åˆ†çœŸæ˜¯æ‚ä¹±ï¼Œæ‹¿äº†å¥½å¤šç¯‡å‡‘åœ¨ä¸€èµ·ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>SaltStack åœ¨ CentOS 6.x ä¸Šå®‰è£…å¾ˆå®¹æ˜“ï¼Œåœ¨ EPEL æºé‡Œæœ‰ï¼Œé…ç½®æ–‡ä»¶çš„è¯­æ³•ä¹Ÿå¾ˆç®€å•ä¸€è‡´ï¼Œä½†ä»”ç»†çœ‹æ–‡æ¡£åå‘ç° SaltStack è¿˜æ˜¯å¾ˆå¤æ‚çš„ï¼Œæ¦‚å¿µå¾ˆå¤šï¼Œå„ç§ç»†å¾®å·®åˆ«çš„æŒ‡ä»¤ä¹Ÿå¾ˆå¤šï¼š</p><ul><li><a href=\"https://link.zhihu.com/?target=https%3A//docs.saltstack.com/en/getstarted/overview.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">docs.saltstack.com/en/g</span><span class=\"invisible\">etstarted/overview.html</span><span class=\"ellipsis\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=https%3A//docs.saltstack.com/en/latest/ref/states/requisites.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">docs.saltstack.com/en/l</span><span class=\"invisible\">atest/ref/states/requisites.html</span><span class=\"ellipsis\"></span></a></li></ul><p>SaltStack  æœ€æ—©æ˜¯é¼“å¹ master-minion æ¶æ„ï¼Œç”¨ ZeroMQ åšé•¿è¿æ¥å› æ­¤æ‰§è¡Œæ•ˆç‡æ¯”æ‰¹é‡ ssh å¿«çš„å¤šï¼Œä½†ç°åœ¨ä¹ŸåŠ å…¥äº†  salt-sshï¼ˆè·Ÿ Ansible ç±»ä¼¼ï¼Œä¸éœ€è¦ minion ç«¯é¢„å…ˆè£… ansibleï¼‰ï¼Œæˆ–è€…åœ¨ minion ç«¯ç”¨ salt-minion  æœåŠ¡è¯»å–æœ¬åœ° /srv/salt ä»è€Œä¸ä¾èµ– salt-masterï¼Œæˆ–è€…åœ¨ minion ç«¯ç”¨ cron + salt-call  --local ä»è€Œä¸ä¾èµ– salt-minion ä¹Ÿä¸ç”¨è·‘ salt-minion æœåŠ¡ã€‚</p><p>è·Ÿ Puppet ç±»ä¼¼ï¼Œè¿™äº›è„šæœ¬è¯­è¨€å†™çš„å·¥å…·è€—å†…å­˜ä¸€ç‚¹éƒ½ä¸åå•¬ï¼Œsalt-minion åŸºæœ¬ç©ºè·‘èƒ½æ¶ˆè€—äºŒä¸‰åå…† RSSï¼Œ500å…† VSSï¼Œsalt-master å˜›è€—äº†ä¸‰å››åå…† RSSï¼Œ500M ~ 1GB VSS äº†ï¼Œçœ‹ç€å¾ˆæ˜¯ä¸çˆ½ã€‚</p><p>SaltStack å®£ç§°çš„å¿«é€Ÿè¿æ¥çœŸçš„æ˜¯æ€æ‰‹ç‰¹æ€§å—ï¼Ÿé…ç½®ç®¡ç†å·¥å…·ä¸»è¦æœ‰ä¸‰ç§åœºåˆä¸‹ä½¿ç”¨ï¼š</p><ol><li>åšéƒ¨ç½²ã€‚éƒ¨ç½²éœ€è¦è€ƒè™‘ä¸åŒå­ç³»ç»Ÿçš„å…ˆåé¡ºåºï¼Œä»¥åŠéƒ¨ç½²çš„å¹¶å‘åº¦ï¼Œä»¥é¿å…å¯¹çº¿ä¸ŠæœåŠ¡å½±å“å¤ªå¤§ï¼ŒSalt æœ‰ä¸ª <a href=\"https://link.zhihu.com/?target=https%3A//docs.saltstack.com/en/latest/topics/tutorials/states_pt5.html%23orchestrate-runner\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">orchestrator</a> åŠŸèƒ½è¾¾åˆ°è¿™ä¸ªæ•ˆæœï¼Œè¿™ä¸ªä¸œè¥¿æœ¬è´¨å°±æ˜¯ä¸ªæ‰¹å¤„ç†è„šæœ¬ã€‚éƒ¨ç½²æ—¶èŠ±åœ¨è¿æ¥ä¸Šçš„æ—¶é—´è·Ÿ state.apply çš„æ—¶é—´ç›¸æ¯”å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</li><li>åšæŒç»­çš„é…ç½®æ”¶æ•›ã€‚è¿™ç§äº‹ä¸€èˆ¬éƒ½æ˜¯åœ¨è¢«ç®¡ç†æœºå™¨ä¸Š cron job å®šæœŸæ‰§è¡Œï¼Œä¹Ÿæ²¡å•¥è¿æ¥æ…¢çš„é—®é¢˜ã€‚</li><li>ad hoc çš„æ‰¹é‡å‘½ä»¤ã€‚ä¸€èˆ¬æ“ä½œçš„æœºå™¨æ•°é‡ä¸ä¼šç‰¹åˆ«å¤šï¼Œä¹Ÿä¸é¢‘ç¹ï¼Œä¸€èˆ¬ç”¨ pdsh, parallel-ssh ä»€ä¹ˆçš„ææå®Œäº‹ï¼Œssh è¿æ¥æ…¢ä¸æ˜¯å¤ªå¤§é—®é¢˜ã€‚</li></ol><p>æ‰€ä»¥ä¸ªäººè§‰å¾— SaltStack å·ç§°é€Ÿåº¦å¿«æ²¡å¤ªå¤§æ„æ€ã€‚</p><p>ä¸Šé¢è¿™äº›éƒ½æ˜¯å°äº‹ï¼Œæœ€è®©æˆ‘ä¸èƒ½å¿çš„æ˜¯  SaltStack ä¸ç›´æ¥æ”¯æŒ role çš„æ¦‚å¿µï¼Œå®˜æ–¹æ–‡æ¡£æ¨èç”¨ grainï¼Œä½† grain é…ç½®ä»¥ minion  æœºå™¨ä¸Šçš„è®¾ç½®ä¸ºå‡†ï¼Œè¿™å°±æ¶æäº†å•Šï¼Œminion å¯ä»¥éšä¾¿å£°ç§°è‡ªå·±çš„è§’è‰²ï¼Œé‚£å²‚ä¸æ˜¯ä¹±å¥—äº†ï¼ å¦ä¸€ä¸ªåŠæ³•æ˜¯æŠŠ role å®šä¹‰ç”¨ pillar  ç®¡ç†ï¼Œpillar æ˜¯åœ¨ salt-master ä¸Šé…ç½®çš„ï¼Œä½† pillar æœ¬èº«æ˜¯è¦ç”¨ targeting æ¯”å¦‚ grain, IP ä¹‹ç±»çš„è·Ÿ  minion å…³è”çš„ï¼Œè¿™å°±æˆäº†é¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡çš„çŸ›ç›¾äº†ã€‚ æˆ–è®¸æœ‰äººæåˆ° nodegroup åŠŸèƒ½å¾ˆæ¥è¿‘ï¼Œä½†è¿™ä¸ªåŠŸèƒ½è¦åœ¨  /etc/salt/master æ–‡ä»¶é‡Œé…ç½®ï¼Œæ¯æ¬¡æ”¹è¦é‡å¯ salt-masterï¼Œè¿™å¤ªäºŒé€¼äº†ï¼</p><p>å¦å¤– SaltStack çš„ minion å’Œ master ä¹‹é—´å®¹æ˜“å‡ºç°æ€§èƒ½é—®é¢˜ï¼Œæœ‰äººæ±‡æŠ¥è¿‡ï¼Œ<a href=\"https://link.zhihu.com/?target=https%3A//docs.saltstack.com/en/latest/topics/tutorials/intro_scale.html\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">è§£å†³åŠæ³•è™½ç„¶æœ‰</a>ï¼Œä½†ä¸€ä¸ªå·¥å…·éƒ½è¦è°ƒä¼˜è¿™ç§äº‹å¾ˆè®¨äººåŒå•Šï¼<br/></p><p>è™½ç„¶èŠ±äº†ä¸¤å¤©æ—¶é—´ï¼Œé…ç½®äº†ä¸€å°æ®µ saltï¼Œæœ€åå†³å®šè¿˜æ˜¯ç‹ ä¸‹å¿ƒæ¥æŠ›å¼ƒ SaltStack äº†ï¼Œçšˆä¾ Ansible å§ï¼Œå”‰ï¼Œæœ¬æ¥è¿˜æœ‰ç‚¹çœ¼é¦‹ SaltStack å¼€æºçš„é‚£ä¸ª web UI haliteï¼Œè¿˜æ²¡ç©è¿‡å‘¢ã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }, 
                {
                    "tag": "saltstack", 
                    "tagLink": "https://api.zhihu.com/topics/19841482"
                }
            ], 
            "comments": [
                {
                    "userName": "willww64", 
                    "userLink": "https://www.zhihu.com/people/0294d2d0861a3c92ed20f0abeb90ebab", 
                    "content": "<p>ansible ç”¨äº†å¿« 3 å¹´äº†ï¼Œä¹Ÿç®—æ˜¯æœ‰ç»éªŒçš„è€æ‰‹äº†ã€‚æ„Ÿè§‰è¿™ç§ç”¨ yaml å£°æ˜å¼çš„ä¸œè¥¿ï¼Œè™½ç„¶ä¸€å¼€å§‹ç®€å•ï¼Œä½†å†™äº›å¤æ‚çš„ä¸œè¥¿è¿˜æ˜¯å¾ˆå¤æ‚çš„ä¸ç›´è§‚å®¹æ˜“å‡ºé”™ï¼Œä¸€å¼€å§‹ä¸ç†Ÿæ‚‰çš„è¯éœ€è¦å„ç§ç¿»æ–‡æ¡£å„ç§æ”¹ï¼Œå„ç§ workaround å¼çš„ featureã€‚ç†Ÿæ‚‰çš„è¯ä¹Ÿä¸è§‰å¾—å†™èµ·æ¥ç®€å•ã€‚loop / when ä»€ä¹ˆçš„è¿˜ä¸å¦‚ç›´æ¥ç”¨ for / if ç®€å•ç›´è§‚ã€‚æˆ‘å€’æ˜¯æƒ³å­¦å­¦ Chef è¿™ç§ï¼Œå¥ˆä½•å¤©å¤©ä¸€å¤§å †äº‹æƒ…ä¸€å¤§å †è¦å­¦çš„ã€‚å¤§ä½¬ç†Ÿæ‚‰ ansible åå¯ä»¥æ¥åˆ†äº«ä¸€ä¸‹ ansible çš„ä¼˜ç¼ºç‚¹ã€‚</p>", 
                    "likes": 0, 
                    "childComments": []
                }, 
                {
                    "userName": "718097281", 
                    "userLink": "https://www.zhihu.com/people/425be0e7391e5898bb42b1e846e3e1b4", 
                    "content": "<p>å¯èƒ½ä½ å¯¹saltæœ‰ä»€ä¹ˆè¯¯è§£</p>", 
                    "likes": 0, 
                    "childComments": []
                }, 
                {
                    "userName": "å¢è‰å‰‚", 
                    "userLink": "https://www.zhihu.com/people/57e69a27a15e95b594e114a638517230", 
                    "content": "saltå¯ä»¥åœ¨masterç«¯æ›´å…·ä¸»æœºåè‡ªå®šä¹‰grains æŠŠroleå†™åœ¨è¿™é‡Œé¢å°±å®Œäº‹äº†", 
                    "likes": 0, 
                    "childComments": []
                }
            ]
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50811580", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "ä¼ä¸šå†…éƒ¨ä¿¡æ¯èšåˆ", 
            "content": "<p>ã€è¿ç§»ã€‘ä¼ä¸šå†…éƒ¨ä¿¡æ¯èšåˆ</p><p>ä¿¡æ¯èšåˆæ˜¯ä¼ä¸šå†…éƒ¨éå¸¸éœ€è¦çš„ä¸œè¥¿ï¼ŒåŸºæœ¬æ‰€æœ‰å…¬å¸é‡Œå¤´ wikiã€ms wordã€gdocã€email, chat, bugs,<br/>file sharingï¼Œå„ç§ä¿¡æ¯æ•£ä¹±å››å¤„ã€‚ä¸‹é¢ç®€å•ç½—åˆ—å‡ ä¸ªå…¬å¸é‡Œå¤´å¸¸ç”¨çš„ä¿¡æ¯ç®¡ç†ç³»ç»Ÿã€‚</p><p>Seafile è·Ÿ Dropbox ç±»ä¼¼ï¼Œå…±äº«æ–‡æ¡£ï¼Œæ­¤å¤–è¿˜å¯ä»¥ç¾¤ç»„è®¨è®ºã€‚</p><p>Jive  ç±»ä¼¼äºèåˆäº†ç¤¾äº¤å…ƒç´ ä»¥åŠ twiki çš„ multi site ç‰¹æ€§çš„ Drupalï¼Œå‚ä¸è€…å¯ä»¥ follow ä¸€ä¸ªä¸»é¢˜ï¼Œfollow  ä¸€ä¸ªäººï¼Œå¤§å®¶å¯ä»¥æé—®ï¼Œå†™æ–‡æ¡£ï¼Œå†™åšå®¢ï¼ŒæŠ•ç¥¨ç­‰ç­‰ï¼Œæ‰€è§å³æ‰€å¾—çš„ç¼–è¾‘æ–¹å¼ï¼Œå¯ä»¥ç”¨ &#34;@&#34; éªšæ‰°åˆ«äººã€‚æ²¡æœ‰ä¿¡æ¯èšåˆåŠŸèƒ½ã€‚ä¸ªäººè§‰å¾—ä½¿ç”¨ä½“éªŒä¸æ€ä¹ˆæ ·ã€‚</p><p>Yammer æ˜¯ Jive çš„ç«äº‰å¯¹æ‰‹ï¼Œè¢«å¾®è½¯æ”¶è´­äº†ã€‚åŠŸèƒ½ä¸Šè·Ÿ Jive ä¹Ÿå¾ˆåƒï¼Œä¹Ÿæ²¡åšä¿¡æ¯èšåˆï¼Œå®ƒæŒ‡æœ›ç”¨æˆ·åªç”¨<br/>å®ƒä¸€ä¸ªç³»ç»Ÿã€‚</p><p>HipChat æ˜¯ä¸€ä¸ª IM å·¥å…·ï¼Œå•èŠï¼Œç¾¤èŠï¼Œ@ æé†’ï¼Œé™„ä»¶ï¼Œè§†é¢‘èŠå¤©ç­‰ç­‰ï¼Œæœ€å¤§å–ç‚¹æ˜¯èŠå¤©è®°å½•é•¿ä¹…ä¿å­˜ï¼Œå¯ä»¥æœç´¢ã€‚</p><p>OwnCloud æ˜¯ä¸ªæ–‡ä»¶å…±äº«çš„èšåˆå·¥å…·ï¼Œæ–‡ä»¶å¯ä»¥å­˜æ”¾åœ¨ä»»ä½•åœ°æ–¹ï¼Œæ¯”å¦‚ Jive, SharePoint, NFS, SMB, Dropbox, FTPã€‚</p><p>Slack çš„åŸå‹æ˜¯ IRCï¼Œç”¨æˆ·æŠŠå„ç§ä¿¡æ¯poståˆ° IRC çš„èŠå¤©å®¤é‡Œï¼Œè¿™å°±è¾¾åˆ°ä¿¡æ¯èšåˆçš„ç›®çš„ã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50811563", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 12, 
            "title": "å…³äºä¼ä¸šçº§æ— çº¿ç½‘ç»œéƒ¨ç½²æ–¹æ¡ˆ", 
            "content": "<p>ã€è¿ç§»ã€‘å…³äºä¼ä¸šçº§æ— çº¿ç½‘ç»œéƒ¨ç½²æ–¹æ¡ˆ</p><p>ä»¥å‰åªäº²æ‰‹ç©è¿‡å®¶ç”¨æ— çº¿è·¯ç”±ï¼Œå¯¹å…¬å¸é‡Œæ— çº¿æ€ä¹ˆéƒ¨ç½²çš„æ¯«ä¸çŸ¥æƒ…ï¼Œè¿™ä¸¤å¤©ç”°æ˜¥å†°æ²³åŒå­¦åœ¨å¾®åšä¸Šå…¬å¼€äº†å…¶ 2010 å¹´åº•<a href=\"https://link.zhihu.com/?target=http%3A//vdisk.weibo.com/s/qFP9Ntw_UVuC/1398398218\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">ä¸ºç½‘æ˜“è°ƒç ”æ— çº¿éƒ¨ç½²æ–¹æ¡ˆçš„æŠ¥å‘Š</a>ï¼Œç”±æ­¤å‘ç°è¿™é‡Œå¤´é“é“å¾ˆå¤šï¼Œå®Œå…¨é¢ è¦†äº†æˆ‘é‚£ç‚¹æµ…è–„çš„å®¶ç”¨æ— çº¿è·¯ç”±éƒ¨ç½²çŸ¥è¯†ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>æ— çº¿ç½‘ç»œé‡Œæœ€åŸºæœ¬çš„ç¡¬ä»¶è®¾å¤‡æ˜¯ Wireless Access Pointï¼Œç®€ç§° APï¼ŒAP å°±åƒç½‘æ¡¥ï¼ŒæŠŠæ— çº¿ç½‘ã€æœ‰çº¿ç½‘æˆ–è€…æ— çº¿ç½‘ã€æ— çº¿ç½‘è¿æ¥èµ·æ¥ï¼ŒAP åˆ†ä¸¤ç§ï¼š</p><ul><li>èƒ–AP(fat AP, standalone AP, autonomous AP)</li><li>ç˜¦AP(fit AP, lightweight AP, controller-based AP)</li></ul><p>å…¶å®è¯´èƒ–ç˜¦å¹¶ä¸åˆé€‚ï¼Œä»ç¡¬ä»¶ä»¥åŠè½¯ä»¶ä¸Šåè€…ä¹Ÿå¯ä»¥å¾ˆä¸°å¯Œï¼Œåªæ˜¯åœ¨éƒ¨ç½²ä¸Šæœ‰åŒºåˆ«ï¼Œæœ¯è¯­  standalone  or autonomous AP vs.  controller-based AP  æ‰æ˜¯æœ€æ°åˆ‡çš„ï¼Œä»åç§°ä¸Šå¾ˆæ¸…æ¥šï¼Œå‰è€…æŒ‡å¤šä¸ª AP ä¹‹é—´æ²¡æœ‰å…³è”ï¼Œåè€…æŒ‡å¤šä¸ª AP å—ä¸€ä¸ªå•ç‹¬çš„ç¡¬ä»¶çš„æˆ–è€…è½¯ä»¶çš„ Wireless LAN  Controller ç»Ÿä¸€é…ç½®å’Œç®¡ç†ï¼Œæœ‰ WLC å controller-based AP  å¯ä»¥åªåšå°„é¢‘ä¿¡å·çš„æ”¶å‘ï¼ŒæŠŠè®¤è¯ã€ä¿¡é“åŠ å¯†è§£å¯†å’Œè½¬å‘å…¨äº¤ç»™ WLCï¼Œä½†ä¹Ÿå¯ä»¥APè‡ªå·±åšè®¤è¯ï¼ˆå½“æ— æ³•è”é€š WLC  æ—¶ï¼‰ã€ä¿¡é“åŠ å¯†è§£å¯†å’Œè½¬å‘ï¼ˆå‡è½»WLCå‹åŠ›ï¼Œä¹Ÿé¿å…WLCå’ŒAPä¹‹é—´è·¨åœ°åŒºæ—¶æ— è°“çš„ä¸­è½¬æµé‡ï¼Œè¿™ä¸ªç‰¹æ€§å« local  switchingï¼‰ã€‚é¡ºå¸¦è¯´ä¸€å¥ï¼Œå®¶ç”¨æ— çº¿è·¯ç”±æ˜¯åœ¨ AP çš„åŸºç¡€ä¸Šé›†åˆäº†é›†çº¿å™¨ã€è·¯ç”±ç”šè‡³åº”ç”¨å±‚çš„ DHCPã€FTPã€VOD  ç­‰ä¼—å¤šæœåŠ¡ï¼Œå¹¶ä¸æ˜¯çº¯ç²¹çš„ APï¼Œåœ¨å®¶åº­æ— çº¿ç½‘é‡Œä¸€èˆ¬åªéœ€è¦æ— çº¿è·¯ç”±å†…ç½®çš„ä¸€ä¸ª APï¼Œæ‰€ä»¥ä¹Ÿä¸éœ€è¦å…³å¿ƒæ— çº¿æ§åˆ¶å™¨äº†ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>åœ¨ä¼ä¸šç¯å¢ƒé‡Œï¼ŒåŠå…¬é¢ç§¯ä¸€èˆ¬å¾ˆå¤§ï¼Œå•ä¸ª AP çš„ä¿¡å·è¦†ç›–ä¸äº†ï¼Œæ‰€ä»¥éœ€è¦å¤šä¸ª AP ä¸€èµ·æä¾›æœåŠ¡ï¼Œè¿™æ ·å°±å¸¦æ¥ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>å¤šä¸ª AP å¦‚ä½•ç»Ÿä¸€é…ç½®</li><ul><li>æ‰‹åŠ¨ç™»å½•æ¯ä¸ª AP çš„Webç®¡ç†ç•Œé¢é€ä¸€é…ç½®</li><li>ç”¨ä¸€ä¸ªç®¡ç†è½¯ä»¶é…ç½®å¥½ç„¶ååˆ†å‘åˆ°å¤šä¸ª  AP ä¸Šï¼Œè¿™è·Ÿ PC ä¸Šä½¿ç”¨ Puppet/Chef ä¹‹ç±»çš„é…ç½®ç®¡ç†å·¥å…·å¾ˆç±»ä¼¼ã€‚è¦é›†ä¸­ç®¡ç† AP è‡ªç„¶éœ€è¦ç®¡ç†ç«¯å’Œ AP  ä¹‹é—´æœ‰æ ‡å‡†åè®®ï¼Œè€Œä¸æ˜¯ hack å„å®¶çš„ Web ç®¡ç†ç•Œé¢ï¼Œå‘äº› http  è¯·æ±‚æ¨¡æ‹Ÿç½‘é¡µäº¤äº’ã€‚éµå¾ªä¸šç•Œæƒ¯ä¾‹ï¼Œæ ‡å‡†çš„æœ€å¤§å¥½å¤„æ˜¯ä¸åªä¸€ä¸ªæ ‡å‡†ï¼Œè¿™é‡Œçš„ç®¡ç†åè®®æœ€å¸¸è§çš„æœ‰ä¸¤ç§ï¼š</li><ul><li>LWAPP: Lightweight Access Point Protocol</li><li>CAPWAP: Control And Provisioning of Wireless Access Points Protocol<br/></li></ul></ul><li>ç§»åŠ¨è®¾å¤‡åœ¨å¤šä¸ª AP ä¹‹é—´æ€ä¹ˆæ¼«æ¸¸</li></ul><p>Cisco  çš„ä¸œè¥¿æˆ‘ç›¸ä¿¡ç¡®å®æ˜¯ä¸€åˆ†é’±ä¸€åˆ†è´§ï¼Œä½†æˆ‘è¿˜æ˜¯æœ‰ç‚¹æ€€ç–‘é‡‡è´­äºŒåä¸‡äººæ°‘å¸çš„ç¡¬ä»¶ Cisco WLC 5508çš„å¿…è¦æ€§ã€‚åœ¨ WLC å’Œ AP  ä¹‹é—´æœ‰ä¸¤ç§æµé‡ï¼šæ§åˆ¶æµé‡ï¼ŒæŒ‡å„ç§é…ç½®ã€æ§åˆ¶ã€çŠ¶æ€æŠ¥å‘Šæµé‡ï¼›æ•°æ®æµé‡ï¼ŒæŒ‡ç§»åŠ¨è®¾å¤‡è®©APä»£ä¸ºè½¬å‘çš„ç”¨æˆ·æµé‡ã€‚æˆ‘ç›¸ä¿¡æ—©æœŸçš„ç˜¦APæ–¹æ¡ˆæ˜¯è®© WLC  åšè®¤è¯å’Œä¿¡é“åŠ å¯†è€ŒAPæ´»å„¿å¾ˆç®€å•ï¼Œåªæ˜¯æ”¶å‘æ— çº¿ä¿¡å·ï¼Œè¡¨ç°çš„åƒå¤©çº¿ä¸€æ ·ï¼Œè¿™ç§ææ³•ç¼ºç‚¹æ˜¯å¾ˆæ˜æ˜¾çš„ï¼ŒWLC å‹åŠ›å¤ªå¤§ï¼Œéœ€è¦é«˜é…ç½®çš„å®šåˆ¶ç¡¬ä»¶ï¼Œå½“ WLC  å’Œ AP ä¸åœ¨ä¸€ä¸ªåŸå¸‚æ—¶ï¼Œæ¯”å¦‚WLCåœ¨æ­å·ï¼ŒAP  åœ¨åŒ—äº¬ï¼Œé‚£ä¹ˆåŒ—äº¬åŠå…¬å®¤å†…éƒ¨çš„æµé‡è¿˜è¦å»æ­å·ç»•ä¸€åœˆï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸åˆ’ç®—çš„ã€‚æ‰€ä»¥å®é™…ä¸€ç‚¹çš„ç˜¦APæ–¹æ¡ˆæ˜¯ WLC åªåšç»Ÿä¸€é…ç½®ã€æ§åˆ¶ã€è®¤è¯ï¼ŒAP  è‡ªå·±åšä¿¡é“åŠ å¯†è§£å¯†ï¼Œè€ƒè™‘åˆ°WLCå’ŒAPä¹‹é—´æœ‰æ—¶è¿æ¥æ–­æ‰ï¼ŒAP æœ¬èº«ä¹Ÿè¦æœ‰è®¤è¯åŠŸèƒ½ï¼Œè¿™æ—¶ï¼Œå«ç˜¦APå·²ç»ä¸åˆé€‚äº†ï¼ŒCisco æ–‡æ¡£é‡Œç§°ä¹‹ä¸º  controller-based APï¼Œè¿™ç§æ–¹æ¡ˆä¸‹ WLC çš„çš„æ´»å„¿å¾ˆè½»æ¾ï¼Œç”¨è½¯ä»¶ WLC å³å¯ï¼ŒCisco ä¹Ÿç¡®å®æä¾›<a href=\"https://link.zhihu.com/?target=http%3A//www.cisco.com/c/en/us/products/wireless/virtual-wireless-controller/index.html\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">çº¯è½¯ä»¶ç‰ˆçš„ WLC</a>(æ³¨æ˜é€‚ç”¨äº<a href=\"https://link.zhihu.com/?target=http%3A//www.cisco.com/c/en/us/products/wireless/buyers-guide.html%23~controllers\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">ä¸­å°ä¼ä¸š</a>)ï¼Œå¦ä¸€ä¸ªå¾ˆç«çš„æ— çº¿è§£å†³æ–¹æ¡ˆ <a href=\"https://link.zhihu.com/?target=http%3A//www.ubnt.com/unifi\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">UniFi</a> å°±å‹æ ¹æ²¡æœ‰ç¡¬ä»¶ç‰ˆçš„ WLCã€‚<br/></p><p>å¦ä¸€ä¸ªé—®é¢˜æ˜¯æ— ç¼æ¼«æ¸¸(seamless roaming, zero handoff roaming)ï¼Œæ‰€è°“æ— ç¼æ¼«æ¸¸æ˜¯æŒ‡ç§»åŠ¨è®¾å¤‡åœ¨ä¸¤ä¸ªæœ‰é‡å çš„APä¿¡å·è¦†ç›–åŒºé—´ç§»åŠ¨æ—¶ä¸ä¼šå› åˆ‡æ¢APè€Œä¸¢åŒ…ç”šè‡³æ–­ç½‘ã€‚</p><p>éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œæ¼«æ¸¸æ€»æ˜¯è¢«ç§»åŠ¨è®¾å¤‡è§¦å‘çš„ï¼Œç§»åŠ¨è®¾å¤‡åœ¨å‘ç°å½“å‰ AP çš„ä¿¡å·ä½åˆ°ä¸€å®šç¨‹åº¦ã€ä¸¢åŒ…ç‡åˆ°ä¸€å®šç¨‹åº¦åå°±ä¼šå¼€å§‹æ‰«ææ–°çš„æ— çº¿ç½‘ç»œå¹¶åˆ‡æ¢è¿‡å»ï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦é‡æ–°è®¤è¯å¹¶ä¸æ–°çš„APå»ºç«‹ç»‘å®šï¼Œåœ¨é“¾è·¯å±‚ä¼šèŠ± 50~500msï¼Œåœ¨ç½‘ç»œå±‚ä¼šå¯¼è‡´äº”ç§’å·¦å³çš„åœé¡¿ã€‚</p><p><a href=\"https://link.zhihu.com/?target=https%3A//www.hometoys.com/article/2012/04/demystifying-wi-fi-roaming-what-you-need-to-know-to-avoid-costly-mistakes/1812/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Demystifying Wi-Fi Roaming: What You Need to Know to Avoid Costly Mistakes</a> è¿™ç¯‡æ–‡ç« è®²è§£çš„å¾ˆæ¸…æ™°ã€‚AP ä¹‹é—´è¿ç§»æœ‰ä¸¤ç§æ¨¡å¼ï¼š</p><ul><li>å¤šä¸ª AP ä½¿ç”¨ç›¸åŒ SSIDï¼Œç›¸åŒè®¤è¯æ–¹å¼ï¼Œä¸åŒä¿¡é“ï¼Œä¸åŒMACåœ°å€ã€‚è¿™ç§æ–¹å¼æ˜¯ç½‘ä¸Šèµ„æ–™æè¿°æœ€å¤šçš„ä¸€ç§ï¼Œæ¼«æ¸¸è¢«ç§»åŠ¨è®¾å¤‡è§¦å‘ï¼Œæ‰«æSSIDå¹¶é‡æ–°è®¤è¯ã€‚Cisco çš„æ— çº¿è§£å†³æ–¹æ¡ˆæ”¯æŒå„ç§ <a href=\"https://link.zhihu.com/?target=http%3A//www.cisco.com/c/en/us/support/docs/wireless-mobility/wireless-lan-wlan/116493-technote-technology-00.html\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">fast-secure roaming</a> æŠ€æœ¯ä»¥åŠ å¿«è¿™ä¸ªé‡æ–°è®¤è¯è¿‡ç¨‹: CCKM(åœ¨ WLC ä¸Šç¼“å­˜ä¼šè¯ç§˜é’¥ï¼Œç›´æ¥è·³è¿‡ EAP è®¤è¯å’Œ WPA2 4-way handshake) ï¼ŒPMKID Caching(åœ¨<b>è¿æ¥è¿‡</b>çš„APä¸Šç¼“å­˜ä¼šè¯ç§˜é’¥),  Proactive Key Caching(WLCä¸ºæ‰€æœ‰APç¼“å­˜ä¼šè¯ç§˜é’¥), 802.11r(Fast BSS  Transition)ï¼Œè¿™äº›éƒ½éœ€è¦ç§»åŠ¨è®¾å¤‡çš„æ”¯æŒã€‚ä½†è¿™ä¹ˆåšåªæ˜¯åŠ å¿«æ¼«æ¸¸ï¼Œå¹¶æ²¡æœ‰æ¶ˆé™¤æ¼«æ¸¸ï¼Œç”±äºæ¼«æ¸¸è¿‡ç¨‹æ˜¯è¢«ç§»åŠ¨è®¾å¤‡æ§åˆ¶ï¼Œæ‰€èŠ±æ—¶é—´è·Ÿç§»åŠ¨è®¾å¤‡çš„æ— çº¿ç®¡ç†ç¨‹åºã€ç½‘ç»œä¸­  SSID ä¸ªæ•°æœ‰å…³ï¼Œè¿™ä¸ªè¿‡ç¨‹æ€»æ˜¯ä¼šå¯¼è‡´é“¾è·¯å±‚æ•°æ®åŒ…ä¸¢å¤±ï¼Œä»è€Œä¼ è¾“å±‚çš„æ•°æ®åŒ…ä¸¢å¤±ï¼šUDP ä¸¢åŒ…ï¼ŒTCP  é‡ä¼ æ•°æ®åŒ…ã€‚å¦‚æœæ²¡æœ‰è®¤è¯ä¿¡æ¯ç¼“å­˜æŠ€æœ¯ï¼Œè¿™ç§æ¼«æ¸¸ä¼šæ˜æ˜¾å½±å“æ— çº¿è¯­éŸ³ã€è§†é¢‘åº”ç”¨ï¼Œä¸¥æ ¼æ¥è¯´è°ˆä¸ä¸Šæ— ç¼æ¼«æ¸¸ã€‚</li><li>å¤šä¸ª AP ä½¿ç”¨ç›¸åŒ  SSIDï¼Œç›¸åŒè®¤è¯æ–¹å¼ï¼Œç›¸åŒä¿¡é“ï¼Œç›¸åŒMACåœ°å€ã€‚æ‰€æœ‰ AP  è¡¨ç°çš„åƒä¸€ä¸ªä¿¡å·è¦†ç›–èŒƒå›´å¾ˆå¹¿çš„å•ä¸€APï¼Œè¿™è¢«ç§°ä¸ºæ— çº¿ç½‘è™šæ‹ŸåŒ–ã€‚ç‰©ç†APä¹‹é—´çš„è¿ç§»æ˜¯è¢«WLCè§¦å‘çš„ï¼ŒAP ä¸æ–­çš„å‘ WLC  æ±‡æŠ¥æŸä¸ªç§»åŠ¨è®¾å¤‡çš„ä¿¡å·å¼ºåº¦ï¼ŒWLC  æ§åˆ¶åœ¨ä»€ä¹ˆæ—¶åˆ»é€‰æ‹©æŸä¸ªAPä¸ºè¿™ä¸ªç§»åŠ¨è®¾å¤‡æœåŠ¡ï¼Œè¿™ä¸ªè¿‡ç¨‹è‡ªç„¶ä¹Ÿéœ€è¦WLCåˆ†å‘è®¤è¯ä¿¡æ¯åˆ°å„ä¸ªAPï¼Œä½†å…³é”®çš„æ˜¯ä¸éœ€è¦ç§»åŠ¨è®¾å¤‡åšAPåˆ‡æ¢ï¼Œå®é™…ä¸Šç§»åŠ¨è®¾å¤‡æ²¡æœ‰è§¦å‘æ¼«æ¸¸ï¼Œèƒ½æ„Ÿå—åˆ°çš„åªæ˜¯ä¿¡å·å¼±äº†ç‚¹ç„¶ååˆæ¢å¤äº†ï¼Œé“¾è·¯å±‚ä¸Šæ²¡æœ‰æ•°æ®åŒ…ä¸¢å¤±ï¼Œè¿™æ‰æ˜¯çœŸæ­£çš„  seamless roaming, zero handoff roamingï¼Œzero handoff  æ˜¯æŒ‡ä»ç§»åŠ¨è®¾å¤‡ç«¯çœ‹æ¥æ²¡æœ‰å‘ç”ŸAPåˆ‡æ¢ã€‚æ— çº¿ç½‘è™šæ‹ŸåŒ–çœ‹èµ·æ¥å¾ˆç¾å¥½ï¼Œä½†ä¹Ÿæ˜¯æœ‰å…¶ç¼ºé™·çš„ï¼Œç”±äºæ‰€æœ‰APä½¿ç”¨ç›¸åŒä¿¡é“ï¼Œä¼šå¯¼è‡´ä¿¡å·è¦†ç›–é‡å åŒºåŸŸçš„å¸¦å®½æ‰“æŠ˜æ‰£ã€‚Unifi  Wireless Controller Software 3.x æ”¯æŒ zero handoff roaming,  Cisco  çš„äº§å“æ²¡æœ‰è¿™ä¸ªç‰¹æ€§ã€‚<br/></li></ul><p class=\"ztext-empty-paragraph\"><br/></p><p>BTW, ä¸Šé¢æåˆ° WLC  åšè®¤è¯ä¿¡æ¯ç¼“å­˜ã€è°ƒåº¦APåˆ‡æ¢ï¼Œè¿™äº›äº‹æƒ…ä¹Ÿå¯ä»¥åœ¨APç«¯åšï¼Œå¤šä¸ªAPä¹‹é—´é€‰ä¸¾ä¸€ä¸ª &#34;domain controller AP&#34; æˆ–è€… P2P  æ–¹å¼ï¼Œæ­¤æ—¶ WLC é™¤äº†é›†ä¸­é…ç½®ã€ç›‘ç®¡å°±æ²¡å•¥å…¶å®ƒäº‹äº†ï¼ŒAPè¿ä½œæ—¶ç”šè‡³å¯ä»¥å…³æ‰ WLCï¼Œè²Œä¼¼ UniFi å°±è¿™ä¹ˆæçš„(ä¸æ¸…æ¥šæ˜¯ domain  controller AP æ–¹å¼è¿˜æ˜¯ P2P æ–¹å¼)ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ç¨èŠä¸€ä¸‹ä¼ä¸šçº§æ— çº¿ç½‘ç»œé‡Œçš„è®¤è¯é—®é¢˜ã€‚WPA åˆ†ä¸º WPA  Personal(WPA-PSK, pre-shared key) å’Œ WPA Enterprise(ä¸€èˆ¬ä¹Ÿç®€ç§°ä¸º  WPA)ï¼Œå‰è€…æ˜¯å®¶ç”¨æ— çº¿è·¯ç”±ä¸Šå¸¸ç”¨çš„æ–¹å¼ï¼Œæ‰€æœ‰äººç”¨ä¸€ä¸ªå…±äº«ç§˜é’¥åšè®¤è¯ï¼Œé—®é¢˜æ˜¯æ— æ³•å®¹æ˜“çš„åŒºåˆ†åˆ°åº•æ˜¯å“ªä¸ªç”¨æˆ·åœ¨ä½¿ç”¨æ— çº¿ç½‘ã€‚WPA  Enterprise ä½¿ç”¨ EAP è®¤è¯æ¡†æ¶åè®®åšè®¤è¯ï¼ŒçœŸæ­£çš„è®¤è¯è¿‡ç¨‹ä¸€èˆ¬ä¼šç”¨ RADIUS åè®®äº¤ç»™ WLC æˆ–è€… FreeRADIUS  æœåŠ¡ã€‚EAP è®¤è¯æ¡†æ¶åè®®åŒ…å«å¾ˆå¤š EAP methodï¼Œå¥½æ¯” SASL æ¡†æ¶å®¹çº³å¤šç§è®¤è¯åè®®ä¼¼çš„ã€‚æœ‰çš„ EAP method  æ²¡æœ‰è€ƒè™‘ä¼ è¾“åŠ å¯†é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªå°è£…åè®®å®‰å…¨çš„ä¼ è¾“è®¤è¯æŠ¥æ–‡ã€‚å¸¸è§çš„ EAP method:</p><ul><li>EAP-TLS:  ä½¿ç”¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ X509 è¯ä¹¦åšäº’ç›¸è®¤è¯ï¼Œç”±äºéœ€è¦å®¢æˆ·ç«¯è¯ä¹¦ï¼Œæ‰€ä»¥éƒ¨ç½²æ¯”è¾ƒéº»çƒ¦ã€‚å¦ä¸€ä¸ªé—®é¢˜æ˜¯å®¢æˆ·ç«¯è¯ä¹¦ä¼ ç»™æœåŠ¡å™¨æ—¶æ²¡æœ‰åŠ å¯†ï¼Œä¼šæš´éœ²ç”¨æˆ·IDï¼Œè§£å†³åŠæ³•æ˜¯ç»“åˆ EAP-TTLS æˆ–è€… PEAP ä½¿ç”¨ã€‚<br/></li><li>EAP-TTLS  + PAP: EAP-TTLS ä½¿ç”¨æœåŠ¡ç«¯X509è¯ä¹¦è®¤è¯æœåŠ¡ç«¯ï¼ŒåŒæ–¹å»ºç«‹ TLS  è¿æ¥åå†è¿›ä¸€æ­¥è®¤è¯å®¢æˆ·ç«¯ï¼Œè¿™ä¸ªç¬¬äºŒé˜¶æ®µè®¤è¯å¯ä»¥ç”¨ä»»ä½•è®¤è¯æ–¹æ³•ï¼ŒåŒ…æ‹¬é EAP methodã€‚PAP æ˜¯ Password  Authentication Protocolçš„ç¼©å†™ï¼Œä¼ æ˜æ–‡å¯†ç åˆ°æœåŠ¡ç«¯ã€‚</li><li>PEAP + EAP-MSCHAPv2: PEAP è·Ÿ  EAP-TTLS ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å»ºç«‹ä¸€ä¸ª TLS è¿æ¥å†è®¤è¯å®¢æˆ·ç«¯ï¼ŒåŒºåˆ«åœ¨äºç¬¬äºŒé˜¶æ®µçš„åè®®ä¸ä¸€æ ·ï¼ŒPEAP åªå…è®¸ä½¿ç”¨ EAP  methodã€‚è¿™ä¸ªç»„åˆæ˜¯è¢«å„ç§ç§»åŠ¨è®¾å¤‡ã€æ“ä½œç³»ç»Ÿæœ€å¹¿æ³›æ”¯æŒçš„ï¼Œç¼ºé™·æ˜¯ MSCHAPv2 è¦æ±‚å¯†ç åœ¨æœåŠ¡ç«¯ä»¥ä¸é‚£ä¹ˆå®‰å…¨çš„ ntlm_hash  æ–¹å¼ä¿å­˜ã€‚<br/></li><li>PEAP + EAP-GTC:  Cisco åˆ›å»ºç”¨æ¥æ›¿ä»£ PEAP + EAP-MSCHAPv2ï¼Œæ›´çµæ´»ï¼Œå…è®¸å¯†ç åœ¨æœåŠ¡ç«¯ä»¥å¤šç§å½¢å¼å­˜å‚¨ï¼š<a href=\"https://link.zhihu.com/?target=http%3A//deployingradius.com/documents/protocols/compatibility.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">deployingradius.com/doc</span><span class=\"invisible\">uments/protocols/compatibility.html</span><span class=\"ellipsis\"></span></a></li><li>EAP-FAST: Cisco åˆ›å»ºç”¨æ¥æ›¿ä»£ LEAP</li><li>LEAP: ä¿®æ”¹ç‰ˆçš„ MSCHAPï¼Œå±äºæ—§åè®®ï¼Œä¸æ¨èä½¿ç”¨ã€‚<br/></li></ul><p class=\"ztext-empty-paragraph\"><br/></p><p>æœ€ååˆ—å‡ ä¸ªæ— çº¿æ–¹æ¡ˆæä¾›å•†ï¼Œè¯´ä¸å®šå“ªå¤©ç”¨çš„ä¸Šï¼š</p><ul><li>Cisco</li><li>Aruba</li><li>Ruckus</li><li>HP<br/></li><li>NetGear</li><li>UniFi<br/></li><li>Aerohive</li></ul>", 
            "topic": [
                {
                    "tag": "æ— çº¿ç½‘ç»œ", 
                    "tagLink": "https://api.zhihu.com/topics/19554922"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50811513", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 5, 
            "title": "ã€Šæ·˜å®æŠ€æœ¯è¿™åå¹´ã€‹è¯»åæ„Ÿ", 
            "content": "<p>ã€è¿ç§»ã€‘ã€Šæ·˜å®æŠ€æœ¯è¿™åå¹´ã€‹è¯»åæ„Ÿ</p><p>èŠ±äº†ä¸¤å¤©æ—¶é—´æ‰«äº†ä¸‹ï¼Œåé¢çš„åˆ—ä¼ æ²¡ä»”ç»†çœ‹ï¼Œæ•´ä¸ªçš„æ–‡é£å°±æ˜¯ä¸ª BBS å…«å¦ä½“ï¼Œå†™çš„å¾ˆæœ‰è¶£å‘³ï¼Œå¯¹äº’è”ç½‘ä»ä¸šäººå‘˜ä¹Ÿå¾ˆæœ‰å¯å‘æ€§ï¼Œæ˜¯æœ¬å¥½ä¹¦ã€‚ä¸‹é¢è®°å½•ä¸‹ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„æ€ç»ªã€‚</p><p>æ·˜å®ä¸€å¼€å§‹åˆ›ä¸šçš„æŠ€æœ¯å¹¶ä¸é«˜æ˜ï¼Œè™½ç„¶æœ‰å¾ˆå¤šç‰›äººï¼Œä½†æ„Ÿè§‰ä¹Ÿåªæ˜¯å¾ˆå‹¤å¥‹è€Œå·²ï¼ˆä¸ªäººè§‰å¾—ç”šè‡³æœ‰ç‚¹çŸ¬ï¼Œæ¯”å¦‚é‚£ä¸ªé‡å¯  sql relay çš„æ´»å„¿ï¼Œå“¥å•Šï¼Œä½ ä»¬çœŸçš„æ²¡æ•´ä¸ªè‡ªåŠ¨ç›‘æµ‹å¹¶é‡å¯çš„è„šæœ¬ï¼Ÿå¦ä¸€ä¸ªä¾‹å­æ˜¯æ²¡æå®š php  çš„æ•°æ®åº“è¿æ¥æ± ï¼‰ï¼Œæ²¡æå‡ºå•¥â€œçº¯æŠ€æœ¯â€ä¸Šçš„å¤§åå ‚ã€‚æˆåŠŸå…³é”®è¿˜åœ¨äºé©¬äº‘çš„å•†ä¸šå¤´è„‘ï¼ŒæŠ“ä½å•†æœºã€‚è¿™å¹¶ä¸æ˜¯è¯´â€œæŠ€æœ¯é¡¶ä¸ªçƒâ€ï¼ŒæŠ€æœ¯è™½ç„¶ä¸æ˜¯ç¬¬ä¸€ï¼Œä½†ä¹Ÿä¸æ˜¯å€’æ•°ç¬¬ä¸€ã€‚</p><p>æ·˜å®å¼€å§‹çš„å¾ˆæ—©ï¼Œå¾ˆå¤šå¼€æºæŠ€æœ¯è¿˜æ²¡å‡ºç°æˆ–è€…ä¸è¢«äººæ‰€çŸ¥ï¼Œå¦‚æœä»Šå¤©å¼€å§‹åšçš„è¯ï¼Œå¯èƒ½æœ‰å¾ˆå¤šä¸œè¥¿ä¼šç›´æ¥æ‹¿æ¥ç”¨æˆ–è€…æ”¹è¿›äº†ï¼Œæ¯”å¦‚ memcacheï¼Œredis, voldemort, kafka, storm, thrift + twitter finagle.</p><p>ä¸€å¼€å§‹å¦‚æœèƒ½å¤šè€ƒè™‘ç‚¹å¯æ‰©å±•çš„æ¶æ„ï¼Œæ—¥åä¸€æ—¦å£®å¤§ï¼Œé‡æ„ä¼šä¸é‚£ä¹ˆç—›è‹¦ã€‚å…·ä½“å®ç°è§†æƒ…å†µæ‰“æŠ˜æ‰£ï¼Œç†æƒ³å®ç°æ˜¯å³ä½¿åœ¨å•æœºä¸Šä¹ŸæŒ‰ç…§åˆ†å¸ƒå¼åº”ç”¨æ€è·¯åšï¼Œä½†è‚¯å®šæ²¡åŠæ³•è¿™ä¹ˆç†æƒ³ï¼Œè¿›åº¦æ‰€è¿«ï¼Œäº§å“è®¾è®¡æ€»åœ¨å˜åŒ–ï¼Œéœ€æ±‚æ€»åœ¨å˜ã€‚æ— è®ºå¦‚ä½•ï¼Œä¸€å¼€å§‹å®Œå…¨ä¸è€ƒè™‘ä¸€å‘³æ±‚ç³™å¿«çŒ›æ˜¯æ„šè ¢çš„ï¼Œå¿½è§†ä¸šç•Œç»éªŒï¼Œå°¤å…¶æ˜¯è¿™æœ¬ä¹¦è®²åˆ°çš„ç»éªŒï¼Œæœ‰å¯èƒ½æ—¥åä¸­é“å´©æ®‚ã€‚</p><p>æŠ€æœ¯å¯¹äº†ï¼Œäº§å“è®¾è®¡å¯¹äº†ï¼Œæœªå¿…èƒ½æˆåŠŸï¼Œå› ä¸ºæ—¶æœºå¯èƒ½ä¸å¯¹ï¼Œç”¨æˆ·ä¸€æ—¶æ¥å—ä¸äº†ã€‚</p><p>å¥½çš„è®¾è®¡æ˜¯ç£¨ç»ƒå‡ºæ¥çš„ï¼Œå†å¥½çš„æ¶æ„å¸ˆä¹Ÿæ²¡æ³•ä¸€é”¤å®šéŸ³ï¼Œä¸€æ–¹é¢æ˜¯æµé‡ä¸Šæ¥åå„ç§æœªé¢„æ–™åˆ°çš„é—®é¢˜ï¼Œå¦ä¸€æ–¹é¢æ˜¯æ²¡æœ‰å®Œå…¨ä¸€æ¨¡ä¸€æ ·çš„éœ€æ±‚ï¼Œå„ç§æœªé¢„æ–™åˆ°çš„éœ€æ±‚ã€‚å³ä½¿å¦‚æ­¤ï¼Œäº’è”ç½‘è¡Œä¸šçš„ç³»ç»Ÿæ¶æ„è¿˜æ˜¯æœ‰ç²—ç•¥å¥—è·¯å¯å¾ªçš„ï¼Œå› ä¸ºåŒä¸€è¡Œä¸šå†…è¦è§£å†³çš„äº‹æƒ…æ€»æœ‰ç±»ä¼¼çš„ã€‚</p><p>å¯ä¾›å‚è€ƒçš„æŠ€æœ¯ï¼Œä¸å®Œå…¨æ˜¯ä¹¦ä¸­æåˆ°çš„ã€‚</p><ol><li>load balancing + high availability<br/></li></ol><ul><li>DNS server æ ¹æ®å®¢æˆ·ç«¯çš„ IP å¯¹åº”çš„åœ°ç†ä½ç½®å¯¹åŒä¸€åŸŸåè§£æå‡ºä¸åŒçš„ IP åœ°å€ï¼Œä»¥æŠŠç”¨æˆ·è¯·æ±‚å¯¼å‘ä¸åŒçš„æœºæˆ¿ï¼›</li><li>åœ¨é¡µé¢é‡ŒåµŒå…¥ä¸€æ®µ JS è„šæœ¬ï¼ŒåŒæ—¶è¯·æ±‚å¤šä¸ªæœºæˆ¿çš„æŸç›¸åŒèµ„æºï¼ŒæœåŠ¡ç«¯å¯ä»¥è®°å½•ä¸‹è¯·æ±‚æ—¥å¿—ï¼Œç„¶åç»ç”±åå°çš„æ—¥å¿—åˆ†æç³»ç»Ÿåˆ†æå‡ºè¿™ä¸ªå®¢æˆ·ç«¯è¯·æ±‚å“ªä¸ªæœºæˆ¿æœ€å¿«ï¼Œè¿™ä¸ªä¿¡æ¯å¯ä»¥ç”¨æ¥æ”¹è¿›ä¸Šé¢çš„ç¬¬ä¸€ç§åŠæ³•ï¼›</li><li>åœ¨åŸŸåè§£æå®Œæˆåï¼Œå®¢æˆ·ç«¯çš„è¯·æ±‚è¢«å‘é€åˆ°æŒ‡å®š  IP ä¸Šï¼Œè¿™ä¸ª IP ä¸Šéƒ¨ç½² LVS(å·¥ä½œåœ¨ OSI ç½‘ç»œæ¨¡å‹ç¬¬å››å±‚)ï¼ŒLVS åé¢éƒ¨ç½² HAProxy(å·¥ä½œåœ¨ OSI  ç½‘ç»œæ¨¡å‹ç¬¬ä¸ƒå±‚)ï¼Œä¸¤å±‚ä¸€èµ·åš load balancerï¼Œç»¼åˆ LVS çš„é«˜æ•ˆä»¥åŠ HAProxy çš„ä¸°å¯Œç‰¹æ€§ã€‚</li><ul><li>Apache å’Œ Nginx ä¹Ÿæœ‰ proxy åŠŸèƒ½ï¼Œä½†æœ¯ä¸šæœ‰ä¸“æ”»ï¼Œæµé‡ç‰¹åˆ«å¤§çš„æ—¶å€™æ•ˆç‡è‚¯å®šè¿˜æ˜¯æ¯”ä¸ä¸Š HAProxy<br/></li><li>å„ä½çœ‹å®˜ï¼Œè²Œä¼¼ä¸è¦ LVS ä¹Ÿè¡Œå§? HAProxy åŠ ä¸Š keepalived or pacemaker + corosync/heartbeat ä¹Ÿèƒ½é¿å…å•ç‚¹æ•…éšœã€‚</li></ul></ul><li>edge cache: Apache Traffic Server, Squid, Varnishï¼Œç”¨æ¥ç¼“å­˜é™æ€å†…å®¹æˆ–è€…ä¸€æ®µæ—¶é—´å†…ä¸å˜çš„åŠ¨æ€å†…å®¹</li><li>http server:  Nginx, Apache, Tomcat, Jetty</li><ul><li>åœ¨å±•ç°å±‚ä¸Šå…ä¸äº†èµ°ä¸¤æ¡è·¯å­ï¼šæœåŠ¡ç«¯æ¨¡æ¿æŠ€æœ¯ï¼Œåœ¨æœåŠ¡ç«¯å…¨æ¸²æŸ“å¥½ï¼›AJAX æ–¹å¼ã€‚è™½ç„¶ä¸¤è€…å¹¶ä¸æ’æ–¥ï¼Œä½†ä¸ªäººè§‰å¾— AJAX æ–¹å¼ä¼˜é›…çš„å¤šï¼Œä¸€å¼€å§‹å°±æŠŠ service å’Œ UI åˆ†ç¦»å¼€äº†ï¼Œå¼€å‘ä¹Ÿå®¹æ˜“ï¼Œå‰ç«¯å·¥ç¨‹å¸ˆå’Œåç«¯å·¥ç¨‹å¸ˆä¸ç”¨åœ¨æ¨¡æ¿æ–‡ä»¶ä¸Šæ‰“æ¶ã€‚<br/></li></ul><li>session persistence</li><ul><li>session ID<br/></li><ul><li>cookie</li><li>url parameterï¼Œæ¯”å¦‚ JSESSIONID=xxx</li></ul><li>session çš„å­˜å‚¨</li><ul><li>ç›´æ¥æŠŠä¿¡æ¯æ”¾åœ¨ cookie é‡Œï¼ŒQPS é«˜æ—¶å¸¦å®½æµªè´¹ä¸¥é‡</li><li>http server æœ¬åœ°ç£ç›˜ï¼Œéœ€è¦ load balancer æ”¯æŒ sticky sessionï¼Œå•ä¸ª http server å´©æºƒä¼šä¸¢å¤± session æ•°æ®<br/></li><li>global session storage: redis, rdbms + memcache</li></ul></ul><li>RPC systemï¼Œåˆ‡åˆ†å„ä¸ªæœåŠ¡åï¼ŒæœåŠ¡ä¹‹é—´éœ€è¦ç»Ÿä¸€è€Œä¸”é«˜æ•ˆçš„ RPC æœºåˆ¶<br/></li><ul><li>service registryï¼Œè¿™æ˜¯æ¯ä¸ªåˆ›ä¸šå…¬å¸ä¸€å¼€å§‹éƒ½ä¼šå¿½è§†çš„ä¸œè¥¿ï¼Œè€Œä¸€æ—¦å£®å¤§åéƒ½å¿…éœ€å¾—åšï¼Œå°¤å…¶æ˜¯æŠŠå„ç§åŠŸèƒ½åˆ†å‰²åˆ°ä¸åŒå­ç³»ç»Ÿæˆä¸ºæœåŠ¡ä¹‹åã€‚</li><li>RPC framework:  thrift, twitter finagle</li></ul><li>cache:  memcache, redis, <a href=\"https://link.zhihu.com/?target=http%3A//code.taobao.org/p/tair/src/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">tair</a>, <a href=\"https://link.zhihu.com/?target=http%3A//www.project-voldemort.com/voldemort/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">voldemort</a></li><li>storage: åˆ†å¸ƒå¼å­˜å‚¨åº”è¯¥æ˜¯æ•´ä¸ªæŠ€æœ¯æ ˆé‡Œæœ€éš¾çš„éƒ¨åˆ†äº†ã€‚<br/></li><ul><li>å…³ç³»æ•°æ®åº“ï¼šMySQL, PostgreSQL</li><ul><li>è¿™ä¿©æ•°æ®åº“éƒ½æ˜¯å•æœºç‰ˆæœ¬ï¼Œè¦è¾¾åˆ°é›†ç¾¤æ•ˆæœéœ€è¦åšå¤§é‡å·¥ä½œï¼šåˆ†åº“åˆ†è¡¨ã€joinã€åˆ†é¡µã€äº‹åŠ¡ã€failoverã€è´Ÿè½½å‡è¡¡ï¼Œå°½å¯èƒ½è‡ªåŠ¨åŒ–çš„å¯¼å…¥å¯¼å‡ºã€å¢å‡å®ä¾‹ï¼Œç›®æµ‹åªæœ‰ Googleã€Facebookå’Œæ·˜å®ç©çš„å¾ˆæºœã€‚</li></ul><li>NoSQL: HBase, Cassandra, Riak, RethinkDB, CouchBaseï¼Œ<a href=\"https://link.zhihu.com/?target=http%3A//www.project-voldemort.com/voldemort/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Voldemort</a></li><li>å°æ–‡ä»¶å­˜å‚¨ï¼š<a href=\"https://link.zhihu.com/?target=http%3A//code.taobao.org/p/tfs/src/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">TFS</a>ï¼ŒMogileFS, FastDFS</li></ul><li>æ¶ˆæ¯é˜Ÿåˆ—ï¼šè¿™ç±»äº§å“å¤šå¦‚ç‰›æ¯›ï¼Œä½†èƒ½åŒæ—¶æ”¯æŒè‡³å°‘ä¸€æ¬¡ã€è‡³å¤šä¸€æ¬¡ã€ä¿åºç‰¹æ€§çš„è¿˜æ˜¯ä¸å¤šã€‚å¤šæä¸€å¥çš„æ˜¯ Redis é›†ç¾¤ï¼ˆå®˜æ–¹çš„æŠ‘æˆ–å„ç§å±±å¯¨çš„ï¼‰éƒ½æ˜¯ AP ç³»ç»Ÿï¼Œä¸æ˜¯ CP ç³»ç»Ÿï¼Œä½œä¸º queue ä¸é€‚åˆä¸¥è‚ƒåœºåˆ(ä½œä¸º storage ä¹Ÿå¦‚æ­¤)<br/></li><li>ä»»åŠ¡é˜Ÿåˆ—ï¼š<a href=\"https://link.zhihu.com/?target=http%3A//gearman.org/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Gearman</a>, <a href=\"https://link.zhihu.com/?target=http%3A//www.celeryproject.org/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Celery</a></li><li>ç³»ç»Ÿç›‘æµ‹ï¼šNagios, Ganglia, <a href=\"https://link.zhihu.com/?target=http%3A//blog.163.com/guaiguai_family/blog/static/20078414520140914721687/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Graphite</a>, <a href=\"https://link.zhihu.com/?target=https%3A//github.com/etsy/statsd\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">statsd</a></li><li>æ—¥å¿—æ”¶é›†ï¼šKafka, <a href=\"https://link.zhihu.com/?target=http%3A//blog.163.com/guaiguai_family/blog/static/20078414520138100562883/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Flume</a>, Fluentd, <a href=\"https://link.zhihu.com/?target=https%3A//github.com/elasticsearch/kibana\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Kibana</a>ï¼Œ<a href=\"https://link.zhihu.com/?target=http%3A//blog.163.com/guaiguai_family/blog/static/20078414520138911393767/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">LinkedIn çš„å®è·µ</a>éå¸¸å€¼å¾—å‚è€ƒï¼Œå°¤å…¶å€¼å¾—ä¸€æçš„æ˜¯ schema registry çš„æ¦‚å¿µï¼Œæ²¡æœ‰è¿™ä¸ªæœåŠ¡ï¼Œå¾ˆéš¾åˆ©ç”¨æ”¶é›†çš„æ•°æ®ã€‚<br/></li><li>æ•°æ®åˆ†æï¼šHadoop, Storm, Spark, <a href=\"https://link.zhihu.com/?target=https%3A//github.com/facebook/presto\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Presto</a></li><li>è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼š<a href=\"https://link.zhihu.com/?target=http%3A//puppetlabs.com/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Puppet</a>, <a href=\"https://link.zhihu.com/?target=http%3A//www.getchef.com/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Chef</a>, <a href=\"https://link.zhihu.com/?target=http%3A//www.ansibleworks.com/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Ansible</a> ç­‰ã€‚</li>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50811465", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 2, 
            "title": "ä¸€ä¸ªæœ‰å¾…éªŒè¯çš„ Redis é›†ç¾¤æ¶æ„", 
            "content": "<p>ã€è¿ç§»ã€‘ä¸€ä¸ªæœ‰å¾…éªŒè¯çš„ Redis é›†ç¾¤æ¶æ„</p><p>å®˜æ–¹çš„ Redis Cluster è¿˜ä¸æˆç†Ÿï¼Œè€Œä¸”ä¹Ÿä¸æ”¯æŒè·¨æœºæˆ¿å¤åˆ¶ï¼Œåªå¥½è‡ªå·±å±±å¯¨ Redis é›†ç¾¤äº†ã€‚</p><ul><li>æ‰€æœ‰æœºæˆ¿éƒ¨ç½²çš„è½¯ä»¶æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯é…ç½®ä¸ä¸€æ ·ï¼Œmaster DC çš„ sentinel å¯åŠ¨ï¼Œslave DCs çš„ sentinel ä¸å¯åŠ¨ã€‚</li><li>master DC æ¥å—å†™å…¥ï¼Œslave DC éƒ½æ˜¯åªè¯»ï¼Œåˆ‡æ¢ master DC éœ€è¦æ‰‹åŠ¨æ“ä½œã€‚</li><li>å®¢æˆ·ç«¯éœ€è¦å°è£… Jedis æˆ–è€… hiredis å®¢æˆ·ç«¯åº“ï¼Œå¯¹è¯»å’Œå†™åšé›†ç¾¤åŒ–å¤„ç†ã€‚Twemproxy ä¸é€‚åˆï¼Œå› ä¸ºä¼Šæ²¡æœ‰ replication çš„æ”¯æŒï¼Œè€Œè¿™é‡Œçš„åœºæ™¯æ˜¯æŠŠ Redis å½“ storage è€Œé cacheï¼ˆåæ¨¡å¼å•Šï¼ï¼‰<br/></li><li>master DC ä¸­æ¯ä¸ª partition é‡Œçš„å¤šä¸ª redis server ä½¿ç”¨ redis sentinel ä¿æŒé«˜å¯ç”¨æ€§</li><li>slave  DC å¯ä»¥é€‰æ‹©ä» master DC é•œåƒï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä»å¦ä¸€ä¸ª slave DC é•œåƒï¼Œè¿™ä¸ªé•œåƒåŠŸèƒ½éœ€è¦ä¸€ä¸ªè¡¥ä¸ï¼Œä»¥ä¿è¯ master DC  é‡Œçš„ sentinel ä¸ä¼šè°ƒæ•´ slave DC é‡Œ redis server çš„ slaveof è®¾ç½®ã€‚</li><li>slave DC  é‡Œæ¯ä¸ª partition çš„å¤šä¸ª redis server éƒ½ä»å…¶å®ƒæœºæˆ¿åŒæ­¥æ•°æ®ï¼Œè€Œä¸æ˜¯åšæˆé“¾å¼ï¼Œè®©å…¶ä¸­ä¸€å° redis server  ä»å…¶å®ƒæœºæˆ¿åŒæ­¥æ•°æ®ã€‚åå¤„æ˜¯è·¨æœºæˆ¿æ•°æ®ä¼ è¾“ç¿»äº†å¥½å‡ å€ï¼ˆå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯ partial syncï¼Œç»†æ°´é•¿æµï¼Œå‹åŠ›ä¸å¤§ï¼Œä½†ä¸€æ—¦å‡ºç° full sync  å¯èƒ½ä¼šæ­»ç¿˜ï¼‰ï¼Œå¥½å¤„æ˜¯ slave DC é‡Œä¸ç”¨æ“å¿ƒ chain head é‚£å° Redis æ­»æ‰çš„é—®é¢˜ã€‚</li><li>Redis é›†ç¾¤æ˜¯ä¸ª  AP ç³»ç»Ÿï¼Œä¸æ˜¯ CP ç³»ç»Ÿï¼Œå¯èƒ½ä¸¢æ•°æ®ï¼Œè¿™ç‚¹æ— è®ºæ˜¯å®˜æ–¹çš„ Redis Cluster è¿˜æ˜¯è¿™é‡Œå±±å¯¨çš„æ¶æ„ï¼Œéƒ½æ˜¯å¦‚æ­¤ï¼Œæ–°æµªå¾®åšé‚£ä¸ªç”¨  ZooKeeper åŠ  DNS æ¶è®¾çš„ Redis é›†ç¾¤åº”è¯¥ä¹Ÿå¦‚æ­¤ã€‚æ‰€ä»¥ä½¿ç”¨åœºåˆåº”è¯¥å…è®¸æ•°æ®ä¸¢å¤±ï¼Œæ¯”å¦‚åå°å®æ—¶æµè®¡ç®—åˆ†æç”¨æˆ·è¡Œä¸ºã€‚<br/></li></ul><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><noscript><img src=\"https://pic2.zhimg.com/v2-1a12ed242ff16a084695a7a7e69e8bc5_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"750\" data-rawheight=\"1681\" class=\"origin_image zh-lightbox-thumb\" width=\"750\" data-original=\"https://pic2.zhimg.com/v2-1a12ed242ff16a084695a7a7e69e8bc5_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;750&#39; height=&#39;1681&#39;&gt;&lt;/svg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"750\" data-rawheight=\"1681\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"750\" data-original=\"https://pic2.zhimg.com/v2-1a12ed242ff16a084695a7a7e69e8bc5_r.jpg\" data-actualsrc=\"https://pic2.zhimg.com/v2-1a12ed242ff16a084695a7a7e69e8bc5_b.jpg\"/></figure><p></p>", 
            "topic": [
                {
                    "tag": "Redis", 
                    "tagLink": "https://api.zhihu.com/topics/19557280"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50811407", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "Graphite é›†ç¾¤æ¶æ„", 
            "content": "<p>ã€è¿ç§»ã€‘Graphite é›†ç¾¤æ¶æ„</p><p>å‚è€ƒè¿™ç¯‡æ–‡ç« ä»¥åŠå…¶ä¸­æåˆ°çš„å‡ ä¸ªé“¾æ¥ï¼š<a href=\"https://link.zhihu.com/?target=http%3A//bitprophet.org/blog/2013/03/07/graphite/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">bitprophet.org/blog/201</span><span class=\"invisible\">3/03/07/graphite/</span><span class=\"ellipsis\"></span></a>ï¼Œå®ç°ä¸€ä¸ªå¯æ‰©å±•çš„ç›‘æµ‹åŸºç¡€è®¾æ–½ä¹Ÿä¸æ˜¯ä¸ªå®¹æ˜“äº‹æƒ…ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><noscript><img src=\"https://pic2.zhimg.com/v2-3d83f313d259723106ec04a956700415_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"750\" data-rawheight=\"1474\" class=\"origin_image zh-lightbox-thumb\" width=\"750\" data-original=\"https://pic2.zhimg.com/v2-3d83f313d259723106ec04a956700415_r.jpg\"/></noscript><img src=\"data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;750&#39; height=&#39;1474&#39;&gt;&lt;/svg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"750\" data-rawheight=\"1474\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"750\" data-original=\"https://pic2.zhimg.com/v2-3d83f313d259723106ec04a956700415_r.jpg\" data-actualsrc=\"https://pic2.zhimg.com/v2-3d83f313d259723106ec04a956700415_b.jpg\"/></figure><p>ä¸€äº›è¯´æ˜ï¼š</p><ul><li>åŸºæœ¬æ˜¯è¿™ä¸ªé“¾æ¥æåˆ°çš„æ¶æ„ï¼š<a href=\"https://link.zhihu.com/?target=https%3A//answers.launchpad.net/graphite/%2Bquestion/178969\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">answers.launchpad.net/g</span><span class=\"invisible\">raphite/+question/178969</span><span class=\"ellipsis\"></span></a>ï¼Œä¸Šé¢  bitprophet.org æåˆ°çš„æ¶æ„æ„Ÿè§‰å¤æ‚äº†ç‚¹(bitprophet ç”¨äº†ä¸¤å±‚ consistent hashï¼Œå¹¶ä¸”æ¯ä¸ª  graphite-web app åªä¸æœ¬æœºä¸Šçš„ carbon-cache é€šä¿¡ï¼Œè€Œä¸æ˜¯ä¸æ‰€æœ‰ carbon-cache  é€šä¿¡)ï¼Œæœ¬æ–‡æåˆ°çš„æ¶æ„åªç”¨äº†ä¸€å±‚ consistent hashï¼Œgraphite-web app ä¼šä¸æ‰€æœ‰ carbon-cache  é€šä¿¡ï¼Œå¥½å¤„æ˜¯ç†è§£èµ·æ¥ç®€å•ï¼Œé…ç½®ä¹Ÿç®€å•ï¼ˆæ¯ä¸ªå®ä¾‹åŸºæœ¬éƒ½æ˜¯ç­‰ä»·çš„)ï¼Œåå¤„æ˜¯:</li><ul><li>å¢åŠ  carbon-cache  å®ä¾‹æ—¶ï¼Œæ‰€æœ‰åœ°æ–¹çš„ consistent hash åˆ†å¸ƒéƒ½ä¼šå—å¹²æ‰°ã€‚å½“å¢åŠ ç¬¬äºŒå±‚ hash ring ä¸Šçš„èŠ‚ç‚¹æ—¶ï¼Œbitprophet  æ–¹æ¡ˆå¹²æ‰°é¢è¾ƒå°ï¼Œä½†å®é™…ä¸­è¿™ç§æƒ…å†µå¾ˆå°‘å‡ºç°ï¼Œå› ä¸ºæ€§èƒ½æµ‹è¯•å°±å¯ä»¥åœ¨ä¸€å¼€å§‹å†³å®šå•æœºä¸Šéƒ¨ç½²å¤šå°‘ä¸ª carbon-cache å®ä¾‹ï¼Œæ‰€ä»¥åœ¨  bitprophet æ¶æ„é‡ŒåŠ  carbon-cache ä¸€èˆ¬ä¼šåœ¨ç¬¬ä¸€å±‚ hash ring ä¸Šï¼Œå¹²æ‰°å°±ä¸€æ ·å¤§äº†ã€‚</li><li>graphite-web app ä¸ carbon-cache çš„ TCP é“¾æ¥æ›´å¤šï¼ˆåº”è¯¥é—®é¢˜ä¸å¤§ï¼‰</li></ul><li>å•æœºä¸Šéƒ¨ç½²  carbon-relay : carbon-aggregator : carbon-cache : graphite-web = 1 : M :  N : 1ï¼Œrelay å› ä¸ºæœ‰ä¸¤å±‚ï¼Œå¯ä»¥å•æœºä¸Šéƒ¨ç½²ä¸¤ä¸ªï¼Œç³»ç»Ÿç“¶é¢ˆåœ¨ carbon-aggregator å’Œ carbon-cache çš„  CPU è¿ç®—ï¼Œä»¥åŠ carbon-cache çš„ç£ç›˜ I/Oï¼Œgraphite-web åº”è¯¥æ²¡å¿…è¦åœ¨å•æœºä¸Šéƒ¨ç½²å¤šä¸ªï¼Œå¦‚æœæœ‰å¤šå°æœºå™¨çš„è¯å·²ç»æœ‰å¤šä¸ª  graphite-web å®ä¾‹åšè´Ÿè½½å‡è¡¡äº†ã€‚<br/></li><li>carbon-relay åœ¨ç”¨ rule è½¬å‘æ—¶ï¼Œå¦‚æœ  relay-rules.conf é‡Œå¤´çš„é…ç½®æ”¯æŒ consistent hash æ–¹å¼è½¬å‘å‡ºå»ï¼Œåˆ™å¯ä»¥çœç•¥æ‰ç¬¬äºŒå±‚ carbon-relay  (Graphite ä½œè€…ä¸¤å¹´å‰è¯´è¦æ”¯æŒè¿™ä¸ªç‰¹æ€§ï¼Œè‡³ä»Šè²Œä¼¼è¿˜æ²¡åŠ ä¸Šå»)ã€‚</li><li>carbon-0.9.12 é‡Œçš„  bin/carbon-client.py å¯ä»¥ä»æ ‡å‡†è¾“å…¥è¯»å…¥ metricsï¼Œæ‰€ä»¥å¯ä»¥æŠŠ carbon-client éƒ¨ç½²åˆ°  application æ‰€åœ¨æœºå™¨ä¸Šï¼Œå¯åŠ¨ä¸¤ä¸ª carbon-client ä¸€ä¸ª relay åˆ° carbon-aggregator, ä¸€ä¸ª  relay åˆ°ç¬¬äºŒå±‚ carbon-relayï¼Œè¿™æ ·ç¬¬ä¸€å±‚ carbon-relay å¯ä»¥çœç•¥æ‰ï¼Œä½†è¿™ä¸ªæ€è·¯å¹¶ä¸æ¨èï¼Œå› ä¸ºä¼šæŠŠ  monitoring infrastructure layout æš´éœ²ç»™ application ä¸€ä¾§ï¼Œç»´æŠ¤éº»çƒ¦ã€‚<br/></li><li>å¦‚æœ aggregation çš„éœ€æ±‚å¯ä»¥å…¨éƒ¨ç”¨ StatsD åšï¼Œåˆ™ carbon-aggregator å¯ä»¥çœç•¥æ‰ã€‚</li><li>graphite-web äº’ç›¸è°ƒç”¨è¿™ä¸ªè®¾è®¡æœ‰ç‚¹å¥‡æ€ªï¼Œgraphite-web å……å½“äº† frontend å’Œ web service åŒé‡è§’è‰²ã€‚</li><li>carbon-cache  å¯ä»¥ä»æ”¯æŒ AMQP åè®®çš„ message queue æ¯”å¦‚ ActiveMQ è·å– metricsï¼Œè¿™ä¸ªæ¶æ„é‡Œæ²¡æœ‰ä½¿ç”¨ï¼ŒActiveMQ  çš„è´Ÿè½½å‡è¡¡ã€æ€§èƒ½ã€bugæœ¬èº«å°±æ˜¯ä¸ªå¤´ç–¼äº‹ï¼ŒåŒ…è£…ä¸ª ActiveMQ ä¹Ÿéšè—äº† carbon ç®€å•çš„ç½‘ç»œåè®®ï¼Œæ„Ÿè§‰åŠ é‡ application  ä¸€ä¾§çš„è´Ÿæ‹…ï¼Œç”šä¸ºå¯æƒœã€‚</li><li>å‡¡æ˜¯æ ‡è®° any çš„åœ°æ–¹ä»¥åŠ graphite-web å¯ä»¥ç”¨ HAProxy åš round robin å¼çš„è´Ÿè½½å‡è¡¡ã€‚</li></ul><p><a href=\"https://link.zhihu.com/?target=http%3A//douban.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">douban.com</span><span class=\"invisible\"></span></a> ç”¨äº† Graphiteï¼Œä¸çŸ¥é“ä»–ä»¬æ€ä¹ˆé…ç½®çš„ï¼Œä¹Ÿè®¸å•æœº Graphite è¶³å¤Ÿç”¨ï¼Œä¸ç”¨æƒ³è¿™ä¹ˆå¤æ‚ã€‚ã€‚ã€‚ã€‚</p><p>å¦å¤–ï¼ŒGraphite  çš„ clustering æ”¯æŒæ˜¯ååŠ çš„ï¼Œgraphite-web æä¾›äº† web service æš´éœ²æœ¬åœ°çš„ whisper  æ–‡ä»¶ï¼ŒåŸºæœ¬å°±æ˜¯è‡ªè¡Œå®ç°äº† NFSï¼Œæçš„æŒºå¤æ‚ï¼Œåˆä¸èƒ½ä¿è¯ whisper å­˜å‚¨çš„å¯é æ€§ï¼ˆèŠ‚ç‚¹å¤±è´¥ whisper  æ–‡ä»¶ä¸ä¼šè‡ªåŠ¨è¢«å¤šå¤åˆ¶å‡ ä»½ï¼‰ï¼Œgraphite-web ä¹‹é—´å¹¿æ’­å¼çš„æŸ¥è¯¢å¾ˆæµªè´¹ï¼Œå¦‚æœæŠŠ whisper æ–‡ä»¶æ”¾ NFS ç”šè‡³ MooseFS  ä¸Šï¼Œçœ‹èµ·æ¥ä¼šè®© clustering æ”¯æŒç®€å•å¾ˆå¤šã€‚opentsdb ä¸€å¼€å§‹å°±è€ƒè™‘äº†é›†ç¾¤ï¼Œè®¾è®¡çš„å¾ˆç®€å•ï¼Œä½†æ˜¯ä¼Šçš„ UI å¼±çˆ†äº†ã€‚</p>", 
            "topic": [
                {
                    "tag": "è½¯ä»¶æ¶æ„", 
                    "tagLink": "https://api.zhihu.com/topics/19556273"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50811381", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "ä¸è¦ç”¨ Scribe æ”¶é›†æ—¥å¿—", 
            "content": "<p>ã€è¿ç§»ã€‘ä¸è¦ç”¨ Scribe æ”¶é›†æ—¥å¿—</p><p>Scribe æ›¾ç»åå£°å¤§å™ªï¼Œå¯èƒ½å¾ˆå¤§åŸå› æ˜¯ Facebook å¼€æºå‡ºæ¥çš„ï¼Œåœ¨ Hadoop in China 2011 å¤§ä¼šçš„æ—¶å€™ï¼Œå¬ Facebook çš„é‚µé“®è®² Scribe ä»£ç è´¨é‡ä½ä¸‹ï¼ŒFacebook å†…éƒ¨ç”¨ Java é‡å†™äº†ä¸€ä»½ï¼Œä»Šå¤©ä»”ç»†ç ”ç©¶äº†ä¸‹ï¼Œå‘ç°è¿™ä¸œè¥¿ç¡®å®ä¸èƒ½ç”¨ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ä¸”ä¸è¯´ä»£ç å¹´ä¹…å¤±ä¿®ä¾èµ–è€æ—§ç¼–è¯‘éº»çƒ¦äº†ï¼Œå…¶ä¸€ä¸ªä¸¥é‡é—®é¢˜åœ¨äº  bucket store çš„è®¾è®¡ï¼ŒæŒ‰ç…§è®¾è®¡ï¼Œåœ¨ random bucket çš„æ¨¡å¼ä¸‹ï¼Œæ—¥å¿—ä¼šéšæœºåˆ†é…ç»™ä¸‹æ¸¸çš„æŸäº› Scribe  æœºå™¨(å®é™…æµ‹è¯•å‘ç°è¿™ä¸ªâ€œéšæœºâ€ç›¸å½“ä¸å‡åŒ€ï¼‰ï¼Œä½†å¦‚æœæŸä¸€å°ä¸‹æ¸¸ Scribe å´©æºƒåï¼Œä¸Šæ¸¸ Scribe  è¿˜æ˜¯ä¼šæŠŠæ—¥å¿—åˆ†é…åˆ°å®ƒå¤´ä¸Šï¼Œå½“ç„¶ï¼Œè¿™é‡Œä¼šå‘é€å¤±è´¥ï¼Œäºæ˜¯ä¸Šæ¸¸ Scribe åœ¨ buffer store çš„é…ç½®ä¸‹ä¼šç¼“å­˜èµ·æ¥ã€‚ä¸ªäººè§‰å¾—è¿™é‡Œæ—¢ç„¶æ˜¯  random bucketï¼Œå°±è¯´æ˜ä½¿ç”¨è€…å‹æ ¹ä¸å…³å¿ƒæ—¥å¿—åˆ‡åˆ†ï¼Œè¦çš„å°±æ˜¯ä¸ªå‡åŒ€åˆ†å¸ƒä¸‹æ¸¸ Scribe server  çš„å‹åŠ›ç½¢äº†ï¼Œæ‰€ä»¥ä¸åº”è¯¥ç¼“å­˜ï¼Œè€Œæ˜¯ä»»æ„é€‰æ‹©ä¸€å°ä¸‹æ¸¸ Scribe server ç»§ç»­å‘é€ã€‚ä¹Ÿè®¸æœ‰äººæƒ³åˆ°ç”¨ load balancerï¼Œè¿™æ ·å¯ä»¥ç”¨  network store æ›¿æ¢ bucket storeï¼Œä½†å› ä¸ºè¿™é‡Œçš„ç½‘ç»œä¼ è¾“æ¨¡å¼æ˜¯ request è¿œè¿œå¤§äº responseï¼Œload  balancer ç”¨åœ¨è¿™ä¸ªåœºåˆä¸‹å°±æˆäº†æ€§èƒ½ç“¶é¢ˆã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>å¯¹æ¯” Kafka çš„ partition å’Œ replication  è®¾è®¡ï¼ŒScribe å¤ªä¸šä½™äº†ï¼Œbucket store è®¾è®¡å¾ˆä¸æ–¹ä¾¿è¿ç»´äººå‘˜éšæ„å¢å‡ä¸‹æ¸¸ Scribe é›†ç¾¤çš„æœºå™¨ã€‚å¦å¤– Scribe çš„  HDFS store æ®è¯´å¤ªè€æ—§ï¼Œä¸å¯ç”¨äº†ï¼Œä¸æŠ˜è…¾ä¹Ÿç½¢ï¼Œå®ƒä¹Ÿä¸åƒåæ¥çš„æ—¥å¿—æ”¶é›†ç³»ç»Ÿä¸€æ ·è‡ªå¸¦ä¸€å¤§å †çš„ source æ’ä»¶ï¼Œè¿ tail -f  è¿™ä¹ˆå¸¸è§çš„éœ€æ±‚éƒ½å¾—è‡ªå·±å®ç°ï¼ˆscribe_cat  è¯»ä¸€è¡Œè¾“å…¥å‘é€å‡ºå»ç„¶åå°±è¿›ç¨‹é€€å‡ºï¼‰ã€‚ä¿®æ”¹è¿™å‡ ä¸ªé—®é¢˜çœ‹èµ·æ¥ä¸æ˜¯å¤ªéš¾ï¼Œä½†è€ƒè™‘åˆ°çƒ‚æ³¥ç»ˆç©¶æ‰¶ä¸ä¸Šå¢™ï¼Œè¿˜æ˜¯ä¸å¦‚é‡å†™ä¸ªæˆ–è€…ç´¢æ€§æ‰¾ä¸ªå…¶å®ƒæ—¥å¿—æ”¶é›†å·¥å…·ï¼Œæ¯”å¦‚  Fluentd å’Œ FlumeNGï¼Œç”šæˆ–ç”¨å¤§æ€å™¨ Kafkaã€‚</p>", 
            "topic": [
                {
                    "tag": "æ—¥å¿—åˆ†æ", 
                    "tagLink": "https://api.zhihu.com/topics/19615655"
                }, 
                {
                    "tag": "æ—¥å¿—", 
                    "tagLink": "https://api.zhihu.com/topics/19718384"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50811353", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "Java Monitoring Library", 
            "content": "<p>ã€è¿ç§»ã€‘Java Monitoring Library </p><p>å…¬å¸é‡Œæœ‰ä¸ªç‰›é€¼çš„ monitoring åº“ï¼ŒC/C++/Java/Perl/PHP é€šåƒï¼Œä½†æ˜¯ä¼Šæœ‰ JNI çš„ï¼Œä¸æ–¹ä¾¿åœ¨é RHEL  æœºå™¨ä¸Šè·‘ï¼Œæ‰€ä»¥æ‰¾äº†ä¸‹å¼€æºçš„ Java monitoring libraryï¼Œå€’æ˜¯é¢‡æœ‰å‡ ä¸ªï¼Œä½†æ˜¯æ„Ÿè§‰è¿˜æ˜¯å…¬å¸é‚£ä¸ª API  è®¾è®¡çš„å¥½ï¼Œæ•´ä½“æ¶æ„é«˜ç«¯å¤§æ°”ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>åŸºæœ¬çš„ monitoring API è¦æ±‚ï¼š</p><ul><li>set(label, value):  å•çº¯çš„è®°å½•ä¸‹æ•°å€¼ï¼Œæ¯”å¦‚ memUsed<br/></li><li>add(label, increment): è®°å½•å¢é‡ï¼Œæ¯”å¦‚ QPS</li><li>start(label), stop(label): è®°å½•è¿‡ç¨‹èŠ±è´¹çš„æ—¶é—´ï¼Œæ¯”å¦‚ latency</li><li>æ¯æ¬¡ metric è®°å½•éœ€è¦ä¿å­˜ä¸‹æ—¶é—´æˆ³ï¼Œå› ä¸ºç”»å›¾ä»¥åŠç»Ÿè®¡éœ€è¦ç”¨åˆ°</li><li>æ¯æ¬¡ metric è®°å½•éœ€è¦æ”¯æŒæœ‰ dimension ä¿¡æ¯ï¼Œæ¯”å¦‚ç™»å½•ä¸å¦ã€å“ªä¸ªåœ°åŒºçš„ç”¨æˆ·ï¼Œç»´åº¦ä¿¡æ¯å¯¹äº metrics åˆ†æå¾ˆé‡è¦</li><li>æ”¯æŒå¯¹ metric å®šä¹‰ histogramï¼Œæ¯”å¦‚åˆ† 10 ä¸ªåŒºé—´ï¼Œä» 0 åˆ° 200msï¼Œæ¯ä¸ªåŒºé—´ 20ms</li><li>æœ€å¥½èƒ½æ”¯æŒå¤šç§è¾“å‡ºåç«¯ï¼Œæ¯”å¦‚åˆ°æœ¬åœ°æ–‡ä»¶ï¼Œé€ç»™ Ganglia ç­‰ã€‚<br/></li></ul><p>å‚ç…§<a href=\"https://link.zhihu.com/?target=http%3A//day-to-day-stuff.blogspot.com/2009/01/runtime-monitoring-libraries-for-java.html\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">è¿™ä¸ªé“¾æ¥</a>æ‰¾äº†å¥½å‡ ä¸ªå¼€æºçš„åº“ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š</p><ul><li>Jamon: <a href=\"https://link.zhihu.com/?target=http%3A//jamonapi.sourceforge.net/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">jamonapi.sourceforge.net</span><span class=\"invisible\">/</span><span class=\"ellipsis\"></span></a>ï¼Œæˆ‘çš„ç¥ï¼Œå±…ç„¶èƒ½æŠŠç±»åº“æ•´è¿™ä¹ˆåºå¤§ï¼Œåªæœ‰ start/stop/addï¼Œæ²¡æœ‰ set ä»¥åŠè‡ªå®šä¹‰ç›´æ–¹å›¾ï¼Œä¸æ”¯æŒè¾“å‡ºåˆ°æ–‡ä»¶æˆ–è€…é€ç»™ Gangliaã€‚<br/></li><li>Java Simon: <a href=\"https://link.zhihu.com/?target=http%3A//code.google.com/p/javasimon/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">code.google.com/p/javas</span><span class=\"invisible\">imon/</span><span class=\"ellipsis\"></span></a>ï¼Œè·Ÿ Jamon ç±»ä¼¼ï¼Œnano sec çš„æ”¹è‰¯è²Œä¼¼ Jamon ä¹Ÿæœ‰çš„ï¼Œç±»ä¼¼ log4j çš„å±‚æ¬¡åŒ– metric name æ²¡æ„Ÿè§‰æœ‰å¤šå¤§å¥½å¤„ï¼ŒAPI è·Ÿ Jamon ä¸€èˆ¬çš„çŸ¬ã€‚</li><li>usemon: <a href=\"https://link.zhihu.com/?target=http%3A//code.google.com/p/usemon/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">code.google.com/p/usemo</span><span class=\"invisible\">n/</span><span class=\"ellipsis\"></span></a>ï¼Œçœ‹èµ·æ¥å¾ˆä¼ä¸šçº§ï¼Œä½†æ˜¯ 2008 å¹´åä»£ç å°±æ²¡æ›´æ–°äº†ï¼Œæ²¡å…´è¶£ç»†çœ‹äº†ã€‚</li><li>MoSKito: <a href=\"https://link.zhihu.com/?target=http%3A//www.moskito.org/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">moskito.org/</span><span class=\"invisible\"></span></a>ï¼Œå®˜ç½‘å¹¿å‘Šè§†é¢‘å¤ªæ¶æäº†ï¼ŒåŠå¤œå·¥ç¨‹å¸ˆå¥‹æ–—æ—¶è¢«è‹±é›„  MoSKito æ‰€æ•‘ï¼Œmoskito  æ˜¯èšŠå­å•Šå•Šå•Šã€‚ã€‚ã€‚æ–‡æ¡£ç¡®å®å«ç³Šä¸æ¸…ï¼Œçœ‹æ¶åŠ¿æ˜¯æŒºæœ‰å•†ä¸šå‘³é“æ”¶æœåŠ¡è´¹çš„æ„Ÿè§‰ï¼ŒçŸ­æš‚æ‰«ææ–‡æ¡£çš„ç»“æœæ˜¯ï¼Œè¿™ä¸œè¥¿å¥½åƒæ˜¯ç”¨ AOP  æµ‹é‡æŒ‡å®šç±»çš„æŸäº›æ–¹æ³•æ‰§è¡Œçš„æ—¶é—´ï¼Œå¯ä»¥è¯´æ˜¯ä¸ª online profiling å·¥å…·ï¼Œè·Ÿ monitoring è¿˜æ˜¯æœ‰å·®åˆ«çš„ã€‚</li><li>commons-monitoring: <a href=\"https://link.zhihu.com/?target=http%3A//commons.apache.org/sandbox/monitoring/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">commons.apache.org/sand</span><span class=\"invisible\">box/monitoring/</span><span class=\"ellipsis\"></span></a>ï¼ŒAPI ä¸å¤Ÿæ¼‚äº®ï¼Œå¼€å‘å€’æ˜¯æŒºæ´»è·ƒã€‚</li><li>JETM:<a href=\"https://link.zhihu.com/?target=http%3A//jetm.void.fm/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"> http://jetm.void.fm/</a>ï¼Œè¿™æ˜¯åš profiling çš„ï¼Œç»Ÿè®¡ç±»çš„æ–¹æ³•æ‰§è¡Œå¤šé•¿æ—¶é—´ã€‚</li><li>Yammer Metrics: <a href=\"https://link.zhihu.com/?target=http%3A//metrics.codahale.com/getting-started/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">metrics.codahale.com/ge</span><span class=\"invisible\">tting-started/</span><span class=\"ellipsis\"></span></a>ï¼ŒAPI  è®¾è®¡æ˜¯æ¯”è¾ƒçŸ¬ï¼ŒæŠŠ metric è®°å½•è·Ÿç»Ÿè®¡ç±»å‹ç»‘å®šåœ¨ä¸€èµ·äº†ï¼Œæ¯”å¦‚å¯¹æŸä¸ª metric æˆ‘ä¸€ä¼šæƒ³ Histogramï¼Œä¸€ä¼šæƒ³  Counterï¼Œä¸€ä¼šåˆæƒ³ Meterï¼Œä¼Šçš„ API è®¾è®¡å°±è¦æ±‚ä½¿ç”¨è€…ä¿®æ”¹æºç ã€‚åŠŸèƒ½æŒºä¸°å¯Œçš„ï¼Œæ”¯æŒè¾“å‡ºåˆ° Ganglia, Graphite  ç­‰ï¼ŒåŒ…è£…åŒ…è£…åº”è¯¥è¿˜ä¸é”™ã€‚ä¼¼ä¹ Histogram ä¸æ”¯æŒè‡ªå®šä¹‰åˆ‡åˆ†ã€‚</li><li>Netflix servo: <a href=\"https://link.zhihu.com/?target=https%3A//github.com/Netflix/servo/wiki\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">github.com/Netflix/serv</span><span class=\"invisible\">o/wiki</span><span class=\"ellipsis\"></span></a>ï¼ŒAPI  ç¨å«Œå¤æ‚ï¼Œjavadoc çœ‹ä¸äº†ï¼Œä»ä»£ç ç¤ºä¾‹æ¥çœ‹ï¼Œä¼Šä¼¼ä¹åªæ”¯æŒ pull æ¨¡å¼è·å– metricsï¼ŒåŸç†æ˜¯æŠŠä¸€äº›æ‰“ä¸Š @Monitor  æ ‡è®°çš„å¯¹è±¡æ³¨å†Œä¸Šï¼Œå¼€ä¸ªåå°çº¿ç¨‹å®šæœŸæŸ¥è¯¢è¿™äº›å¯¹è±¡çš„æˆå‘˜å˜é‡æˆ–è€…æ–¹æ³•ï¼Œå¾—åˆ° metrics çš„å€¼ï¼Œä½†æ˜¯è¿™ç§ææ³•æ€ä¹ˆåº”ä»˜ä¸´æ—¶å¼€ä¸€ä¸ª http  é“¾æ¥è·å–ä¸ªè¿œç¨‹èµ„æºå¹¶å…³é—­çš„æƒ…å†µï¼Ÿè¿™ä¸ªè¿‡ç¨‹çŸ­åˆ°å‡ åæ¯«ç§’é‡çº§ï¼Œé  metrics collector è½®è¯¢çš„æ”¶é›†æ˜¯ä¸è¡Œçš„ï¼Œéœ€è¦ API å¯ä»¥ä¸»åŠ¨æŠŠ  metrics ç¼“å­˜åˆ°æŸä¸ªåœ°æ–¹ã€‚<br/></li><li>Jinspired: <a href=\"https://link.zhihu.com/?target=http%3A//www.jinspired.com/solutions/open-api\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">jinspired.com/solutions</span><span class=\"invisible\">/open-api</span><span class=\"ellipsis\"></span></a>ï¼Œä¼ŠæŠŠ  Yammer çš„ metrics library ä»¥åŠ Netflix çš„ servo éª‚çš„ç‹—è¡€æ·‹å¤´ï¼Œç¡®å®ä¼Šè¯´çš„æœ‰é“ç†ï¼Œä½†æ˜¯ä¸ªäººè§‰å¾—ä¸€ä¸ª  monitoring çš„ä¸œè¥¿æŠŠæ¶å­æ­çš„è¿‡äºåä¸½äº†ï¼Œæ²¡æœ‰ open api  ä¸è¦ç´§ï¼Œè‡ªå·±å°è£…ä¸‹å¤Ÿç”¨å°±è¡Œã€‚è€Œä¸”è¿™ä¸ªä¸œè¥¿æ˜¯å•†ä¸šäº§å“ï¼Œä»·æ ¼è¿˜ä¸ä½ï¼Œæ‰€ä»¥å˜›ã€‚ã€‚ã€‚ã€‚</li></ul><p>æ€»ç»“ï¼Œåœ¨ API è®¾è®¡ä¸Šè¿˜çœŸä¸æ•¢æ­ç»´ã€‚Yammer metrics çš„åŠŸèƒ½å€’è¿˜ä¸°å¯Œï¼Œå¯ä»¥åœ¨ä¹‹ä¸Šå°è£…ä¸€å±‚å†ç”¨ã€‚</p>", 
            "topic": [
                {
                    "tag": "Java ç¼–ç¨‹", 
                    "tagLink": "https://api.zhihu.com/topics/19582744"
                }, 
                {
                    "tag": "Java", 
                    "tagLink": "https://api.zhihu.com/topics/19561132"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50795801", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 1, 
            "title": "Parallel SSH", 
            "content": "<p>ã€è¿ç§»ã€‘Parallel SSH</p><p>é›†ç¾¤ç®¡ç†ä¸­å¸¸å¸¸è¦åœ¨å¤§æ‰¹è¿œç¨‹æœºå™¨ä¸Šæ‰§è¡Œä¸€äº›å‘½ä»¤ï¼Œæœ€ç›´æ¥çš„åŠæ³•æ˜¯æ•´ä¸ª bash çš„ for  å¾ªç¯ä»¥è°ƒç”¨sshæˆ–è€…scpä¸€å°å°æœºå™¨çš„æ“ä½œï¼Œè¿™ä¸ªæ–¹å¼æœ‰ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€æ˜¯å¯¹ä¸åŒæœºå™¨çš„æ“ä½œæ˜¯ä¸²è¡Œçš„ï¼Œæ•ˆç‡å¾ˆä½ï¼Œè€Œå¦‚æœç»™ ssh æˆ–è€… scp å‘½ä»¤æ·»åŠ   &#34;&amp;&#34; è®©å…¶åå°æ‰§è¡Œï¼Œè™½ç„¶å¹¶å‘æ‰§è¡Œäº†ï¼Œä½†åˆæ²¡èƒ½æ§åˆ¶å¹¶å‘åº¦ï¼›äºŒæ˜¯è¿™äº›æ‰¹é‡çš„ ssh  å‘½ä»¤çš„è¾“å‡ºæ²¡æœ‰æ±‡æ€»æˆæ–¹ä¾¿æŸ¥çœ‹çš„æ ·å­ï¼Œå…¨æ··åœ¨ä¸€èµ·ï¼Œç³™åŠæ³•æ˜¯è¾“å‡ºåˆ°ä»¥ä¸»æœºåå‘½åçš„æ–‡ä»¶é‡Œï¼Œæœ€åå†æ±‡æ€»ï¼Œä½†æ¯æ¬¡è¿™ä¹ˆææ€»æ˜¯ä¸å¤§æ–¹ä¾¿ã€‚</p><p>è¿™ä¸ªåœºæ™¯å¾ˆæ™®éï¼Œæ‰€ä»¥å¯¹åº”çš„è§£å†³æ–¹æ¡ˆä¹Ÿæ˜¯ç›¸å½“å¤šï¼Œå‰æ®µæ—¶é—´ä¸ªä¸ªæµ…è¯•äº†ä¸‹ï¼Œæ€»ç»“å¦‚ä¸‹ï¼Œå…¶ä¸­  csshx ä»¥åŠ parallel-sshã€pdsh æ˜¯æ¨èä½¿ç”¨çš„ã€‚æƒ³è¦æ›´é«˜çº§ä½†åˆè½»é‡çº§çš„é…ç½®ç®¡ç†å·¥å…·ï¼ŒPython ä¼—å¯ä»¥è€ƒè™‘  Fabricï¼ŒRuby ä¼—å¯ä»¥è€ƒè™‘ Capistranoï¼ŒPerl ä¼—å¯ä»¥è€ƒè™‘ Rexï¼Œè¿™ä¸‰ä¸ªå·¥å…·å¯¹å„è‡ªçš„ç¼–ç¨‹è¯­è¨€èƒ½åŠ›è¦æ±‚è¾ƒé«˜ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥çœ‹çœ‹  Ansibleï¼Œä½¿ç”¨ YAML è¯­æ³•å£°æ˜é…ç½®ã€‚</p><ol><li><a href=\"https://link.zhihu.com/?target=http%3A//code.google.com/p/csshx/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">code.google.com/p/csshx</span><span class=\"invisible\">/</span><span class=\"ellipsis\"></span></a>ï¼ŒMac  OS X åº”ç”¨ï¼Œä»¥ tiling window  æ–¹å¼åŒæ—¶æ“ä½œå¤šå°æœºå™¨å¹¶æ˜¾ç¤ºå…¶è¾“å‡ºï¼Œå¦‚æœæœ¬æœºå±å¹•å¤Ÿå¤§è€Œä¸”æ“ä½œçš„è¿œç¨‹æœºå™¨åœ¨å‡ åå°åˆ°ä¸€ä¸¤ç™¾å°ï¼Œè¿˜æ˜¯ç›¸å½“å¥½ç”¨çš„ï¼Œæ¯”å¦‚ grep  ä¸‹é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨çš„æ—¥å¿—æ–‡ä»¶ï¼Œéšä¾¿æŸ¥æ‰¾ç‚¹ä»€ä¹ˆä¸œè¥¿ã€‚è¿™ä¸ªåº”ç”¨è¿˜å¯ä»¥åˆ‡æ¢æ¨¡å¼åªæ“ä½œå…¶ä¸­ä¸€å°è¿œç¨‹æœºå™¨ï¼Œæœ¬æœºæ˜¯ Mac OS X  çš„åŒå­¦å¼ºçƒˆå»ºè®®è¯•ç”¨ä¸‹ï¼Œä¸ªäººè§‰å¾—æ˜¯åŒç±»åº”ç”¨ä¸­åšçš„æœ€å¥½çš„ä¸€ä¸ªã€‚</li><li><a href=\"https://link.zhihu.com/?target=http%3A//code.google.com/p/parallel-ssh/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">code.google.com/p/paral</span><span class=\"invisible\">lel-ssh/</span><span class=\"ellipsis\"></span></a> ï¼Œå‘½ä»¤è¡Œæ¨¡å¼çš„ parallel ssh å·¥å…·é›†ï¼Œä½¿ç”¨ Python ç¼–å†™ï¼ŒåŒ…å« pssh, pscp, prsync, pnuke, pslurpï¼Œæ”¯æŒå¹¶å‘åº¦æ§åˆ¶ï¼Œçœå¾—è‡ªå·±å±±å¯¨äº†ã€‚</li><li><a href=\"https://link.zhihu.com/?target=https%3A//code.google.com/p/pdsh/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">code.google.com/p/pdsh/</span><span class=\"invisible\"></span></a>ï¼Œå‘½ä»¤è¡Œæ¨¡å¼çš„ parallel ssh å·¥å…·é›†ï¼Œä½¿ç”¨ C ç¼–å†™ï¼ŒåŒ…å«ï¼š</li></ol><ul><li>pdsh: æ‰¹é‡å¹¶å‘çš„åœ¨å¤šå°è¿œç¨‹æœºå™¨ä¸Šæ‰§è¡Œå‘½ä»¤</li><li>dshbak: pdsh åœ¨æ¯è¡Œè¾“å‡ºå‰é¢åŠ ä¸Šè¿œç¨‹ä¸»æœºåä½œä¸ºå‰ç¼€ï¼Œå¦‚æœè¿œç¨‹å‘½ä»¤è¾“å‡ºå¾ˆå¤šè¡Œçš„è¯ï¼Œæ¥è‡ªä¸åŒä¸»æœºçš„è¾“å‡ºä¼šäº¤é”™å‡ºç°ï¼Œdshbak ç”¨æ¥åˆ†æ pdsh çš„è¾“å‡ºï¼ŒæŠŠç›¸åŒå‰ç¼€çš„æ—¥å¿—æ±‡æ€»åˆ°ä¸€èµ·</li><li>pdcp å’Œ rpdcp: ä»æœ¬åœ°å¤åˆ¶æ–‡ä»¶åˆ°å¤šå°è¿œç¨‹ä¸»æœºä¸Šï¼Œä»¥åŠåè¿‡æ¥å¤åˆ¶æ–‡ä»¶ã€‚</li></ul><li><a href=\"https://link.zhihu.com/?target=http%3A//www.ansibleworks.com/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">ansibleworks.com/</span><span class=\"invisible\"></span></a>,  ansible æ˜¯ä¸€ä¸ªé…ç½®ç®¡ç†å·¥å…·ï¼Œä½¿ç”¨ Python ç¼–å†™ï¼Œç±»ä¼¼ <a href=\"https://link.zhihu.com/?target=https%3A//puppetlabs.com/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">puppet</a>ã€<a href=\"https://link.zhihu.com/?target=http%3A//www.opscode.com/chef\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">chef</a>ï¼Œansible  çš„æœ€å¤§ç‰¹ç‚¹æ˜¯å…¶ä¸éœ€è¦ serverã€agent ä»€ä¹ˆçš„ï¼Œç›´æ¥ç”¨ ssh  æ‰§è¡Œå‘½ä»¤æ¥é…ç½®ç›®æ ‡æœºå™¨ï¼ŒåŒæ—¶å®ƒä¹Ÿå¯ä»¥ç”¨æ¥å¹¶å‘çš„ç›´æ¥åœ¨ä¸€å †è¿œç¨‹æœºå™¨ä¸Šæ‰§è¡Œå‘½ä»¤ï¼Œæ¯”å¦‚ ansible all -i my-hosts -c ssh  -f 20 -a uptimeã€‚</li><li><a href=\"https://link.zhihu.com/?target=http%3A//packages.debian.org/sid/mssh\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">packages.debian.org/sid</span><span class=\"invisible\">/mssh</span><span class=\"ellipsis\"></span></a> ä½¿ç”¨ GTK+ åº“ç¼–å†™ç•Œé¢ï¼Œè·Ÿ csshx ç±»ä¼¼ï¼Œä½†è¦å·®ç‚¹ï¼Œå‡‘åˆç”¨ã€‚</li><li><a href=\"https://link.zhihu.com/?target=http%3A//www.heiho.net/pconsole/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">heiho.net/pconsole/</span><span class=\"invisible\"></span></a>  Xwindow åº”ç”¨ï¼Œtiling windows åŒæ—¶æ“ä½œå¤šä¸ªè¿œç¨‹ä¸»æœºï¼Œä¸æ€ä¹ˆå¥½ç”¨ã€‚</li><li><a href=\"https://link.zhihu.com/?target=http%3A//sourceforge.net/apps/mediawiki/clusterssh/index.php%3Ftitle%3DMain_Page\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">sourceforge.net/apps/me</span><span class=\"invisible\">diawiki/clusterssh/index.php?title=Main_Page</span><span class=\"ellipsis\"></span></a>, Perl/Tk åº”ç”¨ï¼Œtiling windows åŒæ—¶æ“ä½œå¤šä¸ªè¿œç¨‹ä¸»æœºï¼Œä¸æ€ä¹ˆå¥½ç”¨ã€‚</li><li><a href=\"https://link.zhihu.com/?target=http%3A//clusterit.sourceforge.net/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">clusterit.sourceforge.net</span><span class=\"invisible\">/</span><span class=\"ellipsis\"></span></a>,   è¿™ä¸ªè½¯ä»¶åŒ…åŒ…å«å¾ˆå¤šå·¥å…·ï¼Œdvt æ˜¯ tiling window å¼çš„äº¤äº’çš„åŒæ—¶æ“ä½œå¤šå°è¿œç¨‹æœºå™¨ï¼Œä¸å¤§å¥½ç”¨ï¼Œdsh å’Œ dshbak ç›¸å½“äº  pdsh è½¯ä»¶åŒ…é‡Œçš„ pdsh å’Œ dshbakï¼Œpcp ç›¸å½“äº pdsh é‡Œçš„ pdcpï¼Œå¦å¤– clusterit  è¿˜æœ‰ä¸€äº›å·¥å…·ç”¨äºæŒ‘é€‰æŸå°è¿œç¨‹æœºå™¨æ‰§è¡ŒæŸä¸ªå‘½ä»¤ã€‚</li><li>è‹¥å¹²ç±»ä¼¼å·¥å…·ï¼Œæ²¡ä»”ç»†ç ”ç©¶ï¼Œæµ…è¯•äº†ä¸‹è§‰å¾—ä¸å ªç”¨ï¼š</li><ul><li><a href=\"https://link.zhihu.com/?target=http%3A//pussh.sourceforge.net/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">pussh.sourceforge.net/</span><span class=\"invisible\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=http%3A//mussh.sourceforge.net/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">mussh.sourceforge.net/</span><span class=\"invisible\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=https%3A//github.com/ndenev/mpssh\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">github.com/ndenev/mpssh</span><span class=\"invisible\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=http%3A//sourceforge.net/projects/mpssh\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">sourceforge.net/project</span><span class=\"invisible\">s/mpssh</span><span class=\"ellipsis\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=http%3A//sourceforge.net/projects/mssh/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">sourceforge.net/project</span><span class=\"invisible\">s/mssh/</span><span class=\"ellipsis\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=http%3A//packages.debian.org/sid/dsh\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">packages.debian.org/sid</span><span class=\"invisible\">/dsh</span><span class=\"ellipsis\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=http%3A//www.csm.ornl.gov/torc/C3/index.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">csm.ornl.gov/torc/C3/in</span><span class=\"invisible\">dex.html</span><span class=\"ellipsis\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=http%3A//freeshell.de/~drimiks/gnu/dish.shtml\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">freeshell.de/~drimiks/g</span><span class=\"invisible\">nu/dish.shtml</span><span class=\"ellipsis\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=http%3A//taktuk.gforge.inria.fr/kanif/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">taktuk.gforge.inria.fr/</span><span class=\"invisible\">kanif/</span><span class=\"ellipsis\"></span></a></li></ul><li><a href=\"https://link.zhihu.com/?target=http%3A//capistranorb.com/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">capistranorb.com/</span><span class=\"invisible\"></span></a>ï¼ŒCapistrano  æ˜¯ä¸ªå¾ˆæœ‰æ„æ€çš„å·¥å…·ï¼Œå°¤å…¶å¯¹ Ruby ç²‰ä¸åº”è¯¥å¾ˆæœ‰å¸å¼•åŠ›ï¼Œå®ƒæœ‰ä¸ª cap shell çš„ç”¨æ³•ï¼Œåœ¨å‘½ä»¤è¡Œä¸‹åˆ©ç”¨æŒç»­çš„ ssh  è¿æ¥å¤šæ¬¡å‘é€å‘½ä»¤åˆ°ä¸€æ‰¹è¿œç¨‹ä¸»æœºä¸Šï¼ŒUI å½¢å¼å¾ˆæœ‰åˆ›æ„ã€‚Capistrano å¯ä»¥ç›´æ¥ç”¨æ¥è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤ï¼šcap COMMAND=uptime  HOSTS=localhost,purplebattle-lm.local  invokeã€‚å¯æƒœï¼Œè¿™ä¸ªå·¥å…·ä¸æ”¯æŒå¹¶å‘åº¦æ§åˆ¶ï¼Œå¦‚æœç›®æ ‡ä¸»æœºæ•°ç›®å¤ªå¤šï¼Œè¿™ä¸ªå·¥å…·ä¼šå› ä¸ºé‡åˆ° max open file limit  è€ŒæŠ¥é”™ï¼Œä¸ªäººè§‰å¾—ä½œè€…è„‘è¢‹è¢«é—¨å¤¹äº†ï¼š<a href=\"https://link.zhihu.com/?target=https%3A//github.com/capistrano/capistrano/issues/270\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">github.com/capistrano/c</span><span class=\"invisible\">apistrano/issues/270</span><span class=\"ellipsis\"></span></a>ï¼Œå¹¸å¥½æœ€æ–°çš„ Capistrano v3 æ”¯æŒå¹¶å‘åº¦æ§åˆ¶äº†ï¼š<a href=\"https://link.zhihu.com/?target=http%3A//www.capistranorb.com/2013/06/01/release-announcement.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">capistranorb.com/2013/0</span><span class=\"invisible\">6/01/release-announcement.html</span><span class=\"ellipsis\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=http%3A//fabfile.org/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">fabfile.org/</span><span class=\"invisible\"></span></a>ï¼Œè·Ÿ  Capistrano ç±»ä¼¼çš„å·¥å…·ï¼Œä¸çŸ¥é“è°æ¨¡ä»¿è°ï¼ŒFabric ä½¿ç”¨ Python ç¼–å†™ï¼Œä¸ªäººè§‰å¾—å…¶è®¾è®¡æ¯” Capistrano  æ›´ç®€å•çº¯ç²¹ï¼ŒFabric çš„æ§åˆ¶è„šæœ¬ç›´æ¥å°±æ˜¯å¾ˆæ™®é€šçš„ Python è„šæœ¬ï¼ŒCapistrano åŸºäº Ruby å¼„äº†ä¸ª DSL(è²Œä¼¼è¿™æ˜¯  Ruby ç¤¾åŒºå¯¹ Ruby è¯­è¨€æœ€è‡ªè±ªçš„åœ°æ–¹ï¼‰ï¼Œåˆ°äº† v3 åˆè½¬å‘ Rakefile äº†ï¼Œè€Œä¸”åˆ°äº† v3 æ‰æ”¯æŒå¹¶å‘åº¦æ§åˆ¶ã€‚ç”¨ Fabric  ç›´æ¥è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤ï¼šfab -H host1,host2 -z 32 -- uptimeï¼Œå‚è€ƒ <a href=\"https://link.zhihu.com/?target=http%3A//docs.fabfile.org/en/1.6/usage/fab.html%23arbitrary-remote-shell-commands\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">docs.fabfile.org/en/1.6</span><span class=\"invisible\">/usage/fab.html#arbitrary-remote-shell-commands</span><span class=\"ellipsis\"></span></a></li><li><a href=\"https://link.zhihu.com/?target=https%3A//fedorahosted.org/func/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">fedorahosted.org/func/</span><span class=\"invisible\"></span></a>ï¼Œè·Ÿ  Fabric ç±»ä¼¼ï¼ŒåŸºæœ¬ä¸Šæ˜¯ç”¨ Python  å®ç°äº†ä¸€å¥—è¿œç¨‹ç®¡ç†çš„å‡½æ•°åº“ï¼Œç„¶åå†™ä¸ªå‘½ä»¤å¼çš„æ§åˆ¶è„šæœ¬è°ƒç”¨è¿™äº›å‡½æ•°æ¥è¾¾åˆ°é…ç½®ç³»ç»Ÿçš„ç›®çš„ï¼Œæ„Ÿè§‰è®¾è®¡ä¸å¦‚ Fabric ä¼˜é›…ç®€å•ï¼Œè€Œä¸” Func  éœ€è¦åœ¨ master server ä¸Šè£…ä¸€ä¸ª cert manager æœåŠ¡ï¼Œåœ¨æ‰€æœ‰è¢«ç®¡ç†æœºå™¨ä¸Šè£… funcd æœåŠ¡ï¼Œè™½ç„¶æ¯”  puppetã€chef è¦è½»é‡ç‚¹ï¼Œä½†è·Ÿ ansibleã€fabricã€capsitrano ç›¸æ¯”è¿˜æ˜¯ç¬¨é‡äº†äº›ï¼šå®é™…ä¸­åŸºæœ¬æ‰€æœ‰è¿œç¨‹æœºå™¨éƒ½ä¼šæœ‰  ssh æœåŠ¡ï¼Œä¸ºå•¥ä¸é‡å¤åˆ©ç”¨è¿™ä¸ªç°æˆçš„åŸºç¡€è®¾æ–½å‘¢ï¼Ÿ</li><li><a href=\"https://link.zhihu.com/?target=http%3A//rexify.org/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">rexify.org/</span><span class=\"invisible\"></span></a>ï¼ŒPerl ç‰ˆçš„ Capistranoï¼Œä½œä¸ºä¸€ä¸ª Perl fanï¼Œå…¶åŸºäº Perl è®¾è®¡çš„ DSL çœ‹ç€ç›¸å½“äº²åˆ‡:-)</li><li><a href=\"https://link.zhihu.com/?target=http%3A//docs.saltstack.com/index.html\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">http://docs.saltstack.com/index.html, </a>Salt æ˜¯ä¸€ä¸ªé…ç½®ç®¡ç†å·¥å…·ï¼Œä½¿ç”¨ Python ç¼–å†™ï¼Œæ¯”èµ· puppetã€chef å®‰è£…è¦ç®€å•è®¸å¤šã€‚Salt éœ€è¦æŸå°æœºå™¨è¿è¡Œ salt-master æœåŠ¡ï¼Œæ‰€æœ‰è¢«ç®¡ç†æœºå™¨ä¸Šè¿è¡Œ salt-minion æœåŠ¡ã€‚é…ç½®å®šä¹‰ä½¿ç”¨ YAML æ ‡è®°è¯­è¨€ã€‚</li>", 
            "topic": [
                {
                    "tag": "SSH(Secure Shell)", 
                    "tagLink": "https://api.zhihu.com/topics/19557973"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": [
                {
                    "userName": "è±†ç“£é…±", 
                    "userLink": "https://www.zhihu.com/people/41d872e07eec8a4380620fd206e8adbc", 
                    "content": "é¢ï¼Œå¤§æ‚çƒ©å—", 
                    "likes": 0, 
                    "childComments": []
                }
            ]
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50795760", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 4, 
            "title": "å¤‡ä»½ç³»ç»Ÿ", 
            "content": "<p>ã€è¿ç§»ã€‘å¤‡ä»½ç³»ç»Ÿ</p><p>å¤©æœ‰ä¸æµ‹é£äº‘ï¼Œè™½ç„¶å¦‚ä»Šäº‘è®¡ç®—é£ç”Ÿæ°´èµ·ï¼Œå¤§å®¶éƒ½æŠŠåˆ†å¸ƒå¼å•¦ã€è´Ÿè½½å‡è¡¡å•¦ã€é«˜å¯ç”¨å•¦ã€æ¨ªç€åˆ‡ç«–ç€åˆ‡æ–œç€åˆ‡å•¦æŒ‚åœ¨å˜´è¾¹ï¼Œæ‚²å‰§çš„æ˜¯ IT  åŸºç¡€è®¾æ–½å¾€å¾€æ²¡è¿™ä¸ªå¾…é‡ï¼Œå †åœ¨è§’è½ç§¯ç°çš„æœåŠ¡å™¨ï¼Œad hocçš„å‡ ä¸ª rsync  è„šæœ¬ï¼Œè·‘çš„å¥½çš„æ—¶å€™å¤§å®¶ç©å‘½å¹²æ´»ï¼Œå´©æºƒäº†å¤§å®¶å°±é—²ç€èŠå¤©ç­‰ç®¡ç†å‘˜æ¢å¤ç³»ç»Ÿã€‚ç«™åœ¨è¢«å‰¥å‰Šé˜¶çº§è€ƒè™‘ï¼ŒIT  åŸºç¡€è®¾æ–½å´©äº†çœŸæ²¡å•¥ï¼Œæ­£å¥½ä¼‘æ¯ä¸‹ï¼Œå¯¹äºå‰¥å‰Šé˜¶çº§å°±ä¸æ˜¯åˆ©å¥½äº†ï¼šé©´å„¿é—²ç€ä¹Ÿæ˜¯ç™½è€—ç²®é£Ÿå•Šã€‚è€Œå¤„äºè¢«å‰¥å‰Šé˜¶çº§åˆæ­£å¥½å¤„åœ¨ç®¡ç†å‘˜ä½ç½®ä¸Šçš„å¯æ€œè™«æ¥è¯´ï¼Œæ²¡æ¯”è¿™æ—¶æ›´è›‹ç–¼çš„æ—¶å€™äº†ã€‚</p><p>è°ƒä¾ƒç‰¢éªšå®Œæ¯•ï¼Œä¿ºå…¶å®å¤§å¤šæ•°æ—¶å€™æ˜¯é‚£ä¸ªä¼‘æ¯çš„ä¸€å‘˜ï¼Œå¶å°”æ‹…æƒŠä¸€ä¸‹ä¹Ÿæ˜¯ç•¥æƒŠæ— é™©ï¼Œå“ˆå“ˆã€‚å›å½’åˆ°æŠ€æœ¯æœ¬èº«ï¼Œæˆ‘ä¸ªäººè§‰å¾— IT åŸºç¡€è®¾æ–½ä¸­çš„å¤‡ä»½ç³»ç»Ÿåº”è¯¥å…·å¤‡å¦‚ä¸‹å‡ ä¸ªç‰¹æ€§ï¼š</p><ul><li>C/S æ¶æ„ï¼šå¤‡ä»½æ˜¯æ¯å°æœºå™¨éƒ½è¦åšçš„äº‹æƒ…ï¼Œæä¸ºéœ€è¦é›†ä¸­æ§åˆ¶, ä¸æ”¯æŒ C/S æ¶æ„çš„å·¥å…·å¯ä»¥ç”¨ rsh/ssh/samba ç­‰åŒ…è£…ä¸‹å‡‘åˆæ¨¡æ‹Ÿæˆ C/S æ¶æ„ï¼›</li><li>è·¨ OS æ”¯æŒï¼šå·¥ä½œç”¨ PC ä¹Ÿæ˜¯éœ€è¦å¤‡ä»½çš„ï¼Œä¸åªæ˜¯æœåŠ¡å™¨;</li><li>å¿«é€Ÿå®šä½å¤‡ä»½æ‰€åœ¨ä½ç½®ï¼Œå°¤å…¶èƒ½å¦¥å–„å¤„ç†åˆ†å·çš„æƒ…å†µï¼Œå¤‡ä»½çš„ä¸€å¤§çª˜å¢ƒæ˜¯æ‰¾ä¸åˆ°éœ€è¦çš„æ–‡ä»¶æ”¾å“ªé‡Œäº†;</li><li>æ”¯æŒä¸åŒç§ç±»æ•°æ®çš„å¤‡ä»½ï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ã€ä»£ç åº“ï¼Œä¸æ˜¯æ‰€æœ‰æƒ…å†µéƒ½èƒ½ rsyncã€tar æå®šçš„ï¼Œåº”è¯¥å¯ä»¥å®¹æ˜“çš„è‡ªå®šä¹‰æ’ä»¶ä»¥åº”å¯¹ç‰¹å®šçš„æ•°æ®ã€‚ è¿™ä¸ªéœ€æ±‚å¯ä»¥å†™ç‹¬ç«‹è„šæœ¬åšï¼Œå¯¼å‡ºå®Œæ¯•åå†å¼€å§‹å¤‡ä»½ï¼Œä½†å¦‚æœå¤‡ä»½ç³»ç»Ÿæœ‰ç›´æ¥æ”¯æŒä¼šæ›´ä¸€è‡´æ›´æ–¹ä¾¿;</li><li>ç¨³å¦¥åº”å¯¹å¤‡ä»½å­˜å‚¨å¯ç”¨ç©ºé—´è€—å°½çš„æƒ…å†µ;</li></ul><p class=\"ztext-empty-paragraph\"><br/></p><p>æœ‰åˆ™æ›´ä½³çš„ç‰¹æ€§ï¼š</p><ul><li>æ”¯æŒå¤šç§å­˜å‚¨è®¾å¤‡ï¼šç¡¬ç›˜ã€ç£å¸¦ã€å…‰ç›˜ï¼Œè¿™å‡ ç§ä»‹è´¨æœ¬èº«çš„ç‰¹æ€§å†³å®šäº†åœ¨å†™å…¥æ—¶ä¸èƒ½ç­‰åŒçœ‹å¾…; ä¸æ”¯æŒçš„è¯éœ€è¦é¢å¤–å†™è„šæœ¬ï¼Œæ¯”å¦‚ä»ç¡¬ç›˜è½¬å‚¨åˆ°ç£å¸¦ã€å…‰ç›˜;</li><li>æ”¯æŒåˆ†å·å­˜å‚¨ï¼šå¤‡ä»½çš„å­˜å‚¨æ€»æœ‰è€—å°½çš„æ—¶å€™ï¼Œéœ€è¦èƒ½å¤Ÿå®¹æ˜“çš„åˆ‡æ¢å­˜å‚¨ä½ç½®ç»§ç»­å†™å…¥;</li><li>æ”¯æŒå¢é‡å¤‡ä»½æˆ–è€…å·®å¼‚å¤‡ä»½ï¼ŒåŠ å¿«å¤‡ä»½é€Ÿåº¦;</li><li>èƒ½å®šåˆ¶ç­–ç•¥å†³å®šå®Œæ•´ã€å¢é‡å¤‡ä»½çš„é¢‘ç‡å’Œé¡ºåºï¼Œèƒ½å®šåˆ¶å¤‡ä»½è½®è½¬ç­–ç•¥ï¼Œæˆ–è€…ç›´æ¥</li><li>æ”¯æŒ GFS è½®è½¬ç­–ç•¥ï¼Œä¸æ”¯æŒçš„è¯ä¹Ÿå¯ä»¥å†™è„šæœ¬åŒ…è£…ä¸‹;</li></ul><p class=\"ztext-empty-paragraph\"><br/></p><p>æä¸€å¥å¢é‡å¤‡ä»½å’Œå·®å¼‚å¤‡ä»½çš„åŒºåˆ«ï¼šincremental backup æŒ‡åªå¤åˆ¶ä¸Šæ¬¡å¤‡ä»½ä»¥æ¥æ›´æ”¹çš„æ–‡ä»¶ï¼Œdifferential backup æŒ‡åªå¤åˆ¶è‡ªä¸Šæ¬¡å®Œæ•´å¤‡ä»½ä»¥æ¥æ›´æ”¹çš„æ–‡ä»¶ã€‚</p><p>å¤‡ä»½çš„å­˜å‚¨æ ¼å¼ä¸Šï¼Œæœ‰ä¸€äº›æµè¡Œçš„åšæ³•ï¼š</p><ul><li>ä¿å­˜ä¸€ä»½å¿«ç…§ä»¥åŠä¸€ç³»åˆ—è¡¥ä¸ï¼Œè¿™ç§åšæ³•å¯¹é¢‘ç¹ä¿®æ”¹çš„å¤§æ–‡ä»¶å¾ˆæœ‰åˆ©ï¼Œæ¯”å¦‚ Outlook çš„é‚®ç®±æ–‡ä»¶</li><li>ä¿å­˜å¤šä»½å¿«ç…§ï¼Œå¿«ç…§ä¹‹é—´ç”¨ç¡¬é“¾æ¥å…±äº«ç›¸åŒå†…å®¹çš„æ–‡ä»¶</li><li>æ‰“åŒ…å­˜æ”¾ï¼Œä¸€èˆ¬æ˜¯å®Œæ•´å¤‡ä»½åŠ ä¸Šå¤šä¸ªå¢é‡å¤‡ä»½æˆ–è€…å·®å¼‚å¤‡ä»½</li></ul><p>æœ‰ä¸€äº›å·¥å…·æŒ‰æ•°æ®å—å­˜æ”¾æ–‡ä»¶ï¼Œä»¥æ›´å¤§ç¨‹åº¦çš„é¿å…é‡å¤æ•°æ®ï¼Œå¦‚æœå¤‡ä»½å·¥å…·æ—¢æ²¡æœ‰æŒ‰æ•°æ®å—å»é‡ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨è¡¥ä¸ï¼Œé‚£ä¹ˆéœ€è¦ç‰¹åˆ«è€ƒè™‘é¢‘ç¹ä¿®æ”¹çš„å¤§æ–‡ä»¶å¦‚ä½•è½¬æ¢æˆâ€œå¤‡ä»½å‹å¥½â€çš„ï¼Œä¸€èˆ¬æ˜¯å°†å¤§æ–‡ä»¶å¯¼å‡ºæˆå¤šä¸ªç‰‡æ®µï¼Œå¤§éƒ¨åˆ†ç‰‡æ®µæ˜¯ä¸å˜çš„ï¼Œæ¯”å¦‚æŒ‰æ—¥æœŸåˆ‡åˆ†é‚®ç®±ã€‚  å¦å¤–å¿«ç…§å¼å¤‡ä»½è™½ç„¶æ¢å¤æ–‡ä»¶æ—¶å¾ˆæ–¹ä¾¿ï¼Œä½†ä¼šæ¶ˆè€—å¤§é‡ inodeã€‚</p><p>å¯¹è¿œç¨‹å¤‡ä»½çš„å®ç°ï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼Œä¸€ç§æ˜¯  pullï¼Œå¤‡ä»½æœåŠ¡å™¨ä¸»åŠ¨å»å…¶ä»–æœåŠ¡å™¨æ‰“åŒ…æ–‡ä»¶å¹¶ä¼ åˆ°å¤‡ä»½å­˜å‚¨é‡Œï¼Œä¸€èˆ¬ç”¨ rsh/ssh/samba  å®ç°ï¼Œå¥½å¤„æ˜¯è¢«å¤‡ä»½çš„æœºå™¨ä¸éœ€è¦è£…ç‰¹åˆ«çš„ä¸œè¥¿ï¼Œåå¤„æ˜¯è¢«å¤‡ä»½çš„æœºå™¨éœ€è¦å¼€ä¸€ä¸ªç‰¹æƒå¸å·ç»™å¤‡ä»½æœåŠ¡å™¨ç”¨ï¼Œå¦‚æœè¢«å¤‡ä»½æœºå™¨æ˜¯ä¸ªäººå·¥ä½œ  PCï¼Œæˆ‘è§‰å¾—æ€ªæ€ªçš„ï¼Œåƒè¢«äººå®‰äº†åé—¨ï¼Œå¯¹äºå…¶ä»–éœ€è¦å¤‡ä»½çš„æœåŠ¡å™¨ï¼Œè¿™ä¹Ÿæ˜¯ä¸ªå®‰å…¨éšæ‚£ï¼Œä¸€æ—¦å¤‡ä»½æœåŠ¡å™¨è¢«æ”»é™·ï¼Œå…¶å®ƒæœåŠ¡å™¨å°±éƒ½åºŸäº†ã€‚</p><p>å¦ä¸€ç§è¿œç¨‹å¤‡ä»½æ–¹å¼æ˜¯ pushï¼Œéœ€è¦å¤‡ä»½çš„æœåŠ¡å™¨è£…ä¸€ä¸ªä»£ç†æœåŠ¡ç¨‹åºï¼Œå®ƒæ”¶é›†æ–‡ä»¶ä¼ ç»™å¤‡ä»½å­˜å‚¨æœåŠ¡å™¨é›†ä¸­å­˜æ”¾ã€‚æˆ‘æ¯”è¾ƒåå¥½è¿™ç§æ–¹å¼ï¼Œè™½ç„¶éƒ¨ç½²è¦éº»çƒ¦ç‚¹ã€‚</p><p>å¾€å¾€å¤‡ä»½å·¥å…·å¯ä»¥åŒæ—¶æ”¯æŒè¿™ä¸¤ç§æ¨¡å¼ï¼Œå› ä¸ºå¦‚æœèƒ½ rsh/ssh/samba è®¿é—®è¢«å¤‡ä»½ç³»ç»Ÿçš„æ–‡ä»¶ï¼Œé€‚å½“é…ç½®çš„è¯å°±å¯ä»¥è®©è¢«å¤‡ä»½æœºå™¨å¾€ä¸­å¿ƒå­˜å‚¨æœåŠ¡å™¨ä¸Šä¼ å¤‡ä»½ã€‚</p><p>BTWï¼Œå›¾å½¢ç•Œé¢çš„æ¡Œé¢ PC å¤‡ä»½å·¥å…·ä¸åœ¨è®¨è®ºèŒƒå›´å†…ï¼Œè¿™ä¸ªä¸»é¢˜æ˜¯ä¸ºç³»ç»Ÿç®¡ç†å‘˜è®¾å®šçš„ã€‚</p><p><b>å¤‡ä»½ç­–ç•¥</b></p><p>å¤‡ä»½çœ‹èµ·æ¥æ˜¯ä¸ªå¾ˆç®€å•çš„äº‹æƒ…ï¼Œå®é™…æ“ä½œæ—¶æ˜¯æœ‰è®²ç©¶çš„ï¼Œæ¯”å¦‚è¿™ä¸ªç®€å•çš„å¢é‡å¤‡ä»½ç­–ç•¥ï¼šæ¯å‘¨æ—¥åšä¸€æ¬¡å®Œæ•´å¤‡ä»½ï¼Œéšåæ¯å¤©å¤‡ä»½å‰ä¸€å¤©ä¿®æ”¹çš„æ–‡ä»¶ã€‚çœ‹èµ·æ¥å¾ˆèŠ‚çº¦ç£ç›˜ï¼Œä½†æ˜¯å®ƒæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>è¿™ä¸€ä¸ªæ˜ŸæœŸçš„å¤‡ä»½ï¼Œä»»æ„ä¸€æ¬¡æŸåï¼Œéƒ½ä¼šå¯¼è‡´æŸåçš„å¤‡ä»½ä¹‹åçš„æ¢å¤ä¸å®Œæ•´</li><li>è¶Šå¾€åæ¢å¤è¶Šéº»çƒ¦ï¼Œå› ä¸ºéœ€è¦è¿™ä¸€æ˜ŸæœŸé‡Œä¹‹å‰çš„æ‰€æœ‰å¢é‡å¤‡ä»½(æƒ³æƒ³å¦‚æœä½ çš„å¤‡ä»½æ˜¯åˆ†å·å­˜å‚¨çš„)</li></ul><p>ä¸ºäº†ç¼“è§£è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œéœ€è¦å®šåˆ¶ç¨å¾®å¤æ‚ç‚¹çš„å¤‡ä»½ç­–ç•¥ã€‚å…ˆä»‹ç»ä¸€ä¸ªæœ¯è¯­&#34;å¤‡ä»½çº§åˆ«&#34;(backup  level): level 0 è¡¨ç¤ºå®Œæ•´å¤‡ä»½(full backup)ï¼Œlevel n è¡¨ç¤ºå¤‡ä»½ä¸Šæ¬¡ level n-1  å¤‡ä»½ä»¥æ¥ä¿®æ”¹è¿‡çš„æ–‡ä»¶ï¼Œå¦‚æœä¹‹å‰åœ¨ level 0 ä¹‹åæ²¡æœ‰ level n-1 å¤‡ä»½ï¼Œåˆ™æ˜¯ level n-2 å¤‡ä»½ä»¥æ¥ï¼Œä¸€ç›´é€’å½’åˆ°level 0  ä»¥æ¥ã€‚</p><p>ä¸Šé¢çš„ç®€å•ç­–ç•¥å°±æ˜¯å‘¨æ—¥ level 0 å¤‡ä»½ï¼Œå‘¨ä¸€ level 1ï¼Œå‘¨äºŒ level 2ï¼Œå‘¨ä¸‰ level  3ï¼Œ...ï¼Œå‘¨å…­ level 6ã€‚ åœ¨ O&#39;Reilly çš„ã€ŠBackup &amp;  Recoveryã€‹ç¬¬äºŒç« ä¸­ä¸“é—¨è®²è¿°äº†è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯å…¶ä¸­æ¨èçš„ä¸¤ç§ç­–ç•¥ï¼š</p><ul><li>å‘¨æ—¥åšä¸€æ¬¡å®Œæ•´å¤‡ä»½ï¼Œå‘¨ä¸€åˆ°å‘¨å…­æ¯å¤©åšä¸€æ¬¡ level-1 å¤‡ä»½ï¼Œä¹Ÿå°±æ˜¯å·®å¼‚å¤‡ä»½</li><li>Hanoi è°ƒåº¦ç­–ç•¥: å‘¨æ—¥ level 0ï¼Œæ¥ä¸‹æ¥ level 3/2/5/4/7/6.</li></ul><p class=\"ztext-empty-paragraph\"><br/></p><p>Hanoi è°ƒåº¦ç­–ç•¥çš„ç»“æœ(å‡è®¾æ‰€æœ‰å¤‡ä»½åœ¨åˆå¤œåäºŒç‚¹å¼€å§‹)ï¼š</p><ul><li>å‘¨æ—¥ level 0;</li><li>å‘¨ä¸€ level 3ï¼Œåªå¤‡ä»½å‘¨ä¸€ä¿®æ”¹çš„æ–‡ä»¶;</li><li>å‘¨äºŒ level 2ï¼Œå› ä¸º level 3 &gt; level 2ï¼Œæ‰€ä»¥ç”¨ level 0 å‚ç…§ï¼Œå¤‡ä»½å‘¨ä¸€ã€å‘¨äºŒä¿®æ”¹çš„æ–‡ä»¶;</li><li>å‘¨ä¸‰ level 5ï¼Œä»¥ level 2 å‚ç…§(æˆ‘æœ‰ç‚¹å¥‡æ€ªä¸ºå•¥ä¸å‚ç…§ level 3)ï¼Œå¤‡ä»½å‘¨ä¸‰ä¿®æ”¹çš„æ–‡ä»¶;</li><li>å‘¨å›› level 4ï¼Œå‚ç…§ level 2 (åŒå¥‡æ€ª)ï¼Œå¤‡ä»½å‘¨ä¸‰ã€å‘¨å››ä¿®æ”¹çš„æ–‡ä»¶;</li><li>å‘¨äº” level 7ï¼Œå‚ç…§ level 4ï¼Œå¤‡ä»½å‘¨äº”ä¿®æ”¹çš„æ–‡ä»¶;</li><li>å‘¨å…­ level 6ï¼Œå‚ç…§ level 4ï¼Œå¤‡ä»½å‘¨äº”ã€å‘¨å…­ä¿®æ”¹çš„æ–‡ä»¶;</li></ul><p>å¤§éƒ¨åˆ†æ—¶å€™æ–‡ä»¶å¤‡ä»½äº†ä¸¤æ¬¡ï¼Œæ¯”è¾ƒå¯é ï¼Œå¤§éƒ¨åˆ†æ—¶å€™æ¢å¤æ—¶ä¹Ÿä¸éœ€è¦æ‰€æœ‰å¤‡ä»½ï¼Œæ¯”è¾ƒå¿«é€Ÿæ–¹ä¾¿ï¼Œä½†ä¸å®Œç¾çš„æ˜¯å‘¨äºŒå’Œå‘¨å››ä¿®æ”¹çš„æ–‡ä»¶éƒ½åªå¤‡ä»½äº†ä¸€æ¬¡ã€‚ã€ŠBackup  &amp; Recoveryã€‹ä¸€ä¹¦æ¨èäº†æ‰©å±•åˆ°æ¯æœˆçš„ Hanoi å¤‡ä»½çº§åˆ«ç­–ç•¥ï¼Œå°±æ˜¯æŠŠæ¯æœˆçš„ç¬¬äºŒã€ä¸‰ã€å››å‘¨å‘¨æ—¥ level 0æ”¹æˆ level  1ï¼Œæˆ‘ä¸ªäººè§‰å¾—å¦‚æœæ—¶é—´å’Œå­˜å‚¨ç©ºé—´å…è®¸ï¼Œè¿˜æ˜¯æ¯å‘¨å‘¨æ—¥ä¸€æ¬¡ level 0 å®‰å…¨ç‚¹ã€‚</p><p>é™¤äº†å¤‡ä»½çš„çº§åˆ«æœ‰ç­–ç•¥ï¼Œå¤‡ä»½å­˜å‚¨ç©ºé—´æœ‰é™éœ€è¦é‡ç”¨çš„è¯ï¼Œå¤‡ä»½è½®è½¬(backup rotation) ä¹Ÿæ˜¯éœ€è¦è€ƒè™‘ç­–ç•¥çš„ï¼Œæœ‰ä¸‰ç§å¸¸è§åšæ³•(<a href=\"https://link.zhihu.com/?target=http%3A//en.wikipedia.org/wiki/Backup_rotation_scheme\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">en.wikipedia.org/wiki/B</span><span class=\"invisible\">ackup_rotation_scheme</span><span class=\"ellipsis\"></span></a>)ï¼š</p><ol><li>FIFO(First-In-First-Out)ï¼Œä¹Ÿå°±æ˜¯æ–°çš„å¤‡ä»½æ€»æ˜¯å ç”¨æœ€æ—§çš„å¤‡ä»½æ‰€å ç©ºé—´ã€‚è¿™ç§åšæ³•å¹¶ä¸æ˜¯å¾ˆæ°å½“çš„ï¼Œæ¯”å¦‚ä¿ç•™ä¸ƒæ¬¡å¤‡ä»½ï¼Œæ¯å¤©å¤‡ä»½ä¸€æ¬¡ï¼Œé‚£ä¹ˆå¦‚æœä¸€ä¸ªå¤‡ä»½é”™è¯¯ä¸€ç¤¼æ‹œä¹‹å†…æ²¡å‘ç°ï¼Œæ­£ç¡®çš„å¤‡ä»½å°±æ‰¾ä¸å›æ¥äº†ã€‚è¿™ç§ç­–ç•¥çš„é—®é¢˜æ˜¯ä¿ç•™çš„å¤‡ä»½å†å²å¤ªçŸ­ã€‚</li><li>GFS(Grandfather-father-son)ï¼Œå¯èƒ½æ˜¯æœ€å¸¸ç”¨çš„å¤‡ä»½è½®è½¬æ–¹æ¡ˆã€‚è¿™æ˜¯ä¸€ä¸ªåˆ†å±‚æ¬¡çš„  FIFOï¼Œæ¯”å¦‚ä¸‰ä¸ªå±‚æ¬¡çš„å¤‡ä»½ï¼šdaily(son), weekly(father), monthly(grandfather), daily  backups æ¯å¤©è½®è½¬ä¸€æ¬¡ï¼Œåˆ°å‘¨æ—¥æ—¶è¢«æŒ¤å‡ºå»é‚£ä¸ªå¤‡ä»½å‡çº§åˆ° weekly backups é‡Œ(æ³¨æ„ï¼šè¿™ä¸ªæ–°çš„ weekly backup  åº”è¯¥æ˜¯ä¸€ä¸ª full backupï¼Œæˆ–è€…ç›¸å¯¹æŸä¸ªæ—§çš„ weekly backup çš„ incremental/differential  backupï¼Œè€Œä¸æ˜¯ç›¸å¯¹æŸä¸ª daily backup çš„ï¼Œå› ä¸ºä¸€æ—¦ daily backups å‘ç”Ÿè½®è½¬ï¼Œè¿™ä¸ªå‚ç…§å°±æ— æ•ˆäº†ï¼‰ï¼Œweekly  backups æ¯å‘¨è½®è½¬ä¸€æ¬¡ï¼Œåˆ°æœˆåº•æ—¶è¢«æŒ¤å‡ºå»é‚£ä¸ªå¤‡ä»½å‡çº§åˆ° monthly backups é‡Œã€‚monthly backups  æ¯æœˆè½®è½¬ä¸€æ¬¡ã€‚å¦‚æœå¯¹å¤‡ä»½æ—¶é—´è¦æ±‚æ›´é•¿ï¼Œè¿˜å¯ä»¥å»ºç«‹ quaterly, biannual, annual backups æˆ–è€…å°†  grandfather å±‚æŒ¤å‡ºçš„å¤‡ä»½è½¬å‚¨ä»¥é•¿æœŸä¿å­˜ã€‚è¿™ç§æ–¹æ¡ˆå…¼å¤‡äº†ç£ç›˜å ç”¨å°‘ä»¥åŠå¤‡ä»½å‘¨æœŸé•¿çš„ä¼˜åŠ¿ï¼Œè€Œä¸”å¾ˆå®¹æ˜“ç†è§£ã€‚</li><li>Towers  of Hanoiï¼Œè¿™ä¸ªæ›´å¤æ‚äº†ï¼Œæ²¡æœ‰å¤‡ä»½ç¨‹åºè¾…åŠ©ï¼Œæ‰‹å·¥å¾ˆå®¹æ˜“å‡ºé”™ã€‚è¿™ç§ç­–ç•¥åœ¨é™åˆ¶ n  ä¸ªå¤‡ä»½ä½ç½®çš„æ¡ä»¶ä¸‹ï¼Œæ¯å¤©å¤‡ä»½ä¸€æ¬¡ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªä½ç½®æ¯ä¸¤å¤©é‡ç”¨ä¸€æ¬¡ï¼Œç¬¬äºŒä¸ªä½ç½®æ¯å››å¤©é‡ç”¨ä¸€æ¬¡ï¼Œç¬¬ä¸‰ä¸ªä½ç½®æ¯å…«å¤©é‡ç”¨ä¸€æ¬¡ï¼Œåœ¨æœ€åä¸€ä¸ªå¤‡ä»½ä½ç½®è¢«é‡å†™å‰ï¼Œèƒ½æ‰¾å›æœ€æ—©  2^(n-1) å¤©å‰çš„å¤‡ä»½ã€‚</li></ol><p><br/><b>å¤‡ä»½å·¥å…·</b></p><p>ç½—åˆ—ä¸‹ Debian æ‰“åŒ…çš„å¤‡ä»½å·¥å…·ï¼Œæ²¡è€å¿ƒçš„åŒå­¦å¯ä»¥ç›´æ¥è·³åˆ°æœ¬æ–‡æœ€æœ«å°¾çš„æ€»ç»“ï¼Œç²¾åŠ›æœ‰é™ï¼Œæ²¡æœ‰äº²è‡ªæŠ˜è…¾ Amanda, Bacula, BackupPCã€‚</p><p>* rdiff-backup</p><p>Python ç¼–å†™ï¼Œä½¿ç”¨äº† librsyncï¼ŒåŸºæœ¬ç›¸å½“äºä¸€ä¸ªæ”¯æŒå¤šç‰ˆæœ¬å¤‡ä»½çš„ã€ä¸æ”¯æŒ rsync standalone server çš„ rsyncã€‚</p><p>rdiff-backup  å¯¹ Linux æ–‡ä»¶ç³»ç»Ÿçš„å„ç§å±æ€§éƒ½æ”¯æŒå¾ˆå¥½ï¼Œä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œå®šæœŸæ‰§è¡Œ rdiff-backup dir dir.backup å°±å¯ä»¥äº†ã€‚  rdiff-backup çš„å¤‡ä»½å­˜å‚¨å¾ˆç®€å•ï¼Œé¦–å…ˆå®ƒæŠŠä¿®æ”¹è¿‡çš„æºæ–‡ä»¶å¤åˆ¶åˆ°å¤‡ä»½ç›®å½•ï¼ŒåŒæ—¶åšä¸€ä¸ªåå‘ diff ä¿å­˜åˆ°ç›®æ ‡ç›®å½•ä¸‹  rdiff-backup-data/increments/ ä¸‹å¯¹åº”è·¯å¾„ï¼Œæ¯”å¦‚ a/b.txt çš„ä¿®æ”¹ä¿å­˜åˆ°  rdiff-backup-data/increments/a/b.txt-yyyy-mm-ddThh:mm:ss+tz.diff.gzï¼Œè¿™ç§æ–¹å¼å¸¦æ¥å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p><ol><li>æœ€è¿‘çš„ä¸€æ¬¡å¤‡ä»½å¯ä»¥å¾ˆå®¹æ˜“æŸ¥çœ‹ï¼Œç›´æ¥ lessã€cp å³å¯;</li><li>æºç›®å½•ä¸èƒ½æœ‰ rdiff-backup-data/ ç›®å½•;</li><li>æ‰¾ä¸€ä¸ªæ–‡ä»¶çš„å†å²ç‰ˆæœ¬å¾ˆå®¹æ˜“ï¼Œå› ä¸º  increments/ ä¸‹å¤‡ä»½æŒ‰ç…§åŸå§‹è·¯å¾„å­˜æ”¾ï¼ŒæŸ¥çœ‹æ¯ä¸€æ¬¡å¤‡ä»½çš„æ–‡ä»¶åˆ—è¡¨ä¹Ÿå¾ˆå®¹æ˜“ï¼šrdiff-backup -l dir.backupï¼Œç„¶å  rdiff-backup --list-at-time &#39;yyyy-mm-ddThh:mm:ss+tz&#39; dir.backup;</li><li>å¤‡ä»½ä¸èƒ½å­˜å‚¨åœ¨ Windows ä¸Šï¼Œå› ä¸ºæ–‡ä»¶åæœ‰å†’å·ï¼ˆæ²¡æµ‹è¯•æ˜¯å¦åœ¨ Windows ä¸‹æœ‰è½¬ä¹‰);</li><li>æ–‡ä»¶åä¸èƒ½å¤ªé•¿ï¼Œå› ä¸ºæ–‡ä»¶ååŒ…å«æ—¶é—´æˆ³(ä¸æ˜¯é—®é¢˜ï¼Œä¸€èˆ¬æ–‡ä»¶åå…è®¸ 256 å­—èŠ‚);</li><li>ç”±äº increments/ ä¸‹æ–‡ä»¶æ•°ç›®è¶Šæ¥è¶Šå¤šï¼Œå¯¹æ–‡ä»¶ç³»ç»Ÿå‹åŠ›ä¼šæ¯”è¾ƒå¤§;</li></ol><p>è²Œä¼¼ rdiff-backup åœ¨ä¿å­˜åå‘ diff æ—¶ä¼šåˆ¤æ–­ diff å’Œæºæ–‡ä»¶å¤§å°ï¼Œå¦‚æœ diff å¤ªå¤§åˆ™ç›´æ¥ä¿å­˜ä¸€ä»½æ­¤æ–‡ä»¶ã€‚è¿™ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº†æœ€æ–°å¤‡ä»½æŸåå¯¼è‡´æ—§çš„åå‘ diff å¤±å»æ„ä¹‰çš„é£é™©ã€‚</p><p>æ€»ç»“ï¼š rdiff-backup å¾ˆé€‚åˆæ–‡ä»¶å¤‡ä»½ï¼Œæˆ‘è‡ªå·±æŠŠå®ƒæ”¾åœ¨å®šæ—¶ä»»åŠ¡é‡Œï¼Œä¸¤å¹´ä¸‹æ¥å¤‡ä»½æ‰€å ç£ç›˜ç©ºé—´ä¾ç„¶å¾ˆå°‘ï¼Œè¿è¡Œå¾ˆç¨³å®šã€‚å¦‚æœæ‹…å¿ƒæŒç»­å¢é‡å¤‡ä»½è€ŒåŸºå‡†ç‰ˆæœ¬æŸåï¼Œå¯ä»¥å®šæœŸçš„æ¢å¤æŸä¸ªç‰ˆæœ¬å‡ºæ¥ï¼Œæ‰“åŒ…å•ç‹¬å­˜æ”¾ã€‚</p><p>* rsnapshot</p><p>Perl  ç¼–å†™ï¼Œè°ƒç”¨äº† rsyncï¼Œ è¿™ä¸ªå·¥å…·åœ¨ ã€ŠBackup and Recoveryã€‹ã€ã€ŠBSD Hacksã€‹ä¸­éƒ½æåˆ°è¿‡ã€‚rsnapshot  çš„åˆ›æ„å¾ˆå·§å¦™ï¼Œå®ƒåœ¨ç¬¬ä¸€æ¬¡å¤‡ä»½æ—¶æŠŠæºç›®å½•å¤åˆ¶ä¸€ä»½ï¼Œæ¯”å¦‚ hourly.0/ï¼Œç„¶åä»¥åå¤‡ä»½æ—¶ï¼Œå¦‚æœæ–‡ä»¶æ²¡æ”¹å˜ï¼Œåˆ™ä¸ºè¿™ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªç¡¬é“¾æ¥ï¼Œæ¯”å¦‚åœ¨  hourly.1/ é‡Œï¼Œå…±äº«ä¹‹å‰çš„æ–‡ä»¶å¤‡ä»½å†…å®¹ï¼›å¦‚æœæ”¹å˜äº†å°±å¤åˆ¶æºæ–‡ä»¶ã€‚è¿™æ ·æ¯ä¸€ä¸ªå¤‡ä»½çœ‹èµ·æ¥éƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ‹·è´ã€‚</p><p>è¿™æ ·åšçš„ç»“æœæ˜¯æŸ¥æ‰¾å¤‡ä»½æä¸ºå®¹æ˜“ï¼Œå ç”¨ç£ç›˜ä¹Ÿå¾ˆå°‘ï¼Œæ–‡ä»¶åä¹Ÿæ²¡æœ‰é¢å¤–çš„å­—ç¬¦ï¼Œä½†æ˜¯è·Ÿ  rdiff-backup ä¸€æ ·ä¸æ”¯æŒå¤‡ä»½çº§åˆ«ï¼Œæ²¡æœ‰å®šæœŸçš„å®Œæ•´å¤‡ä»½ï¼ŒæŸä¸ªæ–‡ä»¶æŸåçš„è¯å®ƒçš„æ‰€æœ‰ç¡¬é“¾æ¥æŒ‡å‘çš„æ–‡ä»¶éƒ½å¤±æ•ˆã€‚rsnapshot  æ²¡æœ‰è€ƒè™‘æ–‡ä»¶æ‰©å±•å±æ€§æ¯”å¦‚  acl/xattrï¼Œå¤‡ä»½æ‰€åœ¨æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒè¿™äº›ç‰¹æ®Šå±æ€§å°±ä¼šä¸¢å¤±ä¿¡æ¯ï¼Œè€Œæ™®é€šæ–‡ä»¶å±æ€§ç›´æ¥ä¾èµ–æ–‡ä»¶ç³»ç»Ÿï¼Œæ¯”å¦‚æŠµæŠ—ä¸äº†æ„å¤–çš„chmod -R ä¹‹ç±»çš„ã€‚</p><p>rsnapshot æ”¯æŒ GFS å¤‡ä»½è½®è½¬ï¼Œä½†æ‰€æœ‰å¤‡ä»½éƒ½æ˜¯åŒ…å«ç¡¬é“¾æ¥çš„å¿«ç…§ï¼Œéœ€è¦æ³¨æ„åŸºå‡†ç‰ˆæœ¬å¤±æ•ˆçš„é£é™©ã€‚ rsnapshot è¿˜æ”¯æŒè§¦å‘å¤–éƒ¨è„šæœ¬ï¼Œæ¯”å¦‚ä¸€ä¸ªå¯¼å‡º postgresql æ•°æ®åº“çš„è„šæœ¬ï¼Œç„¶åå¯¹å¯¼å‡ºçš„æ•°æ®æ–‡ä»¶åšå¤‡ä»½ã€‚</p><p>æ€»ç»“ï¼š  rsnapshot é€‚åˆæ–‡ä»¶ *å†…å®¹* å¤‡ä»½ï¼Œå…¶æœ€å¤§çš„ç‰¹ç‚¹æ˜¯å¤‡ä»½çš„å¿«ç…§å­˜å‚¨æ ¼å¼å°±åƒå¤åˆ¶äº†ä¸€ä»½ç›®å½•æ ‘ï¼Œå¯ä»¥ç”¨ findã€grepã€cp  ç­‰ç›´æ¥æ“ä½œï¼Œä¸è¿‡rdiff-backup æœ‰ä¸ª rdiff-backup-fs å·¥å…·ä¸º rdiff-backup åˆ›å»ºä¸€ä¸ª  fuseæ–‡ä»¶ç³»ç»Ÿï¼Œè¾¾åˆ°ç±»ä¼¼ rsnapshot çš„æ•ˆæœã€‚</p><p>å¦‚æœåœ¨ä¹æ–‡ä»¶çš„å±æ€§ï¼Œè€Œä¸”æœ‰é¢‘ç¹ä¿®æ”¹çš„å¤§æ–‡ä»¶ï¼Œæ¨èç”¨ rdiff-backupã€‚</p><p>* dirvish</p><p>è·Ÿ rsnapshot æ€è·¯ä¸€æ ·ï¼Œæ¯” rsnapshot çŸ¥ååº¦å°çš„å¤šã€‚</p><p>* Flexbackup</p><p>Perl è„šæœ¬ï¼Œè‡ª 2003 å¹´å·²ç»æ²¡æ›´æ–°äº†ï¼Œé™†ç»­æœ‰ä¸€äº›å¢å¼ºæ€§èƒ½çš„è¡¥ä¸è¢«å‘è¡Œç‰ˆæ”¶å½•ï¼Œæ¯”å¦‚ Gentoo(<a href=\"https://link.zhihu.com/?target=http%3A//sources.gentoo.org/cgi-bin/viewvc.cgi/gentoo-x86/app-backup/flexbackup/files/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">sources.gentoo.org/cgi-</span><span class=\"invisible\">bin/viewvc.cgi/gentoo-x86/app-backup/flexbackup/files/</span><span class=\"ellipsis\"></span></a>), Debian(<a href=\"https://link.zhihu.com/?target=http%3A//patch-tracker.debian.org/package/flexbackup/1.2.1-6\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">patch-tracker.debian.org</span><span class=\"invisible\">/package/flexbackup/1.2.1-6</span><span class=\"ellipsis\"></span></a>)ã€‚<br/>Flexbackup æ•´ä¸ªç¨‹åºåªæœ‰ä¸€ä¸ªè„šæœ¬ï¼Œå¾ˆä¾¿æºï¼Œä½¿ç”¨ä¹Ÿéå¸¸ç®€å•ï¼Œå°±ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å¤‡ä»½æœ¬åœ°æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡rsh/ssh å¤‡ä»½è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œè¾“å‡ºå¯ä»¥æ˜¯ç£å¸¦ã€ç¡¬ç›˜ã€æ–‡ä»¶å¤¹ï¼Œæ”¯æŒå¤‡ä»½çº§åˆ«ï¼Œæ¯ä¸€æ¬¡å¤‡ä»½é»˜è®¤ä»¥ tar ball æ ¼å¼ä¿å­˜ã€‚</p><p>Flexbackup  æ²¡æœ‰ç‰¹åˆ«è®°å½•æ–‡ä»¶åœ¨å“ªä¸€ä¸ªå½’æ¡£é‡Œï¼Œåªè®°å½•äº†æ¯ä¸ªå½’æ¡£çš„å¤‡ä»½çº§åˆ«ä»¥åŠå¤‡ä»½æ—¥æœŸï¼Œå¦‚æœå¿˜è®°å½’æ¡£æ–‡ä»¶åçš„æ„ä¹‰ï¼Œé‚£ä¹ˆæ‰¾æ–‡ä»¶åªèƒ½é€ä¸ªå¤‡ä»½çš„flexbackup  -list äº†ï¼Œå…¶å®å°±æ˜¯ tar tvf åˆ—å‡ºå½’æ¡£é‡Œçš„æ–‡ä»¶åˆ—è¡¨ï¼Œåœ¨ tar ball å¾ˆå¤§æ—¶ä¼šå¾ˆæ…¢ï¼Œå› æ­¤å¯èƒ½éœ€è¦é¢å¤–åŒ…è£…ä¸‹  Flexbackup æŠŠæ¯ä¸ªå½’æ¡£é‡Œçš„æ–‡ä»¶åˆ—è¡¨æå–å‡ºæ¥å­˜æ”¾ä»¥åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ã€‚</p><p>åœ¨æŠŠç©æ—¶å‘ç°ä¸€ä¸ªæœ‰æ„æ€çš„ç»†èŠ‚ï¼ŒFlexbackup  åœ¨å¤‡ä»½ç»“æŸæ—¶ touch äº†ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œæ—¶é—´æˆ³æ–‡ä»¶çš„ atime å’Œ mtime éƒ½æ˜¯å¤‡ä»½å¼€å§‹æ—¶ç²¾ç¡®åˆ°åˆ†é’Ÿçš„æ—¶é—´ï¼Œæ¯”å¦‚å¤‡ä»½æ˜¯ 22:05:33  å¼€å§‹çš„ï¼Œé‚£ä¹ˆæ—¶é—´æˆ³æ–‡ä»¶çš„ atime å’Œ mtime éƒ½æ˜¯22:05:00ã€‚è¿™ä¸ªç­–ç•¥ä¼šå¯¼è‡´åœ¨ 22:05:00 è‡³ 22:05:33  ä¹‹é—´ä¿®æ”¹å®Œæ¯•çš„æ–‡ä»¶åœ¨éšåçš„å¢é‡å¤‡ä»½é‡Œåˆä¼šè¢«å¤‡ä»½ä¸€æ¬¡ï¼Œæ›´åˆ«æåœ¨  22:05:33å¼€å§‹åˆ°å¤‡ä»½ç»“æŸæœŸé—´ä¿®æ”¹å®Œæ¯•çš„æ–‡ä»¶äº†ã€‚åä¸€ç§é‡å¤å¤‡ä»½æ˜¾ç„¶æ˜¯å¿…è¦çš„ï¼Œå‰ä¸€ç§é‡å¤å¤‡ä»½å¾ˆå¯èƒ½æ˜¯å¤šä½™çš„ï¼Œä½†è€ƒè™‘åˆ° atime/mtime  æ›´æ–°æœ‰ä¸€å®šè¯¯å·®ï¼Œä¸ºäº†é¿å…ç«æ€æ¡ä»¶ï¼Œå°†æ—¶é—´æˆ³æå‰ä¸€ç‚¹å°±ä¿é™©å¤šäº†ï¼ˆç–‘é—®ï¼šå¦‚æœåˆšå¥½åœ¨æ•´ç§’å¼€å§‹å¤‡ä»½å‘¢ï¼Ÿæˆ‘è§‰å¾—æ—¶é—´æˆ³æå‰ä¸€åˆ†é’Ÿæ›´ä¿é™©)ã€‚</p><p>ç»†è¿½ç©¶ä¸‹æ¥ï¼Œä¸ç”±æ„Ÿå¹ä¸€ä¸‹ï¼Œæœ‰æ²¡æœ‰ä¸ç»æ€ç´¢çš„ç®¡ç†å‘˜åœ¨å¤‡ä»½ç»“æŸå touch ä¸€ä¸ªæ–‡ä»¶ä½œä¸ºæ—¶é—´æˆ³äº†äº‹å‘¢ï¼Ÿ è‡ªå·±ä¸´æ—¶å†™çš„ç³™å¿«çŒ›çš„å¤‡ä»½å°è„šæœ¬çœ‹èµ·æ¥å®¹æ˜“ï¼Œå…¶å®å¾€å¾€æš—è—é™·é˜±ã€‚</p><p>Flexbackup æ”¯æŒå¤‡ä»½çº§åˆ«ï¼Œå› æ­¤è‡ªèº«å°±é¿å…å¿«ç…§ç±»å¤‡ä»½å·¥å…·éšå«çš„å”¯ä¸€åŸºå‡†ç‰ˆæœ¬æŸåçš„é£é™©ã€‚</p><p>æ€»ç»“ï¼šFlexbackup  å¾ˆé€‚åˆæ›¿æ¢è‡ªå·±ä¸´æ—¶æ‹¼å‡‘çš„å¤‡ä»½å°è„šæœ¬ï¼ŒFlexbackup çš„åšæ³•ä¼ ç»Ÿã€ç›´ç™½ã€å¯é ï¼Œä½†å¯¹äºæ•°æ®åº“ã€ç‰ˆæœ¬åº“ç­‰éœ€è¦ç”¨å…¶å®ƒå·¥å…·å¯¼å‡ºä¸‹å†è®©  Flexbackup å¤‡ä»½ï¼Œæ–‡ä»¶çš„æ‰©å±•å±æ€§å¦‚ aclã€xattr éœ€è¦é¢å¤–å¤„ç†ã€‚å¦å¤–éš¾å¾—çš„æ˜¯ Flexbackup  è€ƒè™‘äº†ç£å¸¦è®¾å¤‡ï¼Œåæ¥çš„å¤‡ä»½å·¥å…·å¾€å¾€å‡å®šäº†å¤‡ä»½å­˜å‚¨æ˜¯ç¡¬ç›˜ï¼Œéœ€è¦ç®¡ç†å‘˜é¢å¤–å¤„ç†ç¡¬ç›˜åˆ°ç£å¸¦çš„è½¬å‚¨ã€‚</p><p>* backup2l</p><p>backup2l  å°±åƒæ˜¯ Flexbackup çš„å‚»ç“œç‰ˆï¼ŒFlexbackup  çš„åŠŸèƒ½æ˜¯æ¯”è¾ƒä½çº§çš„ï¼Œæä¾›äº†åšå¤šçº§å¤‡ä»½çš„åŠŸèƒ½ï¼Œä½†å¤šçº§å¤‡ä»½æ—¶æœºã€å¤‡ä»½è½®è½¬ç­–ç•¥éƒ½éœ€è¦é¢å¤–å†™è„šæœ¬ä»¥åŠ cron jobï¼Œè€Œ backup2l  ç›´æ¥æä¾›äº†è¿™ä¸¤ä¸ªç‰¹æ€§(å½“ç„¶å°±ä¸èƒ½éšæ„çš„åˆ¶å®šå¤šçº§å¤‡ä»½ç­–ç•¥äº†)ï¼Œå¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ backup2l  ç”Ÿæˆå½’æ¡£æ—¶é¡ºå¸¦ç”Ÿæˆäº†ä¸€ä»½æ–‡ä»¶åˆ—è¡¨ï¼Œè¿™æ ·æŸ¥æ‰¾æ–‡ä»¶ä¼šå¿«å¾ˆå¤šï¼Œä¸ç”¨æ¯æ¬¡éƒ½å» tar tf å½’æ¡£æ–‡ä»¶æŸ¥çœ‹äº†ã€‚backup2l è¿˜ç”Ÿæˆäº†æ–‡ä»¶çš„ md5  æ‘˜è¦ï¼Œå¯ä»¥ç”¨æ¥æ ¡éªŒå¤‡ä»½æ˜¯å¦æŸåã€‚</p><p>backup2l åªè€ƒè™‘äº†å¤‡ä»½åˆ°ç£ç›˜ï¼Œæ²¡ä¸“é—¨è€ƒè™‘ç£å¸¦çš„æƒ…å†µï¼Œæ›´éœ€è¦æ³¨æ„çš„æ˜¯ backup2l é‡‡ç”¨çš„ level 0, level 1, level 2 è¿™æ ·çš„é€çº§å¢é‡å¤‡ä»½ï¼Œå‰é¢è®²è¿‡è¿™å…¶å®æ˜¯ä¸å¤§å¥½çš„åšæ³•ã€‚</p><p>æ€»ç»“ï¼šbackup2l ç‰ºç‰²äº†ä¸€ç‚¹çµæ´»æ€§å’Œå¯é æ€§ï¼Œå¼•å…¥äº†æ›´å¤šç‰¹æ€§ï¼Œå¹¶ä¸”ä½¿ç”¨æ–¹ä¾¿ã€‚</p><p>* boxbackup</p><p>C/S æ¶æ„çš„å¤‡ä»½å·¥å…·ï¼Œå·ç§°æ”¯æŒ OpenBSD/Linux/NetBSD/FreeBSD/MacOS X/Windows/Solaris, åœ¨ <a href=\"https://link.zhihu.com/?target=http%3A//www.boxbackup.org/wiki/Installation\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">boxbackup.org/wiki/Inst</span><span class=\"invisible\">allation</span><span class=\"ellipsis\"></span></a> æåˆ° client ç«¯åˆ é™¤æ—§æ–‡ä»¶æ—¶ï¼ŒæœåŠ¡ç«¯ä¹Ÿä¼šå¾ˆå¿«çš„æ¸…é™¤è¿™ä¸ªæ–‡ä»¶çš„å¤‡ä»½ï¼Œæˆ‘æ²¡å¤§çœ‹æ˜ç™½è¿™æ˜¯åœ¨è¯´ä»€ä¹ˆï¼Œè²Œä¼¼æ˜¯boxbackup å®ç°çš„å±€é™å¯¼è‡´å¯èƒ½ä¸¢è€æ•°æ®ï¼Œéœ€è¦ç”¨æˆ·æ‰‹åŠ¨ç»•è¿‡è¿™ä¸ªé—®é¢˜ã€‚</p><p>boxbackup-client  æœ‰ä¸¤ç§æ¨¡å¼ï¼Œä¸€ç§æ˜¯ä½œä¸ºæœåŠ¡æŒç»­è¿è¡Œï¼Œå¯ä»¥å¿«é€ŸæŒç»­çš„æ¢æµ‹ä¿®æ”¹å¹¶å¤‡ä»½åˆ°æœåŠ¡å™¨ä¸Šï¼Œå¦ä¸€ç§æ˜¯ä½œä¸ºå®šæ—¶ä»»åŠ¡è¿è¡Œï¼Œå¾—åˆ°å®¢æˆ·ç«¯è¢«å¤‡ä»½æ–‡ä»¶çš„å¿«ç…§ã€‚client  å’Œ server ä¹‹é—´ç”¨ ssl è®¤è¯å’Œé€šè®¯ï¼Œå®¢æˆ·ç«¯å¤‡ä»½çš„æ–‡ä»¶å¯ä»¥è¢«åŠ å¯†åå†ä¼ ç»™æœåŠ¡å™¨ã€‚</p><p>boxbackup çš„å®‰è£…è¿‡ç¨‹å®˜æ–¹æ–‡æ¡£åœ¨å¯†é’¥ç®¡ç†é‚£å—è¯­ç„‰ä¸è¯¦ï¼Œdpkg-reconfigure åˆæŠ¥é”™ï¼Œè¿˜å¥½ /usr/share/doc/boxbackup-server/READ.Debian.gz è¯´çš„æ¯”è¾ƒæ¸…æ¥šã€‚ ä¸‹é¢æ˜¯å®‰è£…è¿‡ç¨‹ï¼š</p><p>Server:<br/>    # aptitude install boxbackup-server<br/>    # mkdir /backup<br/>    # chown bbstored:bbstored /backup</p><p>    ### &#34;dpkg-reconfigure boxbackup-server&#34; fails, have to configure it manually.<br/>    # raidfile-config /etc/boxbackup 4096 /backup<br/>    # bbstored-config /etc/boxbackup http://gold.corp.example.com bbstored<br/>    # bbstored-certs /etc/boxbackup/ca init<br/>    # bbstored-certs /etc/boxbackup/ca sign-server /etc/boxbackup/bbstored/gold.corp.example.com-csr.pem<br/>    # cp -a /etc/boxbackup/ca/servers/gold.corp.example.com-cert.pem /etc/boxbackup/bbstored<br/>    # cp -a /etc/boxbackup/ca/roots/clientCA.pem /etc/boxbackup/bbstored<br/>    # service boxbackup-server restart<br/>    # bstoreaccounts create 1 0 1024M 1250M</p><p>ä¸Šé¢åˆ›å»ºäº†å¸å· 1ï¼Œå¸å·å¯ä»¥æ˜¯å…«ä½åå…­è¿›æ•°ã€‚</p><p>Client:<br/>    # aptitude install boxbackup-client<br/>    # bbackupd-config /etc/boxbackup lazy 1 http://gold.corp.example.com /var/lib/bbackupd /home</p><p>    å¦‚æœ lazy æ”¹æˆ snapshotï¼Œé‚£ä¹ˆéœ€è¦æŠŠ /etc/cron.d/boxbackup-client ä¸­çš„æ³¨é‡Šæ‰“å¼€ã€‚</p><p>    ### On server side:<br/>    # bbstored-certs /etc/boxbackup/ca sign /etc/boxbackup/bbackupd/1-csr.pem<br/>    ### in this case, server and client are in same box<br/>    # cp -a /etc/boxbackup/ca/clients/1-cert.pem /etc/boxbackup/bbackupd/<br/>    # cp -a /etc/boxbackup/ca/roots/serverCA.pem /etc/boxbackup/bbackupd/<br/>    # service boxbackup-client restart</p><p>boxbackup  çš„è¿™å¥— ssl è¯ä¹¦ç®¡ç†çœ‹èµ·æ¥æŒºèµçš„ï¼Œå¾ˆç¬¦åˆä¼ä¸šç¯å¢ƒçš„éœ€æ±‚ã€‚å¤‡ä»½åœ¨æœåŠ¡ç«¯çš„å­˜å‚¨æœ‰ç‚¹åƒ GIT çš„ object  databaseï¼Œboxbackup æœ‰è‡ªå·±çš„ RAID5 è½¯ä»¶å®ç°ï¼Œæäº¤æ–‡ä»¶å­˜å‚¨çš„å¯é æ€§ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ç¡¬ä»¶ RAID æˆ–è€… Linux çš„  device mapper æ”¯æŒã€‚ å®¢æˆ·ç«¯çš„ bbackupquery æœ‰äº¤äº’æ¨¡å¼ï¼Œåƒæ˜¯ä¸ª ftp  å®¢æˆ·ç«¯ï¼Œå¯ä»¥æšä¸¾æ–‡ä»¶ã€æ¯”è¾ƒå¤‡ä»½å’Œæœ¬åœ°çš„åŒºåˆ«ã€æ¢å¤æ–‡ä»¶ç­‰ç­‰ã€‚</p><p><b>ä½†æ˜¯</b>ï¼Œåœ¨æˆ‘ä¿®æ”¹ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶åï¼Œå¤‡ä»½é‡Œçš„è¿™ä¸ªæ–‡ä»¶<b>å±…ç„¶æ¶ˆå¤±</b>äº†ï¼Œbbackupctl force-syncåä¾æ—§ï¼Œå¤ªä¸ç¨³å®šäº†ï¼ box-backup server çš„æ–‡ä»¶å­˜å‚¨æ ¼å¼çœ‹èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œæ²¡æœ‰ tar ballæˆ–è€…åˆ†æ•£å•æ–‡ä»¶å­˜å‚¨å¯é ã€‚</p><p>æ€»ç»“ï¼šçœ‹èµ·æ¥ç‰¹æ€§å¾ˆä¸é”™ï¼Œå¯æ˜¯æœ‰ bugã€‚ã€‚ã€‚ã€‚</p><p>* BackupPC</p><p>åœ¨ã€ŠBackup  &amp; Recoveryã€‹ä¸­è°ˆåˆ°ä¸‰ä¸ªå¼€æºå¤‡ä»½å·¥å…·ï¼ŒAmanda, BackupPC, Baculaï¼Œä½† BackupPC  çš„åæ°”å°çš„å¤šï¼Œå¯èƒ½æ˜¯BackupPC è¿™ä¸ªåå­—å¤ªå¼±äº†ï¼Œæ€ä¹ˆçœ‹éƒ½æ— æ³•è”æƒ³åˆ°ä¼ä¸šçº§å¤‡ä»½è½¯ä»¶ã€‚BackupPC å¯¹ Windows  æ”¯æŒä¸æ˜¯å¾ˆå¥½ï¼Œæ®è¯´å°†æ¥ä¼šæœ‰æ”¯æŒWindows VSS çš„ BackupPC windows å®¢æˆ·ç«¯ã€‚</p><p>BackupPC ä½¿ç”¨  Perl ç¼–å†™ï¼Œæœ€å¤§çš„ç‰¹è‰²ä¸€æ˜¯æ–‡ä»¶å»é‡ï¼ŒäºŒæ˜¯æ–¹ä¾¿çš„ Web ç•Œé¢ã€‚BackupPCä»¥æ–‡ä»¶é•¿åº¦ä»¥åŠæ–‡ä»¶éƒ¨åˆ†å†…å®¹è®¡ç®— MD5  æ‘˜è¦ä½œä¸ºå¤‡ä»½æ–‡ä»¶çš„æ–‡ä»¶åï¼Œæ‰€ä»¥å¯ä»¥è·¨ç›®å½•æ ‘è·¨å¤šæ¬¡å¤‡ä»½å»é‡ã€‚ Web  ç•Œé¢å¯ä»¥ä¿®æ”¹é…ç½®é€‰é¡¹ï¼Œæµè§ˆå„ä¸ªè¢«å¤‡ä»½ä¸»æœºçš„æƒ…å†µï¼Œæµè§ˆå¤‡ä»½å†…å®¹ï¼Œå‘èµ·å¤‡ä»½ï¼Œæ¢å¤æ–‡ä»¶ç­‰ç­‰ï¼Œä¸æ„§æ˜¯ä¼ä¸šçº§çš„æ´¾å¤´ã€‚</p><p>BackupPC æ˜¯  pull æ¨¡å¼çš„ï¼Œå¯ä»¥ä½¿ç”¨ tar over rsh/sshã€rsync over rsh/sshã€rsyncdå’Œ smbclient  å¤‡ä»½æ–‡ä»¶ï¼Œæ¨èä½¿ç”¨ rsync or rsyncdï¼Œå› ä¸º tar å’Œ smbclient æ–¹å¼ä½¿ç”¨æ–‡ä»¶çš„ mtime åˆ¤æ–­æ˜¯å¦éœ€è¦å¤‡ä»½ï¼Œæ²¡è€ƒè™‘  ctime ä»¥åŠå…¶å®ƒæ–‡ä»¶å±æ€§ï¼Œæ‰€ä»¥åœ¨ *å¢é‡å¤‡ä»½*æ—¶å¯èƒ½ä¼šæ¼å¤‡ä»½ä¸œè¥¿(å…³é”®æ˜¯ mtime æ˜¯å¯ä»¥ä¿®æ”¹çš„)ï¼Œæ¯”å¦‚ tar xf å‡ºæ¥çš„æ–‡ä»¶æœ‰å¾ˆæ—©çš„  mtimeï¼Œè¿˜æœ‰åˆ é™¤å’Œæ”¹åçš„æ–‡ä»¶ã€‚å¯ä»¥ç”¨ Filesys::SmbClient æ›¿æ¢ smbclient ç¨‹åºåˆ¤æ–­ mtimeä¹‹å¤–çš„æ–‡ä»¶å±æ€§ã€‚</p><p>BackupPC  å¯¹ Windows æ”¯æŒä¸æ˜¯å¤ªå¥½ï¼Œä¸èƒ½å¤‡ä»½è¢«é”å®šçš„æ–‡ä»¶ï¼Œä¸èƒ½å¤‡ä»½é POSIX çš„æ–‡ä»¶å±æ€§ã€‚å¯¹äºæ–‡ä»¶é”å®šé—®é¢˜ï¼ŒBackupPC  ä¼šå‘é‚®ä»¶æé†’ç”¨æˆ·æŸä¸ªæ–‡ä»¶é•¿æ—¶é—´æ²¡è¢«å¤‡ä»½ï¼Œæç¤ºç”¨æˆ·é€€å‡ºé”å®šæ­¤æ–‡ä»¶çš„ç¨‹åºï¼Œå¹¶ä½¿ç”¨é‚®ä»¶é‡Œæåˆ°çš„é“¾æ¥è§¦å‘å¤‡ä»½ã€‚ BackupPC å¤‡ä»½  Windowsä¸»è¦ç”¨ samba è·å–æ–‡ä»¶ï¼Œåœ¨å…¬å¸é‡Œå¯ä»¥ç”±ç®¡ç†å‘˜å»ºç«‹ä¸€ä¸ªåŸŸå¸å·ï¼ŒåŠ å…¥æ¯å° Windows æœºå™¨çš„Backup operators  ç»„é‡Œã€‚å¦ä¸€ä¸ªåŠæ³•æ˜¯ç”¨ BackupPC ä½œè€…æ‰“åŒ…çš„ cygwin-rsyncd(<a href=\"https://link.zhihu.com/?target=http%3A//sourceforge.net/projects/backuppc/files/cygwin-rsyncd/2.6.8_0/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">sourceforge.net/project</span><span class=\"invisible\">s/backuppc/files/cygwin-rsyncd/2.6.8_0/</span><span class=\"ellipsis\"></span></a>)ï¼Œä¸è¿‡æœ‰ç‚¹è€äº†ï¼Œå¯ä»¥è‡ªå·±æ‰“åŒ…æœ€æ–°çš„ cygwin é‡Œçš„ rsyncã€‚</p><p>æ€»ç»“ï¼š ä¸æƒ³é¼“æ£å¤æ‚çš„ Amandaã€Bacula çš„è¯ï¼ŒBackupPC æ˜¯å¾ˆå€¼å¾—å°è¯•çš„ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>* Amanda</p><p>Amanda   æ˜¯è€ç‰Œå¼€æºå¤‡ä»½è½¯ä»¶äº†ï¼Œç°åœ¨ä¾ç„¶åœ¨å‘å¸ƒæ–°ç‰ˆæœ¬ï¼Œä¸“é—¨é’ˆå¯¹å¤‡ä»½å­˜å‚¨ä»‹è´¨ä¸ºç£å¸¦è®¾è®¡çš„ï¼Œè¿å¤‡ä»½åˆ°ç£ç›˜æ—¶ä¹Ÿæ˜¯å†™å…¥è™šæ‹Ÿç£å¸¦ã€‚ã€‚ã€‚æˆ‘å¥½åƒåœ¨ç”µå½±é‡Œè§è¿‡è‡ªåŠ¨æ¢å…‰ç›˜çš„æœºå™¨ï¼Œä½†è¿˜ä»æ¥æ²¡è§è¿‡è‡ªåŠ¨æ¢ç£å¸¦çš„æœºå™¨ï¼Œä¼°æ‘¸ç€å¦‚æœæ˜¯ç”¨ç£å¸¦å¤‡ä»½æ–‡ä»¶çš„è¯ï¼ŒAmandaè¿˜æ˜¯ç›¸å½“å¼ºå¤§çš„ã€‚åœ¨å¦‚ä»Šè¿™ä¸ªç¡¬ç›˜æ¶¨ä»·ã€å®¹é‡å¢åŠ ä½†é€Ÿåº¦åœæ»ä¸å‰çš„æ—¶ä»£ï¼Œç£å¸¦ä½œä¸ºæ•°æ®å¤‡ä»½æ˜¯ä¸ªå¯ä»¥è€ƒè™‘çš„é€‰æ‹©ï¼Œå‚è§<a href=\"https://link.zhihu.com/?target=http%3A//hardware.solidot.org/article.pl%3Fsid%3D12/05/25/0647205\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">hardware.solidot.org/ar</span><span class=\"invisible\">ticle.pl?sid=12/05/25/0647205</span><span class=\"ellipsis\"></span></a> å’Œ <a href=\"https://link.zhihu.com/?target=http%3A//hardware.solidot.org/article.pl%3Fsid%3D12/03/30/0515204\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">hardware.solidot.org/ar</span><span class=\"invisible\">ticle.pl?sid=12/03/30/0515204</span><span class=\"ellipsis\"></span></a> ã€‚</p><p>Amanda çš„ Windows å®¢æˆ·ç«¯æ¯” Burp è¦æ›´â€œWindowsâ€ç‚¹ï¼Œä½†ä¹Ÿæ²¡å¥½å“ªé‡Œå»ï¼ŒåŸºæœ¬å°±æ˜¯ä¸ª GUI åŒ–çš„é…ç½®ç¼–è¾‘å™¨ã€‚ä¸ºäº†è®°å½•å¤‡ä»½äº†ä»€ä¹ˆæ–‡ä»¶ï¼ŒAmanda çš„windows å®¢æˆ·ç«¯æ‰“åŒ…äº†ä¸€ä¸ª MySQL æœåŠ¡å™¨ï¼Œæ„Ÿè§‰æœ‰ç‚¹å¤¸å¼ ã€‚</p><p>* Bacula</p><p>Bacula æ¯” Amanda å¹´è½»ï¼Œä½†æ„Ÿè§‰å·²ç„¶èµ¶è¶…äº†ï¼Œæ® Bacula ç½‘ç«™ä¸Šè¯´æ³•ï¼Œä»<a href=\"https://link.zhihu.com/?target=http%3A//sf.net\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">sf.net</span><span class=\"invisible\"></span></a> ä¸‹è½½ç»Ÿè®¡çœ‹ï¼ŒBacula æ˜¯æœ€å—æ¬¢è¿çš„å¤‡ä»½å·¥å…·ã€‚ æ²¡æ·±å…¥ç ”ç©¶è¿™ä¸œè¥¿ï¼Œå…‰ä» Windows client çœ‹ï¼Œç¡®å®æ˜¯è¿™ä¸€å †é‡Œçœ‹èµ·æ¥æœ€ä¼ä¸šçº§çš„ã€‚</p><p>Bacula è·Ÿ Amanda ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€å¼€å§‹é’ˆå¯¹å¤‡ä»½å­˜å‚¨ä¸ºç£å¸¦çš„æƒ…å½¢è®¾è®¡çš„ï¼Œè™½ç„¶åæ¥ä¹Ÿæ”¯æŒå¤‡ä»½åˆ°ç£ç›˜ï¼Œä½†æ˜¯ä¹ŸåŸºæœ¬æ˜¯æŠŠæ–‡ä»¶çœ‹æˆç£å¸¦ç®¡ç†çš„ï¼Œæ—©æœŸç‰ˆæœ¬è¿éšæœºå®šä½ç£ç›˜æ–‡ä»¶éƒ½ä¸è¡Œã€‚æˆ‘æ²¡æœ‰æ·±å…¥ç ”ç©¶ Bacula åœ¨è¿™æ–¹é¢çš„ç¼ºç‚¹ï¼ŒBurp ä½œè€…å€’æ˜¯æ‰¹è¯„äº†è¿™ä¸ªã€‚</p><p>Amanda  è²Œä¼¼æ²¡æœ‰æ–‡ä»¶å»é‡ä¸€è¯´ï¼ŒBacula æœ‰æä¸ºåŸºæœ¬çš„æ–‡ä»¶å»é‡ï¼šç¬¬ä¸€æ¬¡å¤‡ä»½å¯ä»¥æŒ‡å®šä¸º base  backupï¼Œä¹‹åå¤‡ä»½ä¸­å¦‚æœæœ‰æ–‡ä»¶å±æ€§ã€å†…å®¹æ²¡æ”¹å˜çš„æ–‡ä»¶åŒ…å«åœ¨ base backup ä¸­ï¼Œåˆ™ä¼šè·³è¿‡æ­¤æ–‡ä»¶çš„å¤‡ä»½ã€‚  è¿™ç§åšæ³•å¯ä»¥ä½¿ç”¨äºå¤‡ä»½æ“ä½œç³»ç»Ÿï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿä¸€æ—¦å®‰è£…åç³»ç»Ÿæ–‡ä»¶å¤§éƒ¨åˆ†ä¸ä¼šæ›´æ”¹ï¼Œä½†ä¸ªäººè§‰å¾—è¿™ç§å»é‡çš„åšæ³•å±€é™æ€§å¤ªå¤§äº†ï¼Œä¼Šä¸æ˜¯æŒ‰ç…§æ–‡ä»¶ md5 or  sha1 æ‘˜è¦å»é‡çš„ã€‚</p><p>Bacula çš„é…ç½®ç›¸å½“å¤æ‚ï¼Œå‚æ•°ã€æ¦‚å¿µæš´å¤šã€‚</p><p>* Burp</p><p>Burp çš„ä½œè€…åœ¨å…¶ä¸»é¡µæ•°è½äº†ä¸å°‘ Bacula çš„ç¼ºç‚¹ï¼š<a href=\"https://link.zhihu.com/?target=http%3A//burp.grke.net/why.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">burp.grke.net/why.html</span><span class=\"invisible\"></span></a> å¤§è‡´ç¿»è¯‘è¿‡æ¥ï¼ŒBaculaï¼š</p><ul><li>é…ç½®å¤ªå¤æ‚äº†ï¼ŒBacula åˆ†æˆå››ä¸ªç‹¬ç«‹æœåŠ¡ï¼Œæ¯ä¸ªæœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶;</li><li>ä»£ç å¾ˆå¤æ‚ï¼Œéš¾ç»´æŠ¤</li><li>ä¸»è¦ä¸ºç£å¸¦å¤‡ä»½è®¾è®¡ï¼Œä¸é€‚åˆç£ç›˜å­˜å‚¨</li><li>ç¼–ç›®ï¼ˆæŸä¸ªæ–‡ä»¶åœ¨å“ªä¸ªå½’æ¡£ä¸­ï¼‰å’Œå½’æ¡£åˆ†å¼€å­˜æ”¾ï¼Œå¯¼è‡´ç»´æŠ¤éº»çƒ¦</li><li>æ€»æ˜¯å¤åˆ¶æ•´ä¸ªæ–‡ä»¶ï¼Œå“ªæ€•åªæ”¹äº†å‡ ä¸ªå­—èŠ‚</li><li>éå¸¸ä¾èµ–æ—¶é’Ÿç²¾åº¦</li><li>ç¬”è®°æœ¬ä¸Šå¤‡ä»½éš¾ä»¥è°ƒåº¦ï¼ˆå› ä¸ºç¬”è®°æœ¬å¯èƒ½éšæ—¶ä¸­æ­¢å¤‡ä»½ï¼Ÿ)</li><li>ä¸æ”¯æŒæ–­ç‚¹ç»­å¤‡</li><li>å¤‡ä»½è½®è½¬ç­–ç•¥éš¾ä»¥é…ç½®åˆç†</li><li>ä¸æ”¯æŒ Windows EFS æ–‡ä»¶</li></ul><p>åœ¨ <a href=\"https://link.zhihu.com/?target=http%3A//burp.grke.net/faq.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">burp.grke.net/faq.html</span><span class=\"invisible\"></span></a>  ä¸­æœ‰ Burp è¯¦ç»†çš„ç‰¹æ€§æ¸…å•ï¼Œçœ‹èµ·æ¥ç›¸å½“è¯±äººã€‚åœ¨ Debian ä¸Šæµ…è¯•äº†ä¸‹ï¼Œä½“éªŒè¿˜æ˜¯å¾ˆæ„‰æ‚¦çš„ï¼Œå®‰è£…å®Œ burp åŒ…åä¿®æ”¹  /etc/default/burpå¯ç”¨å®ƒï¼Œç„¶å service burp start å¯åŠ¨ä¹‹ï¼Œè¿™å°±å®Œäº‹äº†ã€‚é»˜è®¤  /etc/burp/burp.confä¼šå¤‡ä»½ /homeï¼Œæ­¤ç›®å½•å†…å®¹å·¨å¤§çš„åŒå­¦è®°å¾—ä¿®æ”¹ä¸‹å†æµ‹è¯•ã€‚/etc/cron.d/burp  è¿™ä¸ªå®¢æˆ·ç«¯çš„å®šæ—¶ä»»åŠ¡é»˜è®¤æ˜¯æ³¨é‡Šæ‰äº†ï¼Œæ‰‹åŠ¨æ‰§è¡Œ burp -a b ä¼šåšä¸€æ¬¡å®Œæ•´å¤‡ä»½ã€‚burp æœåŠ¡ç«¯çš„å¤‡ä»½é»˜è®¤æ”¾åœ¨  /var/spool/burp ä¸‹ï¼ŒæŒ‰å®¢æˆ·ç«¯çš„ cname åˆ†ç›®å½•å­˜æ”¾ï¼Œè¢«å¤‡ä»½çš„æ–‡ä»¶è¢« gzip  å‹ç¼©åæŒ‰ç…§åŸæ¥çš„ç›®å½•å¸ƒå±€å­˜æ”¾ï¼Œæ¯ä¸€ä¸ªå¤‡ä»½æ˜¯ä¸€ä¸ªå¿«ç…§ï¼Œå¯ä»¥é€‰æ‹©æ˜¯å¦ç”¨ç¡¬é“¾æ¥èŠ‚çº¦ç£ç›˜ï¼Œå¦å¤–æ¯ä¸€ä¸ªå¤‡ä»½é¢å¤–å­˜æ”¾äº†æ–‡ä»¶æ¸…å•ã€ç›¸å¯¹ä¸‹ä¸€æ¬¡å¤‡ä»½çš„æ–‡ä»¶å†…å®¹å·®å¼‚ç­‰ä¿¡æ¯ã€‚ç”±äºæ¯ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æ˜¯å•ç‹¬å­˜æ”¾çš„ï¼Œæ‰€ä»¥ä¼šæ¶ˆè€—å¤§é‡  inodeã€‚</p><p>æˆ‘è§‰å¾— burp æ¯”è¾ƒçˆ½çš„åœ°æ–¹ï¼š</p><ul><li>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ˜¯åŒä¸€ä¸ªç¨‹åºï¼Œéƒ¨ç½²ç®€å•;</li><li>æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¹‹é—´ç”¨ ssl è¯ä¹¦éªŒè¯ï¼Œè€Œä¸”è¯ä¹¦æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„;</li><li>ä¸ä¾èµ–æ•°æ®åº“;</li><li>æ¯ä¸€ä¸ªå¤‡ä»½æ˜¯ä¸€ä¸ªå¿«ç…§ï¼Œæ–¹ä¾¿æŸ¥çœ‹;</li><li>æŸ¥çœ‹å¤‡ä»½åˆ—è¡¨ã€å¤‡ä»½é‡Œçš„æ–‡ä»¶åˆ—è¡¨å¾ˆæ–¹ä¾¿ï¼Œè¿˜æ”¯æŒæ–‡ä»¶è·¯å¾„çš„è¿‡æ»¤;</li><li>å®¢æˆ·ç«¯æ‰§è¡Œ burp -a t æ—¶ç”±æœåŠ¡ç«¯å†³å®šæ˜¯å¦åˆ°æ—¶é—´ç‚¹éœ€è¦å¤‡ä»½äº†;</li><li>æ‰§è¡Œæ—¶çš„æ—¥å¿—è¾“å‡ºæŒºæ¸…æ¥šçš„ï¼Œä»£ç ç®€å•æ‰«äº†ä¸‹ï¼Œæ•´æ´æœ´å®;</li><li>æ”¯æŒ GFS æ—¥å¿—è½®è½¬ç­–ç•¥;</li><li>æœåŠ¡ç«¯å¯ä»¥åœ¨ /var/spool/burp/xxx/ ä¸‹ touch ä¸€ä¸ª backup æ–‡ä»¶ï¼Œè¿™ä¼šè®©å®¢æˆ·ç«¯ xxx ä¸‹æ¬¡ burp -a t æ—¶ç«‹é©¬è§¦å‘å¤‡ä»½ï¼Œé—´æ¥è¾¾åˆ°äº†æ¸©å’Œçš„ pull å¤‡ä»½æ•ˆæœ;</li><li>ä¿å­˜äº† sha1 æ‘˜è¦ï¼Œå¯ä»¥æ ¡éªŒå¤‡ä»½;</li><li>æ”¯æŒ Windows</li><li>æ–­ç‚¹ç»­å¤‡</li></ul><p class=\"ztext-empty-paragraph\"><br/></p><p>ä» 2011 å¹´ 1 æœˆåˆ°å‡ å¤©å‰(2012-5-28) å‘å¸ƒ burp-1.3.6ï¼Œè™½ç„¶å†å²ä¸ä¹…ï¼Œä½†ä½œè€…å¯è¶³äº†åŠ²è·Ÿ Bacula å”±å¯¹å°æˆä¼¼çš„ï¼Œç›¸å½“æ´»è·ƒã€‚</p><p>Burp ä¸æ”¯æŒå¤šçº§åˆ«ï¼Œæ¯ä¸€ä»½å¿«ç…§é»˜è®¤ä¸ä½¿ç”¨ç¡¬é“¾æ¥èŠ‚çº¦ç©ºé—´ï¼ˆçŒœæµ‹æ˜¯ä¼ è¾“æ—¶åªä¼ å·®å¼‚éƒ¨åˆ†ï¼Œå†™å…¥ç£ç›˜æ—¶æŠŠæ—§å¤‡ä»½æ‹·è´ä¸€ä»½å†åº”ç”¨è¡¥ä¸ï¼Œå…¼é¡¾ä¼ è¾“é«˜æ•ˆä»¥åŠå­˜å‚¨å¯é )ï¼Œå¦‚æœä½¿ç”¨ç¡¬é“¾æ¥çš„è¯åˆæœ‰åŸºå‡†ç‰ˆæœ¬æŸåå¯¼è‡´åç»­å¤‡ä»½å¤±æ•ˆçš„é£é™©ï¼Œéœ€è¦å®šæœŸæ¢å¤ä¸€ä»½å‡ºæ¥å•ç‹¬å­˜å‚¨ã€‚</p><p>Burp çš„ Windows å®¢æˆ·ç«¯æŒºåœŸï¼Œå°±ä¸€ä¸ª windows å®šæ—¶ä»»åŠ¡ï¼Œæ²¡å›¾å½¢ç•Œé¢ï¼Œå¤‡ä»½æ²¡é—®é¢˜ï¼Œæ¢å¤å¾—ä¸Šå‘½ä»¤è¡Œäº†ï¼Œä¸è¿‡å€’æ˜¯éå¸¸çš„è½»é‡çº§ã€‚Burp æœåŠ¡ç«¯å¯ä»¥ä¸ºå®¢æˆ·ç«¯è®¾ç½®é…ç½®ï¼Œå¹¶ä¸”èƒ½ä¸»åŠ¨å‡çº§å®¢æˆ·ç«¯ï¼Œå¯¹ç®¡ç†å‘˜æ˜¯æŒºå‹å¥½çš„ã€‚</p><p>æ€»ç»“ï¼š å€¼å¾—è¯„ä¼°è¯•ç”¨ã€‚</p><p>* backupninja</p><p>backupninja  åŸºæœ¬æ˜¯ä¸€ä¸ª shell å†™æˆçš„å¤‡ä»½æ¡†æ¶ï¼Œä¾é æ’ä»¶ï¼ˆç§°ä¸º handler)åšå…·ä½“çš„æ•°æ®åº“å¯¼å‡ºã€ç‰ˆæœ¬åº“å¯¼å‡ºã€æ•°æ®ä¼ è¾“ç­‰æ“ä½œï¼Œæ¯”å¦‚ mysql  å¯¼å‡ºã€postgresqlå¯¼å‡ºã€rsync ä¼ è¾“ã€rdiff-backup ä¼ è¾“ã€duplicity ä¼ è¾“ï¼Œbackupninja  æŠŠå®ƒä»¬çš„é…ç½®é›†ä¸­èµ·æ¥ç»Ÿä¸€æ ¼å¼ï¼Œç„¶åè°ƒç”¨å„ä¸ªæ’ä»¶ã€‚å¯¹äº tar æ’ä»¶ï¼Œå¤‡ä»½æ¯æ¬¡éƒ½æ˜¯å®Œæ•´å¤‡ä»½ï¼Œå¯¹äº  rsync/rdiff-backup/duplicityï¼Œå¤‡ä»½çš„å­˜å‚¨æ˜¯å¿«ç…§å¼çš„ï¼Œè²Œä¼¼ä¼šä½¿ç”¨ç¡¬é“¾æ¥ä»¥èŠ‚çº¦ç£ç›˜ã€‚backupninja æä¾›äº†ä¸€ä¸ª  curses çš„ ninjahelperç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œè¿˜æŒºå¥½ä¸Šæ‰‹ã€‚</p><p>ä¸ªäººè§‰å¾— backupninja è¿™å±‚æ¡†æ¶å¤ªé¸¡è‚‹äº†ï¼Œç»Ÿä¸€çš„é…ç½®æ–‡ä»¶æ ¼å¼è™½å¥½ï¼Œä½†å¯èƒ½æ–°å¢é—®é¢˜ã€‚å¯æ€œå…¶ä½œè€…ä» 2004 å¹´å¼€å§‹æŒç»­å¼€å‘è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œä»Šå¹´(2012) å¹´é©¬ä¸Šå°±è¦å‘å¸ƒæ­£å¼çš„ 1.0 äº†ï¼Œæ±—ï¼</p><p>* obnam</p><p>Python ç¼–å†™ï¼Œå¾ˆæ–°çš„å¤‡ä»½å·¥å…·ï¼Œä¸€äº›ç‰¹ç‚¹ï¼š</p><ul><li>å¿«ç…§ä¼¼çš„å¤‡ä»½ï¼Œæ¯ä¸€ä¸ªå¤‡ä»½çœ‹èµ·æ¥éƒ½åƒæ˜¯å®Œæ•´å¤‡ä»½</li><li>è·¨å¤‡ä»½ã€è·¨æ–‡ä»¶çš„å»é‡</li><li>ä½¿ç”¨ GnuPG åšåŠ å¯†å¤‡ä»½</li><li>æ”¯æŒ pull å’Œ push æ¨¡å¼çš„è¿œç¨‹å¤‡ä»½</li><li>æ–­ç‚¹ç»­å¤‡</li></ul><p>å®‰è£…ä½¿ç”¨äº†ä¸‹ï¼Œå±…ç„¶ç¬¬ä¸€æ¬¡å¤‡ä»½éƒ½åšä¸äº†ï¼ŒæŠ›å¼‚å¸¸ã€‚ã€‚ã€‚çœ‹æ¥ç›¸å½“ä¸ç¨³å®šã€‚çœ‹é”™è¯¯ä¿¡æ¯ï¼Œä¼¼ä¹å­˜å‚¨æ ¼å¼ç”¨äº†ä»€ä¹ˆ B-treeï¼Œå†åŠ ä¸Šå¿«ç…§ã€å»é‡ï¼Œçœ‹èµ·æ¥å¤‡ä»½å‡ºé”™å¯¼è‡´æ•°æ®ä¸¢å¤±çš„å¯èƒ½æ€§å¾ˆå¤§ï¼Œä½œè€…æœ‰ç‚¹ç©å¼„æŠ€å·§ä¼¼çš„ã€‚</p><p>æ€»ç»“ï¼šä¸ç¨³å®šï¼Œä¸æ¨èã€‚</p><p>* duplicity</p><p>è·Ÿ  rdiff-backup å¾ˆåƒï¼ŒPython ç¼–å†™ï¼Œä¹Ÿæ˜¯åŸºäº librsyncã€‚ä¸åŒçš„æ˜¯å­˜å‚¨æ—¶ç”¨å•ä¸ª tar æ–‡ä»¶ä¿å­˜å½’æ¡£ï¼Œè€Œä¸æ˜¯  rdiff-backup é‚£æ ·åˆ†æ•£åœ¨å„è‡ªç›®å½•é‡Œï¼Œå¦å¤– duplicity ç”¨ GnuPG  åŠ å¯†äº†æ–‡ä»¶åˆ—è¡¨ä»¥åŠå½’æ¡£å†…å®¹ï¼Œå¯ä»¥é˜²æ­¢å¤‡ä»½æ‰€åœ¨æœåŠ¡å™¨æŸ¥çœ‹æˆ–è€…ä¿®æ”¹å½’æ¡£ã€‚</p><p>æ€»ç»“ï¼šä½¿ç”¨æ²¡æœ‰ rdiff-backup æ–¹ä¾¿ï¼Œæ²¡æœ‰ç‰¹æ®Šè€ƒè™‘æ–‡ä»¶çš„ acl å’Œ xattr å±æ€§ã€‚</p><p>* hdup</p><p>hdup ä½œè€…å£°ç§°ä¸å†ç»´æŠ¤è¿™ä¸ªå·¥å…·äº†ï¼Œä»–è½¬å‘äº† rdupã€‚</p><p>æ€»ç»“ï¼šå¿½ç•¥ã€‚</p><p>* rdup</p><p>rdup åªç”Ÿæˆéœ€è¦å¤‡ä»½çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶ä¸çœŸçš„åšå¤‡ä»½ï¼Œéœ€è¦å…¶å®ƒå·¥å…·é…åˆï¼Œä»¥éµå¾ªå°å·¥å…·åˆä½œçš„å“²å­¦ã€‚</p><p>æ€»ç»“ï¼šå¿½ç•¥ã€‚</p><p>* vbackup</p><p>ä¸€å¥— shell è„šæœ¬ï¼Œå¾ˆç®€é™‹çš„æ’ä»¶æœºåˆ¶ã€‚</p><p>æ€»ç»“ï¼šå¿½ç•¥ä¹‹ã€‚</p><p>* slbackup</p><p>å¯¹ rdiff-backup çš„ç®€å•å°è£…ï¼Œç»™ä¸€ä¸ªåŸºäº Debian çš„æ•™è‚²ç”¨é€”å‘è¡Œç‰ˆå®šåˆ¶çš„å®šæ—¶å¤‡ä»½ä»»åŠ¡ã€‚</p><p>æ€»ç»“ï¼šå¿½ç•¥ä¹‹ã€‚</p><p>* backup-manager</p><p>backup-manager  åšçš„äº‹æƒ…å¾ˆç®€å•ï¼Œå®šæœŸç”¨ tar åšå®Œæ•´å¤‡ä»½ï¼Œæˆ–è€…åšå®Œæ•´å¤‡ä»½ç„¶ååšå¢é‡å¤‡ä»½ï¼Œå°†ç”Ÿæˆçš„ tar ball é€šè¿‡ ssh/ftp/rsync  ç­‰ä¸Šä¼ åˆ°å¤‡ä»½æœåŠ¡å™¨ã€‚backup-manager æ”¯æŒå¯¼å‡º mysql æ•°æ®åº“ä»¥åŠ svn ä»£ç åº“ï¼Œä»¥åŠç”¨ GnuPG åŠ å¯† tar ballã€‚</p><p>æ€»ç»“ï¼š å‹æ ¹æ²¡è€ƒè™‘æ¢å¤è¿™å›äº‹ï¼Œä¸ç›´æ¥æ”¯æŒæŸ¥è¯¢å¤‡ä»½æ–‡ä»¶æ‰€åœ¨å½’æ¡£ï¼ŒåŸºæœ¬å°±æ˜¯ä¸ªç³™å¿«çŒ›çš„æ‰“åŒ…ã€ä¸Šä¼ é›†ä¸­å­˜å‚¨è„šæœ¬ï¼Œè¿œè¿œä¸æ»¡è¶³ä¸€ä¸ªå¤‡ä»½ç³»ç»Ÿçš„éœ€æ±‚ã€‚</p><p>* chiark-backup</p><p><a href=\"https://link.zhihu.com/?target=http%3A//chiark.greenend.org.uk\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">chiark.greenend.org.uk</span><span class=\"invisible\"></span></a> ç½‘ç«™ä½¿ç”¨çš„å¤‡ä»½è„šæœ¬ã€‚</p><p><b>æ€»ç»“</b></p><p>ç®€å•ç‚¹ï¼Œç”¨ rdiff-backup (å¿«ç…§å¼) æˆ–è€… Flexbackupã€backup2l(å¤šçº§åˆ«å¤‡ä»½)ï¼Œé«˜çº§ç‚¹ï¼Œç”¨ Burp(push æ¨¡å¼) or BackupPC(pull æ¨¡å¼)ï¼Œæ›´ä¼ä¸šçº§ç‚¹ï¼Œç”¨ Amanda or Baculaã€‚</p><p>Flexbackupã€Baculaã€Amanda ç›´æ¥æ”¯æŒç£å¸¦å¤‡ä»½ï¼Œåä¸¤è€…èƒ½è‡ªåŠ¨ç®¡ç†ç£å¸¦ã€‚</p><p>Amandaã€Baculaã€Burp æ”¯æŒ Windows çš„VSS(Volume Shadow copy Service)ï¼Œå¯ä»¥å¤‡ä»½æ­£è¢«æ‰“å¼€çš„æ–‡ä»¶ã€‚</p><p>å¦‚æœæœ‰é¢‘ç¹é‡å¤çš„æ–‡ä»¶ï¼Œåªæœ‰  BackupPC åšçš„æœ€å¥½ï¼Œå¯ä»¥è·¨ç›®å½•æ ‘è·¨å¤‡ä»½å»é‡ï¼Œå…¶å®ƒåŸºæœ¬éƒ½æ˜¯ä¸¤æ¬¡å¤‡ä»½ä¹‹é—´åŒä¸€æ–‡ä»¶åå»é‡ï¼Œæœ€å¸¸è§çš„æ˜¯ç”¨ç¡¬é“¾æ¥ã€‚Amandaå’Œ Bacula  è¿™ä¸¤ä¸ªä¼ä¸šçº§å¤‡ä»½è½¯ä»¶åŸºæœ¬å¯ä»¥è¯´æ²¡æœ‰å»é‡ç‰¹æ€§(ç£å¸¦çš„å»é‡å¤©ç”Ÿå°±ä¸å®¹æ˜“æï¼Œé¡ºåºè¯»å–åŠ å¤šç£å¸¦å€’è…¾ï¼Œä¼šæ­»äººçš„)ã€‚</p><p>å¿«ç…§å¼å¤‡ä»½æœ€å¥½å®šæœŸè½¬å‚¨ä¸€ä»½å®Œæ•´å¤‡ä»½å‡ºæ¥ï¼Œä»¥å…å› åŸºå‡†ç‰ˆæœ¬æŸåæˆ–è€…ç¡¬é“¾æ¥å…±åŒæŒ‡å‘çš„æ–‡ä»¶å†…å®¹æŸåï¼Œå“ªæ€•ä½¿ç”¨ç¡¬ä»¶ RAIDã€è½¯ä»¶ RAIDï¼Œè¿˜æ˜¯æœ‰å¯èƒ½æ–‡ä»¶ç³»ç»ŸæŸåã€‚</p><p>åªé’ˆå¯¹ç£ç›˜è®¾è®¡çš„å¤‡ä»½å·¥å…·ï¼Œå¯ä»¥ç”¨è‡ªå®šä¹‰è„šæœ¬å®šæœŸè½¬å‚¨åˆ°ç£å¸¦ã€å…‰ç›˜ä¸Šã€‚</p><p>rdiff-backup:  å¿«ç…§å¼çš„æŒç»­å¢é‡å¤‡ä»½ï¼Œæœ€å¥½åŠ è¾…åŠ©è„šæœ¬å®šæœŸå¯¼å‡ºæŸä¸ªå®Œæ•´ç‰ˆæœ¬ï¼Œé¿å…åŸºå‡†ç‰ˆæœ¬æŸåã€‚è¿™ä¸ªå¯¼å‡ºçš„å¤‡ä»½éœ€è¦é¢å¤–è„šæœ¬åš GFS  å¤‡ä»½è½®è½¬ã€‚å¦‚æœä¸é‡è§†æ–‡ä»¶æ‰©å±•å±æ€§ï¼Œä¹Ÿæ²¡æœ‰é¢‘ç¹ä¿®æ”¹çš„å¤§æ–‡ä»¶ï¼Œå¯ä»¥ç”¨ rsnapshotã€‚ä¸¤ä¸ªéƒ½ä¸æ”¯æŒå¤šçº§åˆ«å¤‡ä»½ï¼Œéƒ½æ˜¯é’ˆå¯¹ä»¥ç£ç›˜ä½œä¸ºå¤‡ä»½å­˜å‚¨è®¾è®¡çš„ã€‚</p><p>Flexbackup: å¤šçº§åˆ«å¤‡ä»½ï¼Œæ”¯æŒç£å¸¦ï¼Œéœ€è¦é¢å¤–ç¼–å†™å¤‡ä»½è½®è½¬è„šæœ¬ï¼Œéå¸¸çµæ´»ã€‚</p><p>Backup2l: å¤šçº§åˆ«å¤‡ä»½ï¼Œé’ˆå¯¹ç£ç›˜è®¾è®¡ï¼Œæ”¯æŒå¤‡ä»½è½®è½¬ç­–ç•¥ï¼Œä¸å¤Ÿçµæ´»ä½†ç®€ä¾¿ã€‚</p><p>Burp: å¿«ç…§å¼å¤‡ä»½ï¼Œé’ˆå¯¹ç£ç›˜è®¾è®¡ã€‚</p><p>BackupPC: å¿«ç…§å¼å¤‡ä»½ï¼Œé’ˆå¯¹ç£ç›˜è®¾è®¡ã€‚</p><p>Bacula: å¤šçº§åˆ«å¤‡ä»½ï¼Œé’ˆå¯¹ç£å¸¦è®¾è®¡ã€‚</p><p>Amanda: å¤šçº§åˆ«å¤‡ä»½ï¼Œé’ˆå¯¹ç£å¸¦è®¾è®¡ã€‚</p>", 
            "topic": [
                {
                    "tag": "å¤‡ä»½", 
                    "tagLink": "https://api.zhihu.com/topics/19551843"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50795633", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "ä»£ç è¯„å®¡ç³»ç»Ÿ ReviewBoard å’Œ Gerrit (ä¸‹)", 
            "content": "<p>ã€è¿ç§»ã€‘ä»£ç è¯„å®¡ç³»ç»Ÿ ReviewBoard å’Œ Gerrit (ä¸‹)</p><p>æ¥ä¸‹æ¥æ˜¯æŠŠç©ä¸‹ Gerritï¼Œè¿™å®çš„æ–‡æ¡£å†™çš„ä¹Ÿå¾ˆèµï¼ˆå¼€æºçš„ä¸œè¥¿æ–‡æ¡£å†™çš„å¥½çš„çœŸä¸å¤šè§ï¼‰ï¼Œå®‰è£…æ˜¯å¾ˆç®€å•äº†ï¼Œæ—©æœŸçš„ Gerrit æ®è¯´æ˜¯ç”¨  Python å†™çš„ï¼Œåœ¨ GIT ä¸»åŠ›å¼€å‘è€…ä»¥åŠ jgit é¡¹ç›®å‘èµ·äºº Shawn O. Pearce åŠ å…¥ Google åå°±æ”¹ç”¨ Java  å†™äº†ï¼Œç¼–è¯‘å¥½çš„ Gerrit å°±æ˜¯ä¸€ä¸ª war åŒ…ï¼Œå¯ä»¥æ”¾å…¥ Servlet å®¹å™¨é‡Œè¿è¡Œï¼Œä¹Ÿå¯ä»¥java -jar gerrit.war  ç›´æ¥ç”¨å†…ç½®çš„ Jettyï¼Œå¤ªè´´å¿ƒäº†ã€‚Shawn æ˜¯ä¸ªå¾ˆå‹¤å¥‹çš„äººï¼Œç”¨ Java é‡æ–°å®ç°äº† GIT æ ¸å¿ƒåŠŸèƒ½ï¼ŒGerrit å†…ç½® Web  serverã€SSH serverï¼Œè¿˜æœ‰ä¸€ä¸ª Prolog è¯­è¨€è§£é‡Šå™¨ã€‚ã€‚ã€‚ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>Gerrit é‡Œè¯„å®¡æµç¨‹åˆ†ä¸‰ä¸ªé˜¶æ®µï¼Œå¯ä»¥åˆ†åˆ«è®©ä¸åŒè§’è‰²æ‰§è¡Œï¼š</p><ul><li>review: äººè‚‰æ‰«æä»£ç æœ‰æ— é—®é¢˜</li><li>verify: ç¼–è¯‘ã€æµ‹è¯•ï¼Œå¯ä»¥ç”¨ Jenkins çš„ Gerrit Trigger æ’ä»¶è‡ªåŠ¨å‡ºå‘</li><li>submit: æäº¤ä»£ç åˆ°æ­£å¼åˆ†æ”¯ä¸Šï¼Œè²Œä¼¼ç”±äººè§¦å‘ï¼ŒGerrit æ¥æ‰§è¡Œ</li></ul><p>åœ¨ä½¿ç”¨ Gerrit æ—¶ï¼Œä¸è¦å¿˜è®°æŠŠ commit-msg hook è£…ä¸Šï¼š</p><p><a href=\"https://link.zhihu.com/?target=http%3A//gerrit-documentation.googlecode.com/svn/Documentation/2.3/user-changeid.html%23_creation\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">gerrit-documentation.googlecode.com</span><span class=\"invisible\">/svn/Documentation/2.3/user-changeid.html#_creation</span><span class=\"ellipsis\"></span></a></p><p class=\"ztext-empty-paragraph\"><br/></p><p>ç”±äºæˆ‘æƒ³æŠŠå®‰è£…è¿‡ç¨‹è‡ªåŠ¨åŒ–ï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œ  java -jar gerrit.war init æ—¶ç£•ç»Šäº†ä¸‹ï¼Œè¿™ä¸ª init å‘½ä»¤æœ‰ä¸ª --batch é€‰é¡¹ï¼Œè¡¨ç¤ºåœ¨éäº¤äº’çŠ¶æ€ä¸‹æ—¶  initä¼šç”¨é»˜è®¤é…ç½®åˆ›å»ºä¸€ä¸ª Gerrit siteï¼Œæ¯”å¦‚ä½¿ç”¨ H2 æ•°æ®åº“ï¼Œè¿™ä¸æ˜¯æˆ‘æœŸæœ›çš„ï¼Œæˆ‘å¸Œæœ›å®ƒç”¨ PostgreSQL  æ•°æ®åº“ï¼Œè™½ç„¶åˆ›å»ºå®Œ site åå¯ä»¥ä¿®æ”¹SITE_DIR/etc/gerrit.configï¼Œä½†æˆ‘æ‹…å¿ƒ init æ—¶ä¼šåˆå§‹åŒ–æ•°æ®åº“ä»€ä¹ˆçš„ï¼Œä¸æ˜¯åœ¨  gerrit.config ç®€å•æ”¹ä¸‹é…ç½®å°±èƒ½åˆ‡æ¢æ•°æ®åº“çš„ã€‚ äºæ˜¯æˆ‘æŠŠ init äº¤äº’å¼è¿è¡Œæ—¶çš„ç­”æ¡ˆå†™å…¥æ–‡ä»¶é‡Œï¼Œæƒ³é€šè¿‡ç®¡é“ä¼ ç»™ java  -jar gerrit.war initï¼Œæ²¡æƒ³åˆ°ä¼Šåˆ¤æ–­äº†è¾“å…¥æ˜¯å¦ç»ˆç«¯ï¼Œå‘ç°ä¸æ˜¯ç»ˆç«¯å°±ç›´æ¥èµ° --batch æ¨¡å¼äº†ï¼ŒçœŸæ˜¯è‡ªåšèªæ˜ã€‚ã€‚ã€‚æŠ˜è…¾äº†ä¼š  empty (<a href=\"https://link.zhihu.com/?target=http%3A//empty.sf.net\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">empty.sf.net</span><span class=\"invisible\"></span></a>)ã€expectã€socat åæ”¾å¼ƒäº†ï¼Œè¿˜æ˜¯è€å®äº¤äº’å¼å®‰è£…å§ï¼Œåæ­£ä¸ä¼šé¢‘ç¹é‡è£…ã€‚  ä¸‹é¢æ˜¯æˆ‘è¾“å…¥çš„é—®é¢˜ç­”æ¡ˆï¼Œ@@...@@ æ ‡è®°å¤„éœ€è¦æ›¿æ¢æˆçœŸçš„å¯†ç ï¼Œåœ¨æ‰§è¡Œ init ä¹‹å‰è¦å…ˆåˆ›å»ºå¥½gerrit æ•°æ®åº“ä»¥åŠ gerrit  ç³»ç»Ÿè´¦æˆ·ã€gerrit é‚®ä»¶è´¦æˆ·ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">### Gerrit Code Review 2.3\n# Create &#39;/srv/gerrit/site&#39;      [Y/n]?\ny\n\n### Git Repositories\n# Location of Git repositories   [git]:\ngit\n\n### SQL Database\n# Database server type           [H2/?]:\npostgresql\n\n# Server hostname                [localhost]:\nlocalhost\n\n# Server port                    [(POSTGRESQL default)]:\n5432\n\n# Database name                  [reviewdb]:\ngerrit\n\n# Database username              [gerrit]:\ngerrit\n\n# gerrit&#39;s password              :\n@@GERRIT_DB_PASSWORD@@\n\n#               confirm password :\n@@GERRIT_DB_PASSWORD@@\n\n### User Authentication\n# Authentication method          [OPENID/?]:\nhttp\n\n# Get username from custom HTTP header [y/N]?\ny\n\n# Username HTTP header           [SM_USER]:\nX-Forwarded-User\n\n# SSO logout URL                 :\nhttps://sso.corp.example.com/logout\n\n### Email Delivery\n# SMTP server hostname           [localhost]:\nsmtp.corp.example.com\n\n# SMTP server port               [(default)]:\n25\n\n# SMTP encryption                [NONE/?]:\ntls\n\n# SMTP username                  [gerrit]:\ngerrit@corp.example.com\n\n# gerrit&#39;s password              :\n@@GERRIT_SMTP_PASSWORD@@\n\n#               confirm password :\n@@GERRIT_SMTP_PASSWORD@@\n\n### Container Process\n# Run as                         [gerrit]:\ngerrit\n\n# Java runtime                   [/usr/lib/jvm/java-6-openjdk-i386/jre]:\n/usr/lib/jvm/default-java/jre\n\n# Copy gerrit.war to /srv/gerrit/site/bin/gerrit.war [Y/n]?\ny\n\n### SSH Daemon\n# Listen on address              [*]:\n*\n# Listen on port                 [29418]\n2022\n\n# Download and install it now [Y/n]?\ny\n\n### HTTP Daemon\n# Behind reverse proxy           [y/N]\ny\n\n# Proxy uses SSL (https://)      [y/N]?\nn\n\n# Subdirectory on proxy server   [/]:\n/\n\n# Listen on address              [*]:\n127.0.0.1\n\n# Listen on port                 [8081]:\n2080\n</code></pre></div><p class=\"ztext-empty-paragraph\"><br/></p><p>åœ¨è¿™ä¸ªå›ç­”é‡Œæœ‰å‡ ä¸ªåœ°æ–¹æ˜¯æ¯”è¾ƒç‰¹æ®Šçš„ï¼Œä¸€æ˜¯ç”¨æˆ·è®¤è¯æ–¹å¼ï¼Œç”±äºæˆ‘æ˜¯æŠŠGerrit  æ”¾åœ¨ Apache åé¢ï¼ŒApache ä½¿ç”¨ mod_auth_kerb åšç”¨æˆ·è®¤è¯ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ç»™ Gerrit é€‰æ‹©äº† http  è®¤è¯æ–¹å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹ Gerrit httpè®¤è¯æ–¹å¼ä¼šä½¿ç”¨å‰ç«¯ Web æœåŠ¡å™¨ä¼ è¿‡æ¥çš„ Authorization HTTP å¤´éƒ¨ï¼Œæ¯”å¦‚  &#34;Authorization: Basic xxxxxx&#34; æˆ–è€… &#34;Authorization: Digest xxxx&#34;ï¼Œå¯æƒœçš„æ˜¯  Gerrit ä»£ç æ²¡æœ‰å¤„ç† &#34;Authorization: Negotiate xxxx&#34; çš„æƒ…å†µï¼Œæ‰€ä»¥éœ€è¦åœ¨ Apache é‡Œç”¨  mod_rewrite æŠŠ REMOTE_USER å˜é‡ä½œä¸ºX-Forwarded-User å¤´éƒ¨ä¼ ç»™ Gerritï¼Œè¿™ä¸ªåå­—å¯ä»¥éšä¾¿å–ï¼Œä½†æ ¹æ®  Gerritæ–‡æ¡£è¯´æ³•ï¼Œä¸è¦é‡ç”¨ Authorization å¤´éƒ¨ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ç¬¬äºŒä¸ªç‰¹æ®Šçš„åœ°æ–¹æ˜¯ SMTP encryptionï¼Œssl  è¡¨ç¤ºç›´æ¥ä»¥ ssl æ–¹å¼è¿æ¥ï¼Œtls è¡¨ç¤ºå…ˆä»¥é ssl æ–¹å¼è¿æ¥ï¼Œç„¶åç”¨ STARTTLS å‡çº§ä¸º ssl è¿æ¥ï¼Œåä¸€ç§æ–¹å¼æ˜¯ç°åœ¨ ssl  ç”¨æ³•é‡Œæ¨èçš„ã€‚ä½¿ç”¨å“ªä¸€ç§å–å†³äºä½ çš„ smtp æœåŠ¡å™¨é…ç½®ï¼Œä¸€èˆ¬ ssl ä¼šç”¨ç‹¬ç«‹ç«¯å£ï¼Œtls çš„è¯ç›´æ¥ç”¨æ ‡å‡† SMTP 25 ç«¯å£ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ç¬¬ä¸‰ä¸ªç‰¹æ®Šçš„åœ°æ–¹æ˜¯åå‘ä»£ç†ï¼Œå› ä¸ºæˆ‘è¦é…ç½® Kerberos ç»Ÿä¸€ç™»å½•ï¼Œæ‰€ä»¥Gerrit å‰é¢æœ‰ä¸ª Apache åšåå‘ä»£ç†ï¼Œè¿™ä¿©æˆ‘é…ç½®åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œæ‰€ä»¥ä¸ç”¨ httpsã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>åœ¨ java -jar gerrit.war init -d /srv/gerrit/site æ‰§è¡Œå®Œä¹‹åï¼Œå®ƒä¼šæç¤ºä½ è®¿é—® <a href=\"https://link.zhihu.com/?target=http%3A//127.0.0.1%3A2080/%23/admin/projects/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">127.0.0.1:2080/#</span><span class=\"invisible\">/admin/projects/</span><span class=\"ellipsis\"></span></a>ï¼Œä½†ä½ åº”è¯¥è®¿é—®</p><p>http://gerrit.corp.example.com/#/admin/projects/ï¼Œè¿™é‡Œhttp://gerrit.corp.example.com  æ˜¯æˆ‘ç»™ gerrit æ‰€åœ¨æœºå™¨è®¾ç½®çš„ CNAMEï¼Œè¿™ä¸ªè¯·æ±‚ä¼šè¢« Apache çš„ gerrit virtual host æˆªè·ï¼Œåšå®Œ HTTP  Negotiateè®¤è¯åè½¬å‘ç»™åå°çš„ Gerritï¼Œä¹Ÿå°±æ˜¯ <a href=\"https://link.zhihu.com/?target=http%3A//127.0.0.1%3A2080/..\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">127.0.0.1:2080/..</span><span class=\"invisible\"></span></a>.ï¼Œç›´æ¥è¯·æ±‚ 2080  ç«¯å£è¿™ä¸ªåœ°å€çš„è¯ï¼ŒGerrit ä¼šæŠ¥é”™è¯´æ²¡æœ‰ Authorization å¤´éƒ¨ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ä¸‹é¢æ˜¯æˆ‘çš„ Apache gerrit è™šæ‹Ÿä¸»æœºé…ç½®ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">&lt;VirtualHost *:80&gt;\n    ServerName gerrit.corp.example.com\n    ServerAdmin webmaster@corp.example.com\n    DocumentRoot /nonexistent\n\n    ErrorLog ${APACHE_LOG_DIR}/gerrit-error.log\n\n    # Possible values include: debug, info, notice, warn, error, crit,\n    # alert, emerg.\n    LogLevel warn\n\n    CustomLog ${APACHE_LOG_DIR}/gerrit-access.log combined\n\n    ProxyRequests Off\n    ProxyVia Off\n    ProxyPreserveHost On\n\n    &lt;Proxy *&gt;\n        Order deny,allow\n        Allow from all\n    &lt;/Proxy&gt;\n\n    &lt;Location /login/&gt;\n        AuthType Kerberos\n        Require valid-user\n\n        Order allow,deny\n        Allow from all\n\n        RewriteEngine On\n        RewriteCond %{REMOTE_USER} (.+)\n        RewriteRule .* - [E=RU:%1]\n        RequestHeader set X-Forwarded-User %{RU}e\n    &lt;/Location&gt;\n\n    ProxyPass   / http://127.0.0.1:2080/\n    ProxyPassReverse  /  http://127.0.0.1:2080/\n&lt;/VirtualHost&gt;\n</code></pre></div><p>åœ¨è¯·æ±‚  http://gerrit.corp.example.com/#/admin/projects/ æ—¶ï¼ŒGerritå¯èƒ½æŠ¥é”™è¯´æ‰¾ä¸åˆ°  All-Projectsï¼ŒåŸå› ä¸æ˜ï¼Œè§£å†³åŠæ³•æ˜¯æŠŠ PostgreSQLé‡Œçš„ gerrit æ•°æ®åº“åˆ é™¤é‡å»ºï¼Œå†é‡æ–° java -jar  gerrit.war initã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>æ²¡å‡ºå…¶å®ƒé—®é¢˜çš„è¯ï¼ŒGerrit çš„ Web ç•Œé¢å°±å±•ç°åœ¨ä½ é¢å‰ï¼Œå®ƒè¦æ±‚ä¸ºå½“å‰ç”¨æˆ·æ³¨å†Œä¸€ä¸ª email å¸å·ï¼Œç¬¬ä¸€ä¸ªç™»å½•çš„ç”¨æˆ·è‡ªåŠ¨æˆä¸ºç®¡ç†å‘˜ï¼Œåç»­ç™»å½•çš„å…¶å®ƒç”¨æˆ·æ˜¯æ™®é€šæƒé™çš„ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>å¦‚æœä½ ç”¨çš„  SMTP æœåŠ¡å™¨çš„ SSL è¯ä¹¦æ˜¯è‡ªç­¾åçš„ï¼Œå¹¶ä¸”è·Ÿæˆ‘ä¸€æ · Gerritä½¿ç”¨ tls æ–¹å¼è¿æ¥ SMTP  æœåŠ¡å™¨ï¼Œåˆ°è¿™é‡Œä¼šå¡å£³ä¸€ä¸‹ã€‚ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯site/etc/gerrit.config é‡Œé»˜è®¤æ²¡æœ‰  sendemail.sslverifyï¼Œå®ƒçš„å€¼é»˜è®¤æ˜¯ trueï¼Œè¿™ä¼šå¯¼è‡´ javax.net.ssl æ£€æŸ¥ SMTP æœåŠ¡å™¨çš„ SSL  è¯ä¹¦æ˜¯å¦æ˜¯ trusted çš„ï¼Œç­”æ¡ˆå½“ç„¶æ˜¯å¦ï¼Œäºæ˜¯ Gerrit æŠ›å¼‚å¸¸äº†ï¼š</p><p class=\"ztext-empty-paragraph\"><br/></p><p>sun.security.validator.ValidatorException:  PKIX path building failed:  sun.security.provider.certpath.SunCertPathBuilderException: unable to  find valid certification path to requested target</p><p class=\"ztext-empty-paragraph\"><br/></p><p>è§£å†³åŠæ³•æœ‰å¦‚ä¸‹è¿™äº›ï¼š</p><ol><li>åœ¨ /srv/gerrit/site/etc/gerrit.config é‡Œ [sendemail] é‡Œæ·»åŠ  sslverify = falseï¼Œè™½ç„¶ä½¿ç”¨ openssl çš„ client å¤§å¤šæ˜¯è¿™ä¸ªå¾·è¡Œï¼Œä½†æˆ‘è§‰å¾—ä¸å¤§èˆ’æœï¼Œæ‰€ä»¥æ²¡ç”¨è¿™ä¸ªåŠæ³•ã€‚</li><li>æŠŠ SMTP æœåŠ¡å™¨çš„ SSL è¯ä¹¦å¯¼å…¥ Java çš„ truststore é‡Œä¾› javax.net.ssl ä½¿ç”¨ã€‚</li></ol><p class=\"ztext-empty-paragraph\"><br/></p><p>truststore  æ˜¯åªåŒ…å«å…¬é’¥çš„ keystore, keystore æ˜¯ Java å®‰å…¨æ¡†æ¶é‡Œç”¨æ¥ä¿å­˜è¯ä¹¦ã€ç§é’¥ç­‰ç­‰çš„ä¸œè¥¿ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ JKS æ ¼å¼çš„  keystore æ–‡ä»¶ï¼Œæ¯”å¦‚ $JAVA_HOME/jre/lib/security/cacerts,  $HOME/.keystoreã€‚truststore è¢« Java ç±»åº“é‡Œçš„ TrustManager ä½¿ç”¨ï¼Œkeystore è¢« Java  ç±»åº“é‡Œçš„ KeyManager ä½¿ç”¨ï¼Œå½“ç„¶ TrustManager ä¹Ÿèƒ½ç”¨ keystoreã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>åœ¨è¿™ä¸ªè¯ä¹¦éªŒè¯é—®é¢˜ä¸Šï¼Œéœ€è¦ç»™ TrustManager æŒ‡å®šä¸€ä¸ª truststore æˆ–è€…keystoreï¼Œæœ‰ä¸‰ç§åŠæ³•ï¼š</p><p class=\"ztext-empty-paragraph\"><br/></p><ol><li>å¦‚æœ  javax.net.ssl.trustStore ç³»ç»Ÿå±æ€§æŒ‡å®šäº†ï¼Œå°±ä½¿ç”¨è¿™ä¸ªç³»ç»Ÿå±æ€§æŒ‡å®šçš„é‚£ä¸ªæ–‡ä»¶å½“ä½œ  truststoreï¼Œtruststore  çš„å¯†ç ä»javax.net.ssl.trustStorePasswordç³»ç»Ÿå±æ€§è·å–ã€‚ç½‘ä¸Šæœ‰ä¸å°‘æ–‡ç« è¿˜æåˆ°  javax.net.ssl.keyStore å’Œ javax.net.ssl.keyStorePasswordï¼Œè¿™ä¸ªåªåœ¨ ssl server  ç«¯æˆ–è€… ssl client ç«¯ä½¿ç”¨client cert å‘ ssl serverè®¤è¯çš„æƒ…å†µä¸‹æ‰éœ€è¦ã€‚</li><li>å¦‚æœ javax.net.ssl.trustStore å±æ€§æ²¡æŒ‡å®šæˆ–è€…æ–‡ä»¶æ²¡æ‰¾åˆ°ï¼Œåˆ™ä½¿ç”¨ $JAVA_HOME/jre/lib/security/jssecacerts</li><li>å¦‚æœ jssecacerts æ²¡æ‰¾åˆ°ï¼Œåˆ™ä½¿ç”¨ $JAVA_HOME/jre/lib/security/cacertsã€‚</li></ol><p class=\"ztext-empty-paragraph\"><br/></p><p>ç½‘ä¸Šæœ‰ä¸å°‘æ–‡ç« éƒ½è¯´æŠŠè¯ä¹¦ç›´æ¥åŠ å…¥  jssecacerts æˆ–è€… cacerts ä¸­ï¼Œæˆ‘æ˜¯åŠå®‰å…¨åæ‰§ç‹‚ï¼Œè§‰å¾—æŠŠä¸€ä¸ªè‡ªå·±ç©çš„è¯ä¹¦åŠ è¿›å»ä¸å¤ªé è°±ï¼Œå¦å¤–æ‹…å¿ƒ Debian  çš„è½¯ä»¶åŒ…å‡çº§ä¼šè‡ªåŠ¨æ›´æ–° cacertsï¼ˆä¼Šå…¶å®æ˜¯ç¬¦å·é“¾æ¥åˆ°  /etc/ssl/certs/java/cacertsäº†ï¼Œca-certificates åŒ…çš„  /usr/sbin/update-ca-certificates ä¼šé€šè¿‡ca-certificates-java åŒ…çš„  /etc/ca-certificates/update.d/jks-keystoreæ›´æ–°å®ƒï¼Œæ–‡æ¡£æœ‰æåˆ° local cert  ä¼šä¾ç„¶ä¿ç•™ï¼Œæˆ‘æ²¡è¯•éªŒï¼‰ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>é€šè¿‡åˆ†æ /srv/gerrit/site/bin/gerrit.sh å¯åŠ¨è„šæœ¬ï¼Œä¼Šä½¿ç”¨äº†JAVA_OPTIONS å˜é‡ï¼Œå¹¶ä¸”è¯»å– /etc/default/gerritcodereview æ–‡ä»¶ï¼Œæ‰€ä»¥</p><p>å¯ä»¥åœ¨ /etc/default/gerritcodereview é‡Œå†™å…¥ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">JAVA_OPTIONS=&#34;-Djavax.net.ssl.trustStore=/srv/gerrit/truststore \\\n  -Djavax.net.ssl.trustStorePassword=changeit&#34;\n</code></pre></div><p>ç„¶å  /srv/gerrit/site/bin/gerrit.sh stop å† start é‡å¯ gerritã€‚(ä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªé€‰é¡¹æ”¾åœ¨  /srv/gerrit/site/etc/gerrit.config çš„container.javaOptions é‡Œï¼š</p><p><a href=\"https://link.zhihu.com/?target=http%3A//gerrit-documentation.googlecode.com/svn/Documentation/2.3/config-gerrit.html%23_a_id_container_a_section_container\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">gerrit-documentation.googlecode.com</span><span class=\"invisible\">/svn/Documentation/2.3/config-gerrit.html#_a_id_container_a_section_container</span><span class=\"ellipsis\"></span></a></p><p>)</p><p class=\"ztext-empty-paragraph\"><br/></p><p>/srv/gerrit/truststore æ˜¯è¿™ä¹ˆç”Ÿæˆçš„ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">gerrit$ keytool -importcert -alias exim -file /etc/exim4/exim.crt \\\n            -keystore /srv/gerrit/truststore -storepass changeit\n</code></pre></div><p>è¿™ä¸ª truststore çš„å¯†ç æ˜¯æ— æ‰€è°“çš„ï¼Œå› ä¸ºå®ƒé‡Œå¤´æ²¡æœ‰ç§é’¥ã€‚ exim.crt æ˜¯ç”¨/usr/share/doc/exim4/examples/exim-gencert ç”Ÿæˆçš„ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>é‡å¯  Gerrit åï¼Œè¯ä¹¦é—®é¢˜è§£å†³äº†ï¼Œç¬¬ä¸€æ¬¡ç™»å½•è¦æ±‚æ³¨å†Œé‚®ç®±çš„å¯¹è¯æ¡†ä¹Ÿæ²¡äº†ï¼Œè¿™æ—¶å¯ä»¥ç‚¹å‡»å³ä¸Šè§’çš„ settings é“¾æ¥ï¼Œåœ¨ contact  information é‚£ä¸€æ é‡Œã€‚å¯æƒœçš„æ˜¯é—®é¢˜æ²¡å®Œï¼Œè¾“å…¥é‚®ç®±ç‚¹å‡»&#34;Register New Email...&#34;åï¼ŒGerrit ä¸€ç›´  Loadingï¼Œ/var/log/exim4/mainlog ä»¥åŠ /srv/gerrit/site/logs/error_log  é‡Œæ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼ŒGerrit Web é¡µé¢å°±é‚£ä¹ˆä¸€ç›´æŒ‚ç€ï¼Œç›´åˆ° exim4 æŠ¥å‘Šè¿æ¥è¶…æ—¶ï¼ŒæŠŠ Gerritå‘èµ·çš„ smtp é“¾æ¥æ–­æ‰ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>èŠ±è´¹äº†ä¸‰ç™¾è„‘ç»†èƒåï¼Œä¿ºç»ˆäºæ‰¾åˆ°åŸå› ï¼Œæ˜¯ Gerrit çš„ AuthSMTPClient.startTLS()å®ç°è·Ÿ SMTP æœåŠ¡å™¨é…åˆæœ‰é—®é¢˜ï¼Œè¿™æ˜¯ä¸€ä¸ª SMTP STARTTLS ä¼šè¯ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">$ gsasl --smtp smtp.corp.example.com\nTrying `gold.corp.example.com&#39;...\n220 gold.corp.example.com ESMTP Exim 4.77 Mon, 21 May 2012 14:46:43 +0800\nEHLO [127.0.0.1]\n250-gold.corp.example.com Hello localhost [127.0.0.1]\n250-SIZE 10485760\n250-PIPELINING\n250-AUTH GSSAPI\n250-STARTTLS\n250 HELP\nSTARTTLS\n220 TLS go ahead\nEHLO [127.0.0.1]\n250-gold.corp.example.com Hello localhost [127.0.0.1]\n250-SIZE 10485760\n250-PIPELINING\n250-AUTH GSSAPI DIGEST-MD5 CRAM-MD5\n250 HELP\nAUTH GSSAPI\n....\n</code></pre></div><p>å¯ä»¥çœ‹åˆ°åœ¨ STARTTLS ä¹‹åï¼ŒExim ä¸ä¼šå†æ¬¡å‘é€ banner äº†ï¼š</p><p>220 http://gold.corp.example.com ESMTP Exim 4.77 Mon, 21 May 2012 14:46:43 +0800</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ä¸‹é¢æ˜¯ Gerrit AuthSMTPClient çš„ä»£ç ï¼Œä¼Šåœ¨ org.apache çš„å‘½åç©ºé—´äº†æ’äº†ä¸ª AuthSMTPClient ç±»ï¼Œè¯•å›¾ç»™ apache commons-net 2.2 çš„ SMTPClientå¢åŠ  STARTTLS æ”¯æŒï¼š</p><p class=\"ztext-empty-paragraph\"><br/></p><p><a href=\"https://link.zhihu.com/?target=http%3A//code.google.com/p/gerrit/source/browse/gerrit-patch-commonsnet/src/main/java/org/apache/commons/net/smtp/AuthSMTPClient.java%3Fname%3Dstable-2.3\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">code.google.com/p/gerri</span><span class=\"invisible\">t/source/browse/gerrit-patch-commonsnet/src/main/java/org/apache/commons/net/smtp/AuthSMTPClient.java?name=stable-2.3</span><span class=\"ellipsis\"></span></a></p><div class=\"highlight\"><pre><code class=\"language-text\">  public boolean startTLS(final String hostname, final int port, final boolean verify)\n      throws SocketException, IOException {\n    if (sendCommand(&#34;STARTTLS&#34;) != 220) {\n      return false;\n    }\n\n    _socket_ = sslFactory(verify).createSocket(_socket_, hostname, port, true);\n    _connectAction_();\n    return true;\n  }\n</code></pre></div><p>äº‹æƒ…ååœ¨  _connectAction_() é‡Œï¼Œè¿™ä¸ªåœ¨ AuthSMTPClient çš„çˆ¶ç±» SMTPClientçš„çˆ¶ç±» SMTP é‡Œä¼šåœ¨å»è¯»å–  SMTP æœåŠ¡å™¨çš„ banner ä¿¡æ¯ï¼Œäºæ˜¯ startTLS() å°±æŒ‚åœ¨è¿™ä¸ªåœ°æ–¹å‚»ç­‰ç›´åˆ° SMTP  æœåŠ¡å™¨è¸¢å¼€å®ƒã€‚ã€‚ã€‚ã€‚äººç”Ÿä¸å¦‚æ„äº‹åä¹‹å…«ä¹å•Šã€‚ã€‚ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p><a href=\"https://link.zhihu.com/?target=http%3A//www.rfc-editor.org/rfc/rfc2487.txt\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">rfc-editor.org/rfc/rfc2</span><span class=\"invisible\">487.txt</span><span class=\"ellipsis\"></span></a></p><p>5.2 Result of the STARTTLS Command</p><blockquote>Upon completion of the TLS handshake, the SMTP protocol is reset to<br/>the initial state (the state in SMTP after a server issues a 220<br/>service ready greeting). </blockquote><p class=\"ztext-empty-paragraph\"><br/></p><p>ä»è¿™ä¸ªæè¿°çœ‹ï¼ŒSMTP server æ˜¯ä¸åº”è¯¥å†å‘ä¸€æ¬¡ banner çš„ã€‚åœ¨ AuthSMTPClient.startTLS()æ­ä¸ªè¡¥ä¸å(<a href=\"https://link.zhihu.com/?target=http%3A//code.google.com/p/gerrit/issues/detail%3Fid%3D1397\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">code.google.com/p/gerri</span><span class=\"invisible\">t/issues/detail?id=1397</span><span class=\"ellipsis\"></span></a>)ï¼ŒSTARTTLS  é¡ºåˆ©å®Œæˆï¼Œå¼€å§‹ SMTP è®¤è¯ï¼Œæ³¨æ„ apache commons-net 2.2 åªæ”¯æŒ CRAM-SHA1, CRAM-MD5,  LOGIN, PLAINè¿™å‡ ç§ï¼Œä¸æ”¯æŒ DIGEST-MD5ï¼Œè¿˜å¥½æˆ‘å‰é¢ä¸ºäº†ReviewBoardæ‰“å¼€äº† Exim4 çš„ CRAM-MD5  è®¤è¯æ”¯æŒã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>è¿™å—ä»£ç æ„Ÿè§‰æ¯”è¾ƒé¾Œé¾Šï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å®ç°æœ‰ç¼ºé™·ï¼Œæ‰€ä»¥ apache commons-netç½‘ç«™ä¸ŠæŠŠ 2.x ç³»åˆ—ä»ä¸‹è½½é¡µé¢åˆ é™¤äº†ï¼Œåªæœ‰ 1.x å’Œ 3.x ç³»åˆ—ã€‚ã€‚ã€‚ä¸çŸ¥é“Google é‚£å¸®äººä¸ºä»€ä¹ˆæ²¡è½¬å‘æ ‡å‡†çš„ JavaMail APIã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>å¦‚æœ  Gitweb å·²ç»å®‰è£…äº†ï¼Œé‚£ä¹ˆ Gerrit è‡ªåŠ¨é›†æˆ Gitwebï¼Œæ ‡å‡†å®‰è£…æƒ…å†µä¸‹å•¥éƒ½ä¸ç”¨é…ç½®ï¼Œåœ¨ Gerrit Web UI  ä¸Šæ¯ä¸ªè¡¥ä¸æ—è¾¹æœ‰ gitweb çš„é“¾æ¥ï¼Œç›¸å½“ç›¸å½“çš„å¥½ç”¨ã€‚Gerrit æ–‡æ¡£è¿˜å£°ç§°èƒ½è·Ÿ cgit é›†æˆï¼Œæˆ‘æ²¡å®éªŒè¿‡ã€‚ç”±äº Gerrit  ä¼šåŠ¨æ€çš„åœ¨/srv/gerrit/.gerritcodereview/tmp/gerrit..../ ä¸‹ç”Ÿæˆ  gitweb_config.perlï¼Œæœ‰è¿™ä¸ªæ–‡ä»¶å /usr/lib/cgi-bin/gitweb.cgi å°±ä¸ä¼šè¯»å–  /etc/gitweb.conf äº†ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>Gerrit è¿˜èƒ½é€šè¿‡ commentlink å’Œ trackingid è·Ÿå¤–éƒ¨çš„ Bug è·Ÿè¸ªç³»ç»Ÿé›†æˆï¼Œå‚è€ƒï¼š<a href=\"https://link.zhihu.com/?target=http%3A//gerrit-documentation.googlecode.com/svn/Documentation/2.3/config-gerrit.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">gerrit-documentation.googlecode.com</span><span class=\"invisible\">/svn/Documentation/2.3/config-gerrit.html</span><span class=\"ellipsis\"></span></a></p><p class=\"ztext-empty-paragraph\"><br/></p><p>Gerrit ç›´æ¥ä½¿ç”¨ jgit åº“ç›´æ¥ç®¡ç†ä»£ç åº“ï¼Œå¦‚æœæœ‰å¤–éƒ¨çš„ GIT åº“ï¼Œæ¯”å¦‚è¢«Gitolite ç®¡ç†çš„ï¼Œæœ‰ä¸¤ä¸ªåŠæ³•è®©æäº¤åˆ° Gerrit çš„ä¿®æ”¹ä¹Ÿæ•£æ’­åˆ°å¤–éƒ¨ GIT åº“é‡Œï¼š</p><ol><li>ä½¿ç”¨ Gerrit çš„ Git replication ç‰¹æ€§ï¼ŒGerrit èƒŒåœ°é‡ŒæŠŠä¿®æ”¹ git push åˆ°å¤–éƒ¨åº“é‡Œï¼Œè¿™ä¸ªåŠæ³•ä¼šæœ‰å»¶è¿Ÿã€‚ å‚è€ƒï¼š<a href=\"https://link.zhihu.com/?target=http%3A//gerrit-documentation.googlecode.com/svn/Documentation/2.3/config-replication.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">gerrit-documentation.googlecode.com</span><span class=\"invisible\">/svn/Documentation/2.3/config-replication.html</span><span class=\"ellipsis\"></span></a></li><li>åˆ›å»ºå¤–éƒ¨åº“çš„ç¬¦å·é“¾æ¥åˆ° /srv/gerrit/site/git/ é‡Œï¼Œæ¯”å¦‚ ln -s /srv/git/repositories/testing.git /srv/gerrit/site/git/testing.gitï¼Œéœ€è¦æ³¨æ„æ–‡ä»¶æƒé™ã€‚ å‚è€ƒï¼š<a href=\"https://link.zhihu.com/?target=http%3A//gerrit-documentation.googlecode.com/svn/Documentation/2.3/project-setup.html%23_manual_creation\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">gerrit-documentation.googlecode.com</span><span class=\"invisible\">/svn/Documentation/2.3/project-setup.html#_manual_creation</span><span class=\"ellipsis\"></span></a>ï¼Œè¿™ä¸ªæ–‡æ¡£ä¸æ˜¯è¯´åˆ›å»ºç¬¦å·é“¾æ¥çš„ï¼Œæˆ‘åªæ˜¯çŒœæµ‹å¯è¡Œã€‚</li></ol><p class=\"ztext-empty-paragraph\"><br/></p><p>ä¸€ç•ªé…ç½®ã€è¯»æ–‡æ¡£ä¸‹æ¥ï¼Œæ„Ÿè§‰ Gerrit çœŸæ˜¯ GIT ç”¨æˆ·å±…å®¶åŠå…¬å¿…å¤‡è‰¯å“ï¼Œè¿™ä¹ˆå¥½çš„ç©æ„å±…ç„¶æ˜¯å¼€æºçš„ï¼Œå¤ªèµäº†ï¼</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50795526", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "ä»£ç è¯„å®¡ç³»ç»Ÿ ReviewBoard å’Œ Gerrit (ä¸Š)", 
            "content": "<p>ã€è¿ç§»ã€‘ä»£ç è¯„å®¡ç³»ç»Ÿ ReviewBoard å’Œ Gerrit (ä¸Š) </p><p>// æœ¬æ¥æ˜¯æ‰“ç®—æŠŠ ReviewBoard å’Œ Gerrit æ”¾åœ¨ä¸€èµ·å†™çš„ï¼Œä½†æ˜¯å¤ªé•¿äº†ï¼Œæ‰€ä»¥åˆ†æˆä¸Šä¸‹ä¸¤ç¯‡ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ä¸è®ºæ˜¯å…¬å¸é‡Œè¿˜æ˜¯å…¬å¸å¤–ï¼Œæ­£ç»çš„å¤šäººåˆä½œå¼€å‘æœ€å¥½è¦ç»å¸¸åšä»£ç è¯„å®¡ï¼Œå…¶å¿…è¦æ€§ä¸ç”¨æˆ‘å¤šè¯´ï¼Œä½†æ˜¯å¦‚ä½•åšä»£ç è¯„å®¡ç¡®å®ä¸ªå¤´å¤§çš„äº‹æƒ…ï¼Œæˆ‘ä¸ªäººæ˜¯éå¸¸åå¯¹æ‹‰ä¸€ç¥¨äººå»ä¼šè®®å®¤å¼€æŠ•å½±ä»ªä¸€è¡Œè¡Œè®²çš„ï¼Œå¤ªæµªè´¹èµ„æºå’Œæ—¶é—´äº†ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>æŠ›å¼€è¯„å®¡çš„ç§¯ææ€§ä¸è°ˆï¼Œæˆ‘è§‰å¾—ä»£ç è¯„å®¡åº”æ˜¯å¯ä»¥éšæ—¶å‘èµ·éšæ—¶ç»“æŸçš„ï¼Œé‚®ä»¶æ˜¯ä¸ªå¾ˆä¸é”™çš„è½½ä½“ï¼Œè¿™åœ¨å¼€æºç•Œå·²ç»å°è¯äº†ã€‚ä½†æ˜¯é‚®ä»¶é‡Œå‘è¡¥ä¸ç¡®å®ä¸å¤Ÿæ­£å¼ï¼Œéœ€è¦ä¼—äººæé«˜çš„çƒ­æƒ…å’Œè‡ªè§‰ï¼Œå¦å¤–é‚®ä»¶çš„æ—¶å»¶æ¯”è¾ƒå¤§ï¼Œçº¯æ–‡æœ¬diff æ ¼å¼å¾ˆå¤šäººæ¥å—ä¸äº†ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>æˆ‘ä»¥å‰æ•´äº†ä¸€å¥—é¾Œé¾Šçš„è„šæœ¬ï¼Œè§£å†³ä¸´æ—¶åº“å’Œæ­£å¼åº“çš„è‡ªåŠ¨æäº¤é—®é¢˜ï¼š</p><p class=\"ztext-empty-paragraph\"><br/></p><div class=\"highlight\"><pre><code class=\"language-text\">          auto fetch       manually push\næ­£å¼åº“  --------&gt; ä¸´æ—¶åº“ &lt;--------+\n |      &lt;--------                 |\n |       auto push                |\n |                                |\n +---------------&gt;  å¼€å‘äººå‘˜------+\n    manually fetch\n\n</code></pre></div><p>å¼€å‘äººå‘˜å¾€ä¸´æ—¶åº“ä¸Šè‡ªå·±çš„ç‹¬ç«‹åˆ†æ”¯  pushï¼Œè§¦å‘ GIT hook  å‘é€é‚®ä»¶é€šçŸ¥å¤§å®¶ï¼Œé‚®ä»¶é‡Œå†…åµŒäº†æäº¤ä¿¡æ¯ï¼Œç„¶åå¦å¤–ä¸€ä¸ªäººå›å¤é€šçŸ¥é‚®ä»¶ï¼Œåœ¨é‚®ä»¶å¼€å¤´æ·»åŠ [COMMIT]ï¼Œä¸´æ—¶åº“æ‰€åœ¨æœºå™¨ä¸Šæœ‰ä¸ªå®šæ—¶ä»»åŠ¡æ”¶å–é‚®ä»¶ï¼Œé‡åˆ°æ ‡é¢˜ä»¥[COMMIT]  å¼€å¤´çš„é‚®ä»¶å°±å»é‚®ä»¶å†…å®¹é‡Œæ‰¾æäº¤ä¿¡æ¯ï¼Œå¹¶è‡ªåŠ¨ push åˆ°æ­£å¼åº“é‡Œã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>è¿™ä¹ˆæçš„ç›®çš„ä¸€æ˜¯è®©æ­£å¼åº“å®‰å…¨ç‚¹ï¼Œå› ä¸ºå¤§å®¶ GIT  ç”¨çš„ä¸æ˜¯å¾ˆç†Ÿç»ƒï¼ŒäºŒæ˜¯å¢åŠ ç‚¹æäº¤å»¶æ—¶ï¼Œè™½ç„¶å¤§å®¶å¹¶ä¸çœŸçš„è¯„å®¡ï¼Œä½†è‡³å°‘æ¯ä¸€ä¸ªä¿®æ”¹ä¼šæœ‰ä¸¤ä¸ªäººâ€œå…³æ³¨â€ï¼ˆå…¶å®æ˜¯ç‰µæ¶‰è€Œå·²ï¼Œå¾ˆå°‘æœ‰äººçœŸçš„çœ‹ä¿®æ”¹å†…å®¹ï¼‰ã€‚è¿™ä¸ªä¸œè¥¿å¤ªè¿‡äºç†æƒ³åŒ–äº†ï¼Œè¢«äººæŠ±æ€¨çš„æœ€å¤§é—®é¢˜æ˜¯æäº¤å»¶æ—¶ï¼ˆå…¶å®ä¹Ÿå°±åŠå°æ—¶å·¦å³ï¼‰ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰å‡ æ¬¡ç¡®å®é¿å…äº†é”™è¯¯çš„æäº¤ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ä½†åœ¨å…¬å¸é‡Œé‚®ä»¶å¾€å¾€å¤ªå¤šï¼Œå¤„ç†å¾ˆä½æ•ˆï¼Œè¿˜æ˜¯æœ‰ä¸ª  Web ç•Œé¢æ›´å‹å¥½æ›´å®æ—¶ç‚¹ï¼Œè¿™æ–¹é¢å¼€æºçš„ç‹¬ç«‹å¯è¿è¡Œäº§å“æœ€ä¸ºçŸ¥åçš„è¯¥å± ReviewBoard å’ŒGerrit äº†ã€‚è¿˜æœ‰ä¸ª  Rietveldï¼Œç®—æ˜¯ Gerrit çš„å‰è¾ˆï¼ŒPython ä¹‹çˆ¶é’ˆå¯¹ Subversion åšçš„ï¼Œä½¿ç”¨äº† Google App Engine  çš„æœåŠ¡ï¼Œæœ‰äººç»™å®ƒæ‰“äº†è¡¥ä¸ä»¥æ”¯æŒåœ¨æœ¬åœ°å•æœºè¿è¡Œï¼Œä½†ç»ˆæ˜¯åœ¨ Google ä¹‹å¤–ä½¿ç”¨ä¸å¹¿ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ReviewBoard  çš„ç•Œé¢ç®€æ´æ¼‚äº®ï¼Œæˆ‘æŒºå–œæ¬¢çš„ï¼Œä½†æˆ‘å¸ç”¨çš„ 1.5 çš„ç‰ˆæœ¬é¢‘ç¹æŒ‚æ‰ï¼Œä¸çŸ¥é“æ–°çš„ 1.6 å¥½ç‚¹æ²¡ï¼Œç•Œé¢ä¸Šå€’æ˜¯åˆæœ‰æ”¹è¿›ï¼Œç‰¹åˆ«æ˜¯å¯ä»¥åœ¨ comment  é‡Œå¼€ issue çš„åšæ³•å¾ˆæœ‰åˆ›æ„ã€‚æ³¨æ„è¿™ä¸ªå¹¶ä¸æ˜¯çœŸçš„åœ¨ BUG ç®¡ç†ç³»ç»Ÿé‡Œå¼€ä¸€ä¸ª BUGï¼Œè€Œæ˜¯åœ¨ ReviewBoard é‡Œåšä¸€ä¸ªç±»ä¼¼FIXME  çš„æ ‡è®°ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ReviewBoard çš„å®‰è£…å¾ˆå®¹æ˜“ï¼Œå®˜æ–¹æ–‡æ¡£åšçš„æŒºå¥½ï¼Œæˆ‘åœ¨é‚®ä»¶é…ç½®é‡Œå¡å£³äº†ä¸‹ï¼Œæˆ‘çš„ Exim 4 åªç»™é…ç½®äº†  GSSAPI å’Œ DIGEST-MD5 è®¤è¯æ–¹å¼ï¼Œå‰è€…ç»™ç”¨æˆ·ï¼Œåè€…ç»™éœ€è¦å‘é‚®ä»¶çš„æœåŠ¡ï¼Œæ¯”å¦‚  RoundCubeã€ReviewBoardã€Gerritï¼Œä½†æ˜¯æ‚²å‚¬çš„æ˜¯ ReviewBoard ä½¿ç”¨çš„ Python smtplib åº“åªæ”¯æŒ  CRAM-MD5ã€LOGINï¼Œä¿ºæŠ˜è…¾äº†å¥½å‡ å¤©ï¼Œæœ€ååœ¨qunshan@newsmth çš„å¤§åŠ›å¸®åŠ©ä¸‹ï¼Œç»ˆäºæå‡ºä¸€ä¸ªå‡‘åˆå¯ç”¨çš„æ”¯æŒDIGEST-MD5  çš„ smtplib.pyï¼Œä»£ç è§ <a href=\"https://link.zhihu.com/?target=https%3A//gist.github.com/2679719\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">gist.github.com/2679719</span><span class=\"invisible\"></span></a> ï¼Œä½†æœ€åæˆ‘è¿˜æ˜¯å†³å®šè®© Exim 4 æ”¯æŒ  CRAM-MD5 è®¤è¯å¾—äº†ï¼Œåæ­£æœ‰ SSL ä¿æŠ¤ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>è¿™ä¸ªè¿‡ç¨‹ä¸­æœ‰ä¸ªå°ç¬‘è¯ï¼ŒæŠ˜è…¾ ReviewBoard  é‚®ä»¶å‘é€æ—¶ï¼Œæˆ‘å‘ç°æœ‰æ—¶å€™å¯ä»¥æˆåŠŸï¼Œå¾ˆæ˜¯æƒŠè®¶ï¼Œæœ€åå‘ç° Web ç•Œé¢ä¿å­˜ Email è®¾ç½®æ—¶ smtp å¯†ç æœ‰æ—¶ä¿å­˜ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯ smtp  å¯†ç æ²¡æŒ‡å®šæ—¶å¯ä»¥å‘é€æˆåŠŸï¼ŒåŸæ¥æ­¤æ—¶ ReviewBoard å‹æ ¹ä¸ä¼šå‘ Exim å‘é€ AUTHæŒ‡ä»¤åšè®¤è¯ï¼Œè€Œ Exim4  å±…ç„¶ä¹Ÿä¹å‘µå‘µçš„åŒæ„å‘é€äº†ï¼ŒæƒŠäº†æˆ‘åŠèº«å†·æ±—ï¼</p><p class=\"ztext-empty-paragraph\"><br/></p><p>Exim è¿™ä¹ˆåšå¯èƒ½æ˜¯ SMTP åè®®å†å²ä¸Šå¾ˆå¼€æ”¾ï¼Œä»¥åŠå±€åŸŸç½‘å†…æ¯”è¾ƒå®‰å…¨çš„ç¼˜æ•…ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯åæ‰§çš„æ‹…å¿ƒæŸä¸ªè®¿å®¢è¿›å…¬å¸åæ’ä¸ªç½‘çº¿å°±å¯ä»¥åˆ©ç”¨Exim ç‹‚å‘é‚®ä»¶ï¼Œæ‰€ä»¥å°±åšäº†é™åˆ¶ï¼Œå¿…éœ€ STARTTLS å¹¶ä¸”è®¤è¯äº†æ‰èƒ½å‘é‚®ä»¶ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">$ cat /etc/exim4/conf.d/acl/30_exim4-config_check_mail\n\n### acl/30_exim4-config_check_mail\n#################################\n\n# This access control list is used for every MAIL command in an incoming\n# SMTP message. The tests are run in order until the address is either\n# accepted or denied.\n#\nacl_check_mail:\n  require\n    message = no AUTH given before MAIL command\n    authenticated = *\n    message = no STARTTLS given before MAIL command\n    encrypted = *\n\n  .ifdef CHECK_MAIL_HELO_ISSUED\n  deny\n    message = no HELO given before MAIL command\n    condition = ${if def:sender_helo_name {no}{yes}}\n  .endif\n\n  accept\n</code></pre></div><p class=\"ztext-empty-paragraph\"><br/></p><p>ReviewBoard  å¦ä¸€ä¸ªé—®é¢˜æ˜¯ä¸æ”¯æŒ HTTP è®¤è¯ï¼ŒåŸå› æ˜¯ReviewBoard ä½¿ç”¨çš„ Djangoæ¡†æ¶çš„æ—§ç‰ˆæœ¬å¯¹è¿™ä¸ªæ”¯æŒä¸åŠ›ï¼Œæ–°ç‰ˆ Django  è²Œä¼¼æ”¯æŒäº†ï¼Œä½† ReviewBoard è¿˜éœ€è¦åšé¢å¤–å·¥ä½œæ‰èƒ½é…åˆï¼Œæ¯”å¦‚è‡ªåŠ¨åˆ›å»º ReviewBoard  é‡Œçš„ç”¨æˆ·ï¼Œæ¯”å¦‚å»æ‰ç™»å½•ã€æ³¨å†Œã€æ³¨é”€é“¾æ¥ç­‰ç­‰ï¼Œæœ‰äººæäº†è¡¥ä¸å‡ºæ¥ï¼Œè¿˜æ²¡æ”¶å½•ï¼Œæˆ‘ä¹Ÿä¸æ¸…æ¥šæ˜¯ä¸æ˜¯æ”¹çš„å®Œå¤‡ï¼Œæˆ‘ä¸æ‡‚ Pythonï¼Œæš‚ä¸”ä¸æŠ˜è…¾äº†ã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50795404", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 1, 
            "title": "Gitolite 3 çš„é…ç½®", 
            "content": "<p>ã€è¿ç§»ã€‘Gitolite 3 çš„é…ç½® </p><p>æœ¬æ¥ä»¥ä¸ºè¿™å®å¾ˆå®¹æ˜“é…ç½®çš„ï¼Œå› ä¸ºä¸¤ä¸‰å¹´å‰ç®€å•ç”¨äº†ä¸‹ Gitolite 2ï¼Œåªç”¨ ssh æ–¹å¼è®¿é—®ï¼Œç›¸å½“ç®€å•ï¼Œæ²¡æƒ³åˆ°æŠ˜è…¾ ssh + http + gitweb è¿˜æ˜¯å¾ˆè´¹äº†ç•ªåŠ›æ°”ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>Gitolite  æ˜¯å¹²å˜›çš„å°±ä¸å®£ä¼ äº†ï¼Œåªè¯´ä¸€å¥ï¼ŒGitosis ç°åœ¨æ˜¯åºŸå¼ƒçš„ä¸œè¥¿ï¼Œå…³äºè¿™ä¿©çš„ä»‹ç»è¯·å„ä½å‚è€ƒã€ŠPro Gitã€‹ä¸€ä¹¦ã€‚ä¹‹å‰æœ‰åœ¨æ°´æœ¨ä¸Šå¹æ°´  Gitolite å®£ç§°ä¸ Gitweb é›†æˆåº¦é«˜ï¼Œæœ‰äººé—®äº†å¥æ€ä¹ˆå°±é›†æˆåº¦é«˜äº†ï¼Œä¿ºå½“æ—¶æ²¡ç»†æŠ˜è…¾ï¼Œç­”ä¸å…·ä½“ï¼Œè¿™æ¬¡å¯ä»¥è¯´è¯¦ç»†äº†ï¼š</p><ul><li>Gitolite  è‡ªå¸¦çš„ git update hook ä¼šæ ¹æ® gitolite-admin/conf/gitolite.conf ä¸­çš„æƒé™é…ç½®æ›´æ–°  ~git/projects.list æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å†…å®¹è¢« Gitweb å½“ä½œä»£ç åº“åˆ—è¡¨ã€‚Gitolite ä¼šæ ¹æ®æŸä¸ª repo æ˜¯å¦å¯è¢«  gitweb è¯»å–æˆ–è€…æ˜¯å¦æœ‰ gitweb ç›¸å…³çš„ git config å†³å®šè¦ä¸è¦åŠ å…¥ projects.list æ–‡ä»¶ä¸­ï¼ŒåŒæ—¶æ ¹æ®æ˜¯å¦å¯è¢«  daemon ç”¨æˆ·è¯»å–å†³å®šè¦ä¸è¦ç”Ÿæˆ REPO.git/git-daemon-export-ok æ ‡è®°æ–‡ä»¶ã€‚</li><li>ç”±äº Gitolite æ˜¯ Perl ç¼–å†™çš„ï¼Œæ‰€ä»¥å…¶æƒé™åˆ¤æ–­å‡½æ•°å¾ˆå®¹æ˜“è¢«åŒæ˜¯ Perl å†™çš„ Gitweb ä½¿ç”¨ã€‚</li></ul><p>ä¼—å¤šå¼€æºç‰ˆæœ¬æ§åˆ¶å·¥å…·é‡Œï¼Œæœ¬äººå¯¹ GIT æœ€æœ‰å¥½æ„Ÿï¼ˆè™½ç„¶ä¼Šä¹Ÿä¸æ˜¯ç™¾åˆ†ç™¾è®©äººæ»¡æ„ï¼‰ï¼Œæœ¬ç€æ¨å¹¿ Git çš„ç²¾ç¥ï¼Œä¸‹é¢ç ´ä¾‹è¯´è¯´å…·ä½“é…ç½®è¿‡ç¨‹ï¼Œå„ä½çœ‹å®˜å‚è€ƒçš„æ—¶å€™ç•™ç¥è¿™ç¯‡å°æ–‡å†™ä½œçš„æ—¶é—´ï¼Œä»¥å…ä¿¡æ¯è¿‡æ—¶è¢«è¯¯å¯¼ã€‚å¦å¤–è¿™é‡Œæ˜¯å…¨æ–°å®‰è£…ï¼Œä» 2.x å‡çº§çš„åŒå­¦ä¸€å®šè®°å¾—çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œ<b>ä¸èƒ½è‡ªåŠ¨å¹³æ»‘å‡çº§çš„ï¼</b></p><p class=\"ztext-empty-paragraph\"><br/></p><p>Git ä»£ç åº“çš„ Web æµè§ˆï¼Œé™¤äº†å®˜æ–¹çš„ Gitwebï¼Œè¿˜æœ‰ cgit è¢«ç”¨çš„æ¯”è¾ƒå¤šï¼Œæ¯”å¦‚ <a href=\"https://link.zhihu.com/?target=http%3A//cgit.freedesktop.org/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">cgit.freedesktop.org/</span><span class=\"invisible\"></span></a>ï¼Œå…¶ç‰¹ç‚¹æ˜¯ç”¨  C ç¼–å†™ï¼Œé“¾æ¥äº† Git å®˜æ–¹çš„ libgit.a åº“ï¼Œä¸ç”¨ fork è¿›ç¨‹å»æ‰§è¡Œ git å‘½ä»¤ï¼Œæ‰€ä»¥æ•ˆç‡å¾ˆé«˜ï¼Œä½†æ˜¯ä¼Šå°±ä¸æ–¹ä¾¿ç”¨  Gitolite çš„æƒé™æ§åˆ¶åŠŸèƒ½äº†ã€‚å¦å¤–è¿˜æœ‰ä¸ª git-browser ä½¿ç”¨ JavaScript åœ¨æµè§ˆå™¨é‡Œç»˜åˆ¶ç±»ä¼¼ gitk  å±•ç¤ºçš„ç‰ˆæœ¬å›¾ï¼Œæ•ˆæœå¾ˆç‚«ï¼Œä½†æ˜¯å¤ªè´¹èµ„æºäº†ï¼Œä¸ªäººè§‰å¾—ä¹Ÿæ²¡å¿…è¦ï¼Œgitk å·²ç»éå¸¸å¥½ç”¨äº†ï¼Œåˆè·¨å¹³å°ï¼Œæƒ³å›´è§‚çš„åŒå­¦å¯ä»¥çœ‹çœ‹ <a href=\"https://link.zhihu.com/?target=http%3A//repo.or.cz/git-browser/by-commit.html%3Fr%3Dgit/repo.git\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">repo.or.cz/git-browser/</span><span class=\"invisible\">by-commit.html?r=git/repo.git</span><span class=\"ellipsis\"></span></a> ï¼Œ<b>è­¦å‘Šï¼Œä½ çš„æµè§ˆå™¨ç”šè‡³æ•´ä¸ªæ¡Œé¢å¯èƒ½å†»ç»“ä½ï¼</b></p><p class=\"ztext-empty-paragraph\"><br/></p><p>ä¸€ã€å®‰è£… Gitoliteã€Gitweb ç­‰ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>Gitolite  ä½œè€…åˆé—²åˆè¿½æ±‚å®Œç¾ï¼Œé‡å†™äº†ä¸ª Gitolite 3 å‡ºæ¥ï¼Œä½¿ç”¨ä¸Šè·Ÿ 2.x å¾ˆç±»ä¼¼ï¼Œæ®è¯´å†…éƒ¨ä»£ç æ•´ç†çš„æ›´å¹²å‡€é«˜æ•ˆäº†ï¼Œç›®å‰ Debian  ä¸Šè¿˜æ²¡å¼•å…¥ Gitolite 3.xï¼Œä¼°è®¡çŸ­æœŸä¹Ÿä¸ä¼šå¼•å…¥ï¼Œ3.0 æ‰å‡ºæ¥ä¸€ä¸ªæœˆï¼Œè€Œä¸” 2.x åˆ° 3.x  ä¸èƒ½å¹³æ»‘å‡çº§ã€‚ä»æºç å®‰è£…ç›¸å½“ç®€å•çš„ï¼Œgit clone æŠŠæºç æŠ“ä¸‹æ¥ï¼Œgit describe &gt; src/VERSIONï¼Œç„¶åæŠŠ  src/ ç›®å½•å¤åˆ¶ä¸º /usr/local/share/gitoliteï¼Œç„¶å </p><div class=\"highlight\"><pre><code class=\"language-text\"># ln -s /usr/local/share/gitolite/gitolite /usr/local/bin</code></pre></div><p> å°±æå®šäº†ï¼Œclone ä¸‹æ¥é‚£ä»½æºç å¯ä»¥åˆ æ‰ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>å®‰è£… gitweb ä»¥åŠ gitweb ç”¨æ¥é«˜äº®ä»£ç çš„ highlight:</p><div class=\"highlight\"><pre><code class=\"language-text\"># aptitude install gitweb highlight\n</code></pre></div><p>ç”±äºæˆ‘æƒ³è®©  gitolite ä¹Ÿæ”¯æŒ http æ–¹å¼ pushï¼Œä½†è®© www-data ç”¨æˆ·å¯ä»¥å†™å…¥ git ä»£ç åº“æ€»è§‰å¾—ä¸å®‰å…¨ï¼Œæ‰€ä»¥æˆ‘ apache çš„  suexec ç‰¹æ€§ï¼Œç”¨ apache2-suexec-custom åŒ…æ˜¯å› ä¸ºä¸æƒ³æŠŠ gitolite-shell-wrapper  æ”¾åˆ°  /var/www/ è¿™ä¸ªåƒåœ¾åœºé‡Œï¼Œè¿™ä¸ªåœ°æ–¹æˆ‘ä¿ç•™ç»™æœªå— Kerberos ä¿æŠ¤çš„ default virtual host  äº†ã€‚ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªæ„å¤–çš„é—®é¢˜ï¼ŒApache çš„ SuexecUserGroup æŒ‡ä»¤æ˜¯é’ˆå¯¹æ•´ä¸ª virtualhost ç”Ÿæ•ˆçš„ï¼Œè€Œæˆ‘é…ç½®çš„  gitolite http è®¿é—®å’Œ gitweb http è®¿é—®éƒ½ç”¨ http://git.corp.example.com åŸŸåï¼Œæ‰€ä»¥ gitweb ä¹Ÿå¾—ä»¥  git ç”¨æˆ·è¿è¡Œï¼Œå¦‚æœ gitweb æœ‰æ¼æ´å¯ä»¥å†™å…¥ /srv/gitï¼Œé‚£ä¹ˆäº‹æƒ…å°±ä¹±å¥—äº†ã€‚ç†æƒ³çŠ¶æ€æ˜¯ gitweb ä»¥ gitweb  ç”¨æˆ·è¿è¡Œï¼Œå¹¶åœ¨ git ç»„é‡Œæ‰€ä»¥å¾—ä»¥è®¿é—® /srv/git/repositoriesã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\"># aptitude install apache2-suexec-custom</code></pre></div><p>è®©  Gitolite æ”¯æŒä¸é‚£ä¹ˆæ­£ç»Ÿçš„ http è®¿é—®æ–¹å¼æ˜¯å› ä¸º Kerberos ç»Ÿä¸€è®¤è¯ï¼Œä»¥åŠ Windows ä¸‹ç”¨ ssh  å…¬é’¥ä»€ä¹ˆçš„å¯èƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œä¸è¿‡è¿˜ä¸æ¸…æ¥š msysgit ç¼–è¯‘æ—¶ç”¨çš„ libcurl æ”¯æŒ Kerberos ä¸ï¼Œæ±—ï¼ è®© Gitolite æ”¯æŒ  ssh ä¸€æ˜¯å¯ä»¥åº”ä»˜ Kerberos æœåŠ¡å½“æœºçš„æƒ…å†µï¼ŒäºŒæ˜¯ä¸€äº›éœ€è¦è®¿é—® git ä»£ç åº“çš„æœåŠ¡ä¸ç”¨æä¾› Kerberos ticket  äº†ï¼ˆè¿™ä¸ªæ˜¯éœ€è¦ç”¨ k5start å®šæ—¶åˆ·æ–°çš„ï¼‰ï¼Œç”¨ ssh-agent + ssh key å°±è¡Œäº†ï¼Œæ¯”å¦‚ ReviewBoard å°±æ˜¾å¼æ”¯æŒ  ssh æ–¹å¼ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>äºŒã€é…ç½® Gitoliteã€Gitweb</p><p class=\"ztext-empty-paragraph\"><br/></p><p>æ¥ä¸‹æ¥åˆ›å»º git ç³»ç»Ÿç”¨æˆ·ä»¥åŠ git ç³»ç»Ÿç»„ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\"># addgroup --system git# adduser --system --home /srv/git --shell /bin/bash --ingroup git \\\n  --disable-password --disable-login --gecos &#34;git repository hosting&#34; git\n# chmod 700 /srv/git\n</code></pre></div><p>åˆå§‹åŒ– Gitoliteï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\"># ssh-keygen -t ecdsa -b 521 -f admin\n# cp admin.pub /srv/git\n$ su git\n$ gitolite setup --pubkey admin.pub\n$ rm admin.pub\n</code></pre></div><p>ssh-keygen ç”Ÿæˆçš„ admin å’Œ admin.pub éœ€è¦å¤åˆ¶åˆ°è‡ªå·±æœ¬æœºçš„ ~/.ssh ä¸‹ï¼Œå¹¶è®¾ç½® ~/.ssh/config:</p><div class=\"highlight\"><pre><code class=\"language-text\">Host git.corp.example.com\n    User git\n    IdentifyFile ~/.ssh/admin\n</code></pre></div><p>è¿™æ—¶å¯ä»¥ç”¨ ssh æ–¹å¼è®¿é—® Gitolite äº†ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">...æ£€å‡º gitolite-admin åº“ï¼Œéœ€è¦äº‹å…ˆåœ¨ /etc/hosts é‡Œè®¾ç½® git.corp.example.com å’Œ IP çš„å¯¹åº”å…³ç³»...\n\n$ git clone git.corp.example.com:gitolite-admin\n...æŸ¥çœ‹è‡ªå·±èƒ½è®¿é—®å“ªäº›ä»£ç åº“\n\n$ ssh git.corp.example.com info\n</code></pre></div><p>å¸ƒç½®  suexec æ‰§è¡Œçš„  CGI ç¨‹åºï¼šï¼ˆæ²¡æœ‰ç”¨ mod_perl æ˜¯å› ä¸º mod_perl æŠ€æœ¯ä»¥åŠ git  æœ¬èº«éƒ½å¾ˆè€—å†…å­˜ï¼Œæˆ‘æ˜¯é’ˆå¯¹å°ç«™ç‚¹ï¼Œæ²¡å¿…è¦å¾ˆé«˜æ•ˆï¼Œå¦å¤– gitweb çš„ FastCGI æ–¹å¼ä¸æ˜¯å¾ˆæˆç†Ÿï¼ŒGitolite ä¸æ¸…æ¥šæ˜¯å¦æ”¯æŒ  FastCGIï¼‰</p><div class=\"highlight\"><pre><code class=\"language-text\"># mkdir -m 755 -p /srv/www/git\n# cp gitolite-shell-wrapper /srv/www/git/gitolite-shell-wrapper\n# cp /usr/share/gitweb/gitweb.cgi /srv/www/git/gitweb.cgi\n# chown -R git git /srv/www/git\n# chmod 755 /srv/www/git\n# chmod 700 /srv/www/git/{gitweb.cgi,gitolite-shell-wrapper}\n</code></pre></div><p>æ¯”è¾ƒæ‚²å‚¬çš„æ˜¯ä¸ºäº†å®‰å…¨èµ·è§ suexec ä¸å…è®¸ç¬¦å·é“¾æ¥ï¼Œæ‰€ä»¥è¿™é‡Œåªå¥½æ‹·è´æ–‡ä»¶äº†ï¼Œå±ä¸»ã€æƒé™éƒ½å¿…éœ€æŒ‰ç…§ä¸Šé¢çš„è®¾ç½®ï¼Œå¦åˆ™ suexec æ£€æŸ¥ä¼šå¤±è´¥ã€‚</p><p>/srv/www/git/gitolite-shell-wrapper çš„å†…å®¹å¦‚ä¸‹ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">#!/bin/sh\n#\n# Suexec wrapper for gitolite-shell, suexec doesn&#39;t allow symlink,\n# and it will clear those GIT or Gitolite environment variables\n# before executing this script.\n#\n\nexport GIT_PROJECT_ROOT=${GIT_PROJECT_ROOT:-/srv/git/repositories}\nexport GITOLITE_HTTP_HOME=${GITOLITE_HTTP_HOME:-/srv/git}\nexport GIT_HTTP_EXPORT_ALL=1\n\nexec /usr/local/share/gitolite/gitolite-shell\n</code></pre></div><p>/etc/gitweb.confï¼ˆå¦‚æœåŒä¸€ä¸ªæœºå™¨ä¸Šä½ æƒ³å®‰è£…å¤šä»½ gitwebï¼Œå¯ä»¥æŠŠè¿™ä¸ªå†…å®¹å¤åˆ¶åˆ° /srv/www/git/gitweb_config.perlï¼Œå‚è§ man gitweb.confï¼‰:</p><div class=\"highlight\"><pre><code class=\"language-text\"># path to git projects (&lt;project&gt;.git)\n# DON&#39;T include trailing slash, it breaks $export_auth_hook below!\n$projectroot = &#34;/srv/git/repositories&#34;;\n\n# directory to use for temp files\n$git_temp = &#34;/tmp&#34;;\n\n# target of the home link on top of all pages\n#$home_link = $my_uri || &#34;/&#34;;\n\n# html text to include at home page\n#$home_text = &#34;indextext.html&#34;;\n\n# file with project list; by default, simply scan the projectroot dir.\n$projects_list = &#34;/srv/git/projects.list&#34;;\n\n# stylesheet to use\n@stylesheets = (&#34;/static/gitweb.css&#34;);\n\n# javascript code for gitweb\n$javascript = &#34;/static/gitweb.js&#34;;\n\n# logo to use\n$logo = &#34;/static/git-logo.png&#34;;\n\n# the &#39;favicon&#39;\n$favicon = &#34;/static/git-favicon.png&#34;;\n\n# git-diff-tree(1) options to use for generated patches\n#@diff_opts = (&#34;-M&#34;);\n\n$prevent_xss = 1;\n$highlight_bin = &#34;/usr/bin/highlight&#34;;\n$feature{&#39;highlight&#39;}{&#39;default&#39;} = [1];\n$feature{&#39;timed&#39;}{&#39;default&#39;} = [1];\n\n$strict_export = 1;\n$export_ok = &#34;git-daemon-export-ok&#34;;\n\nBEGIN { $ENV{HOME} = &#34;/srv/git&#34;; }\nuse lib &#39;/usr/local/share/gitolite/lib&#39;;\nuse Gitolite::Easy ();\n$export_auth_hook = sub {\n    return unless $ENV{REMOTE_USER};\n    my $repo_path = $_[0];\n    my $repo_name = substr($repo_path, length($projectroot) + 1);\n\n    $ENV{GL_USER} = $ENV{REMOTE_USER};\n    $repo_name =~ s/\\.git$//;\n    Gitolite::Easy::can_read($repo_name);\n};\n</code></pre></div><p>ä¸Šé¢ç»“å°¾çš„ä¸€æ®µæ˜¯è°ƒç”¨ Gitolite 3 çš„æƒé™åˆ¤æ–­å‡½æ•°ï¼Œcan_read() è²Œä¼¼åªèƒ½åˆ¤æ–­åˆ°åº“ä¸€çº§ï¼Œæ›´åº•å±‚çš„å‡½æ•° access() è²Œä¼¼èƒ½åˆ¤æ–­æ›´ç»†ï¼Œä½†æ˜¯ç”±äº GIT çš„ä»£ç æ ‘ä¸å¯åˆ†å‰²ä»¥åŠè¿™æ˜¯ä¸ºä¼ä¸šå†…éƒ¨è€ƒè™‘ï¼Œè¯»æƒé™ç²’åº¦ç²—æ”¾ä¸€ç‚¹ä¸€èˆ¬ä¹Ÿä¸æ˜¯å¤§é—®é¢˜ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>éœ€è¦å¼ºè°ƒä¸€ä¸‹çš„æ˜¯  $strict_export å’Œ $export_okï¼Œé»˜è®¤ä¸¤ä¸ªæ˜¯æ²¡å®šä¹‰çš„ï¼Œåœ¨æ²¡æœ‰å®šä¹‰ $export_auth_hook æ—¶ï¼Œä¼šå¯¼è‡´  gitweb é¦–é¡µæ²¡æœ‰åˆ—å‡ºçš„ project åœ¨ URL é‡Œç›´æ¥è¾“å…¥æ˜¯å¯ä»¥è®¿é—®çš„ï¼Œæ¯”å¦‚  http://git.corp.example.com/gitweb?p=gitolite-admin.git;a=logï¼Œæˆ‘å¾ˆæ™•è¿™ä¸ªé»˜è®¤è®¾ç½®ï¼Œå¤ªä¸å®‰å…¨äº†ï¼Œæˆ‘ç”šè‡³æ€€ç–‘æ‰«æäº’è”ç½‘ä¸Šå…¬å¼€çš„  gitwebï¼Œæˆ–è®¸èƒ½æ‰«å‡ºä¸€ç‰‡ gitolite-admin.gitï¼Œä» conf/gitolite.conf  çŸ¥é“æ‰€æœ‰ä»£ç åº“åˆ—è¡¨ï¼Œä»è€Œçœ‹åˆ°éšè—ä»£ç åº“çš„å†…å®¹ã€‚ã€‚ã€‚ã€‚</p><p>$strict_ok çš„æ„æ€æ˜¯ä¸åœ¨ projects.list  ä¸­çš„ä»£ç åº“ä¸æ˜¾ç¤ºåœ¨ä»£ç åº“åˆ—è¡¨é‡Œï¼Œä¹Ÿä¸èƒ½é€šè¿‡ URL ç›´æ¥è®¿é—®ï¼Œè¿™ä¸ªé€‰é¡¹éœ€è¦ Gitolite é‡Œç»™ä»£ç åº“æƒé™åŠ å…¥  R =  gitwebï¼Œæˆ–è€…è¿™ä¸ªä»£ç åº“æœ‰ <a href=\"https://link.zhihu.com/?target=http%3A//gitweb.xxx\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">gitweb.xxx</span><span class=\"invisible\"></span></a> çš„ git é…ç½®(Gitolite æ”¯æŒåœ¨ conf/gitolite.conf  é‡Œä¸ºæ¯ä¸ªä»£ç åº“è®¾ç½® git config çš„é…ç½®ï¼‰ã€‚</p><p>$export_ok çš„æ„æ€æ˜¯åªæœ‰  REPO.git/git-daemon-export-ok å­˜åœ¨æ—¶æ‰æ”¾å…¥ projects.list å¹¶å¯ä»¥é€šè¿‡ URL ç›´æ¥è®¿é—®ï¼Œè¿™ä¸ªé€‰é¡¹éœ€è¦  Gitolite é‡Œç»™ä»£ç åº“åŠ å…¥ R = daemon æƒé™ï¼ŒåŠ ä¸Š gitweb çš„ï¼Œå°±æ˜¯ R = daemon gitweb äº†ï¼Œæ¯”å¦‚ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">...in working copy of gitolite-admin...\n$ cat conf/gitolite.conf\n...\nrepo myserver\n    RW+ = dieken\n    R   = daemon gitweb\n$ git comit -a -m &#34;blah blah&#34;\n$ git push  # will trigger git update hook, /srv/git/projects.list will be generated from scratch\n</code></pre></div><p>æœ€åä¸€é“å·¥åºï¼Œé…ç½® Apache:</p><div class=\"highlight\"><pre><code class=\"language-text\">$ cat /etc/apache2/suexec/www-data\n/srv/www\npublic_html/cgi-bin\n$ cat /etc/apache2/sites-enabled/git\n&lt;VirtualHost *:80&gt;\n    ServerName git.corp.example.com\n    ServerAdmin webmaster@corp.example.com\n    DocumentRoot /nonexistent\n\n    ErrorLog ${APACHE_LOG_DIR}/git-error.log\n\n    # Possible values include: debug, info, notice, warn, error, crit,\n    # alert, emerg.\n    LogLevel warn\n\n    CustomLog ${APACHE_LOG_DIR}/git-access.log combined\n\n    SuexecUserGroup git git\n\n    # Actually, suexec will clear these environment variables...\n    SetEnv GIT_PROJECT_ROOT         /srv/git/repositories\n    SetEnv GITOLITE_HTTP_HOME       /srv/git\n    SetEnv GIT_HTTP_EXPORT_ALL\n\n    ScriptAlias /git/ /srv/www/git/gitolite-shell-wrapper/\n    ScriptAlias /gitweb /srv/www/git/gitweb.cgi\n    Alias /static /usr/share/gitweb/static\n\n    &lt;Directory /usr/share/gitweb/static&gt;\n        AllowOverride None\n        Order allow,deny\n        Allow from all\n    &lt;/Directory&gt;\n\n    &lt;Location /&gt;\n        AuthType Kerberos\n        Require  valid-user\n\n        Order allow,deny\n        Allow from all\n    &lt;/Location&gt;\n\n    &lt;Location /git&gt;\n        AuthType Kerberos\n        Require  valid-user\n\n        Order allow,deny\n        Allow from all\n    &lt;/Location&gt;\n\n    &lt;Location /gitweb&gt;\n        AuthType Kerberos\n        Require  valid-user\n\n        Order allow,deny\n        Allow from all\n    &lt;/Location&gt;\n\n    RedirectMatch   ^/$     /gitweb\n\n&lt;/VirtualHost&gt;\n\n</code></pre></div><p><b>æ²¡æœ‰ç»™ Apache é…ç½® Kerberos è®¤è¯çš„åŒå­¦å¯ä»¥ç”¨ AuthType Basicï¼Œå‚è€ƒ <a href=\"https://link.zhihu.com/?target=http%3A//sitaramc.github.com/gitolite/http.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">sitaramc.github.com/git</span><span class=\"invisible\">olite/http.html</span><span class=\"ellipsis\"></span></a> ã€‚</b></p><p class=\"ztext-empty-paragraph\"><br/></p><p>HTTP æ–¹å¼è®¿é—® Gitolite:</p><div class=\"highlight\"><pre><code class=\"language-text\">$ kinit\n\n$ curl --negotiate -u : http://git.corp.example.com/git/info\n$ git clone http://dieken@git.corp.example.com/git/gitolite-admin\n</code></pre></div><p>&#34;git  clone&#34; å‘½ä»¤é‡Œéœ€è¦æŒ‡å®š &#34;dieken@&#34; éƒ¨åˆ†ï¼Œå¦åˆ™ git ä¼šæé—®å¯†ç ï¼Œä½†æ˜¯åœ¨ Kerberos  è®¤è¯æ—¶ï¼Œè¿™ä¸¤ä¸ªé—®é¢˜éƒ½å¯ä»¥å¡«å…¥ä»»æ„å­—ç¬¦ï¼Œå¦‚åŒä¸Šé¢é‚£æ¡ curl  å‘½ä»¤ä¼¼çš„ï¼Œ&#34;-u :&#34; æŒ‡å®šç”¨æˆ·åä¸ºå†’å·ï¼Œè¿™æ˜¯ curl å®ç°çš„é—®é¢˜ï¼Œè™½ç„¶  Kerberos ticket æä¾›äº†ç”¨æˆ·åï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦æŒ‡å®šä¸‹ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>è®¿é—® Gitwebï¼šhttp://git.corp.example.com/ ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>Gitolite è¿™ä¸ªå¥‡æŠ€æ·«å·§çš„ä¸œè¥¿è¿˜æœ‰è®¸å¤šç‰¹æ€§æœ‰å¾…é’»ç ”ï¼Œä»¥åå†æ…¢æ…¢ç¢ç£¨äº†ã€‚</p>", 
            "topic": [
                {
                    "tag": "Git", 
                    "tagLink": "https://api.zhihu.com/topics/19557710"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": [
                {
                    "userName": "ktw361", 
                    "userLink": "https://www.zhihu.com/people/9f87a7a6f2071508a2036844a4cbc175", 
                    "content": "ä¼Šï¼Ÿå…„å¼Ÿç¦å»ºäººï¼Ÿ", 
                    "likes": 0, 
                    "childComments": []
                }
            ]
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50795346", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "Web ä¼šè®®ç³»ç»Ÿ", 
            "content": "<p>ã€è¿ç§»ã€‘Web ä¼šè®®ç³»ç»Ÿ</p><p>æœ‰æ—¶å€™åœ°ç†ä½ç½®ä¸åœ¨åŒä¸€åœ°æ–¹çš„å‡ ä¸ªäººæƒ³å¼€ä¼šï¼Œè®¨è®ºä¸ªè®¾è®¡ï¼Œå¼€ä¸ªè®²åº§å•¥çš„ï¼Œæœ‰ä¸ª Web ä¼šè®®ç³»ç»Ÿä¼šå¾ˆæ–¹ä¾¿ï¼Œå®¢æˆ·ç«¯æœ‰æµè§ˆå™¨å°±è¡Œï¼Œè£…ä¸ª JRE æˆ–è€… Flash æ’ä»¶ã€‚<a href=\"https://link.zhihu.com/?target=http%3A//en.wikipedia.org/wiki/Web_conferencing\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Web conferencing</a> ç³»ç»Ÿçš„å‡ ä¸ªåŸºæœ¬éœ€æ±‚ï¼š</p><ul><li>å®¢æˆ·ç«¯åªéœ€è¦ Web æµè§ˆå™¨ï¼Œä¸€èˆ¬éƒ½ä¼šç”¨ Flash æˆ–è€… JRE æ’ä»¶ï¼ŒGoogle æçš„ WebRTC åŸºäº HTML 5ï¼Œå¾ˆæœ‰æ„æ€ã€‚</li><li>ä¼šè®®å®¤çš„æƒé™æ§åˆ¶ï¼šè°å¯ä»¥å‚åŠ ï¼Œè°å¯ä»¥å¾—åˆ°ä¸»æŒæƒåŠ›ï¼Œè°å¯ä»¥é‚€è¯·åˆ«äººå‚åŠ ï¼Œç­‰ç­‰ã€‚</li><li>å…±äº«ç™½æ¿ç”¨æ¥ç”»ç¤ºæ„å›¾</li><li>å…±äº«å±å¹•ç”¨æ¥å±•ç¤ºä¸€äº›æ–‡æ¡£ä»€ä¹ˆçš„</li><li>å…±äº«æ¡Œé¢æ§åˆ¶ï¼Œå…è®¸åˆ«äººæš‚æ—¶æ“ä½œä¸‹è‡ªå·±çš„æœºå™¨</li><li>éŸ³é¢‘ã€è§†é¢‘é€šè®¯ï¼Œå£°éŸ³æ˜¯ä¸ç”¨è¯´äº†ï¼Œè§†é¢‘å¯ä»¥ç”¨æ¥çœ‹çœ‹è¯´è¯çš„äººæ˜¯è°ï¼ˆæˆ‘ç»å¸¸åˆ†è¾¨ä¸å‡ºç”µè¯ä¼šè®®é‡Œè¯´è¯çš„äººæ˜¯è°ã€‚ã€‚ã€‚ï¼‰</li><li>ä¼šè®®è¿‡ç¨‹çš„å½•åˆ¶ï¼Œä¾›äº‹åæŸ¥é˜…</li><li>è·Ÿæ—¥å†ç³»ç»Ÿé›†æˆï¼Œæˆ–è€…æœ‰è‡ªå·±çš„æ—¥å†ç³»ç»Ÿï¼ŒæŸ¥çœ‹æœ‰å“ªäº›ä¼šè®®å³å°†å‘ç”Ÿï¼Œè¿‡å»å¼€è¿‡ä»€ä¹ˆä¼šè®®</li><li>ä¼šè®®çš„è¿›è¡Œè·ŸæŸä¸€ä¸ªå‚ä¸è€…æ˜¯å¦åœ¨çº¿æ²¡æœ‰è€¦åˆï¼Œæ¯”å¦‚ä¸»æŒäººæ‰çº¿äº†ï¼Œä¼šè®®ä¸èƒ½è‡ªåŠ¨ç»“æŸï¼Œä¼šè®®å½•åˆ¶ä¸èƒ½ä¸­æ–­</li><li>ä¸ºäº†é¿å…æ³„æ¼å•†ä¸šæœºå¯†ï¼ŒWeb ä¼šè®®ç³»ç»Ÿä¸èƒ½æ˜¯ç¬¬ä¸‰æ–¹å…¬å¸ç®¡ç†çš„<br/></li></ul><p>å•†ä¸š Web ä¼šè®®ç³»ç»Ÿå¾ˆå¤šï¼Œæˆ‘ç”¨è¿‡ Adobe Connectï¼Œå¬è¯´è¿‡ Lync å’Œ WebExã€‚æ»¡è¶³<i><b>éƒ¨åˆ†</b></i>éœ€æ±‚çš„äº§å“ä¹Ÿé¢‡æœ‰ä¸€äº›ï¼Œæ¯”å¦‚  NetMeeting(å¯æƒœ Ekiga ä¸æ”¯æŒç™½æ¿ã€ç¨‹åºå…±äº«ã€æ¡Œé¢å…±äº«ï¼‰ã€ä¸€äº› IM å·¥å…·ã€‚å¼€æºçš„æ­£ç» Web  ä¼šè®®ç³»ç»Ÿå´æ˜¯å¾ˆå°‘ï¼Œå¾ˆå¯èƒ½æ˜¯å› ä¸ºæ¶‰åŠåˆ°éŸ³é¢‘ã€è§†é¢‘ã€æµåª’ä½“ã€å®¢æˆ·ç«¯ JSã€Flash ç­‰å¤šæ–¹é¢æŠ€æœ¯ï¼Œä¸é‚£ä¹ˆå®¹æ˜“å®ç°ã€‚ä»ç½‘ä¸Šæ‰“å¬åˆ°çš„å¼€æº Web  ä¼šè®®ç³»ç»Ÿæœ‰è¿™äº›ï¼š</p><ul><li>OpenMeetingsï¼šåŸæ¥ä»£ç åœ¨ google code ä¸Šï¼Œç°åœ¨è½¬ç§»åˆ° Apache  ç»„ç»‡ä¸‹å­µåŒ–äº†ï¼Œè¿™æ˜¯æˆ‘å”¯ä¸€è¯•ç”¨è¿‡çš„ï¼Œè¿è¡Œå¾ˆæ–¹ä¾¿ï¼Œå¼€ç®±å³ç”¨ï¼Œå¤–éƒ¨ä¾èµ–æå°‘ï¼ŒåŠŸèƒ½æ¯”è¾ƒå…¨é¢ï¼ŒåŸºæœ¬å¯ç”¨ï¼Œå° bug æ¯”è¾ƒå¤šã€‚å®¢æˆ·ç«¯ç”¨çš„ Flash  åšç•Œé¢ï¼ŒJava WebStart æŠ€æœ¯åšå±å¹•å…±äº«ï¼ŒæœåŠ¡ç«¯ä½¿ç”¨ Java æŠ€æœ¯ï¼Œå°¤å…¶æ˜¯ Red5 æµåª’ä½“æœåŠ¡å™¨ã€‚<br/></li><li>BigBlueButtonï¼šå¼€å‘çŠ¶æ€ä¸é”™ï¼Œä½†æˆ‘çœ‹åˆ°å®‰è£…æ–‡æ¡£å°±é€€å´äº†ï¼Œå®‰è£…è¿˜çœŸç½—å—¦ï¼Œä¾èµ–æš´å¤šï¼Œçœ‹æ–‡æ¡£ä¼¼ä¹æ˜¯æ··æ‚äº† Ruby/Java/Flashã€‚çœ‹ demo çš„ç•Œé¢è²Œä¼¼åŠŸèƒ½ä¸å¦‚ OpenMeetings ä¸°å¯Œã€‚</li><li>WebHuddle:  è¿™å®å·ç§°æ˜¯å¼€æºçš„ï¼Œå…¶åœ¨ <a href=\"https://link.zhihu.com/?target=http%3A//sourceforge.net\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">sourceforge.net</span><span class=\"invisible\"></span></a> ä¸Šçš„æºç çœ‹èµ·æ¥å¾ˆä¹…æ²¡æ›´æ–°äº†ï¼Œä¸‹è½½é‡Œæœ‰ <a href=\"https://link.zhihu.com/?target=http%3A//sourceforge.net/projects/webhuddle/files/webhuddle/WebHuddle-0.4.9/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">0.4.9 Windows</a> ç‰ˆï¼Œ2007 å¹´ä¸Šä¼ çš„ã€‚ä»è¿™ä¸ªå°æ¹¾å…„å¼Ÿçš„<a href=\"https://link.zhihu.com/?target=http%3A//163.13.177.120/blog/index.php%3Fload%3Dread%26id%3D11\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">æ•™å­¦ç‰‡</a>çœ‹ï¼Œè¿™å¥—ç³»ç»ŸæœåŠ¡ç«¯ç”¨äº† jbossï¼Œå®¢æˆ·ç«¯æ˜¯ç”¨ Java Appletã€‚</li></ul><p class=\"ztext-empty-paragraph\"><br/></p><p>æ€»ç»“ä¸‹ï¼šå¦‚æœä¼ä¸šæœ‰è¿™æ–¹é¢çš„éœ€æ±‚ï¼Œè¿˜æ˜¯æ‰¾ä¸ªå•†ä¸šç³»ç»Ÿå§ï¼Œå®åœ¨æ²¡é’±åˆä¸æƒ³ç›—ç‰ˆï¼Œå¯ä»¥è¯•è¯• OpenMeetingsã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50795289", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "å±…ç„¶å°†è¿‘äº”ä¸ªæœˆè¿‡å»äº†", 
            "content": "<p>ã€è¿ç§»ã€‘å±…ç„¶å°†è¿‘äº”ä¸ªæœˆè¿‡å»äº†</p><p>ä»å»å¹´åäºŒæœˆå¼€å§‹å†™ç³»ç»Ÿç®¡ç†ç³»åˆ—ï¼Œæ–­æ–­ç»­ç»­ç½—å“©ç½—å—¦è‡ªè¯´è‡ªåˆ’å±…ç„¶å°†è¿‘äº”ä¸ªæœˆäº†ï¼ è¿™å¥½åƒæ˜¯æˆ‘æœ‰ç”Ÿä»¥æ¥å…¨å‡­å…´è¶£ä¸šä½™åšæŒçš„æœ€é•¿çš„ä¸€ä»¶äº‹æƒ…ï¼Œæ±—ã€‚ã€‚ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>æƒ³æƒ³è¿˜æ˜¯æ¯”è¾ƒéª„å‚²çš„ï¼Œè™½ç„¶å¤§å¤šå†™çš„ä¸æ·±å…¥ï¼Œä½†æ¯•ç«Ÿç»å¤§å¤šæ•°éƒ½æ˜¯äº²èº«å®è·µäº†ä¸€æ¬¡ï¼Œæˆ‘ä¹Ÿä¸æ˜¯ï¼ˆä¹Ÿæ²¡æ‰“ç®—å°†æ¥æˆä¸ºï¼‰ä¸“ä¸šç³»ç»Ÿç®¡ç†å‘˜ï¼Œå¦å¤–æŒç»­ç»´æŠ¤äº†äº”ä¸ªæœˆçš„è‡ªåŠ¨é…ç½®è„šæœ¬ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥åœ¨å¾ˆçŸ­æ—¶é—´å†…å¤ç°è¿™ä¸€æ®µç»å†ï¼Œè¿™ç‚¹å°¤å…¶è‡ªè±ªã€‚å‰©ä¸‹è¿˜æœ‰ä¸€äº›ä¸œè¥¿æŠ˜è…¾ä¸‹å°±æš‚å‘Šä¸€æ®µè½äº†ï¼š</p><ul><li>Web ä¼šè®®ç³»ç»Ÿï¼šåœ°ç†ä½ç½®ä¸Šä¸åœ¨ä¸€èµ·åŠå…¬ï¼Œå¶å°”ä¼šæœ‰éœ€æ±‚å¼€ç½‘ç»œä¼šè®®ï¼Œèƒ½å…±äº«æ¡Œé¢ã€ç™½æ¿å•¥çš„ï¼›</li><li>Code review ç³»ç»Ÿï¼šReviewBoard, Gerritã€‚Gitolite ä½œè€…æ­£åœ¨é‡å†™æ–°ç‰ˆæœ¬ï¼Œå¯æƒœ Debian è¿˜æ²¡æ”¶å½•ã€‚</li><li>å¤‡ä»½ç³»ç»Ÿï¼šBacula/Amanda/Burp/BakcupPC/obnam...</li></ul><p>è¿™å‡ ä¸ªæ¯”è¾ƒå¥½ç©ï¼Œå…¶å®ƒå‡ ä¸ªä¹ŸæŒºåŸºæœ¬ï¼Œä½†ä¸æ‰“ç®—æŠ˜è…¾äº†ï¼š</p><ul><li>FAIï¼šç”±äºæ˜¯ IT åŸºç¡€è®¾æ–½ï¼Œé‡è£…çš„æ¦‚ç‡å¾ˆå°ï¼Œè€Œä¸”æœ‰è‡ªåŠ¨é…ç½®è„šæœ¬ï¼Œæ‰€ä»¥å¯¹è‡ªåŠ¨å®‰è£…ç³»ç»Ÿæ²¡å¤ªå¤§éœ€æ±‚ï¼›</li><li>Jenkinsï¼šCI ç³»ç»Ÿæ˜¯å¿…ä¸å¯å°‘çš„ï¼Œä½†è¿™ä¸ªä¸œè¥¿æ²¡å•¥å¥½ç ”ç©¶çš„ï¼Œç”¨å°±æ˜¯äº†ï¼›</li><li>OpenGrok: è¿™ä¸ªæˆ‘ä¸€ç›´åœ¨ç”¨ï¼Œç›¸å½“å¥½ä½¿ï¼Œä¹Ÿå±äºåŸºæœ¬æ²¡è®²å¤´çš„ä¸œè¥¿ï¼Œç”¨ Apache æŒ¡åœ¨å‰é¢é˜²æ­¢åŒ¿åè®¿é—®å¥½äº†ï¼Œéº»çƒ¦çš„æ˜¯åŸºäºè·¯å¾„çš„è®¿é—®æƒé™è®¾ç½®ï¼Œè¿™ä¸ªææ€•è¦æ”¹ OpenGrok ä»£ç ï¼Œæˆ‘æ˜¯æ²¡ç²¾åŠ›æŠ˜è…¾åˆ° OpenGrok ä»£ç é‡Œå¤´äº†ï¼›</li><li>Searchï¼šç”¨ Apache solr æ­ä¸€ä¸ªå†…éƒ¨æœç´¢ç½‘ç«™ï¼Œè¿™ä¸ªå·¥ä½œé‡å¤ªå¤§ï¼Œä¸æ˜¯ç®€å•é…ç½®ä¸‹å°±å¯ä»¥çš„ã€‚</li></ul><p>å¦å¤–ç›‘æ§ä¹Ÿå¯ä»¥åšçš„æ›´ç»†ï¼Œæ¯”å¦‚ç”¨ monit ç›‘æ§æœåŠ¡è¿›ç¨‹ï¼Œç”¨ logcheck æ£€æµ‹æ—¥å¿—ï¼Œç”¨ fail2ban é¿å…æš´åŠ›ç ´è§£ï¼›</p><p>Kerberos å¦‚ä½•å¼•å…¥åŒå› å­æˆ–è€…ä¸€æ¬¡æ€§å¯†ç è®¤è¯ä¹Ÿæ˜¯ä¸ªæœ‰æ„æ€çš„è¯é¢˜ï¼Œæœ‰ç©ºäº†å†çœ‹çœ‹ï¼Œå¯ä»¥å‚è€ƒ google-authenticator å’Œ Barada ã€‚</p><p>ç³»ç»Ÿçº§çš„å®‰å…¨é˜²æŠ¤å¯¹äºè‡³å…³é‡è¦çš„  IT åŸºç¡€è®¾æ–½èƒ½æä¾›æ›´é«˜çš„ä¿é™©ï¼Œæˆ‘æ˜¯æ²¡æŒ‡æœ›å„ä¸ªæœåŠ¡è‡ªèº«æ˜¯æ²¡æœ‰æ¼æ´äº†ï¼Œåªèƒ½å¸Œæœ›ä¸€ä¸ªæœåŠ¡è¢«æ”»å‡»äº†å½±å“çš„é¢è¶Šå°è¶Šå¥½ï¼Œè¿™æ–¹é¢ GrSecurity,  AppArmor, SELinux, SMACK, TOMOYO  ä¹‹æµåº”è¯¥å¾ˆæœ‰å¸®åŠ©ï¼Œä½†ææ€•æ˜¯æ²¡ç²¾åŠ›ä¸€ä¸€æŠ˜è…¾äº†ï¼Œåæ‰§å½’åæ‰§ï¼Œæš‚ä¸”è®¤ä¸ºå°ä¼ä¸šå†…éƒ¨å‘˜å·¥æ˜¯ç›¸å½“å€¼å¾—ä¿¡ä»»çš„å§ï¼Œå¹¶ä¸”æ‰€æœ‰æœåŠ¡éƒ½åœ¨å†…ç½‘é‡Œå¤´ï¼Œå¥½æ¯”é¸µé¸ŸåŸ‹å¤´äºæ²™ä¸­ï¼Œå®‰å…¨æ„Ÿé‚£æ˜¯ç›¸å½“å¼ºå•Šï¼Œå“ˆå“ˆã€‚</p><p>è¿˜æœ‰ä¸€äº›ç»†èŠ‚é—®é¢˜æ²¡å¤„ç†ï¼Œæ¯”å¦‚é‚®ä»¶åœ°å€ç°¿ï¼Œæˆ‘æ²¡æŠ˜è…¾  LDAP åœ°å€ç°¿ï¼ŒRoundCube é‡Œä¹Ÿæ²¡é…ç½®è¿™ä¸ªï¼Œæ»‘ç¨½çš„æ˜¯è¿™ææ€•æ˜¯ LDAP æœ€åŸå§‹çš„ç”¨é€”äº†ï¼Œå®‰æ…°è‡ªå·±â€œæ— ä¼¤å¤§é›…â€äº†ï¼Œè¿˜å¥½  Kerberos å•ç‚¹ç™»å½•ã€å„ç³»ç»Ÿä¹‹é—´é…åˆçš„æƒ³æ³•å¾—åˆ°è´¯å½»ï¼Œæ•´ä¸ªç³»åˆ—é…ç½®ä¸‹æ¥è¿˜æ˜¯åŸºæœ¬è¾¾åˆ°ç›®æ ‡çš„ã€‚</p><p>äººç”Ÿåœ¨äºæŠ˜è…¾ï¼Œç”Ÿå‘½ä¸æ¯ï¼ŒæŠ˜è…¾ä¸æ­¢ï¼Œç­‰ä¸Šé¢ä¸‰ä¸ªå¤§è‡´ç¢ç£¨ä¸€éåå†ç©ç© Common Lispï¼Œå†™ä¸ª Common Lisp å­¦ä¹ ç¬”è®°ç³»åˆ—ï¼Ÿ</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50795225", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 2, 
            "title": "ç›‘æ§ç³»ç»Ÿ", 
            "content": "<p>ã€è¿ç§»ã€‘ç›‘æ§ç³»ç»Ÿ</p><p>æµ…å°è¾„æ­¢çš„ä¸€ç‚¹ç¬”è®°ã€‚åœ¨æ­£æ–‡ä¹‹å‰çš„æ€»ç»“ï¼š</p><p>ç›‘æ§ä¸€ä¸ªç³»ç»Ÿï¼Œæ— éæ˜¯ä¸¤ç§éœ€æ±‚ï¼š æŒç»­çš„ç›‘è§†å„ä¸ªç»„ä»¶çš„è¡¨ç°(performance)ï¼Œæ¯”å¦‚<br/>QPSã€latencyã€CPUã€memoryã€diskã€network ç­‰ç­‰ï¼Œå¾—çŸ¥ç³»ç»Ÿè¿è¡Œæ˜¯å¦é¡ºç•…ï¼Œèµ„æº<br/>åˆ©ç”¨æ˜¯å¦å……åˆ†ï¼›å¦ä¸€ä¸ªé‡è¦éœ€æ±‚æ˜¯åœ¨æ€§èƒ½è¶…å‡ºé¢„å®šèŒƒå›´æ—¶åŠæ—¶é€šçŸ¥ç®¡ç†å‘˜ï¼Œæ¯”å¦‚<br/>å†…å­˜ä¸è¶³ã€CPU å ç”¨å¤ªé«˜ã€ç£ç›˜å‰©ä½™ç©ºé—´ä¸å¤Ÿã€‚</p><p>    * è­¦æŠ¥(alerting): Nagios æˆ–è€… Icinga æ— ç–‘æ˜¯è¿™æ–¹é¢äº‹å®ä¸Šçš„ç‹è€…ã€‚<br/>    * æ€§èƒ½å›¾è¡¨(performance graph)ï¼š<br/>        * æœ‰äº† Nagios/Icinga åå¯ä»¥é‡ç”¨å®ƒä»¬æ”¶é›†çš„æ€§èƒ½æ•°æ®ï¼Œè‡ªè¡Œæ­é…Nagiosçš„å„ç§<br/>          Web UI ä»¥åŠ Cactiï¼Œæˆ–è€…ä½¿ç”¨ OpsViewã€isyVmon é‚£æ ·çš„é›†æˆåŒ…ï¼›<br/>        * æˆ–è€…å†å•ç‹¬ç”¨å…¶å®ƒç³»ç»Ÿæ”¶é›†æ€§èƒ½æ•°æ®å¹¶å±•ç°ï¼Œè¿™æ–¹é¢æ¨è Gangliaï¼Œå…¶å®<br/>          Ganglia æ”¶é›†çš„æ•°æ®ä¹Ÿå¯ä»¥é€ç»™ Nagios æ¥åˆ¤æ–­æ˜¯å¦å‘å‡ºè­¦æŠ¥ï¼Œè¿™æ ·å°±<br/>          ä¸ç”¨ Nagios æ”¶é›†æ•°æ®äº†ã€‚</p><p>å¯¹äºç³»ç»Ÿç®¡ç†å‘˜æ¥è¯´ï¼Œè­¦æŠ¥æ¯”èµ·æ€§èƒ½å›¾è¡¨æœ‰ç”¨çš„å¤šï¼Œè°æœ‰ç²¾åŠ›æ•´å¤©ç›¯ç€æ¼‚äº®çš„å›¾è¡¨çœ‹ï¼Ÿ<br/>è¿™ä¹Ÿå°±è§£é‡Šäº† Nagios åœ¨ <a href=\"https://link.zhihu.com/?target=http%3A//LinuxQuestions.org\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">LinuxQuestions.org</span><span class=\"invisible\"></span></a> Members Choice ä¸­å æ®äº†çº¦ 65% çš„<br/>ç¥¨æ•°ï¼š<br/><a href=\"https://link.zhihu.com/?target=http%3A//www.linuxquestions.org/questions/2011-linuxquestions-org-members-choice-awards-95/network-monitoring-application-of-the-year-919908/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">linuxquestions.org/ques</span><span class=\"invisible\">tions/2011-linuxquestions-org-members-choice-awards-95/network-monitoring-application-of-the-year-919908/</span><span class=\"ellipsis\"></span></a><br/><a href=\"https://link.zhihu.com/?target=http%3A//www.linuxquestions.org/questions/2011mca.php\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">linuxquestions.org/ques</span><span class=\"invisible\">tions/2011mca.php</span><span class=\"ellipsis\"></span></a></p><p>æƒ³å°è¯•å•†ä¸šæ”¯æŒåŠ›åº¦å¤§çš„é Nagios è¡ç”Ÿçš„å¼€æºäº§å“ï¼Œå¯ä»¥è¯•è¯• Pandora FMSã€Zabbixã€<br/>NetXMSã€Zenossï¼Œæ³¨æ„å®ƒä»¬å„è‡ªçš„æ”¶è´¹ç‰ˆæœ¬ç›¸æ¯”å…¶å¼€æºç‰ˆæœ¬ï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p><a href=\"https://link.zhihu.com/?target=http%3A//en.wikipedia.org/wiki/Comparison_of_network_monitoring_systems\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">en.wikipedia.org/wiki/C</span><span class=\"invisible\">omparison_of_network_monitoring_systems</span><span class=\"ellipsis\"></span></a></p><p>ç›‘æ§ç³»ç»Ÿå¿…ä¸å¯å°‘çš„ä¸‰ä¸ªéƒ¨åˆ†ï¼š<br/>    * æ•°æ®é‡‡é›†ï¼šå¦‚ SNMP æ–¹å¼ï¼ŒTCP/IP ä¸»åŠ¨æ¢æµ‹æœåŠ¡æ–¹å¼ï¼Œé‡‡é›†ç³»ç»Ÿå†…å­˜ã€è´Ÿè½½ä¿¡æ¯ï¼›<br/>    * æ•°æ®å­˜å‚¨ï¼šä½¿ç”¨ rrdtool ä¿å­˜åˆ° rrd æ•°æ®æ–‡ä»¶é‡Œï¼Œæˆ–è€…ä¿å­˜åˆ°å…³ç³»æ•°æ®åº“é‡Œï¼›<br/>    * æ•°æ®å±•ç°ï¼šå¸¸ç”¨ rrdtool ç»˜åˆ¶æ—¶é—´åºåˆ—å›¾ã€‚</p><p>æ•°æ®é‡‡é›†éƒ¨åˆ†å¦‚æœèƒ½æ”¯æŒè‡ªåŠ¨æœåŠ¡å‘ç°ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œä¸ç”¨ä¸€é¡¹é¡¹åŸºç¡€æœåŠ¡éƒ½æ‰‹åŠ¨é…ç½®ä¸€éï¼›<br/>æ•°æ®é‡‡é›†å®Œåé€ç»™æ•°æ®å­˜å‚¨æ—¶ï¼Œå¯ä»¥æ ¹æ®é¢„å®šä¹‰çš„æ¡ä»¶è§¦å‘è­¦æŠ¥ï¼›<br/>åœ¨æ•°æ®å±•ç°å±‚é¢å¯ä»¥åšä¸€äº›æ•°æ®åˆ†æï¼Œå¦‚æœåŠ¡çŠ¶æ€çš„é¢„æµ‹ã€‚</p><p>* Nagios Core</p><p>æ ‡é…ä¸æ”¯æŒæœåŠ¡è‡ªåŠ¨å‘ç°ï¼Œé…ç½®ç¹çã€‚é•¿äºæ•°æ®æ”¶é›†å’Œé¢„è­¦ï¼Œé¢„è­¦çš„é€»è¾‘è€ƒè™‘å‘¨å…¨ã€‚<br/>æ ‡é…çš„æ•°æ®å±•ç°éå¸¸å¼±ã€‚</p><p>  Remote check:<br/>    * check_by_ssh<br/>    * NRPE<br/>    * nsclient<br/>    * check_snmp<br/>    * nrdp: replacement of nsca<br/>    * nsca<br/>    * check-mk<br/>    * nagios-statd-server</p><p>  Web UI:<br/>    * Nagios CGI<br/>    * Centreon<br/>    * Ninja<br/>    * Nagvis<br/>    * Thruk<br/>    * Check-MK Multisite</p><p>* Icinga</p><p>Nagios çš„æ´¾ç”Ÿç‰ˆæœ¬ï¼Œæ”¹è¿›äº† Web UIï¼Œä½¿ç”¨äº†ä¸€äº› HTML 5 ç‰¹æ€§ã€‚<br/><a href=\"https://link.zhihu.com/?target=https%3A//www.icinga.org/nagios/feature-comparison/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">https://www.icinga.org/nagios/feature-comparison/ </a>å¹¶æ²¡æœ‰å¾ˆé‡å¤§çš„æ”¹è¿›ã€‚</p><p><a href=\"https://link.zhihu.com/?target=http%3A//robertogaloppini.net/2010/11/25/sos-open-source-reports-open-source-monitoring-icinga-vs-nagios/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">robertogaloppini.net/20</span><span class=\"invisible\">10/11/25/sos-open-source-reports-open-source-monitoring-icinga-vs-nagios/</span><span class=\"ellipsis\"></span></a><br/>The &#34;community&#34; behind Icinga is the company Netways. Their business model was<br/>to hijack the Nagios brand until Ethan Galstad told them to stop selling<br/>Nagios as if it were their own.</p><p>æ¯”è¾ƒæ€€ç–‘æ˜¯ä¸€éƒ¨åˆ†å¼€å‘è€…è¢«è¸¢å‡ºå±€æ²¡åˆ†åˆ°å¥½å¤„ã€‚è¿™ä¸ª netways å…¬å¸å¾ˆå¥‡æ€ªï¼Œå…¶<br/>ä¸»é¡µä¸Šçš„äº§å“åˆ—è¡¨æŠŠ Nagios/JasperReport/Puppet/MuleESB/RT/Bacula/TWiki<br/>å…¨åˆ—ä¸Šå»(<a href=\"https://link.zhihu.com/?target=http%3A//www.netways.de/en/de/produkte/products/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">netways.de/en/de/produk</span><span class=\"invisible\">te/products/</span><span class=\"ellipsis\"></span></a>)ï¼Œäº§å“å›¾æ ‡<br/>æ¢äº†ï¼Œåˆæ²¡æœ‰æ˜æ˜¾é“¾æ¥åˆ°å„è‡ªå®˜æ–¹ç½‘ç«™ï¼Œç¡®å®é¢‡æœ‰æ¬ºä¸–ç›—åä¹‹å«Œã€‚</p><p>* Shinken</p><p><a href=\"https://link.zhihu.com/?target=http%3A//www.shinken-monitoring.org/what-is-in-shinken-not-in-nagios-and-vice-versa/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">shinken-monitoring.org/</span><span class=\"invisible\">what-is-in-shinken-not-in-nagios-and-vice-versa/</span><span class=\"ellipsis\"></span></a></p><p>Python ç¼–å†™ï¼ŒåŸºæœ¬æ˜¯é‡æ–°å®ç° Nagiosï¼Œå…¼å®¹ Nagios çš„æ’ä»¶ï¼Œç‹¬ç«‹æ‰§è¡Œçš„ç»„ä»¶ä¹‹é—´åˆ†å·¥å¾ˆæ˜ç¡®ã€‚<br/>å–œæ¬¢ Python çš„å…„å¼Ÿä¸å¦¨è¯•è¯•ã€‚</p><p>* OpsView</p><p>æ‰“åŒ… Nagios + NagVis + NagiosGraph + MRTG + NMIS.</p><p>* isyVmon (<a href=\"https://link.zhihu.com/?target=http%3A//www.isyvmon.com/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">isyvmon.com/</span><span class=\"invisible\"></span></a>)</p><p>æ‰“åŒ… Nagios + Centreon.</p><p>* Munin</p><p>æ•°æ®æ”¶é›†ã€å­˜å‚¨å’Œå±•ç°ï¼Œåä¸¤è€…éƒ½ä¾èµ– rrdtoolã€‚Perl ç¼–å†™ï¼Œæ•°æ®é‡‡é›†æ’ä»¶ä¸°å¯Œï¼Œ<br/>å°¤å…¶æ’ä»¶è‡ªåŠ¨æ¿€æ´»å¾ˆå¥½ç”¨ï¼Œè¾¾åˆ°æœåŠ¡è‡ªåŠ¨å‘ç°çš„æ•ˆæœï¼Œå¾ˆçœäº‹ã€‚å¯èƒ½æ˜¯å› ä¸º Perl<br/>ç¼–å†™çš„ç¼˜æ•…ï¼Œä»¥åŠ munin æ²¡æœ‰ä¸€ä¸ªä¸º web ui æä¾›æ•°æ®çš„æŒç»­è¿è¡Œçš„ serverï¼Œ<br/>æ¯æ¬¡å±•ç°éƒ½è¦é‡æ–°ç”Ÿæˆå›¾è¡¨ä»¥åŠè¯»å– rrd æ–‡ä»¶ï¼Œå¯¼è‡´ munin CPU æ¶ˆè€—è¾ƒå¤§ï¼Œæˆ‘<br/>è¯•ç”¨çš„ç»“æœæ˜¯é¢‘ç¹æœ‰ç™¾åˆ†ä¹‹åäº”åˆ°äºŒåçš„ CPU å ç”¨ç‡ã€‚</p><p>munin ä» monitor agent æ”¶é›†ä¿¡æ¯å­˜å…¥ rrd æ–‡ä»¶ä»¥åŠç”Ÿæˆ html é¡µé¢ä¾›<br/>web ç•Œé¢ä½¿ç”¨ï¼Œè¿™æœ‰ä¸¤ç§æ–¹å¼å®ç°ï¼Œé»˜è®¤æ˜¯ç”¨æ¯äº”åˆ†é’Ÿæ‰§è¡Œçš„ cron ä»»åŠ¡ï¼Œ<br/>è¿™ä¸ªä»»åŠ¡ä»¥ munin ç”¨æˆ·èº«ä»½æ‰§è¡Œï¼Œå†™å…¥ /var/cache/munin å’Œ /var/lib/munin<br/>ä¸‹ï¼Œå¦ä¸€ç§æ–¹å¼æ˜¯è®© munin cgi ç¨‹åºè¢«è°ƒç”¨æ—¶å®æ—¶ç”Ÿæˆï¼Œè¿™ç§æ–¹å¼è€—è´¹èµ„æºæ›´å¤šï¼Œ<br/>ä½†å®æ—¶æ€§å¼ºã€‚æ³¨æ„ç¬¬äºŒç§æ–¹å¼æ˜¯ä»¥ apache ç”¨æˆ·èº«ä»½æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯ www-data<br/>ç”¨æˆ·ï¼Œåˆ‡æ¢æ‰§è¡Œæ–¹å¼æ—¶éœ€è¦æ³¨æ„ä¸Šé¢æåˆ°çš„ä¸¤ä¸ªç›®å½•é‡Œæ–‡ä»¶æƒé™ï¼Œæƒé™ä¸å¯¹<br/>ä¼šå¯¼è‡´ munin æ— æ³•æ›´æ–° rrd æ–‡ä»¶ï¼Œå„ç§æ€§èƒ½å›¾ä¸ä¼šæ›´æ–°ã€‚</p><p>Munin çš„æœ€å¤§äº®ç‚¹æ˜¯å…¶ä¸°å¯Œè€Œä¸”è‡ªåŠ¨é…ç½®çš„æ’ä»¶ï¼Œmunin ä¹Ÿæ”¯æŒåŸºæœ¬çš„æŠ¥è­¦ï¼Œä½†<br/>å¤ªå«©ï¼Œæ¨èé€šè¿‡ Nagios æŠ¥è­¦:<br/><a href=\"https://link.zhihu.com/?target=http%3A//munin-monitoring.org/wiki/HowToContact\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">munin-monitoring.org/wi</span><span class=\"invisible\">ki/HowToContact</span><span class=\"ellipsis\"></span></a><br/><a href=\"https://link.zhihu.com/?target=http%3A//waste.mandragor.org/munin_tutorial/munin.html%23alerting\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">waste.mandragor.org/mun</span><span class=\"invisible\">in_tutorial/munin.html#alerting</span><span class=\"ellipsis\"></span></a></p><p>* Ganglia</p><p>æ”¶é›†ä¿¡æ¯å¹¶ä½¿ç”¨ rrdtools å­˜å‚¨ã€ç”»å›¾ï¼Œæ¼‚äº®ï¼Œé«˜æ•ˆï¼Œæ‰©å±•å¤§å¤šç”¨ C ç¼–å†™ï¼Œ<br/>ä»¥åŠ¨æ€åº“å½¢å¼è½½å…¥ Ganglia monitor æœåŠ¡è¿›ç¨‹ï¼Œè™½ç„¶é«˜æ•ˆï¼Œä½†æ„Ÿè§‰è€¦åˆå¤ªå¤§ï¼Œ<br/>å´©æºƒçš„é£é™©æ¯”è¾ƒå¤§ã€‚</p><p>ä¸çŸ¥é“æ˜¯ä¸æ˜¯é”™è§‰ï¼Œè™½ç„¶ä¹Ÿæ˜¯ç”¨ rrdtools ç”»å›¾ï¼Œæˆ‘è§‰å¾— Ganglia ç”»å‡ºæ¥<br/>çš„å›¾è¡¨å°±æ˜¯è¦æ¼‚äº®çš„å¤šï¼Œè²Œä¼¼è·Ÿç”¨è‰²ã€çº¿æ¡æœ‰å…³ç³»ã€‚</p><p>Ganglia é»˜è®¤ä½¿ç”¨ UDP å¤šæ’­é€šä¿¡ï¼Œå¯èƒ½éœ€è¦è·¯ç”±ä»¥åŠé˜²ç«å¢™çš„é¢å¤–é…ç½®ï¼Œå¦‚æœæ²¡<br/>è¿™ä¸ªæ¡ä»¶çš„è¯å¯ä»¥ç”¨ UDP å•æ’­ã€‚</p><p>* Collectd</p><p>æ”¶é›† cpu/ram/disk/network/irq/processes ä¿¡æ¯å†™å…¥ rrd æ–‡ä»¶ï¼Œæ²¡æœ‰ç›´æ¥æ”¯æŒ<br/>ç”»å›¾åŠŸèƒ½ï¼ŒæŠ¥è­¦ç‰¹æ€§è¿˜å¤„äºåˆçº§é˜¶æ®µã€‚</p><p>* Cacti</p><p>ä¸“æ³¨äºæ•°æ®å±•ç°ï¼ŒåŸºæœ¬æ˜¯ RRDTool çš„ Web å‰ç«¯ï¼Œç”¨äºå±•ç¤ºå„ç§æ€§èƒ½å›¾è¡¨ï¼Œä¾èµ– MySQL æ•°æ®åº“ã€‚</p><p>* Zabbix</p><p>ä¾èµ– SQL æ•°æ®åº“ï¼Œ æœåŠ¡è¿›ç¨‹ä¼šæ´¾ç”Ÿå¾ˆå¤šå­è¿›ç¨‹ï¼Œç½‘é¡µå“åº”å¾ˆæ…¢ï¼Œæ¯”è¾ƒé‡é‡çº§ã€‚<br/>æ”¯æŒæ€§èƒ½ç›‘æ§å’ŒæŠ¥è­¦ï¼Œæ–‡æ¡£å’ŒåŠŸèƒ½éƒ½æ¯”è¾ƒä¸°å¯Œï¼Œæœ‰ä¼ä¸šçº§æ´¾å¤´ã€‚zabbix proxy çš„<br/>è®¾è®¡å¾ˆé€‚åˆä¼ä¸šç›‘ç®¡åœ°ç†éš”ç¦»çš„å¤šä¸ªæœºæˆ¿ã€‚</p><p>zabbix çš„ web ç•Œé¢æ”¯æŒ HTTP è®¤è¯ï¼Œä½†æ˜¯æ˜¯ç”¨ PHP çš„å†…ç½® http è®¤è¯ç‰¹æ€§åšçš„ï¼Œä¸æ”¯æŒ<br/>web æœåŠ¡å™¨çš„ http è®¤è¯ï¼Œç³™å¿«çŒ›çš„ä¿®æ”¹å¾ˆå®¹æ˜“ï¼Œgrep -nr ZBX_AUTH_HTTP /usr/share/zabbixï¼Œ<br/>ç»™ HTTP è®¤è¯åŠ ä¸Šå¯¹ REMOTE_USER çš„åˆ¤æ–­å°±å·®ä¸å¤šäº†ã€‚</p><p>Debian å¯¹ Zabbix çš„æ‰“åŒ…æœ‰ä¸¤ä¸ªå‘äººçš„åœ°æ–¹ï¼Œzabbix_agentd.conf é‡Œ Server<br/>é€‰é¡¹å®˜æ–¹è®¾ç½®çš„æ˜¯ 127.0.0.1ï¼ŒDebian æ”¹æˆ localhost äº†ï¼Œå¯èƒ½æ˜¯æ–°ç‰ˆ<br/>zabbix ä¸å†è§£æä¸»æœºåæˆ–è€…åŸŸåäº†ï¼Œå¯¼è‡´ zabbix-agent é˜»æ­¢äº†æ¥è‡ª 127.0.0.1<br/>çš„è¿æ¥è¯·æ±‚ï¼Œzabbix web ç•Œé¢çš„ Graphs éƒ¨åˆ†æ˜¾ç¤ºä¸äº†å›¾å½¢ï¼Œè¿™ä¸ªé—®é¢˜åœ¨<br/>zabbix_agentd.log é‡Œæ˜¾ç¤ºï¼š<br/>Listener error: Connection from [127.0.0.1] rejected. Allowed server is [localhost]</p><p>å¦ä¸€ä¸ªé—®é¢˜æ˜¯å®˜æ–¹çš„ zabbix_agentd.conf é‡Œ Hostname æ˜¯ &#34;Zabbix server&#34;,<br/>è¿™ä¸ªæ˜¯è·Ÿ zabbix web UI é‡Œçš„ hosts è®¾ç½®å¯¹åº”çš„ï¼Œzabbix-agent é è¿™ä¸ªåå­—<br/>æ‰¾å®ƒçš„é…ç½®ï¼Œä½† Debian æ‰“åŒ…çš„è¿™ä¸ªæ–‡ä»¶é‡Œæ­¤è®¾ç½®æ˜¯ç©ºçš„ï¼Œé»˜è®¤æ˜¯ä¸»æœºåï¼Œè·Ÿ<br/>zabbix Web UI é‡Œçš„ &#34;Zabbix server&#34; ä¸åŒ¹é…ï¼Œå¯¼è‡´ Zabbix Web UI é‡Œ<br/>æŠ¥é”™è¯´ Zabbix server unreachableï¼Œåœ¨ Zabbix agent æ—¥å¿—é‡Œæ˜¾ç¤ºï¼š<br/>No active checks on server: host [gold] not found</p><p>è™½ç„¶ Zabbix çš„ Web UI åšçš„æŒºå¥½ï¼Œä½†æ˜¯æˆ‘æœ‰ç‚¹æ’æ–¥è¿™ç§æŠŠé…ç½®ä¿¡æ¯è®°å½•åˆ°<br/>æ•°æ®åº“é‡Œçš„åšæ³•ï¼Œä¸ä¾¿äºç‰ˆæœ¬è·Ÿè¸ªï¼ˆçœŸæ˜¯éš¾ä¼ºå€™å•Šï¼Œæ²¡æœ‰ Web UI æŠ±æ€¨ä¸å‹å¥½ï¼Œ<br/>æœ‰ Web UI åˆæŠ±æ€¨æ²¡æœ‰æ§åˆ¶æ„Ÿï¼‰ã€‚</p><p>* Zenoss</p><p>ä½¿ç”¨ Python ç¼–å†™ï¼Œä¾èµ– MySQL æ•°æ®åº“ï¼Œå®˜æ–¹æœ‰æä¾›ç»™ Debian ç”¨çš„ Zenoss Core<br/>deb åŒ…ã€‚Web UI å¾ˆå¼ºå¤§ï¼Œæ”¯æŒéƒ¨åˆ† Nagios æ’ä»¶ï¼Œå·ç§°ä¸éœ€è¦ agentï¼ˆçŒœæµ‹æ˜¯ç”¨<br/>ssh è¿œç¨‹è¿è¡Œæ¢æµ‹è„šæœ¬)ã€‚</p><p>* Pandora FMS</p><p>è¢«å…¶ Web UI æŠ“å›¾éœ‡ä½äº†ï¼Œå¾ˆæ¼‚äº®ï¼Œå¾ˆå¼ºå¤§çš„æ ·å­ã€‚</p><p>Pandora agent å’Œ server é‡‡ç”¨ Perl ç¼–å†™ï¼Œä½¿ç”¨ MySQL å­˜å‚¨æ•°æ®ï¼ŒWeb UI<br/>ä½¿ç”¨ PHPã€‚</p><p>* OpenNMS</p><p>ä½¿ç”¨ Java ç¼–å†™ï¼Œæˆ‘è§‰å¾—ç›‘æ§çš„ä¸œè¥¿åº”è¯¥è€—èµ„æºè¶Šå°‘è¶Šå¥½ï¼Œæ‰€ä»¥ä¸€çœ‹æ˜¯ Java<br/>çš„æˆ‘å°±æ²¡å…´è¶£äº†ï¼Œä¼Šè¿˜ä¾èµ–å…³ç³»æ•°æ®åº“(PostgreSQL)ï¼ŒWeb æœåŠ¡å™¨(Tomcat or Jetty)ã€‚</p><p>ä¼Šè¿˜æ˜¯é¢‡å äº†ä¸€å°å—å¸‚åœºä»½é¢ï¼ŒçŒœæµ‹æ˜¯å› ä¸ºå¼ºå¤§çš„ Web ç•Œé¢ä»¥åŠé€šè¿‡ NRPEã€NSClient<br/>ä½¿ç”¨ Nagios çš„æ’ä»¶ã€‚</p><p>* NetXMS</p><p>å®˜ç½‘ <a href=\"https://link.zhihu.com/?target=http%3A//www.netxms.org/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">netxms.org/</span><span class=\"invisible\"></span></a> æœ‰é€‚ç”¨äº Debian çš„ deb åŒ…ï¼Œæ§åˆ¶å°åŸæ¥æ˜¯ä¸ª<br/>Win32 GUI åšçš„ï¼Œç°åœ¨åŸºäº Eclipse äº†ï¼Œçœ‹æŠ“å›¾å¾ˆå¼ºå¤§çš„æ ·å­ã€‚</p><p>NetXMS è·Ÿå¾ˆå¤šç›‘æ§ç³»ç»Ÿä¸€æ ·ï¼Œåˆ† agent/server/console ä¸‰å¤§å—ï¼Œagent å¾ˆå°ï¼Œ<br/>è¿è¡Œåœ¨è¢«ç›‘æ§æœºä¸Šï¼›server å­˜å‚¨ç›‘æ§æ•°æ®ï¼ŒNetXMS server ä¾èµ–å…³ç³»æ•°æ®åº“ï¼›<br/>console ç”¨æ¥æŸ¥çœ‹ç›‘æ§æ•°æ®ã€‚</p><p>NetXMS å¯ä»¥æ”¶é›†æ•°æ®ã€å±•ç°å¹¶æŠ¥è­¦ï¼Œæœ‰æ„æ€çš„æ˜¯å®ƒå¯ä»¥ä½¿ç”¨å¤§éƒ¨åˆ† nagios<br/>æ’ä»¶ï¼Œå¹¶ä¸”æ‹¥æœ‰è‡ªå·±çš„è„šæœ¬è¯­è¨€ã€‚</p><p>æˆ‘æ²¡æœ‰è¯•ç”¨è¿™ä¸œè¥¿ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è¯•è¯•ï¼Œå®˜æ–¹æ–‡æ¡£åšçš„ä¸é”™ã€‚</p><p>* MRTG</p><p>ä½¿ç”¨ SNMP æ”¶é›†ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨ rrdtools ç”»å›¾ã€‚</p><p>* cricket (<a href=\"https://link.zhihu.com/?target=http%3A//cricket.sourceforge.net/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">http://cricket.sourceforge.net</a>)</p><p>æ”¶é›†ä¿¡æ¯å¹¶ä½¿ç”¨ rrdtools å­˜å‚¨ã€ç”»å›¾ï¼Œçœ‹é¡¹ç›®çŠ¶æ€è¿˜å¾ˆå«©çš„æ ·å­ã€‚</p><p>* xymon</p><p>UI å¤ª geeky äº†ï¼Œsourceforge é¡¹ç›®ä¸»é¡µä¸Šæœ‰ä¸å°‘å¥½è¯„ï¼Œè²Œä¼¼å¾ˆå®¹æ˜“å®‰è£…ã€‚ç²—ç•¥çœ‹<br/>èµ· Web UI çš„è¾“å‡ºï¼Œçœ‹èµ·æ¥æ£€æµ‹éƒ½æ˜¯ç”¨ shell è„šæœ¬åˆ†æçš„ï¼Œæ¯”å¦‚åˆ†æ dfã€<br/>netstat è¾“å‡ºï¼Œè¿ web çš„ CGI è„šæœ¬éƒ½æ˜¯ç”¨ shell å†™çš„ã€‚</p><p>* ntop</p><p>ç½‘ç»œæ€§èƒ½ç›‘æ§ï¼Œä¾èµ–ç½‘å¡æ··æ‚æ¨¡å¼å—…æ¢æ•°æ®åŒ…ï¼Œèƒ½æ£€æµ‹åˆ°å±€åŸŸç½‘ä¸­æ¯å°æœºå™¨çš„æµé‡ã€‚</p><p>* argus (argus-client, argus-server)</p><p>ç½‘ç»œæ€§èƒ½ç›‘æ§ã€‚</p>", 
            "topic": [
                {
                    "tag": "ç›‘æ§", 
                    "tagLink": "https://api.zhihu.com/topics/19563297"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50795191", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "Drupal æµ…è¯•", 
            "content": "<p>ã€è¿ç§»ã€‘Drupal æµ…è¯•</p><p>ç†è®ºä¸Šæœ‰ Wiki äº†ï¼Œæ˜¯æ²¡å¤ªå¤§å¿…è¦æ•´èŠ±å“¨çš„ CMS çš„ï¼Œä¸è¿‡ï¼Œè‚¯å®šæœ‰ç”¨æˆ·ä¸æ„¿æ„çšˆä¾ Wikiï¼Œå“ªæ€•æœ‰æ‰€è§å³æ‰€å¾—ç¼–è¾‘ç‰¹æ€§ã€‚ä»¥å‰ä¹Ÿæ­è¿‡   Drupalï¼Œç•Œé¢æ˜¯ç›¸å½“æ¸…çˆ½ï¼Œä¸å°‘åŒäº‹è¡¨ç¤ºå¾ˆå–œæ¬¢ï¼ŒBlogã€Bookã€Forumã€Pollï¼Œç•Œé¢ä¸€è‡´æ˜“ç”¨ï¼Œä¹Ÿå¾ˆå®ç”¨ã€‚Debian æ‰“åŒ…çš„  Drupal æœ€æ–°ç‰ˆæ˜¯ 7.12ï¼Œå°±å•å•ä¸€ä¸ªåŒ…ï¼Œå®‰è£…å¾ˆå®¹æ˜“ï¼Œdeb åŒ…å®‰è£…æ—¶ä¼šè‡ªåŠ¨é…ç½®å¥½æ•°æ®åº“ã€‚ä¸€ä¸ªå°é—®é¢˜æ˜¯ PHP  ç‰ˆæœ¬å¤ªé«˜ï¼Œå¯¹è¯­æ³•è¦æ±‚æ›´ä¸¥æ ¼äº†ï¼Œå¯¼è‡´åœ¨ Drupal çš„ç•Œé¢ä¸Šç»å¸¸æ˜¾ç¤ºé•¿é•¿çš„è­¦å‘Šä¿¡æ¯ï¼ŒDrupal  å®˜æ–¹çš„é—®é¢˜åˆ—è¡¨æœ‰äººæå‡ºè¡¥ä¸äº†ï¼Œè²Œä¼¼ä¹Ÿè¿›äº†ç‰ˆæœ¬åº“ï¼Œåªæ˜¯æ²¡å‘å¸ƒæ–°ç‰ˆæœ¬ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>æ¥ä¸‹æ¥å°±æ˜¯ä¸å˜çš„ä¸»é¢˜äº†ï¼šå¦‚ä½•æ”¯æŒ web server çš„è®¤è¯æœºåˆ¶ï¼Œä¹Ÿå³è®© Drupal 7 ä½¿ç”¨ REMOTE_USER ä¿¡æ¯è¯†åˆ«å½“å‰ç”¨æˆ·ã€‚Drupal 7  æ²¡æœ‰å†…ç½®æ”¯æŒï¼Œæœ‰ä¸€ä¸ª Drupal 6.x çš„æ’ä»¶ <a href=\"https://link.zhihu.com/?target=http%3A//drupal.org/project/webserver_auth\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">drupal.org/project/webs</span><span class=\"invisible\">erver_auth</span><span class=\"ellipsis\"></span></a>  æ”¯æŒè¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘æ‹¿è¿‡æ¥å€ŸåŠ© Drupal çš„ Coder æ¨¡å—è‡ªåŠ¨å‡çº§åŠŸèƒ½ä»¥åŠæ…¢æ…¢æ‘¸ç´¢ï¼ŒæˆåŠŸç§»æ¤åˆ° Drupal 7.x ä¸Šäº†ï¼ŒDrupal  å®˜æ–¹çš„æ–‡æ¡£åšçš„è¿˜æ˜¯æŒºä¸é”™çš„ã€‚ç§»æ¤è¿‡ç¨‹ä¸­å¢åŠ äº†ä¸€ç‚¹å°ç‰¹æ€§ï¼Œæˆ–è€…è¯´æ”¹æ­£äº†ä¸€ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯åœ¨ç”¨ webserver_auth  æ³¨å†Œç”¨æˆ·å‰ï¼Œå…ˆåˆ¤æ–­ä¸‹æœ‰æ²¡æœ‰å…¶å®ƒæœºåˆ¶åˆ›å»ºäº†åŒåç”¨æˆ·ï¼Œæœ‰çš„è¯å°±ç›´æ¥ç™»å½•ï¼Œä¸æ³¨å†Œäº†ï¼Œå¦åˆ™ Drupal ä¼šæŠ¥é”™è¯´æ’å…¥æ•°æ®åº“æ—¶è¿åäº†å”¯ä¸€æ€§ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ç§»æ¤è¿™ä¸ªæ¨¡å—è¿‡ç¨‹ä¸­ï¼Œåˆå‘ç° PHP çš„ä¸€ä¸ªå¾ˆé¾Šçš„åœ°æ–¹ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">&lt;?php\n\nerror_reporting(E_ALL | E_STRICT);\n#echo array_pop(array(2, 3));\n$tmp = array(2, 3);\necho array_pop($tmp);\n</code></pre></div><p>æ³¨é‡Šæ‰çš„é‚£è¡Œæ˜¯ä¸è¡Œçš„å†™æ³•ï¼Œphp  ä¼šæŠ±æ€¨ï¼š Only variables can be passed by  referenceï¼Œæˆ‘æ²¡ä»”ç»†çœ‹ç½‘ä¸Šå…³äºè¿™ä¸ªé—®é¢˜çš„è§£é‡Šï¼Œè²Œä¼¼æ˜¯å› ä¸ºè§£é‡Šå™¨å®ç°çš„é™åˆ¶ï¼Œä¼šå¯¼è‡´å†…å­˜æ³„æ¼è¿˜æ˜¯ç ´åæ¥ç€ã€‚å”‰ï¼Œæ€ä¹ˆæœ‰è¿™ä¹ˆçŸ¬çš„è¯­è¨€å¤§å®¶ç”¨çš„è¿˜æŒº  highã€‚ã€‚ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>æŠ˜è…¾å®Œæ¯•åæµ‹è¯•äº†ä¸‹ï¼Œç”¨ Kerberos è®¤è¯åï¼ŒDrupal ç¡®å®ç»™åˆ›å»ºäº†ä¸ªæ–°ç”¨æˆ·ï¼Œä½†æ˜¯è¿™ä¸ªæ–°ç”¨æˆ·ä¸èƒ½åœ¨  Drupal ä¸Šæ–°å¢ä»»ä½•å†…å®¹ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯é‚£ä¸ª webserver_auth  æ¨¡å—ç§»æ¤çš„æœ‰é—®é¢˜å‘¢ï¼Œåæ¥çŒœæµ‹æ˜¯é»˜è®¤æƒé™è®¾ç½®æœ‰é—®é¢˜ï¼Œäºæ˜¯æ‰¾åœ¨å“ªé‡Œè®¾ç½®æƒé™ï¼Œ Peopleã€Configuration é¡µé¢éƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œæœ€åå‘ç°åœ¨  Modules é¡µé¢é‡Œï¼ŒçœŸæ˜¯è›‹ç–¼ï¼Œå¯¹ Drupal UI å‹å¥½çš„æ„Ÿè§‰ä¸‹é™äº†ä¸€å°æˆªã€‚Drupal é‡Œç”¨ Role åˆ†é…æƒé™ï¼Œå…¶å® Role å°±æ˜¯  groupï¼Œè²Œä¼¼æ˜¯ä¸æ”¯æŒç›´æ¥é’ˆå¯¹ user è®¾ç½®æƒé™ï¼Œéå¾—æ”¾åˆ°æŸä¸ª Role é‡Œï¼Œè¿™ç‚¹ä¸å¤§æ–¹ä¾¿ï¼Œè²Œä¼¼ä¹Ÿä¸èƒ½ç›´æ¥å¯¹æŸä¸€ç¯‡æ–‡ç« è®¾ç½®æƒé™ï¼Œè¿™åœ¨  wiki é‡Œæ˜¯å¾ˆæ–¹ä¾¿çš„äº‹æƒ…ã€‚</p>", 
            "topic": [
                {
                    "tag": "Drupal 7", 
                    "tagLink": "https://api.zhihu.com/topics/19629064"
                }, 
                {
                    "tag": "Drupal", 
                    "tagLink": "https://api.zhihu.com/topics/19597200"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50795110", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "ViewVC çš„é…ç½®", 
            "content": "<p>ã€è¿ç§»ã€‘ViewVC çš„é…ç½®</p><p>ä¹‹å‰ç»™ svnserve åˆ†é…äº† http://svn.corp.example.com çš„åŸŸåï¼Œç”¨äº svn:// åè®®ï¼Œç©ºå‡º  http://svn.corp.example.com æ²¡ç”¨æ€»è§‰çš„ç©ºäº†ä¸€å—ã€‚æœ¬æ¥æ˜¯ä¸æƒ³é¼“æ£ svn ä¸€ä¼—çš„ï¼Œè€ƒè™‘åˆ°ä¸æ˜¯æ‰€æœ‰äººéƒ½ç”˜å¿ƒçšˆä¾  GITï¼Œå°±é…ç½®äº† svnserveï¼Œæ‰€ä»¥ç´¢æ€§å°±å†ç»™ http://svn.corp.example.com/ é…ä¸Š ViewVC å¾—äº†ã€‚</p><p>ViewVC æ˜¯ç”¨ Python å†™çš„ï¼Œå…¶ä½œè€…ä¸æ»¡ Perl å†™æˆçš„ CVSWeb (è§ <a href=\"https://link.zhihu.com/?target=http%3A//viewvc.org/who.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">viewvc.org/who.html</span><span class=\"invisible\"></span></a>)ã€‚æˆ‘å¤§è‡´äº†è§£ä¸‹  ViewVC çš„å‘å±•å†å²ï¼Œä¼Šå…¶å®ä¹Ÿå‰åæ”¹åŠ¨è›®å¤§çš„ï¼Œåˆ°ç°åœ¨ææ€•ä¹Ÿè°ˆä¸ä¸Šä»£ç ç»“æ„å®Œç¾ï¼Œè¿™å…¶ä¸­ä¸€æ–¹é¢æ˜¯ VCS  å·¥å…·ç‰¹æ€§å„å¼‚ï¼Œæƒ³æŠ½è±¡å‡ºç»Ÿä¸€çš„æŠ½è±¡å±‚æ¯”è¾ƒéš¾ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿæ˜¯æ—¶é—´é•¿äº†ï¼Œæºå’Œçš„äººå¤šäº†ï¼Œéœ€æ±‚å¤šäº†ï¼Œç‰¹æ€§å¤šäº†ï¼Œå¿…ç„¶æ˜¯ä»£ç è¶‹äºæ··ä¹±ï¼Œé¢ æ‰‘ä¸ç ´çš„ç†µå¢åŸç†ã€‚æ”¹æˆâ€œä¼˜ç¾â€çš„è¯­è¨€å†™ä¸œè¥¿ï¼ŒçœŸä¸è§å¾—ä»£ç å°±ä¼˜ç¾å°±æ˜“ç»´æŠ¤ã€‚BTWï¼Œæœ¬äºº  Perl fanã€‚ã€‚ã€‚</p><p>ViewVC æœ‰ä¸ªæå¥½çš„ç‰¹æ€§ï¼Œæ”¯æŒ svn çš„ authz  æ–‡ä»¶ï¼Œè¿™æ ·ä¸€ä»½åŸºäºè·¯å¾„çš„æˆæƒæ–‡ä»¶ï¼Œå¯ä»¥åŒæ—¶ç”¨äº svnserve æœåŠ¡ä»¥åŠ ViewVCï¼Œç›¸å½“èµï¼ ä½†è¿™é‡Œæœ‰ä¸ªå°é—®é¢˜ï¼Œsvnserve +  gssapi sasl è®¤è¯å¾—åˆ°çš„ç”¨æˆ·åæ˜¯ä¸å¸¦ @REALM åç¼€çš„ï¼Œè¿™æ˜¯æˆ‘æœŸæœ›çš„è¡Œä¸ºï¼Œå› ä¸ºæˆ‘ä¸æƒ³åœ¨ authz æ–‡ä»¶é‡Œç½—å—¦çš„å†™  userA@CORP.EXAMPLE.COMã€userB@CORP.EXAMPLE.COMï¼Œä½†æ˜¯ apache2 + mod_auth_kerb  å¾—åˆ°çš„ REMOTE_USER æ˜¯ user@REALM çš„å½¢å¼ï¼Œå¯¼è‡´ authz é‡Œçš„è®¾ç½® ViewVC ç”¨ä¸äº†ã€‚</p><p>è§£å†³è¿™ä¸ªé—®é¢˜çš„ç¬¬ä¸€æ€è·¯è‡ªç„¶æ˜¯ä¿®æ”¹  ViewVC çš„ä»£ç ï¼Œè®©å®ƒåˆ¤æ–­ authz æ—¶æŠŠ @REALM  å»æ‰ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°ä¿®æ”¹çš„åœ°æ–¹ï¼Œæ”¹åŠ¨ä¹Ÿå°±ä¸¤ä¸‰è¡Œä»£ç ï¼Œæ”¹å®Œæ”¶å·¥ï¼Œè¯•ç”¨äº†ä¸‹æœç„¶æœ‰æ•ˆï¼Œç¾äº†ä¸åˆ°å‡ åˆ†é’Ÿï¼Œæ— æ„é—´ Google å‡º mod_auth_kerb  æœ€æ–°ç‰ˆæœ‰ä¸ªç§˜å¯†ç‰¹æ€§ KrbLocalUserMappingï¼Œè®¾ç½®æˆ On çš„è¯ mod_auth_kerb å°±ä¼šæŠŠ REMOTE_USER  è®¾ç½®æˆ user è€Œé user@REALMï¼Œè¿™ä¸ªç‰¹æ€§åœ¨é…ç½®æ–‡æ¡£é‡Œæ²¡æï¼Œä»£ç é‡Œçš„ ChangeLog æåˆ°äº†ï¼Œæ±—ã€‚ã€‚ã€‚ã€‚</p><p>äºæ˜¯å°æŠ˜è…¾äº†ä¸€ç•ªï¼Œæ‰“å¼€è¿™ä¸ªç‰¹æ€§ï¼Œé‡æ–°æ£€æŸ¥ä¹‹å‰é…ç½®çš„æ‰€æœ‰  web appï¼Œä¸­é—´ç»å†è«åçš„ &#34;gss_acquire_cred() failed: Unspecified GSS failure.   Minor code may provide more information (, )&#34; é”™è¯¯ï¼Œé‡å¯æœºå™¨åå±…ç„¶å¥½äº†ï¼Œæœ€åé™¤äº† Bugzilla  è¦æ±‚ç”¨æˆ·åæ˜¯é‚®ä»¶åœ°å€ï¼Œå…¶å®ƒ web app éƒ½ç”¨äº† KrbLocalUserMapping On è®¾ç½®ï¼Œå¯æ€œæˆ‘ä¹‹å‰è¿˜æŠ˜è…¾ Foswiki  é‡Œå¦‚ä½•å†™æ’ä»¶æŠŠ user@REALM è½¬æˆ userã€‚ã€‚ã€‚è¿˜å¥½ç»“å±€æ˜¯æ¯”è¾ƒç†æƒ³çš„ï¼Œçœ‹ç€ä¸å¸¦ @REALM çš„ç”¨æˆ·åæ„Ÿè§‰è¿˜æ˜¯æ¸…çˆ½å¤šäº†ã€‚</p><p>Debian  æ‰“åŒ…çš„ ViewVC ç‰ˆæœ¬å¤ªæ—§äº†ï¼Œå®˜æ–¹çš„ 1.1.x ç³»åˆ—å·²ç»åˆæ­¥æ”¯æŒ WSGI å’Œ FastCGI æ¨¡å¼è¿è¡Œäº†ï¼Œæˆ‘é…ç½®æˆ WSGI æ¨¡å¼ï¼Œä»¥  viewvc ç”¨æˆ·èº«ä»½è¿è¡Œ WSGI daemonï¼Œè¿™ä¸ªç”¨æˆ·å¤„åœ¨ svn ç»„é‡Œï¼Œè¿™æ ·ä¼Šå°±å¯ä»¥è¯»å– /srv/svn ä¸‹çš„ä»£ç åº“äº†ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå°é—®é¢˜æ˜¯  ViewVC çš„ query.cgi è„šæœ¬ï¼Œåœ¨ Debian é‡Œä½äºå•ç‹¬çš„ viewvc-query è½¯ä»¶åŒ…ï¼Œè¿™ä¸ªåŒ…ä¾èµ– MySQL  æ•°æ®åº“ä¿å­˜ svn æäº¤æ—¥å¿—ï¼Œåœ¨ ViewVC çš„ bug è·Ÿè¸ªç³»ç»Ÿé‡Œæœ‰ PostgreSQL çš„è¡¥ä¸ï¼Œä½†æ˜¯å¾ˆæš´åŠ›ï¼Œç›´æ¥æŠŠ MySQL  æ”¯æŒå¹²æ‰äº†ï¼Œæ‰€ä»¥è‡³ä»Š ViewVC ä¹Ÿæ²¡æ­£å¼æ”¯æŒ PostgreSQLã€‚æˆ‘å› ä¸ºä¹‹å‰é…ç½®çš„ web app éƒ½ç”¨çš„ PostgreSQL  æ•°æ®åº“ï¼Œä¸æƒ³å†ç´¯èµ˜æ·»ä¸ª MySQLï¼Œè€Œä¸”åŒæ—¶è£…è¿™ä¸¤ç§æ•°æ®åº“çš„è¯ï¼Œä¸€äº› web app çš„ Debian å®‰è£…è„šæœ¬ä¼šä¼˜å…ˆé€‰æ‹©  MySQLï¼Œä»è€Œç ´åæˆ‘é‚£äº›è‡ªåŠ¨å®‰è£…é…ç½®è„šæœ¬çš„é€»è¾‘ï¼Œæ‰€ä»¥å°±æ”¾å¼ƒ query.cgi äº†ã€‚è²Œä¼¼æ–°ç‰ˆ ViewVC é‡Œ viewvc.cgi å†…ç½®äº†  query åŠŸèƒ½ï¼Œviewvc.conf é‡Œæåˆ°ï¼Œæˆ‘æ²¡æ‰¾åˆ°å¯¹åº”ä»£ç ä»€ä¹ˆåœ°æ–¹ï¼Œå¯èƒ½æ˜¯æŒ‡ç°åœ¨ viewvc å¯ä»¥ç›´æ¥æŸ¥è¯¢ svn log  äº†ï¼Œç¼ºå°‘çš„åªæ˜¯æœç´¢åŠŸèƒ½ï¼Œè¿™éƒ¨åˆ†æˆ‘æ‰“ç®—ç”¨æ›´å¼ºå¤§çš„ OpenGrok ä»¥åŠå®šåˆ¶ Apache solr ä»£æ›¿ã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50793993", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "Windowsï¼ŒKFWï¼ŒSASLï¼ŒGSSAPIï¼Œ è¿·ä¸€èˆ¬çš„ç»„åˆ", 
            "content": "<p>ã€è¿ç§»ã€‘Windowsï¼ŒKFWï¼ŒSASLï¼ŒGSSAPIï¼Œ è¿·ä¸€èˆ¬çš„ç»„åˆ</p><p>å‰å‡ å¤©å‘å¸ƒ MyServer-scripts-2.1 æ—¶ï¼Œå‘ç° 64 ä½Windows 7ä¸‹ HTTP Negotiate å’Œ GSSAPI è®¤è¯ä¸å¥½ä½¿äº†ï¼Œæ¥ä¸‹æ¥å‡ å¤©å¾ˆæ˜¯æŠ˜è…¾äº†ä¸€ç•ªï¼Œç»ˆäºæ¯”è¾ƒç²—æš´çš„æå®šäº†ï¼Œè®°å½•ç‚¹ç¬”è®°ä»¥å¤‡å¿˜ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>é—®é¢˜ä¸€ï¼š  KFW (Kerberos for Windows 3.2.2)ä¿å­˜è®¾ç½®å¤±è´¥ã€‚</p><p>åŸå› ï¼š  ç”¨ Sysinternals Suite çš„ Process Monitor æŸ¥çœ‹äº†ä¸‹ï¼ŒKFW å†™å…¥ C:\\Windows\\krb5.ini  å¤±è´¥ï¼ŒåŸæ¥æ˜¯ Windows 7 å¯¹ C: ç›˜åšäº†ä¿æŠ¤ï¼Œä¸è®©æ™®é€šç”¨æˆ·å†™å…¥ï¼Œè¿™ä¸ªå¾ˆå¥½è§£å†³ï¼Œå³é”®é€‰æ‹©è¿™ä¸ªæ–‡ä»¶ï¼Œå±æ€§é‡Œèµ‹äºˆ users  ç»„å¯å†™æƒé™ï¼Œå†ä¿å­˜è®¾ç½®å°±å¯ä»¥äº†ï¼ŒKFW ä¿å­˜è®¾ç½®æ—¶æ˜¯å…ˆåˆ é™¤è¿™ä¸ªæ–‡ä»¶ï¼Œå†å†™ä¸€ä»½æ–°çš„ã€‚ä½†æ˜¯å¥‡è‘©å¾—æ˜¯ Windows 7  å¯¹è¿™ä¸ªå†™å…¥åšäº†é­”æ³•èˆ¬çš„é‡å®šå‘ï¼š å®é™…æ˜¯å†™å…¥åˆ°  C:\\Users\\YOUR-ACCOUNT\\AppData\\Local\\VirtualStore\\Windows\\krb5.ini ä¸‹äº†ã€‚  KFW çš„ä»£ç è‚¯å®šä¸çŸ¥é“è¿™ä¸ªé­”æ³•ï¼Œå¯è§ Windows çš„å‘åå…¼å®¹æ˜¯å¤šä¹ˆå¯æ€•çš„å¼ºå¤§ï¼ ä» ProcMon çš„è¾“å‡ºçœ‹ï¼Œè²Œä¼¼  Putty/Firefox/ThunderBird éƒ½ä¸ä¼šå» VirtualStore/ ä¸‹æ‰¾æ–‡ä»¶ï¼Œç¨³å¦¥èµ·è§ï¼Œè¿˜æ˜¯å¾€  C:\\Windows\\  ä¸‹å¤åˆ¶ä¸€ä»½å¾—äº†ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>KFW-3.2.2 åªæœ‰ 32 ä½ç‰ˆæœ¬ï¼Œå®éªŒæ€§çš„ 3.2.3 å€’æ˜¯æœ‰ 64 ä½ç‰ˆæœ¬ï¼Œä½† Putty  0.62ã€Firefox 11ã€ThunderBird 11 éƒ½æ˜¯ 32 ä½çš„ï¼Œæ‰€ä»¥å¿…é¡»å¾—å®‰è£… KFW-3.2.2ã€‚ Putty å’Œ KFW  é…åˆè‰¯å¥½ï¼Œåœ¨  Putty æºç  putty-src\\windows\\wingss.c ä¸­ï¼ŒPutty é€šè¿‡æ³¨å†Œè¡¨  HKLM\\Software\\MIT\\Kerberos\\InstallDir å¾—åˆ° KFW å®‰è£…ç›®å½•ï¼Œé»˜è®¤æ˜¯ C:\\Program Files  (x86)\\MIT\\Kerberosï¼Œæ‹¼æ¥ä¸Š bin\\gssapi32.dll å¹¶åŠ è½½å¾—åˆ°é‡è¦çš„å‡ ä¸ª GSSAPI å‡½æ•°å…¥å£åœ°å€ã€‚ è¿™ä¸ªåœ°æ–¹  64bit Windows 7 åˆæäº†ä¸ªé­”æ³•ï¼Œ Putty çš„è¿™æ¬¡æ³¨å†Œè¡¨è¯»å–è¢«é‡å®šå‘åˆ°  HKLM\\Software\\Wow6432Node\\MIT\\Kerberos äº†ï¼ŒPutty çš„ä»£ç è‡ªç„¶å¯¹è¿™ä¸ªä¹Ÿæ˜¯ä¸€æ— æ‰€çŸ¥ï¼Œå¯æ€•çš„  Windows å…¼å®¹æ€§ï¼</p><p class=\"ztext-empty-paragraph\"><br/></p><p>é—®é¢˜äºŒï¼š Firefox ä»¥åŠ ThunderBird å‡ä¸åš HTTP Negotiate è®¤è¯ï¼Œç›´æ¥è¢« Apache 401 äº†ã€‚</p><p>åŸå› ï¼š </p><ul><li>Firefox  å’Œ ThunderBird éœ€è¦æ‰¾åˆ° gssapi32.dllï¼Œ å®ƒä»¬çš„ä»£ç è²Œä¼¼æ˜¯é€šè¿‡ PATH æ‰¾è¿™ä¸ªæ–‡ä»¶ï¼Œæ²¡ç”¨æ³¨å†Œè¡¨ï¼Œè¿˜å¥½  KFW-3.2.2 çš„ MSI å®‰è£…ç¨‹åºè‡ªåŠ¨æŠŠ C:\\Program Files (x86)\\MIT\\Kerberos\\bin åŠ å…¥ PATH  äº†ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼ˆæ³¨æ„ Windows 7 è‡ªèº«ä¹Ÿæœ‰ klist.exe ç¨‹åºï¼Œå‘½ä»¤è¡Œä¸‹è°ƒç”¨æ—¶éœ€è¦åˆ†æ¸…æ¥šï¼‰ã€‚</li><li>KFW  çš„è®¾ç½®é‡Œé»˜è®¤ realm æ²¡æœ‰è®¾ç½®æˆ http://CORP.EXAMPLE.COMï¼Œè¿™ä¼šå¯¼è‡´åš HTTP Negotiate æˆ–è€… GSSAPI  è®¤è¯æ—¶éå¸¸ç¼“æ…¢ï¼Œå› ä¸º KFW è·‘å» MIT çš„ kerberos æœåŠ¡å™¨ä¸Šæ‰¾ç”¨æˆ·äº†ã€‚è²Œä¼¼æ‰¾ä¸åˆ°åä¼š rollback åˆ°  http://CORP.EXAMPLE.COMï¼Œå¯èƒ½æ˜¯æ ¹æ®åŸŸåæ¨æ–­çš„ã€‚</li><li>Firefox å’Œ Thunderbird çš„ Config  Editor é‡Œæ²¡æœ‰æŠŠ network.auth.use-sspi è®¾ç½®æˆ falseï¼Œ åªè®¾ç½®  network.negotiate-auth.trusted-uris ä¸º http://corp.example.com  æ˜¯ä¸å¤Ÿçš„ã€‚å‰ä¸€ä¸ªé€‰é¡¹çš„æ„æ€æ˜¯æ˜¯å¦ä½¿ç”¨ Windows çš„ security service provider interfaceï¼Œç”±äº  Windows çš„ Kerberos å®ç°å¤¹å¸¦äº†ç§è´§ï¼Œä¸èƒ½ä¸ MIT Kerberos æœåŠ¡äº’æ“ä½œï¼Œæ‰€ä»¥å¿…é¡»è®¾ç½®æˆ  falseï¼Œå¦åˆ™æ ¹æœ¬ä¸ä¼šå»è°ƒç”¨ gssapi32.dllã€‚ ç”±äºè¿™ä¸ªé€‰é¡¹åœ¨ Linux ç‰ˆ Firefox å’Œ Thunderbird  é‡Œæ²¡æœ‰ï¼Œæˆ‘åˆå¾ˆå°‘åœ¨ Windows ä¸‹æµ‹è¯•ï¼Œæ‰€ä»¥æ—©å°±å¿˜è®°å½“åˆåœ¨ 32bit WinXP ä¸Šç»™ Firefox è®¾ç½®è¿‡è¿™ä¸ªé€‰é¡¹â€¦â€¦</li></ul><p>è¿™ä¸ªé—®é¢˜çš„ä¸€äº›å‚è€ƒèµ„æ–™ï¼š</p><p><a href=\"https://link.zhihu.com/?target=https%3A//hg.mozilla.org/mozilla-central/file/fd2da289a3c1/extensions/auth\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">hg.mozilla.org/mozilla-</span><span class=\"invisible\">central/file/fd2da289a3c1/extensions/auth</span><span class=\"ellipsis\"></span></a></p><p><a href=\"https://link.zhihu.com/?target=https%3A//hg.mozilla.org/mozilla-central/annotate/fd2da289a3c1/extensions/auth/nsAuthGSSAPI.cpp\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">hg.mozilla.org/mozilla-</span><span class=\"invisible\">central/annotate/fd2da289a3c1/extensions/auth/nsAuthGSSAPI.cpp</span><span class=\"ellipsis\"></span></a></p><p><a href=\"https://link.zhihu.com/?target=https%3A//developer.mozilla.org/En/Integrated_Authentication\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">developer.mozilla.org/E</span><span class=\"invisible\">n/Integrated_Authentication</span><span class=\"ellipsis\"></span></a></p><p><a href=\"https://link.zhihu.com/?target=https%3A//developer.mozilla.org/en/Mozilla_Source_Code_Directory_Structure\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">developer.mozilla.org/e</span><span class=\"invisible\">n/Mozilla_Source_Code_Directory_Structure</span><span class=\"ellipsis\"></span></a></p><p>Firefox çš„è°ƒè¯•æ—¥å¿—ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">set NSPR_LOG_MODULES=negotiateauth:5\nset NSPR_LOG_FILE=c:\\firefox_in_domain_negotiateauth.log\n...\\firefox.exe -console\n\nset NSPR_LOG_MODULES=all:5\nset NSPR_LOG_FILE=c:\\firefox_in_domain_debug.log...\\firefox.exe -console\n</code></pre></div><p class=\"ztext-empty-paragraph\"><br/></p><p>é—®é¢˜ä¸‰ï¼š 64 bit TortoiseSVN æŠ¥å‘Š Unable to negotiate authentication mechanism.</p><p>åŸå› ï¼š  64bit Windows ä¸‹å®‰è£…ä¸äº† 32bit TortoiseSVNï¼Œ è€Œ 64bit TortoiseSVN åˆéœ€è¦  gssapi64.dllï¼Œæ‰€ä»¥éœ€è¦å» <a href=\"https://link.zhihu.com/?target=http%3A//web.mit.edu/kerberos/dist/testing.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">web.mit.edu/kerberos/di</span><span class=\"invisible\">st/testing.html</span><span class=\"ellipsis\"></span></a> ä¸‹è½½  kfw-3-2-3-amd64.zip (æ²¡ä¸‹è½½ MSI  ç‰ˆæ˜¯å› ä¸ºæ‹…å¿ƒå¹²æ‰° 32bit KFW-3.2.2)ï¼Œè§£å‹ç¼©åï¼ŒæŠŠé‡Œå¤´ amd64/  ç›®å½•ä¸‹æ‰€æœ‰ *64.dll å¤åˆ¶åˆ° C:\\Program Files\\TortoiseSVN\\bin\\ ä¸‹ï¼Œ ç„¶åå°±å¯ä»¥è®©  TortoiseSVN è®¿é—® svn://http://svn.corp.example.com/test æ—¶ä½¿ç”¨ SASL GSSAPI è®¤è¯æœºåˆ¶äº†ã€‚  å¦‚æœè¿˜æ˜¯å¤±è´¥ï¼Œæ£€æŸ¥ 32bit KFW-3.2.2 æ˜¯å¦å·²ç»æˆåŠŸè·å¾— Kerberos ticket å¹¶ä¸”å¯¹åº” Principal æ˜¯å¦æ˜¯é»˜è®¤  Principalï¼Œ ä»¥åŠ C:\\Windows\\krb5.ini æ˜¯å¦å­˜åœ¨ï¼Œgssapi*.dll ä¼šåœ¨ dll æ‰€åœ¨ç›®å½•ä»¥åŠ  C:\\Windows ä¸‹æ‰¾å¯»è¿™ä¸ªæ–‡ä»¶â€”â€”ä¸è¿‡æˆ‘åœ¨æˆåŠŸè¿‡ä¸€æ¬¡ååˆ é™¤ C:\\Windows\\krb5.ini ä¼Šè¿˜æ˜¯å¯ä»¥æˆåŠŸè®¤è¯ï¼Œä¸è§£ä¸­ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>è¿™ä¸ªé—®é¢˜çš„è°ƒè¯•è¿‡ç¨‹ä¸­å‘ç°ä¸€ä¸ªå¯¹è°ƒè¯•æœ‰äº›è®¸å¸®åŠ©çš„æŠ€å·§ï¼š <a href=\"https://link.zhihu.com/?target=http%3A//subversion.apache.org/docs/community-guide/debugging.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">subversion.apache.org/d</span><span class=\"invisible\">ocs/community-guide/debugging.html</span><span class=\"ellipsis\"></span></a></p><p> $  socat -v TCP-LISTEN:9630,reuseaddr,fork TCP4:localhost:svn ï¼Œåœ¨ svnserve  è¿è¡Œæ‰€åœ¨æœºå™¨æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œç„¶åå®¢æˆ·ç«¯è®¿é—® svn://....:9630/testï¼Œsocat å°±ä¼šæŠŠ svnserve å’Œ svn  client ä¹‹é—´çš„é€šè®¯è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>é—®é¢˜å››ï¼š 64bit TortoiseSVN éšå¸¦çš„ svn.exe æŠ¥å‘Š Unable to negotiate authentication mechansim.</p><p>åŸå› ï¼š  å‘½ä»¤è¡Œç‰ˆæœ¬çš„ svn client éœ€è¦çŸ¥é“ sasl module library æ‰€åœ¨è·¯å¾„ï¼ŒTortoiseSVN  å¤§æ¦‚æ˜¯ä»£ç é‡Œè®¾ç½®äº†ï¼Œsvn.exe å°±æ²¡è¿™ä¸ªå¥½è¿æ°”ï¼Œè¿™ä¸ªé—®é¢˜è°ƒè¯•è¿‡ç¨‹ä¸­ï¼ŒProcMon åˆå¸®äº†å¤§å¿™ï¼Œå¯ä»¥çœ‹åˆ° svn.exe   å…ˆæŸ¥æ³¨å†Œè¡¨HKLM\\SOFTWARE\\Carnegie Mellon\\Project Cyrus\\SASL Libraryï¼Œç„¶åå»æ‰¾  c:\\cmu\\binï¼Œæ”¾ç‹—ä¸€æœï¼Œç«‹é©¬è§åˆ°ç­”æ¡ˆï¼š<a href=\"https://link.zhihu.com/?target=http%3A//svn.apache.org/repos/asf/subversion/trunk/notes/sasl.txt\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">svn.apache.org/repos/as</span><span class=\"invisible\">f/subversion/trunk/notes/sasl.txt</span><span class=\"ellipsis\"></span></a>  ï¼Œå½“åˆé…ç½® svnserve æ—¶å°±çœ‹è¿‡ï¼Œå¯æƒœæ²¡æ³¨æ„çœ‹ Windows ç›¸å…³ç« èŠ‚ã€‚ è¿™æ®µæ–‡æ¡£é‡Œåªæœ‰ SearchPath å¯¹ svn  client æ˜¯éœ€è¦çš„ï¼Œåœ¨æˆ‘è¿™ä¸ªåœºæ™¯é‡Œï¼Œå°±æ˜¯è®¾ç½®æˆ C:\\Program Files\\TortoiseSVN\\binã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>è‡³æ­¤ï¼Œ64bit  Windows 7 ä¸‹ TortoiseSVN/svn/Firefox/ThunderBird/Putty çš„ GSSAPI  è®¤è¯æå®šï¼ŒåŠ ä¸Šä»¥å‰ 32bit WinXP ä¸‹çš„è¯•éªŒï¼ŒWindows ä¸‹ä½¿ç”¨ MIT Kerberos server è¿˜æ˜¯ç›¸å½“å‡‘åˆçš„ :-)</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50793952", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 2, 
            "title": "Trac & Redmine", 
            "content": "<p>ã€è¿ç§»ã€‘Trac &amp; Redmine</p><p>ç©äº†ä¸‹è¿™ä¸¤ä¸ªç²ç‘çš„é¡¹ç›®ç®¡ç†å·¥å…·ï¼Œé›† wikiã€btsã€source browser äºä¸€èº«çš„ web åº”ç”¨ã€‚</p><p>Redmine  æ²¡å‡ºæ¥çš„æ—¶å€™ï¼ŒTrac ä¸€æç‹¬ç§€ï¼Œé¢‡å¾—å°ä¼—æ¬¢å¿ƒï¼Œæˆ‘ä¹Ÿæ›¾ç»æµ…ç”¨è¿‡ï¼Œåšç®¡ç†å‘˜æ¯”è¾ƒæ‚²å‚¬ï¼Œå¹²ç‚¹å˜›ç®¡ç†æ“ä½œéƒ½æ˜¯å¾—å‘½ä»¤è¡Œé‡Œæ“ä½œï¼Œä¸çŸ¥é“ä½œè€…å‡ºäºä»€ä¹ˆè€ƒè™‘ï¼Œå¦å¤–  Trac å®˜ç½‘çš„ wiki æ¯”è¾ƒä¹±ï¼Œè¿‡æœŸçš„ä¿¡æ¯ã€ä¸æ¨èçš„åšæ³•å…¨éƒ½æ··åœ¨æ­£æ–‡é‡Œï¼›åš Trac çš„ç”¨æˆ·æ˜¯æŒºçˆ½çš„ï¼Œç•Œé¢æ¸…çˆ½ï¼Œwiki é‡Œèƒ½æ–¹ä¾¿çš„ä½¿ç”¨  ticket å·ç ä»¥åŠ svn ç‰ˆæœ¬å·ï¼Œé›†æˆçš„æ„Ÿè§‰æŒºå¥½ï¼Œæœ‰ç‚¹è´ªå¿ƒä¸è¶³çš„æ˜¯è§‰å¾— wikiã€ticket  åŠŸèƒ½å°‘äº†äº›ï¼Œæ²¡åŠæ³•ï¼Œå…¨é¢ä¹‹åéš¾ä»¥ç‹¬ä¸“ä¸€é¢ã€‚æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯ Trac ä¸æ”¯æŒè®¿é—®è¿œç¨‹ Subversion åº“ï¼Œè¿™ä¸ªé—®é¢˜å·²ç»æ‚¬ç€å…«å¹´äº†ï¼Œè§ <a href=\"https://link.zhihu.com/?target=http%3A//trac.edgewall.org/ticket/493\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">trac.edgewall.org/ticke</span><span class=\"invisible\">t/493</span><span class=\"ellipsis\"></span></a> ã€‚</p><p>æ—¶è‡³ä»Šæ—¥ï¼Œè¿™ä¸ªå°ä¼—å¸‚åœºä¸Š  Redmine åˆ†äº†å¾ˆå¤§ä¸€æ¯ç¾¹ï¼Œé¢‡æœ‰å¥½è¯„ã€‚è·Ÿ Trac ç›¸æ¯”ï¼ŒRedmine çš„ç®¡ç†åŠŸèƒ½æœ‰ Web UI  å¯æ“ä½œï¼Œå¯¹ç®¡ç†å‘˜å‹å¥½äº†å¾ˆå¤šï¼Œç›´æ¥æ”¯æŒå¤šç§ VCS æ¯”å¦‚ Subversionã€Mercurialã€GITã€Bazaarï¼Œä¸åƒ Trac  é»˜è®¤åªæ”¯æŒ Subversionã€‚é™¤äº†è·Ÿ Trac ä¸€æ ·æ”¯æŒ wikiã€ticketã€timeline ç‰¹æ€§ä¹‹å¤–ï¼Œ Redmine è¿˜æœ‰  forrumã€calendarã€ganttï¼Œåä¸¤ä¸ªç‰¹æ€§å¾ˆæ–¹ä¾¿çœ‹é¡¹ç›®è¿›å±•æƒ…å†µï¼Œçœ‹èµ·æ¥æŒºå®ç”¨çš„ã€‚è¦è¯´ç¼ºç‚¹çš„è¯ï¼ŒRedmine  å®˜æ–¹çš„æ–‡æ¡£ã€è®ºå›ä¿¡æ¯ä¹Ÿæ¯”è¾ƒè¿‡æ—¶ï¼Œæ’ä»¶æ¯” Trac å°‘å¾ˆå¤šï¼Œå†·å¯åŠ¨å¾ˆæ…¢ï¼ˆé‡å¯åŠ¨ Apache åç¬¬ä¸€æ¬¡è®¿é—®ï¼Œæˆ–è€…é—²ç½®ä¸€æ®µæ—¶é—´åå†è®¿é—®ï¼Œä¼¼ä¹  FastCGI æ¨¡å¼ä¸‹ ruby è¿›ç¨‹ä¼šè¿‡ä¸€æ®µæ—¶é—´è‡ªåŠ¨é€€å‡ºï¼‰ï¼Œå¾—èŠ±ä¸ªåæ¥ç§’ã€‚</p><p>ç»™è¿™ä¿©é…ç½® Kerberos è®¤è¯çœŸæ˜¯å¤©ä¸Šåœ°ä¸‹ï¼ŒTrac å˜›éƒ½ä¸ç”¨ç®¡ï¼Œç›´æ¥æ”¯æŒï¼ŒRedmine å°±éƒé—·å¤§å‘äº†ï¼Œç”±äºæˆ‘æ˜¯ Perl fanï¼Œä¸æ‡‚ Ruby ä¹Ÿæä¸èµ·å…´è¶£å­¦ï¼Œç½‘ä¸Šæœç´¢äº†ä¸‹ï¼Œè®© Redmine æ”¯æŒ HTTP Auth çš„åŠæ³•å€’æ˜¯é¢‡æœ‰å‡ ä¸ªï¼š</p><ul><li><a href=\"https://link.zhihu.com/?target=http%3A//www.redmine.org/issues/1131\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">redmine.org/issues/1131</span><span class=\"invisible\"></span></a> è¿™ä¸ªåŠæ³•æ˜¯ä¸‰å¹´å‰çš„ï¼Œç»æµ‹è¯•ï¼Œä¸å¥½ç”¨</li><li><a href=\"https://link.zhihu.com/?target=http%3A//www.redmine.org/projects/redmine/wiki/Alternativecustom_authentication_HowTo\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">redmine.org/projects/re</span><span class=\"invisible\">dmine/wiki/Alternativecustom_authentication_HowTo</span><span class=\"ellipsis\"></span></a>  è¿™ä¸ªç®—æ˜¯æœ€é è°±çš„æ–‡æ¡£äº†ï¼Œä¹Ÿæœ‰å¿«ä¸¤å¹´å†å²äº†ï¼Œæœ‰äº›åœ°æ–¹ä¹Ÿæ˜¯éœ€è¦ä¿®æ”¹çš„ï¼Œè€Œä¸”è¿™ä¸ªæ–‡æ¡£è¯´çš„ä¸è¯¦ç»†ï¼ˆæˆ–è€…æˆ‘æ²¡çœ‹æ˜ç™½ï¼‰ï¼Œä¼Šæ²¡è¯´æ˜æ˜¯ä¸æ˜¯å†™æˆ Redmine  pluginï¼Œå®³æˆ‘é’»ç ”äº†ä¸‹æ€ä¹ˆå†™ Redmine æ’ä»¶ã€‚è¿™ä¸ªæ–‡æ¡£é‡Œé‚£æ®µç›´æ¥å¾€ Redmine æ•°æ®åº“é‡Œ auth_sources  è¡¨æ ¼é‡Œæ’è®°å½•çš„æ–¹å¼å¾ˆæ¶æï¼Œä¸«å°±ä¸èƒ½æ•´ä¸ªè„šæœ¬æˆ–è€… Web UI å•¥çš„å°è£…è¿™ä¸ªå†…éƒ¨ç»†èŠ‚ä¹ˆï¼Ÿ</li><li><a href=\"https://link.zhihu.com/?target=https%3A//github.com/AdamLantos/redmine_http_auth\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">github.com/AdamLantos/r</span><span class=\"invisible\">edmine_http_auth</span><span class=\"ellipsis\"></span></a>  çœ‹èµ·æ¥è¿™ä¸ªæ­£æ˜¯æˆ‘è¦çš„ï¼Œå¯æƒœè¯•éªŒè¿‡åå‘ç°ä¸å¥½ç”¨ï¼Œæ¯•ç«Ÿä¹Ÿæœ‰ä¸¤å¹´æ²¡æ›´æ–°äº†ï¼Œåæ¥å¤§è‡´æ‰«äº†ä¸‹å®ç°ï¼Œä¼Šæ˜¯ç©äº†ä¸ªæŠ€å·§ï¼Œå®é™…ä¹Ÿæ˜¯åˆ©ç”¨ä¸Šé¢ç¬¬ä¸€ä¸ªåŠæ³•çš„æ€è·¯ï¼Œåªæ˜¯åˆ©ç”¨ Ruby åŠ¨æ€è¯­è¨€ç‰¹æ€§è¦†å†™äº†ä¸€äº›  Redmine çš„ä»£ç ã€‚</li><li><a href=\"https://link.zhihu.com/?target=https%3A//github.com/edavis10/redmine_sso_client\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">github.com/edavis10/red</span><span class=\"invisible\">mine_sso_client</span><span class=\"ellipsis\"></span></a> æ²¡è¯•éªŒè¿™ç©æ„ï¼Œä¼Šè¿˜æ•´äº†ä¸ª sso serverï¼Œé¬¼æ‰ç”¨å‘¢ã€‚ã€‚ã€‚</li></ul><p>æ²¡åŠæ³•ï¼Œåªå¥½è‡ªå·±æ‘¸ç´¢ç€é¼“æ£ï¼ŒRuby  çš„è¯­æ³•ç³–çœŸå¤šï¼Œçœ‹å¾—æˆ‘è¿™ä¸ª Perl ä¸­é«˜æ®µé€‰æ‰‹éƒ½ä¸€æ„£ä¸€æ„£çš„ï¼Œå¥½ä¸å®¹æ˜“æ‘¸å‡ºé—¨é“ï¼Œç»“åˆä¸Šé¢ç¬¬ä¸€ä¸ªåŠæ³•å’Œç¬¬äºŒä¸ªåŠæ³•ï¼Œè®© Redmine æ”¯æŒ  HTTP auth äº†ï¼Œæœ¬æ¥æƒ³ç»™ Redmine å®˜æ–¹æä¸ªè¡¥ä¸ï¼Œç»“æœå‘ç°ä¼Šè¿é‚®ä»¶åˆ—è¡¨éƒ½æ²¡æœ‰ï¼Œæˆ‘æ‡’å¾—åœ¨å®ƒç½‘ç«™æ³¨å†Œå¸å·ï¼Œä½ çœ‹ Trac  çš„å¼€å‘è€…å°±æ²¡é‚£ä¹ˆäºŒï¼Œäººå®¶å°±æœ‰é‚®ä»¶åˆ—è¡¨â€”â€”ä½ ä»¥ä¸ºä½  Redmine æä¸ª forum ç”¨æˆ·å°±çº·çº·æ¥æ³¨å†Œå•Šã€‚ã€‚ã€‚</p>", 
            "topic": [
                {
                    "tag": "Redmine", 
                    "tagLink": "https://api.zhihu.com/topics/19560850"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50793941", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "svnserve é…ç½®", 
            "content": "<p>ã€è¿ç§»ã€‘svnserve é…ç½®</p><p>é¢˜å¤–è¯ï¼šDebian ä¸Š Dovecot ç»ˆäºå‡çº§åˆ° 2.0.18 äº†ï¼ŒCalenderServer ä¹Ÿå‡çº§äº†ä¸€æŠŠï¼Œè§£å†³äº† Python 2.7 ä¸‹æ— æ³•å¯åŠ¨çš„é—®é¢˜ï¼ŒSamba 4 å±…ç„¶ä¹Ÿæ‰“åŒ…äº†ï¼Œè™½ç„¶å®‰è£…æ—¶æŠ¥ä¸€å¤§å †é”™ã€‚ã€‚ã€‚</p><p>ä½œä¸º  GIT æ´¾ï¼Œæœ¬æ¥æ˜¯ä¸æƒ³é…ç½® Subversion çš„ï¼Œä¸è¿‡å¯¹ TortoiseSVN è¿˜çœŸæ˜¯å°è±¡è‰¯å¥½ï¼ŒåŠ ä¸Šè€ƒè™‘åˆ°å¤§ä¼—éœ€æ±‚ï¼Œæœªå¿…æ‰€æœ‰äººéƒ½å–œæ¬¢  GIT è¿™æ ·çš„å£å‘³ï¼Œæ‰€ä»¥è¿˜æ˜¯é…ç½®ä¸‹ svnserve ç©ç©ã€‚svn æœ€è¿‘çš„å‘å±•ä¹ŸæŒºæœ‰æ„æ€ï¼Œ.svn ç›®å½•åªæ”¾åœ¨é¡¶çº§å·¥ä½œç›®å½•é‡Œï¼Œfsfs  åº“çš„æ–‡ä»¶å­˜å‚¨æ–¹å¼å¢åŠ äº† shard ç‰¹æ€§ï¼Œé¿å…ä¸€ä¸ªç›®å½•ä¸‹æœ‰å¤ªå¤šæ–‡ä»¶ï¼Œè¿˜å¢åŠ äº† svnadmin pack å‘½ä»¤ï¼Œé¢‡æœ‰åƒ GIT  çœ‹é½çš„æ„æ€ï¼Œä¸å¾—ä¸å†èµä¸€ä¸‹ Linus çš„é«˜ç»è¿œç©ã€‚</p><p>Subversion çš„æœåŠ¡ç«¯æœ‰ä¸‰ç§è¿è¡Œæ–¹å¼ï¼š<a href=\"https://link.zhihu.com/?target=http%3A//svnbook.red-bean.com/en/1.7/svn.serverconfig.choosing.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">svnbook.red-bean.com/en</span><span class=\"invisible\">/1.7/svn.serverconfig.choosing.html</span><span class=\"ellipsis\"></span></a></p><ul><li>Apache + mod_dav_svnï¼Œäº®ç‚¹æ˜¯å¯ä»¥åˆ©ç”¨ Apache çš„è®¤è¯æœºåˆ¶ã€è¯¦ç»†çš„è®¿é—®æ—¥å¿—ã€å•å†™å¤šè¯»ä¸»ä»ä»£ç†æœºåˆ¶ä»¥åŠç®€å•çš„ä»£ç åº“æµè§ˆ Web ç•Œé¢ã€‚<br/></li><li>svnserve daemon æˆ–è€…  inetd</li><li>svnserve + ssh</li></ul><p>ä¹‹å‰ç”¨  subversion æ—¶ä¸€ç›´ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œä½†åœ¨æˆ‘è¿™ä¸ª SSO æ–¹æ¡ˆé‡Œï¼Œå®ƒæœ‰ä¸€äº›é—®é¢˜ï¼šä»£ç åº“è¢« www-data ç”¨æˆ·æ‰€æœ‰ï¼ŒåŒä¸€ä¸ª Apache  ä¸ŠæœåŠ¡çš„å…¶å®ƒ web åº”ç”¨å¦‚æœæœ‰æ¼æ´ï¼Œé‚£ä¹ˆä»£ç åº“ä¹Ÿæœ‰æš´éœ²é£é™©ï¼›mod_kerb å¾—åˆ°çš„ç”¨æˆ·åå¸¦æœ‰ @REALM åç¼€ï¼Œæˆ‘ä¼°è®¡å¾ˆå¯èƒ½  mod_dav_svn å¾—åˆ°çš„ä¹Ÿæ˜¯è¿™ç§ç”¨æˆ·åï¼Œè¿™æ ·å†™ authz æ–‡ä»¶æ—¶æ¯”è¾ƒç½—å—¦ã€‚</p><p>ç¬¬ä¸‰ç§æ–¹å¼ä¸‹ svnserve  æ‰€åœ¨æœºå™¨éœ€è¦å®šåˆ¶ login shellï¼Œé¿å…ç”¨æˆ·å¯ä»¥ç™»å½• svnserve æ‰€åœ¨æœåŠ¡å™¨è·å¾— shell è®¿é—®ï¼Œä½†å³ä½¿è¿™ä¹ˆåšï¼Œç”±äº  svnserve å¤„äº tunnel æ¨¡å¼ï¼Œä»¥ ssh ç™»å½•ç”¨æˆ·èº«ä»½è¿è¡Œï¼Œæ‰€ä»¥è¦ç‰¹åˆ«æ³¨æ„ svn repository  çš„æ–‡ä»¶æƒé™ï¼Œä¸€èˆ¬éœ€è¦æŠŠæ‰€æœ‰ç”¨æˆ·æ”¾å…¥ git ç»„ï¼Œå¹¶ä½¿ç”¨ svnwrap æ¥ç»Ÿä¸€ umaskï¼›å¦‚æœä»¿é€  gitolite çš„åšæ³•ï¼Œç”¨åŒä¸€ä¸ª svn  è´¦æˆ·ï¼Œç”¨æˆ·ç”¨ ssh å…¬é’¥è®¤è¯æäº¤ï¼Œé‚£åˆç”¨ä¸äº† kerberos è®¤è¯ï¼Œè€Œä¸”å¾ˆå¯èƒ½ svn log é‡Œçš„ author å…¨æ˜¯ svn è´¦æˆ·äº†ã€‚</p><p>ç”±äº  svnserve æ”¯æŒ SASL è®¤è¯ï¼Œæ‰€ä»¥è¿˜æ˜¯ç¬¬äºŒç§æ–¹å¼æœ€å®Œç¾ï¼Œä¸éœ€è¦ç”¨æˆ·å¯ä»¥ç™»å½• svnserve æ‰€åœ¨æœºå™¨ï¼Œå¯ä»¥ç”¨ Cyrus SASL  æ”¯æŒçš„ GSSAPI è®¤è¯ï¼Œsvnserve çš„ --log-file é€‰é¡¹å¯ä»¥è®°å½• svn è®¿é—®æ—¥å¿—ï¼Œç¾ä¸­ä¸è¶³çš„æ˜¯ svnserve  çš„é”™è¯¯æ—¥å¿—å®Œå…¨æ²¡æœ‰ï¼Œæ¯”å¦‚ç™»å½•å¤±è´¥äº† svnserve å±éƒ½ä¸æ”¾ä¸€ä¸ªï¼Œè¿˜å¥½ Cyrus SASL æœ‰è°ƒè¯•æ—¥å¿—ã€‚å¦ä¸€ä¸ªé—®é¢˜æ˜¯ svnserve  ä¸æ”¯æŒæ¥æ”¶åˆ° SIGHUP æ—¶é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ï¼Œæ‰€ä»¥åšæ—¥å¿— rotation æ—¶éœ€è¦é‡å¯ svnserve æœåŠ¡ã€‚</p><p>Debian  æ‰“åŒ…çš„ Subversion æ²¡æœ‰æä¾› svnserve çš„ /etc/init.d/svnserve æ–‡ä»¶ï¼Œæˆ‘æŠ˜è…¾äº†ä¸‹ï¼Œä»¿ç…§  /etc/init.d/skeleton å†™äº†ä¸€ä¸ªï¼Œå¹¶åˆ›å»ºäº† svn ç”¨æˆ·ä»¥åŠ svn ç»„ï¼Œè®© svnserve ä»¥ svn  ç”¨æˆ·èº«ä»½è¿è¡Œã€‚svnserve çš„ SASL è®¤è¯é…ç½®æ–‡ä»¶å¯ä»¥æ”¾åœ¨ /etc/sasl2/svn.conf é‡Œã€‚ä¸€ç•ªæŠ˜è…¾åï¼Œsvnserve çš„  GSSAPI è®¤è¯æå®šï¼ŒLinux ä¸‹ svn å‘½ä»¤è¡Œä»¥åŠ Windows ä¸‹ TortoiseSVN éƒ½å¯ä»¥ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯  Kerberos for Windows é‡Œå¦‚æœå½“å‰ principal ä¸æ˜¯ default principalï¼Œé‚£ä¹ˆ  TortoiseSVNã€Putty åœ¨åš GSSAPI è®¤è¯æ—¶éƒ½ä¼šè§¦å‘ Kerberos for Windows å¼¹å‡ºå¯†ç è¾“å…¥çª—å£ã€‚</p>", 
            "topic": [
                {
                    "tag": "SVN(Subversion)", 
                    "tagLink": "https://api.zhihu.com/topics/19607465"
                }, 
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50793909", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "ä¼ä¸šå†…éƒ¨å³æ—¶é€šè®¯æœåŠ¡", 
            "content": "<p>ã€è¿ç§»ã€‘ä¼ä¸šå†…éƒ¨å³æ—¶é€šè®¯æœåŠ¡</p><p>å…¬å¸å†…éƒ¨åŒäº‹ä¹‹é—´åŸºäºç½‘ç»œçš„é€šè®¯æ–¹å¼ï¼Œæœ€å¸¸ç”¨çš„æ˜¯é‚®ä»¶å’Œå³æ—¶é€šè®¯å·¥å…·ï¼Œæ¯”å¦‚ MSNã€QQã€GTalkã€Yahoo!  Messengerï¼Œè¿™äº›éƒ½æ˜¯é¢å‘å› ç‰¹ç½‘ç”¨æˆ·çš„ï¼Œé¢å‘ä¼ä¸šå†…éƒ¨çš„å³æ—¶é€šè®¯å·¥å…·æˆ‘ç”¨è¿‡  RTXï¼Œç›¸å½“å¥½ç”¨ï¼Œä¸è¿‡è²Œä¼¼æ˜¯å•†ä¸šæ”¶è´¹çš„ï¼ˆä¸æ¸…æ¥šå…¬å¸è´­ä¹°äº†æ²¡ï¼Œå“ˆå“ˆï¼‰ã€‚æ­å»ºä¼ä¸šå†…éƒ¨å³æ—¶é€šè®¯æœåŠ¡ï¼Œè·Ÿæ­å»ºä¼ä¸šå†…éƒ¨é‚®ä»¶ç³»ç»Ÿä¸€æ ·ï¼Œä¸»è¦æ˜¯ä¸ºäº†å…¬å¸æœºå¯†ä¸è¢«æ³„æ¼ï¼ˆä¸çŸ¥é“å¥‡è™  360 å†…éƒ¨æ˜¯å¦ç¦æ­¢ä½¿ç”¨ QQï¼Œå†æ¬¡å“ˆå“ˆï¼ï¼‰ï¼Œå…¶æ¬¡æ˜¯å†…éƒ¨ç»´æŠ¤æ›´æ–¹ä¾¿ç›‘ç®¡ä»¥åŠå†å²å›æº¯ï¼Œæ¯”å¦‚è®°å½•èŠå¤©æ—¥å¿—ã€‚é¡ºå¸¦è¯´ä¸€å˜´ï¼ŒGTalk  çš„èŠå¤©è®°å½•é»˜è®¤ä¼šæ”¾é‚®ç®±é‡Œï¼Œæœ‰ç‚¹ææ€–ï¼Œä¸€æ˜¯è‚¯å®šä¼šè¢« Google åˆ†æç”¨æˆ·è¡Œä¸ºï¼ŒäºŒæ˜¯ä¸€æ—¦å¸å·æ³„æ¼ï¼Œé‚£å°±å°´å°¬å¤§å‘äº†ã€‚</p><p>å…¬å¸å†…éƒ¨æ­å»ºå³æ—¶é€šè®¯æœåŠ¡åªæœ‰ä¸¤ä¸ªé€‰æ‹©ï¼ŒIRC  å’Œ Jabber(XMPP)ï¼Œå‰è€…è²Œä¼¼è¿˜ä¸æ˜¯ç°ä»£æ„ä¹‰çš„å³æ—¶é€šè®¯ï¼Œä¸æ”¯æŒç”¨æˆ·ä¹‹é—´è„±ç¦»èŠå¤©å®¤ç›´æ¥èŠã€‚Jabber  åˆ™ç‰¹æ„æ‰“é€ ä¸ºå¼€æ”¾çš„å³æ—¶é€šè®¯åè®®ï¼ŒGTalk ä¸€å¼€å§‹å°±é‡‡ç”¨äº† Jabber åè®®ï¼ŒMSN æ®è¯´æ–°ç‰ˆæœ¬ä¹Ÿè¦çšˆä¾äº†ã€‚å¼€æºçš„ Jabberd  æœåŠ¡å™¨æœ‰å¾ˆå¤šï¼Œä½†ç°åœ¨æ´»çš„å¥½çš„å‡¤æ¯›éºŸè§’ï¼Œejabberd é‡‡ç”¨ Erlang è¯­è¨€ç¼–å†™ï¼Œå¯¹å¤š Jabberd  æœåŠ¡å™¨ç»„æˆé›†ç¾¤æ”¯æŒçš„å¾ˆå¥½ï¼ˆErlang è¯­è¨€è¿è¡Œæ—¶å¤©ç”Ÿå°±å†…ç½®é›†ç¾¤æ”¯æŒï¼‰ï¼Œä¼°è®¡æ˜¯ç›®å‰ç”¨çš„æœ€å¹¿çš„ Jabberd æœåŠ¡ç¨‹åºäº†ï¼ŒDebian  åŒ…å«äº†å®ƒçš„å®‰è£…åŒ…ï¼Œæ‰€ä»¥åœ¨ Debian ä¸Šå®‰è£…å¾ˆå®¹æ˜“ï¼Œä½†å¯æƒœçš„æ˜¯ ejabberd ä¸€å¼€å§‹ä¸æ”¯æŒ GSSAPI è®¤è¯ï¼Œå¹¸å¥½ Mikma  åŒå­¦å‘é£™ç»™å®ƒåŠ å…¥è¿™ä¸ªé‡è¦çš„ä¼ä¸šçº§ç‰¹æ€§ï¼Œåœ¨ <a href=\"https://link.zhihu.com/?target=http%3A//www.ejabberd.im/cyrsasl_gssapi\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">ejabberd.im/cyrsasl_gss</span><span class=\"invisible\">api</span><span class=\"ellipsis\"></span></a> ä¸Šæä¾›äº†é’ˆå¯¹  ejabberd å¤šä¸ªç‰ˆæœ¬çš„è¡¥ä¸ï¼Œejabberd ç»´æŠ¤è€…ä¹‹ä¸€ Badlop åŒå­¦æŠŠè¿™ä¸ªç‰¹æ€§æ”¶å…¥äº† ejabberd 3.0  åˆ†æ”¯ä¸­ï¼ŒæœŸå¾…å…¶ä»Šå¹´æ—©æ—¥å‘å¸ƒå¹¶æ”¶å…¥ Debian è½¯ä»¶æºä¸­ï¼Œç­‰ä¸åŠçš„åŒå­¦å¯ä»¥æŒ‰ç…§è¿™ä¸ªæ­¥éª¤å°è¯•ä¸‹ï¼š</p><ul><li>è·å– Debian ejabberd çš„æºç åŒ…ï¼Œæˆ–è€… git clone å…¶ä»£ç åº“ï¼šgit://git.deb.at/pkg/ejabberd.git</li><li>apt-get build-dep ejabberd å®‰è£…ç¼–è¯‘ ejabberd æ‰€éœ€è¦çš„è½¯ä»¶åŒ…</li><li>aptitude install erlang-nox å®‰è£… erlang è¿è¡Œç¯å¢ƒ</li><li>å®‰è£… <a href=\"https://link.zhihu.com/?target=https%3A//support.process-one.net/doc/display/EXMPP/exmpp%252Bhome\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">exmpp</a> å’Œ <a href=\"https://link.zhihu.com/?target=https%3A//github.com/mikma/esasl\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">esasl</a>ï¼Œæ³¨æ„  esasl é»˜è®¤ make install åä¼šè£…åˆ° /usr/local/lib/erlang ä¸‹ï¼Œéœ€è¦æŠŠå®ƒå¤åˆ¶åˆ°  /usr/lib/erlang çš„å¯¹åº”ç›®å½•é‡Œï¼Œå› ä¸º ejabberd ä¸ä¼šå»æ‰¾ /usr/local/lib/erlang ä¸‹çš„ Erlang  æ¨¡å—ï¼›<br/></li><li>åˆ é™¤æ‰é™¤ debian/ ç›®å½•å¤–çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå°† ejabberd-3.0 ä»£ç ä»å…¶å®˜æ–¹ git åº“æŠ“ä¸‹æ¥å¹¶è¦†ç›–è¿‡å»</li><li>cd src/;  aclocal; autoconf; cd ..</li><li>åˆ é™¤ debian/patches/*ï¼Œæˆ‘æ‡’å¾—æŠŠè¿™äº›è¡¥ä¸ç§»æ¤åˆ° 3.0 ä¸Šäº†ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥æŠ˜è…¾ä¸‹ï¼›<br/></li><li>dpkg-buildpackage -rfakeroot -b -us -uc</li></ul><p>ejabberd  çš„é…ç½®æŒºç®€å•çš„ï¼Œè¯»ä¸€éå®˜æ–¹ Installation and Operation Guide å°±è¡Œäº†ï¼ŒPidgin å¯¹ GSSAPI  è®¤è¯æ”¯æŒå¾ˆå¥½ï¼ŒæŒ‰ç€ <a href=\"https://link.zhihu.com/?target=http%3A//www.ejabberd.im/cyrsasl_gssapi\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">ejabberd.im/cyrsasl_gss</span><span class=\"invisible\">api</span><span class=\"ellipsis\"></span></a> çš„è¯´æ˜é…ç½®ä¸‹æ¥ï¼ˆå…¶å®æˆ‘åªé…ç½®äº†  KRB5_KTNAME ä»¥åŠ sasl_realm å°±è¡Œäº†ï¼‰ï¼ŒPidgin GSSAPI è®¤è¯ä¸€æ¬¡é€šè¿‡ã€‚å¿…éœ€æä¸€ä¸‹çš„æ˜¯ ejabberd çš„  mod_muc_log æ’ä»¶å¯ä»¥æŠŠèŠå¤©å®¤çš„èŠå¤©æ—¥å¿—ä¿å­˜åˆ°æŒ‰æ—¥æœŸå‘½åçš„ HTML æ–‡ä»¶é‡Œï¼Œé¢‡æœ‰ IRC logger çš„æ„Ÿè§‰ã€‚</p><p>ejabberd  çš„å…¶å®ƒåŠŸèƒ½å¦‚ pubsub è¿˜ä¸çŸ¥é“æ€ä¹ˆç”¨ï¼Œä¸ MSNã€ICQã€Yahoo! Messenger  çš„äº’é€šæˆ‘ä¹Ÿæ²¡æŠ˜è…¾ï¼Œå› ä¸ºæˆ‘æœ¬æ¥å°±æƒ³è®©è¿™ä¸ªæœåŠ¡å±€é™åœ¨å…¬å¸å†…éƒ¨ã€‚æ¯”è¾ƒæ»‘ç¨½çš„ä¸€ä»¶äº‹æƒ…æ˜¯ ejabberd è‡ªå¸¦äº†ä¸ª web admin  ç•Œé¢ï¼ŒçœŸæ˜¯ç¨‹åºå‘˜çš„è®¾è®¡æ°´å¹³ï¼Œç®€ç›´å°±å¥½æ¯”å¼€äº†ä¸ª GUI ç¼–è¾‘å™¨è®©ä½ ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œè™šå¼ äº† web admin çš„é—¨é¢ã€‚ã€‚ã€‚ã€‚å¦å¤–åœ¨ Pidgin  é‡Œåˆ›å»ºèŠå¤©å®¤æ—¶ï¼Œæˆ‘æ²¡æå®šæ€ä¹ˆè®© logging é»˜è®¤æ‰“å¼€ï¼Œåœ¨ ejabberd.cfg é‡ŒæŒ‡å®šäº†æ²¡ç”¨ï¼Œè€Œä¸”åˆ›å»ºå®Œåï¼ŒPidgin æ²¡æœ‰ UI  å¯ä»¥é‡æ–°é…ç½®èŠå¤©å®¤ï¼Œä¸çŸ¥é“æ˜¯ Jabber åè®®ä¸æ”¯æŒè¿˜æ˜¯ Pidgin ä¸æ”¯æŒã€‚</p><p>å¦ä¸€ä¸ªç°åœ¨æ´»çš„ä¸é”™çš„å¼€æº Jabber  æœåŠ¡å™¨æ˜¯ä½¿ç”¨ Java ç¼–å†™çš„ Openfireï¼Œå®ƒèƒŒåçš„å…¬å¸è¿˜åšäº†ä¸ª Jabber å®¢æˆ·ç«¯ Spark ä»¥åŠ Jabber åè®®åº“  Smackï¼Œä¸‰ä¸ªæˆ‘éƒ½ç²—ç•¥çš„ç”¨è¿‡ï¼Œç›¸å½“çš„æ˜“ç”¨ï¼ŒOpenfire æœ€ç§°é“çš„æ˜¯å…¶ web admin ç•Œé¢â€”â€”è¿™æ‰èƒ½å«â€œWeb ç®¡ç†ç•Œé¢â€å•Šï¼  ä½†å›¾å½¢é…ç½®ç•Œé¢åšçš„å¥½äº†ï¼Œæ–‡æœ¬é…ç½®æ–‡ä»¶å´æ²¡ä»€ä¹ˆæ–‡æ¡£è§£é‡Šï¼Œä¸æ–¹ä¾¿è‡ªåŠ¨åŒ–é…ç½®ã€‚è€Œä¸” Openfire çš„é›†ç¾¤æ”¯æŒæ˜¯ååŠ çš„ï¼Œæ®è¯´æ²¡ ejabberd  é‚£ä¹ˆ scalable and stableï¼Œå¦å¤–æˆ‘ä¹Ÿæ²¡å‘ç°å®ƒæ€ä¹ˆæŠŠèŠå¤©å®¤æ—¥å¿—è®°å½•åˆ° HTML æ–‡ä»¶é‡Œï¼Œè¿™ä¸ªç‰¹æ€§å¾ˆé‡è¦å•Šã€‚Openfire  å®˜æ–¹æä¾›äº† deb åŒ…ï¼Œä½†æ˜¯æ‰“åŒ…çš„å¤ªç²—ç³™äº†ï¼Œ/etc/init.d/openfire è¿˜æ˜¯ 2001 å¹´çš„ç‰ˆæœ¬ï¼Œé‡Œå¤´åˆ¤æ–­ java  å¯æ‰§è¡Œç¨‹åºè·¯å¾„çš„é€»è¾‘è¿‡æ—¶äº†ï¼Œéœ€è¦æ”¹æ”¹ï¼Œæ—¥å¿—æ–‡ä»¶ä¼Šè¾“å‡ºåˆ° /usr/share/openfire/ é‡Œï¼ŒçœŸæ˜¯è®©äººæ— è¯­ã€‚</p><p>æ‰˜ Java çš„ç¦æ°”ï¼ŒOpenfire çš„ GSSAPI è®¤è¯æ”¯æŒå¾ˆå¥½ï¼Œ<a href=\"https://link.zhihu.com/?target=http%3A//community.igniterealtime.org/docs/DOC-1060\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">community.igniterealtime.org</span><span class=\"invisible\">/docs/DOC-1060</span><span class=\"ellipsis\"></span></a> è¯´æ˜çš„å¾ˆè¯¦ç»†ï¼Œæˆ‘è¯•éªŒäº†ä¸‹ï¼Œä¹Ÿæ˜¯ä¸€æ¬¡é€šè¿‡ã€‚</p><p>æ¯”èµ·å•†ä¸šçš„ä¼ä¸šå†…éƒ¨å³æ—¶é€šè®¯å·¥å…·å¦‚  RTXï¼Œejabberd æ˜¯å¤ªé˜³æ˜¥äº†ï¼Œä¸è¿‡è¦æ±‚ä¸é«˜çš„è¯ä¹Ÿå¾ˆå‡‘åˆç”¨äº†ï¼Œå†åŠ ä¸Šæ˜¯å¼€æºäº§å“ï¼ŒæŠ˜è…¾ä¸‹è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼ˆä¸æ‡‚ Erlang  çš„å…„å¼Ÿå¯ä»¥æŠ˜è…¾ä¸‹ç”¨ Java å†™çš„ Openfireã€‚ã€‚ã€‚)ï¼Œå¼€æ”¾çš„ Jabber åè®®è®©å†™ç‚¹ bot å•¥çš„å®Œå…¨æ˜¯å°èœä¸€ç¢Ÿã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": [
                {
                    "userName": "çŸ¥ä¹ç”¨æˆ·", 
                    "userLink": "https://www.zhihu.com/people/0", 
                    "content": "MSNå•Šã€GTalkå•Šã€Yahoo! Messengerå•Šï¼Œæ—©éƒ½å…³é—¨äº†ï¼Œè¿™æ˜¯å‰å¹´å†™çš„ç¨¿å­å—ï¼Ÿ", 
                    "likes": 0, 
                    "childComments": [
                        {
                            "userName": "çŸ¥ä¹ç”¨æˆ·", 
                            "userLink": "https://www.zhihu.com/people/0", 
                            "content": "å¤§çº¦å…­å¹´å‰å†™çš„ï¼Œæ‰€ä»¥æ ‡é¢˜æœ‰è¿ç§»äºŒå­—ğŸ˜„", 
                            "likes": 0, 
                            "replyToAuthor": "çŸ¥ä¹ç”¨æˆ·"
                        }
                    ]
                }
            ]
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50771850", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "openldap, libnss-ldapd (ç»­)", 
            "content": "<p>ã€è¿ç§»ã€‘openldap, libnss-ldapd (ç»­) </p><p>libnss-ldapd -&gt; nslcd -&gt; slapd çš„è®¤è¯å’Œæˆæƒè¿‡ç¨‹çœŸæ˜¯æ¯”è¾ƒç»•ï¼Œåœ¨ nss-pam-ldapd  é‚®ä»¶åˆ—è¡¨é—®äº†ä¸‹ï¼Œå‡ å¤©äº†éƒ½æ²¡æœ‰å›åº”ã€‚ã€‚ã€‚å¤§è‡´çœ‹äº†ä¸‹ nss-pam-ldapd çš„æºç ï¼Œå‘ç° rebind åªå‘ç”Ÿåœ¨å‘ç”Ÿ referral  çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¬ä¸€ä¸ª slapd æœåŠ¡å™¨çš„æŸä¸ªç›®å½•æ˜¯å§”æ‰˜å¦å¤–ä¸€ä¸ª slapd æœåŠ¡çš„ã€‚libnss-ldapd -&gt; nslcd  -&gt; slapd çš„è®¤è¯å’Œæˆæƒè¿‡ç¨‹çŒœæµ‹å¦‚ä¸‹ï¼š</p><ol><li>ç”¨æˆ·è¿›ç¨‹æ¯”å¦‚ getent passwd è°ƒç”¨ glibc åº“  nss å‡½æ•°ï¼Œæœ€ç»ˆé€šè¿‡ libnss-ldapd åº“å‡½æ•°è¯·æ±‚æœ¬åœ°æœåŠ¡ nslcdï¼Œè¿™ä¸ªé€šè®¯æ˜¯ç”¨çš„ UNIX domain  socketï¼Œnslcd é€šè¿‡è¿™ä¸ª socket å¯ä»¥çŸ¥é“ç”¨æˆ·è¿›ç¨‹çš„ pidã€uidã€gid ä¿¡æ¯ã€‚</li><li>/etc/nslcd.conf  é‡Œé…ç½®äº† sasl_mech GSSAPI è®¤è¯æ–¹å¼ï¼Œæ‰€ä»¥ nslcd å’Œ slapd ä¹‹é—´åˆ©ç”¨ Kerberos åšè®¤è¯ï¼Œnslcd  çš„èº«ä»½ç”± /etc/nslcd.conf é…ç½®çš„ krb5_ccname è·å¾— authentication id (authcid)ï¼Œé»˜è®¤æ˜¯  host@`hostname -f`@REALMã€‚SASL è®¤è¯è¿‡ç¨‹è¿˜ä¼šæŸ¥æ‰¾ nslcd çš„ authorization id  (authzid)ï¼Œå¯ä»¥åœ¨ /etc/nslcd.conf é‡Œé…ç½®ã€‚</li><li>slapd å…è®¸ host@`hostname  -f`@REALM åš sasl bind æˆåŠŸï¼Œnslcd ç«¯çš„ authzid è¦èµ·ä½œç”¨ï¼Œéœ€è¦åœ¨ slapd ä¸€ç«¯é…ç½® DN  &#34;uid=host/gold.corp.example.com,cn=gssapi,cn=auth&#34; çš„ authzFrom å’Œ authzTo  å±æ€§ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æ²¡æœ‰é…ç½®çš„ï¼Œæ‰€ä»¥ host@HOSTNAME é»˜è®¤é…ç½®ä¸‹ç›¸å½“äº LDAP æ™®é€šç”¨æˆ·ï¼Œå¯¹ç›®å½•é¡¹æœ‰è¯»æƒé™ã€‚<br/></li></ol><p class=\"ztext-empty-paragraph\"><br/></p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œlibnss-ldapd  å¹¶æ²¡æœ‰ç”¨ç”¨æˆ·è¿›ç¨‹çš„ krb ticket å‘ nslcd å’Œ slapd åšèº«ä»½è®¤è¯ï¼Œå¯¹äºæœåŠ¡å™¨æ¥è¯´ï¼Œå¯ä»¥è®© nslcd ä½¿ç”¨  host@HOSTNAME krb5 principalï¼Œnslcd æ²¡æœ‰ admin principal çš„è¯æ˜¯æ²¡æ³•ä¿®æ”¹ slapd  é‡Œçš„æ•°æ®çš„ï¼Œåªæ˜¯ slapd æ²¡æ³•ç»†åˆ†ç”¨æˆ·æƒé™äº†(nslcd çš„ authzid  åªèƒ½æ˜¯å›ºå®šçš„ï¼Œä¸èƒ½æ ¹æ®ç”¨æˆ·èº«ä»½å˜åŠ¨)ï¼Œå¯¹äºæ™®é€šç”¨æˆ·æœºå™¨æ¥è¯´ï¼Œå¦‚æœç®¡ç†å‘˜æ²¡æœ‰ç»™é…ç½® host  principal(ä¸€èˆ¬ä¹Ÿä¸å¤§å¯èƒ½è®©ç®¡ç†å‘˜é…ç½®è¿™ä¸ªï¼Œéº»çƒ¦ï¼Œè€Œä¸”ä¸å½’ç®¡ç†å‘˜è´Ÿè´£ï¼‰ï¼Œé‚£ä¹ˆæ™®é€šç”¨æˆ·å¾—é…ç½® nslcd ä½¿ç”¨è‡ªå·±çš„ user  ticketï¼Œè¿™ä¹Ÿæ˜¯æ¯”è¾ƒéº»çƒ¦çš„ã€‚æ¯”è¾ƒæ–¹ä¾¿çš„æ˜¯è®© slapd æ”¯æŒåŒ¿å  bindï¼Œä¹Ÿå°±æ˜¯åŒ¿åè®¤è¯ï¼Œä½†æ˜¯æˆ‘åˆä¸å–œæ¬¢ç½‘ç»œä¸Šçš„è®¿å®¢èƒ½éšéšä¾¿ä¾¿çš„è·å–è´¦æˆ·åˆ—è¡¨ã€‚å®‰å…¨ä¸æ–¹ä¾¿ï¼Œä¸¤éš¾å•Šã€‚</p><p>ç”±äº nslcd ä½¿ç”¨çš„  krb5 principal æ²¡æœ‰ç‰¹æƒï¼Œæ‰€ä»¥å®ƒæ²¡æ³•ä¿®æ”¹ slapd ä¸Šçš„ userPasswordï¼Œä¸è¿‡å› ä¸ºæˆ‘åŸæœ¬å°±æ‰“ç®—å…¨ç”¨ krb5  è®¤è¯ï¼Œå‹æ ¹å°±ä¸è®© slapd ä¿å­˜ç”¨æˆ·å¯†ç æ‘˜è¦ï¼Œæ‰€ä»¥ä¹Ÿæ²¡é—®é¢˜ã€‚å¦ä¸€ä¸ªé—®é¢˜æ˜¯ nslcd æ²¡æœ‰æƒé™ä¿®æ”¹ç”¨æˆ· shellã€gecos  ç­‰ä¿¡æ¯ï¼Œä½†è¿™äº›ä¸€èˆ¬éƒ½ä¸ä¼šä¿®æ”¹ï¼Œä¸æ˜¯ä¸ªå¤§é—®é¢˜ï¼Œè€Œä¸”å…¶å® chsh å‘½ä»¤è²Œä¼¼ä¸è®¤ ldap æˆ–è€…æ˜¯ nss-ldapd ä¸æ”¯æŒ  chshï¼Œè¿™ä¸ªå‘½ä»¤å‹æ ¹å°±ä¸å»æ‰¾ ldapï¼Œå¦‚æœä½  chsh æ”¹ä¸€ä¸ª ldap é‡Œå­˜å‚¨çš„è´¦æˆ·ï¼Œchsh ä¼šæŠ¥å‘Šè¯´åœ¨ /etc/passwd  é‡Œæ‰¾ä¸åˆ°è¿™ä¸ªç”¨æˆ·ï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿåœ¨ nss-pam-ldapd é‚®ä»¶åˆ—è¡¨é‡Œé—®äº†ï¼Œä½†å°šæ— å›ä¿¡ã€‚</p><p>libnss-ldapd  åœ¨é‰´åˆ«ç”¨æˆ·ä¸Šæœ‰ä¸Šè¿°ç¼ºé™·ï¼Œå…¶å‰è¾ˆ  libnss-ldap ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œé…ç½®æ–‡ä»¶é‡Œä¹Ÿæ˜¯å†™æ­»äº† authcid å’Œ authzidï¼Œæˆ‘åŸä»¥ä¸º  libnss-ldap æ²¡æœ‰ç‹¬ç«‹çš„ nslcd æœåŠ¡ï¼Œ ç”¨æˆ·è¿›ç¨‹ç›´æ¥è·Ÿ slapd äº¤äº’ï¼Œå°±å¯ä»¥åœ¨è·Ÿ slapd è®¤è¯æ—¶ç›´æ¥ä½¿ç”¨ user  krb5 ticketï¼Œå®é™…å¹¶éå¦‚æ­¤ï¼Œå¯èƒ½è¿™ä¸¤ä¸ªä¸œè¥¿åœ¨è®¾è®¡ä¹‹åˆå¹¶æ²¡æœ‰è€ƒè™‘åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæˆ–è€…æˆ‘æƒ³å¤æ‚æˆ–æƒ³æ­ªäº†ã€‚</p><p>å…³äº pamã€nss ä¸  slapd çš„é›†æˆï¼Œé™¤äº† nss-pam-ldap å’Œ nss-pam-ldapd å¤–ï¼Œè¿˜æœ‰ä¸€äº›å…¶å®ƒæ–¹æ¡ˆã€‚RedHat åšäº†ä¸€ä¸ª  sssdï¼Œå‰å‡ å¹´å®£ä¼ çš„æ¯”è¾ƒç«ï¼Œç°åœ¨ä¼¼ä¹æ·¡å®šäº†ï¼Œå¼€å‘è¿˜åœ¨ç»§ç»­ï¼Œä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆ Debian  ç¤¾åŒºå¼€å‘è€…æ²¡æœ‰æ”¶å½•ï¼Œä¼¼ä¹å…¶å®ƒå‘è¡Œç‰ˆä»¥åŠå¹¿å¤§ç”¨æˆ·ä¹Ÿæ²¡æ€ä¹ˆé‡‡çº³ï¼Œä¼°è®¡ä¹Ÿè¿˜æ˜¯æœ‰ä¸å°‘é—®é¢˜ã€‚</p><p>sssd  è¦è§£å†³çš„ä¸€ä¸ªé‡å¤§é—®é¢˜æ˜¯ç¦»çº¿æ—¶è´¦æˆ·å¤„ç†é—®é¢˜ï¼Œç”¨è¿‡ Windows çš„åŸŸè´¦æˆ·ï¼ˆMS çš„ domain controller å…¶å®å°±æ˜¯  Kerberos KDCï¼Œdomain å°±æ˜¯ realmï¼Œaccount å°±æ˜¯  principalï¼‰çš„ç”¨æˆ·å°±ä¼šçŸ¥é“ï¼Œåœ¨è¿ä¸ä¸ŠåŸŸæ§åˆ¶å™¨æ—¶ï¼Œç”¨æˆ·ä¾ç„¶å¯ä»¥ä»¥åŸŸè´¦æˆ·èº«ä»½ç™»å½•ç³»ç»Ÿï¼Œè¿™æ˜¯å› ä¸º Windows ç¼“å­˜äº†åŸŸè´¦æˆ·ä¿¡æ¯ã€‚åœ¨  nss-pam-ldap/nss-pam-ldapd/pam-krb5 ä¸­ï¼Œç”¨æˆ·ç™»å½•å‡­è¯(credentialï¼Œå…¸å‹çš„æ˜¯å¯†ç )å¯ä»¥ç”¨  pam-ccreds ç¼“å­˜ï¼Œç”¨æˆ·è´¦æˆ·ä¿¡æ¯(home dir, login shell, uid, gid, groups)  å´æ²¡æœ‰ç¼“å­˜æ–¹æ¡ˆï¼Œnscd å¯ä»¥ä¿®æ”¹é…ç½®é•¿æ—¶é—´ç¼“å­˜æ•°æ®ï¼Œä½†è¿™ä¼šå¯¼è‡´å®ƒé•¿æ—¶é—´ä¸è”ç³» ldap æœåŠ¡å™¨æ›´æ–°ç¼“å­˜ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥ä¿®æ­£ï¼ˆæ¯”å¦‚ nscd  å°è¯•è¿æ¥ ldap æˆåŠŸå°±æ›´æ–°æœ¬åœ°ç¼“å­˜ï¼‰ï¼Œä½†è²Œä¼¼ nscd ç»´æŠ¤è€…æ²¡å…´è¶£è¿™ä¹ˆåšï¼Œæ¯•ç«Ÿæœ¯ä¸šæœ‰ä¸“æ”»ï¼Œä¼Šè®¾è®¡ä¹‹åˆå°±æ²¡è€ƒè™‘ç¦»çº¿åº”ç”¨ã€‚å“ªæ€•æ˜¯  pam-ccredsï¼Œå¦‚æœç”¨æˆ·ä¿¡æ¯æ˜¯å­˜æ”¾åœ¨ ldap é‡Œçš„ï¼Œslapd è¿æ¥ä¸ä¸Šæ—¶ï¼Œlogin æ‰¾ä¸åˆ°ç”¨æˆ·ï¼Œä¾ç„¶ä¸ä¼šå…è®¸ç™»å½•ï¼Œæ‰€ä»¥  nss-pam-ldap/nss-pam-ldapd + kerberos + slapd çš„å•ç‚¹ç™»å½•æ–¹æ¡ˆè¿˜æ˜¯ä¸ç”šç†æƒ³ï¼Œååˆ†ä¾èµ–  kerberos + slapd  éƒ½å¯ä»¥è¿æ¥å¹¶ä¸”å·¥ä½œæ­£å¸¸(slapd çš„ gssapi è®¤è¯éœ€è¦ kerberos æœåŠ¡)ã€‚</p><p>å•ç‚¹æ•…éšœã€ç¦»çº¿åº”ç”¨ï¼Œç—›æ¥šå•Šã€‚ç‰ºç‰²ä¸€ç‚¹åŠæ—¶æ€§ï¼Œè¿˜æ˜¯æœ‰ç»•è¿‡çš„åŠæ³•çš„ï¼Œé‚£å°±æ˜¯  nsscache å’Œ nss-updatedbï¼Œå‰è€…ä¸ä¾èµ– nss-ldap å’Œ nss-ldapdï¼Œè¦é…ç½® ldap è¿æ¥ã€è®¤è¯ç­‰ï¼Œåè€…ä¾èµ–  nss-ldapd/nss-ldapd è·å–ä¿¡æ¯ï¼Œåªæœ‰å½“ ldap æ— æ³•è¿æ¥ä¸Šæ—¶æ‰ä¼šç”¨åˆ°ç¼“å­˜ä¿¡æ¯ï¼Œæ‰€ä»¥ nss-updatedb  åŠæ—¶æ€§æ›´å¥½ã€‚ä¸¤ç§æ–¹æ¡ˆéƒ½éœ€è¦ cron ä»»åŠ¡å®šæœŸæ›´æ–°ç¼“å­˜ã€‚</p><p>pam, nss è¿™å—çœŸé¾Œé¾Šã€‚ã€‚ã€‚ã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50771776", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "openldap, libnss-ldapd", 
            "content": "<p>ã€è¿ç§»ã€‘openldap, libnss-ldapd </p><p>OpenLDAP è¿™ä¸ªè¯é¢˜ææ€•å¾—å†™ä¸¤ç¯‡ï¼Œæˆ‘è¿˜æ²¡æå®š libnss-ldapd  çš„é…ç½®ã€‚ä»¥å‰ä¸€ç›´æ²¡å®é™…ç©è¿‡ç›®å½•æœåŠ¡ï¼Œåˆä¸Šæ‰‹æ„Ÿè§‰éå¸¸åˆ«æ‰­ï¼Œæœ¯è¯­å®Œå…¨ä¸çŸ¥æ‰€äº‘ï¼ŒOpenLDAP æ‰‹å†Œçœ‹äº†ä¸¤éè¿˜ä¸æ˜¯ç‰¹åˆ«æœ‰è°±ã€‚ä¹Ÿè®¸å°†æ¥ä¼šå‘ç°æŠ˜è…¾  OpenLDAP æ˜¯ä¸ªé”™è¯¯ï¼Œå› ä¸ºè¶Šæ¥è¶Šå¤šçš„æœåŠ¡éƒ½æ”¯æŒ SQL å‹æ•°æ®åº“å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€‚ä½†æ— è®ºå¦‚ä½•ï¼ŒKerberos + LDAP  çš„ç»„åˆæ˜¯ä¸ªç»å…¸ä¼ å¥‡ï¼Œå€¼å¾—äº†è§£ï¼Œä¸ç„¶ MS ä¹Ÿä¸ä¼šè´¹åŠ›å§å”§çš„æä¸ª Kerberos + LDAP çš„ç»„åˆæ‹³ Active Directory äº†ã€‚</p><p>è¿™é‡Œå…ˆä»¥æˆ‘ç²—æµ…çš„ç†è§£è¯´ä¸€ä¸‹ç›®å½•æœåŠ¡æ˜¯æ€ä¹ˆå›äº‹ã€‚ç›®å½•æœåŠ¡çœŸçš„æ˜¯åƒä¸€ä¸ªç›®å½•æ ‘ï¼Œåªæ˜¯æ²¡æœ‰æ™®é€šæ–‡ä»¶(å½“ç„¶ä½ ä¹Ÿå¯ä»¥è®¤ä¸ºç©ºçš„ç›®å½•èŠ‚ç‚¹æ˜¯æ™®é€šæ–‡ä»¶èŠ‚ç‚¹ï¼‰ï¼Œæ¯ä¸ªç›®å½•æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªç±»å‹(objectClass)ï¼Œè¡¨æ˜è¿™ä¸ªç›®å½•æœ¬èº«å¯ä»¥æœ‰ä»€ä¹ˆæ ·çš„å…ƒä¿¡æ¯ï¼Œå…ƒä¿¡æ¯æ˜¯ä»¥  key-value å¯¹çš„å½¢å¼ä¿å­˜çš„ã€‚å¦‚åŒ Linux ä¸‹æ–‡ä»¶ç³»ç»Ÿçš„åŠ è½½ç‚¹(mount  point)ï¼Œç›®å½•æœåŠ¡é‡Œçš„ç›®å½•ä¹Ÿæ˜¯å¯ä»¥ç»‘å®šåˆ°ä¸åŒå­˜å‚¨åç«¯çš„ï¼Œæ¯”å¦‚ cn=config ä¿å­˜åˆ° config åç«¯ï¼ˆåœ¨  /etc/ldap/slapd.d ä¸‹çš„ä¼—å¤š LDIF æ–‡ä»¶é‡Œï¼‰ï¼Œdc=corp,dc=example,dc=com å­˜æ”¾åœ¨  /var/lib/ldap ä¸‹çš„  BerkeleyDB æ•°æ®åº“é‡Œã€‚è¿™é‡Œå®¹æ˜“è®©äººè¿·ç³Šçš„æ˜¯ dc= è¿™æ ·çš„ä¸œè¥¿ï¼Œåœ¨ LDAP ä¸­ï¼Œâ€œè·¯å¾„â€æ˜¯ä»¥  DN æ¥æŒ‡ä»£çš„ï¼ŒDistinguished Nameï¼Œdc æ˜¯ domain componentï¼Œè¿˜æœ‰ä¸ª cn æ˜¯ common nameï¼Œou  æ˜¯ orgnization unitï¼Œä¸€ä¸ª DN åŒ…å«å¤šä¸ª ä»¥é€—å·åˆ†å‰²çš„  componentsï¼Œå°±å¥½åƒæ–‡ä»¶è·¯å¾„åŒ…å«å¤šä¸ªæ–œæ åˆ†å‰²çš„ç›®å½•ã€æ–‡ä»¶åã€‚æˆ‘è§‰å¾—å¾ˆä¸æ˜ç™½çš„æ˜¯ä¸ºå•¥è¦å†™ dc=, cn=, ou=  è¿™æ ·çš„ä¸œè¥¿ï¼ŒæŠŠè¿™äº›æ”¾å…¥ key-value å…ƒä¿¡æ¯ä¸æ›´ç®€å•ä¹ˆï¼Ÿ</p><p>LDAP ç›¸æ¯” SQL æ•°æ®åº“ï¼Œä¸ªäººè§‰å¾—å¥½å¤„å¦‚ä¸‹ï¼š</p><ul><li>LDAP ä¸ºè¯»ä¼˜å…ˆè®¾è®¡ï¼Œè¯»å–æ•ˆç‡é«˜ï¼›ï¼ˆæˆ‘æ²¡å®æµ‹è¿‡ï¼‰</li><li>LDAP çš„æ ‘çŠ¶ç»“æ„ç»„ç»‡å±‚æ¬¡ä¿¡æ¯å¾ˆæ–¹ä¾¿ï¼ŒSQL æ•°æ®åº“åˆ™è´¹åŠ›çš„å¤šï¼›</li><li>LDAP çš„æƒé™æ§åˆ¶éå¸¸çµæ´»ï¼›</li></ul><p class=\"ztext-empty-paragraph\"><br/></p><p>LDAP çš„å®ç°æœ‰ä¸¤ä¸ªï¼ŒOpenLDAP å’Œ 389 Directory Service (<a href=\"https://link.zhihu.com/?target=http%3A//directory.fedoraproject.org/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">directory.fedoraproject.org</span><span class=\"invisible\">/</span><span class=\"ellipsis\"></span></a>ï¼Œ389 æ˜¯é»˜è®¤ LDAP ç«¯å£å·ï¼‰ï¼Œåè€…åˆšä»æ°´æœ¨ä¸Šå¬è¯´ï¼Œè²Œä¼¼åæ°”å¾ˆå°ï¼Œç•™ä½œä»¥åç ”ç©¶äº†ã€‚</p><p>OpenLDAP  æœåŠ¡å™¨åœ¨ Debian ä¸Šçš„åŒ…åå« slapdï¼Œä¸ºäº†æ”¯æŒ GSSAPI è®¤è¯ï¼Œè¿˜éœ€è¦ libsasl2-modules-gssapi-mit  è¿™ä¸ªåŒ…ï¼ŒSASL æ˜¯ä¸€ä¸ªå®ç°äº†å¾ˆå¤šè®¤è¯æ–¹å¼çš„å‡½æ•°åº“ï¼Œå…¶ä¸­ä¸€ç§è®¤è¯æ–¹å¼æ˜¯ GSSAPIï¼Œå…¶å®ä¹Ÿå°±æ˜¯ Kerberos v5  äº†ã€‚å®‰è£…æ—¶ä¼šè¯¢é—®æœåŠ¡å™¨åŸŸåï¼Œå¡«å…¥ http://corp.example.comï¼Œè¿™ä¸ªä¼šè½¬æ¢æˆ /var/lib/ldap é‡Œæ•°æ®åº“å¯¹åº”çš„ç›®å½•æ ‘  dc=corp,dc=example,dc=comã€‚å¦å¤–ä¸€ä¸ªé¢„è£…çš„ç›®å½•æ ‘æ˜¯ cn=configï¼Œè¿™ä¸ª slapd çš„é…ç½®ç›®å½•æ ‘ï¼Œå®ƒæ˜¯å¯¹è€ç‰ˆæœ¬  slapd.conf é…ç½®æ–¹å¼çš„æ”¹è¿›ï¼Œä»è€Œæ”¯æŒè¿è¡Œæ—¶ä¿®æ”¹ slapd é…ç½®ã€‚</p><p>éº»çƒ¦çš„åœ°æ–¹åœ¨äº GSSAPI è®¤è¯ï¼Œéœ€è¦é˜…è¯» SASL çš„ç³»ç»Ÿç®¡ç†å‘˜æ‰‹å†Œï¼Œè®¾ç½® /etc/ldap/sasl2/slapd.confã€‚è¿™é‡Œæœ‰ä¸ªå°æ’æ›²ï¼Œå¼€å§‹è¯•éªŒ slapd çš„ Kerberos è®¤è¯çš„æ—¶å€™ï¼Œå®ƒè€æ˜¯å‘Šè¯‰æˆ‘ä¸€ä¸ªè«åçš„é”™è¯¯ä¿¡æ¯ï¼š<br/>    $ ldapwhoami<br/>    SASL/GSSAPI authentication started<br/>    ldap_sasl_interactive_bind_s: Other (e.g., implementation specific) error (80)<br/>             additional info: SASL(-1): generic failure: GSSAPI Error: Unspecified  GSS failure.  Minor code may provide more information (Unknown error)</p><p>åæ¥å‘ç°æ˜¯  slapd è°ƒç”¨ gssapi-mit sasl module é»˜è®¤è¯»å– /etc/krb5.keytabï¼Œå› ä¸º slapd ä¸æ˜¯ä»¥ root  èº«ä»½è¿è¡Œï¼Œå®ƒè¯»ä¸äº†è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥ slapd å°±å¯è€»çš„å¤±è´¥äº†ï¼Œä¼Šçš„é”™è¯¯ä¿¡æ¯å°±åƒæ˜¯å…¥é—¨ C ç¨‹åºå‘˜æ‰“å°çš„æ—¥å¿—ï¼Œå¾ˆ magicï¼Œè€Œ SASL  ä¹Ÿæ²¡æŠ¥å‘Šå•¥æ˜æ˜¾çš„é”™è¯¯ä¿¡æ¯ï¼Œç”±æ­¤å¯è§ä¸€æ–‘è¿™ä¿©çš„ä»£ç è´¨é‡ï¼Œå’³å’³ã€‚ã€‚ã€‚ã€‚äºæ˜¯éœ€è¦è®¾ç½®ä¸‹ï¼Œè®© SASL è¯»æŒ‡å®šçš„ keytab æ–‡ä»¶ï¼ŒSASL  çš„ç³»ç»Ÿç®¡ç†å‘˜æ‰‹å†Œä¸­è¯´ keytab é€‰é¡¹ç›®å‰æ˜¯ä¸æ”¯æŒçš„ï¼Œæˆ‘æŸ¥äº†ä¸‹ï¼Œå…¶å®æ˜¯æ”¯æŒçš„ï¼Œä¸è¿‡æ˜¯ libsasl2-modules-gssapi-mit  è¿™ä¸ªåŒ…çš„ç¼–è¯‘è„šæœ¬æœ‰è¯¯ï¼Œå…·ä½“è§ <a href=\"https://link.zhihu.com/?target=http%3A//bugs.debian.org/cgi-bin/bugreport.cgi%3Fbug%3D651308\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">bugs.debian.org/cgi-bin</span><span class=\"invisible\">/bugreport.cgi?bug=651308</span><span class=\"ellipsis\"></span></a> ã€‚è¿˜å¥½è¿™ä¸ªå¾ˆå®¹æ˜“ç»•è¿‡å»ï¼Œä¿®æ”¹ /etc/default/slapd è®¾ç½®  KRB5_KTNAME ç¯å¢ƒå˜é‡å³å¯ï¼Œå¯æƒœè¿™æ˜¯ä¸ª Debian æ‰“åŒ…çš„æ–‡ä»¶ï¼Œæˆ‘å¾ˆä¸æƒ…æ„¿ä¿®æ”¹å®ƒï¼Œå› ä¸ºåœ¨è½¯ä»¶åŒ…å‡çº§æ—¶è¦ç•™æ„æ‰“åŒ…è€…å¯¹å®ƒçš„ä¿®æ”¹ã€‚</p><p>æˆ‘æ˜¯ä¸ªåæ‰§ç‹‚ï¼Œä¸ºäº†å®‰å…¨èµ·è§ï¼Œæˆ‘å°±å»ä¿®æ”¹  cn=config ç›®å½•å†…å®¹ï¼Œè¯•å›¾è¾¾åˆ°æœ€å¤§çš„å®‰å…¨æ€§ï¼Œå› ä¸ºå¾ˆå¤šå…¶å®ƒæœåŠ¡è¦ä¾èµ– LDAP æœåŠ¡ï¼Œæˆ‘ä¸å¸Œæœ› LDAP æœåŠ¡ IP è¢«æŠ¢å•¥çš„å‡ºç°å‡å†’  LDAP æœåŠ¡ï¼Œæˆ–è€… LDAP ç½‘ç»œä¼ è¾“ä¿¡æ¯è¢«çªƒå¬ï¼Œç»“æœå‘ç° slapd çš„å®‰å…¨ç›¸å…³é€‰é¡¹çš„æ–‡æ¡£ä¸¥é‡ä¸è¶³ï¼Œæˆ‘åŸºæœ¬æ˜¯ç‹‚ç¢ç£¨æ–‡æ¡£ç‹‚å¯¹åŠæµ‹è¯•æ‰æ‰¾å‡ºè®©  slapd ä¸æŠ¥é”™çš„å®‰å…¨è®¾ç½®ã€‚è¿™é‡Œæˆ‘æ•…æ„æ²¡ç”¨ TLS è®¤è¯ï¼Œå› ä¸ºä¼ä¸šè‡ªèº«æ²¡æœ‰ CA èµ„æ ¼ï¼Œæä¸ªè‡ªç­¾åè¯ä¹¦å®¢æˆ·ç«¯éƒ¨ç½²åˆéº»çƒ¦ï¼Œè€Œä¸”è¦è®© TLS  æ”¯æŒå®¢æˆ·ç«¯éªŒè¯çš„è¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿè¦éƒ¨ç½²è‡ªå·±çš„è¯ä¹¦ï¼Œåæ­£å·²ç»æœ‰ Kerberos äº†ï¼Œå†æŠ˜è…¾ TLSã€PKI å°±å¤ªè›‹ç–¼äº†ã€‚åœ¨é…ç½®è¿‡ç¨‹ä¸­å‘ç° SASL  æ— æ³•è¯†åˆ« GSSAPI çš„åŠ å¯†å®‰å…¨å¼ºåº¦ï¼Œç»™æ­»äº†ä¸€ä¸ª ssf å‚æ•° 56ï¼ˆè®¤ä¸º GSSAPI çš„åŠ å¯†å¼ºåº¦æ˜¯ DESï¼Œè€Œå…¶å® Kerberos  ç°åœ¨ä¼˜å…ˆç”¨ AES äº†ï¼‰ï¼ŒSASL å¼€å‘è€…ç»™å‡ºçš„ç†ç”±æ˜¯ GSSAPI è¿˜æ˜¯ Kerberos API  æ²¡æä¾›è·å–åŠ å¯†ç®—æ³•çš„å‡½æ•°ï¼Œä»è€Œæ— æ³•è¯„ä¼°åŠ å¯†å¼ºåº¦ã€‚è¿™ä¸ªé—®é¢˜é¢‡æœ‰å¹´å¤´äº†ï¼Œä»è¿™ä¹Ÿå¯ä»¥çœ‹å‡º Kerberos/GSSAPI/SASL  è¿™ä¸ªç”Ÿæ€åœˆä¸æ˜¯é‚£ä¹ˆå¥åº·ã€‚</p><p>è¿™ä¸ªå®‰å…¨é…ç½®çš„ç»“æœæ˜¯åªå…è®¸ root ç”¨ -Y EXTERNAL -H ldapi:/// æˆ–è€…  Kerberos client ç”¨ -Y GSSAPI -H ldap:/// (æ³¨æ„å‰è€…æ˜¯ ldapi åè€…æ˜¯ ldap)ï¼Œå¹¶ä¸”ç¦æ­¢ SASL  è®¤è¯ç®—æ³•åå•†ï¼ˆå¿…é¡»æ˜¾å¼è®¾ç½® /etc/ldap/ldap.conf çš„ SASL_MECH é€‰é¡¹ï¼Œè¦ä¹ˆæ˜¯åœ¨å‘½ä»¤è¡Œç”¨ -Y  GSSAPIï¼‰ï¼ŒåŸå› æ˜¯è¿™ä¸ªåå•†è¿‡ç¨‹è²Œä¼¼æ˜¯æ˜æ–‡çš„ï¼Œæˆ‘æ²¡ææ˜ç™½æ€ä¹ˆè®© slapd çš„ ssf  è®¾ç½®å…è®¸è¿™ä¸ªé€šä¿¡æ•°æ®å¼€å§‹æ˜¯ä½å®‰å…¨çº§åˆ«ç„¶åæ˜¯é«˜å®‰å…¨çº§åˆ«ã€‚æ‰€å¹¸æˆ‘åªå¸Œæœ›å®ƒç”¨ GSSAPIï¼Œä¹Ÿå°±æ— æ‰€è°“äº†ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯é…ç½® nss  è®©å®ƒæ”¯æŒä» LDAP è·å– /etc/{passwd,group,shadow} ä¿¡æ¯äº†ï¼Œå®é™…ä¸Š LDAP  ä¹Ÿæ”¯æŒç”¨æ¥è®¤è¯çš„ï¼Œnss-pam-ldap å’Œ nss-pam-ldapd æ˜¯ä¸¤ä¸ªå®ç°ï¼Œåè€…æ˜¯å‰è€…çš„æ”¹è¿›ç‰ˆæœ¬ï¼Œä¸¤ä¸ªéƒ½åŒæ—¶æœ‰ pam å’Œ nss  æ¨¡å—ã€‚pam æ¨¡å—æ”¯æŒç”¨ LDAP é‡Œçš„ shadow å¯†ç éªŒè¯ç”¨æˆ·ï¼Œå› ä¸ºå‰é¢å·²ç»é…ç½®äº† libpam-krb5ï¼Œå°±æ²¡å¿…è¦å†ç”¨  pam-ldap/pam-ldapd äº†ï¼Œå›¾å¢å¤šå¤„å­˜å‚¨å¯†ç çš„éº»çƒ¦ä»¥åŠå¯†ç æ³„æ¼çš„é£é™©ã€‚é¡ºå¸¦è¯´ä¸€å¥ï¼ŒMIT Kerberos  æœåŠ¡é»˜è®¤çš„è´¦æˆ·å­˜å‚¨åç«¯æ˜¯ BerkeleyDBï¼Œå®ƒè¿˜æ”¯æŒ LDAP åç«¯ï¼Œæˆ‘æœ¬æ¥æƒ³ç”¨ LDAP  åç«¯ï¼Œä½†è¿™é‡Œæœ‰ä¸ªè›‹ç”Ÿé¸¡ï¼Œé¸¡ç”Ÿè›‹çš„é—®é¢˜ï¼šKerberos å¦‚ä½•çŸ¥é“ LDAP æœåŠ¡æ˜¯çœŸçš„å‘¢ï¼Ÿè¦è¾¾åˆ°è¿™ä¸ªæ•ˆæœï¼Œå…ˆè¦ç”¨ BerkeleyDB  åç«¯ï¼Œé…ç½®å¥½ LDAP çš„ kerberos principalï¼Œå¯¼å‡º keytab æ–‡ä»¶ï¼Œç„¶åæ¢ç”¨ LDAP   åç«¯ã€‚è¿™ä¹ˆææœ‰ç‚¹éº»çƒ¦ï¼Œè€Œä¸”ä¸è®°å¾—é‚£é‡Œçœ‹åˆ°çš„ï¼ŒKerberos å¼€å‘äººå‘˜ä¸æ¨èè¿™æ ·çš„ç”¨æ³•ï¼Œå› ä¸ºå¢åŠ äº† Kerberos  è´¦æˆ·æ•°æ®åº“è¢«æ”»é™·çš„é£é™©ï¼Œè€Œä¸”å› ä¸ºä¾èµ– LDAP æœåŠ¡ï¼ŒKerberos ç³»ç»Ÿå‘ç”Ÿæ•…éšœçš„å¯èƒ½æ€§æ›´å¤§äº†ã€‚</p><p>ä» nss-pam-ldapd ä¸»é¡µä¸Šçœ‹ï¼Œ(<a href=\"https://link.zhihu.com/?target=http%3A//arthurdejong.org/nss-pam-ldapd/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">arthurdejong.org/nss-pa</span><span class=\"invisible\">m-ldapd/</span><span class=\"ellipsis\"></span></a>)  ä¸Šçœ‹ï¼Œè¿™ä¸ªå®ç°æ¯” nss-pam-ldap è¦å¥½ã€‚è£…ä¸Šä¹‹åï¼Œå‘ç°è¿™ä¸œè¥¿æœ‰ç‚¹æŠŠé—®é¢˜æå¤æ‚äº†ï¼ŒåŸæ¥æ˜¯ç”¨æˆ·ç™»å½•ï¼Œlogin è°ƒç”¨  nss-ldapæ¨¡å—ï¼ˆåŒä¸€è¿›ç¨‹ï¼‰ï¼Œå†è®¿é—® slapdï¼Œç°åœ¨æ˜¯ login è°ƒç”¨ nss-ldapdæ¨¡å—ï¼ˆåŒä¸€è¿›ç¨‹ï¼‰ï¼Œå§”æ‰˜æœ¬åœ°çš„ nslcd  (nss-pam-ldapd è‡ªå¸¦ï¼‰å»è®¿é—® slapdï¼Œè¿™å°±å¯¹ slapd åšèº«ä»½é‰´åˆ«é€ æˆéº»çƒ¦äº†ï¼Œé¦–å…ˆï¼Œnslcd éœ€è¦é…ç½® kerberos  principalï¼Œé»˜è®¤æ˜¯ host@`hostname -f`ï¼Œä»¥è®©å…¶è·Ÿ slapd äº’ç›¸è®¤è¯ï¼Œç„¶åå¯èƒ½æ˜¯ nslcd å‘Šè¯‰ slapd  è¯´æˆ‘æ˜¯ userAï¼Œè®© slapd ä»¥ userA èº«ä»½è¿›è¡Œæˆæƒã€‚æˆ‘è¿˜æ²¡ææ˜ç™½ slapd æ€ä¹ˆçŸ¥é“ nslcd å£°ç§° userA  æ˜¯å¦åˆæ³•ï¼Œç½‘ä¸Šæœ‰è¯´æ³•æ˜¯ nslcd è·Ÿ slapd è®¤è¯æˆåŠŸåï¼Œä¼šå†ä»¥ userA èº«ä»½å‘ slapd  è®¤è¯ä¸€æ¬¡ï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯å€’æ²¡æœ‰é—®é¢˜ã€‚ç›®å‰è¿˜åœ¨æ‘¸ç´¢ä¸­ï¼Œåæ–‡å¾…ç»­ã€‚</p><p>BTWï¼Œå®‰è£… libnss-ldapd ä¼šä¿®æ”¹  /etc/nsswitch.conf æ–‡ä»¶ï¼Œè¿™é‡Œé¢ passwd/group/shadow  å¿…é¡»é€‰ä¸­ï¼Œå› ä¸ºä»–ä»¬æ˜¯ç™»å½•å¿…éœ€çš„ï¼Œå…¶å®ƒå¯ä»¥ç¢æƒ…é€‰ç”¨ï¼Œæ¯”å¦‚ ethers å­˜æ”¾ MAC åœ°å€ï¼Œå¯èƒ½èƒ½è®© dhcp server çš„ ldap  åç«¯ä½¿ç”¨ï¼Œnetgroup æ®è¯´å¯ä»¥è®¾ç½®ç»„æƒé™ï¼Œaliases å­˜æ”¾é‚®ä»¶åœ°å€åˆ«åï¼Œè™½ç„¶ MTA é»˜è®¤ä¸ä¼šç”¨å®ƒï¼Œä½†æˆ–è®¸èƒ½é…ç½® MTA è®©å®ƒè¯»å–  LDAP æœåŠ¡ã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50771734", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "dhcp, dns, ntp, kerberos, ssh", 
            "content": "<p>ã€è¿ç§»ã€‘dhcp, dns, ntp, kerberos, ssh</p><p>ä¸€ä¸ªå±€åŸŸç½‘é‡Œå¤´ï¼Œæœºå™¨æ­£å¸¸å¼€æœºæœ€å¯èƒ½å…ˆæ¥è§¦çš„ç½‘ç»œæœåŠ¡åº”è¯¥å°±æ˜¯ DHCP äº†ï¼Œæ‰€ä»¥ä»å®ƒå¼€åˆ€æ˜¯å¾ˆè‡ªç„¶çš„äº†ï¼Œæ­é… FAI è¿˜å¯ä»¥ PXE  å®‰è£…ç³»ç»Ÿï¼Œä¸è¿‡åœ¨å±€åŸŸç½‘é‡Œè¯•éªŒ DHCP å¤ªå®¹æ˜“å†²çªäº†ï¼Œè€Œä¸”çœ‹ isc-dhcp-server æœ‰ä¸ªæ”¯æŒ ldap çš„ç‰ˆæœ¬ï¼Œdhcp è¿˜æœ‰è‡ªåŠ¨æ›´æ–°  dns è®°å½•çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æ”¾åˆ°åé¢å†é¼“æ£ã€‚</p><p>å±€åŸŸç½‘é‡Œæœ‰ä¸ª DNS æœåŠ¡å™¨ä¼šå¾ˆæ–¹ä¾¿ï¼Œä¸ç”¨è®°ä½ IP äº†ï¼Œå¦‚æœè®¾ç½® DNS åŸŸåæ—¶æŠŠç”¨æˆ· ID åŠ ä¸Šå»ï¼Œé‚£å°±æ›´æ–¹ä¾¿ç½‘ç»œçŠ¶æ€åˆ†æäº†ã€‚å¦å¤– Kerberos è¦æ±‚æœåŠ¡æ‰€åœ¨æœºå™¨å¿…éœ€æœ‰ DNS åŸŸåã€‚DNS æœåŠ¡å™¨ç¨‹åºæœ‰å¾ˆå¤šï¼Œ<a href=\"https://link.zhihu.com/?target=http%3A//en.wikipedia.org/wiki/Comparison_of_DNS_server_software\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">en.wikipedia.org/wiki/C</span><span class=\"invisible\">omparison_of_DNS_server_software</span><span class=\"ellipsis\"></span></a>  æœ‰ä¸€ä¸ªå¾ˆèµçš„è¡¨æ ¼å¯¹æ¯”ï¼Œå¯¹äºå°ä¼ä¸šè§„æ¨¡è‡ªç”¨ï¼Œbind9ï¼Œdjbdns, powerdns, dnsmasq, unbound  éƒ½å¾ˆæœ‰æ„æ€ã€‚bind 9 æ˜¯å¸‚åœºä»½é¢æœ€å¤§çš„ DNS æœåŠ¡å™¨ï¼Œå æ® 90% å¤šä»½é¢ã€‚djbdns çš„å®‰å…¨æ–¹é¢å£ç¢‘éå¸¸å¥½ï¼Œå¯æƒœ DJB  å¤§ç¥å·²ç„¶ä¸ç»´æŠ¤è¿™ä¸œè¥¿ï¼Œå®ƒä¸æ”¯æŒ DNSSEC å’Œ IPv6ã€‚PowerDNS æ”¯æŒå¾ˆå¤šå­˜å‚¨åç«¯ï¼Œæœ€å¸å¼•äººçš„æ˜¯ MySQL/PostgreSQL  åç«¯æ”¯æŒäº†ï¼Œ<br/>ä½†ç½‘ä¸Šæœ‰å¤§é‡èˆ†è®ºè¯´è¿™ä¸œè¥¿æ•ˆç‡å…¶å®å¾ˆä½ï¼Œæˆ‘ä¼°è®¡ä¸æ¶ˆè€—å¤§é‡å†…å­˜ç¼“å­˜çš„è¯ï¼Œæ¥ä¸€ä¸ªè¯·æ±‚å°±æ‰§è¡Œä¸€ç³»åˆ— SQL  è¯­å¥ç¡®å®å¾ˆå´©æºƒï¼Œå¯¹äºä¼ä¸šå†…éƒ¨ï¼Œåº”è¯¥è¿˜ä¸è‡³äºåŸŸåå˜æ›´é¢‘ç¹åˆ°éœ€è¦ç”¨æ•°æ®åº“çš„åœ°æ­¥ã€‚dnsmasq å¾ˆé€‚åˆå±€åŸŸç½‘ä½¿ç”¨ï¼Œä¼Šå†…ç½®æ”¯æŒ DHCP å’Œ  TFTPï¼Œä¸è¿‡ä¼Šä¸æ”¯æŒ DNSSECï¼Œä¸æ”¯æŒé€’å½’æŸ¥è¯¢ï¼ˆå®åœ¨æ˜¯ä¸æƒ³å—åˆ¶äº ISP çš„ DNS forwarder å•Šï¼‰ï¼Œè²Œä¼¼æ”¯æŒçš„ DNS  èµ„æºè®°å½•ç±»å‹ä¹Ÿå¾ˆæœ‰é™ï¼Œå½“ç„¶ä¹Ÿä¸æ”¯æŒ masterã€slave æ¨¡å¼äº†ï¼Œä¸ªäººè§‰å¾—å®ƒå¾ˆé€‚åˆç½‘å§ã€åæ¥äººçš„å°ä¼ä¸šã€‚unbound å®Œç¾æ”¯æŒ  IPv6ã€DNSSECï¼Œä¸è¿‡ä¼Šå¯¹æƒå¨è®°å½•æ”¯æŒæœ‰é™ï¼Œä¸æ”¯æŒåŠ¨æ€åŸŸåï¼Œæˆ‘åœ¨è‡ªå·±çš„ PC ä¸Šå°±ç”¨ unboundï¼Œå›¾å®ƒçš„ DNSSEC  æ”¯æŒï¼Œä½ æ‡‚çš„ï¼Œé˜²å°äººã€‚ã€‚ã€‚ã€‚é¡ºå¸¦æä¸€å¥ DNSSECï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒ  <a href=\"https://link.zhihu.com/?target=http%3A//wiki.debian.org/DNSSEC\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">wiki.debian.org/DNSSEC</span><span class=\"invisible\"></span></a>ï¼Œæœ‰ç‚¹ç‚¹è€ï¼Œunbound  ç°åœ¨ä¸ç”¨æ‰‹åŠ¨é…ç½® root trust anchorï¼Œä½†è¿˜æ˜¯å¾ˆæœ‰å‚è€ƒä»·å€¼ï¼Œå°¤å…¶æ˜¯æ•™ä½ å¦‚ä½•è¯†åˆ«ä½ æ˜¯å¦å¤„åœ¨ DNSSEC  ä¿æŠ¤ä¸­ï¼Œå¾ˆæœ‰æ„æ€ã€‚å†é¡ºå¸¦æä¸€å¥ï¼Œè‡ªå·±æœ¬æœºæ­ä¸ª DNS server æ¯”å¦‚ unboundã€bind9ï¼Œå¯ä»¥å±è”½ ISP  çš„åŸŸåé”™è¯¯å¹¿å‘Šé¡µé¢å“¦ã€‚ã€‚ã€‚</p><p>äºæ˜¯é€‰æ‹©äº†ç‰›åˆ€  bind9.  ã€ŠLinux Administration Handbookã€‹çš„  DNS ä¸€ç« éå¸¸ç»™åŠ›ï¼Œçœ‹å®Œåå¯¹ DNS çš„è®¤è¯†æ‹”é«˜äº†åå‡ ä¸ªå°é˜¶ï¼ˆåŸæ¥è®¤è¯†å¤ªå·®äº†ã€‚ã€‚ã€‚ï¼‰ï¼Œé…ç½®äº†ä¸‹  bind9ï¼Œå…¶å®å¾ˆå®¹æ˜“çš„ã€‚æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒæˆ‘æ”¾åœ¨ github ä¸Šçš„é…ç½®æ–‡ä»¶ shell/etc/bind/db.{corp,10}ï¼Œæˆ‘ç”¨çš„  10.x.y.z ç§æœ‰ IP åœ°å€ç©ºé—´ï¼Œhttp://gold.corp.example.com å ç”¨äº† 10.0.0.10ï¼Œå„ä½è¯•éªŒçš„æ—¶å€™å¦‚æœ‰ IP  åœ°å€å·®å¼‚è®°å¾—æ”¹è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚ä¸è¿‡ç”±äºæˆ‘è¿™é‡Œå…¨æ˜¯å•æœºé…ç½®ï¼Œ/etc/hosts å·²ç„¶å¤Ÿç”¨äº†ï¼Œé…ç½® bind9 åªæ˜¯ä¸ºäº†å…¨é¢ç‚¹ï¼Œä»¥åŠä¸ºå…¶å®ƒå®¢æˆ·æœºæœåŠ¡ã€‚</p><p>é…ç½®å¥½ bind9 åä¸è¦å¿˜è®°ä¿®æ”¹ etc/{shorewall,shorewall6}/rules æ‰“å¼€ 53 ç«¯å£ã€‚</p><p>ntp  æœåŠ¡å™¨æ˜¯ kerberos è¿è¡Œæ‰€éœ€è¦çš„ï¼Œå› ä¸º Kerberos åè®®å¯¹æ—¶é—´æ¯”è¾ƒæ•æ„Ÿï¼Œé»˜è®¤é…ç½®ä¸‹æœåŠ¡å™¨å’Œå®¢æˆ·æœºä¸¤è¾¹æ—¶å·®è¶…è¿‡ 5  åˆ†é’Ÿï¼ŒKerberos åè®®ä¼šæ‹’ç»å·¥ä½œã€‚ntp  æœåŠ¡å™¨ç¨‹åºä¹Ÿæœ‰å¥½å‡ ä¸ªï¼Œntpï¼Œopenntpdï¼Œchronyï¼Œç¬¬ä¸€ä¸ªæ˜¯åé—¨æ­£ç»Ÿï¼Œç¬¬äºŒä¸ªå®ç°çš„ç‰¹æ€§ä¸å®Œå…¨ï¼Œå¥½åƒä¸æ”¯æŒä¿®æ­£æ—¶é’Ÿé¢‘ç‡ï¼Œç¬¬ä¸‰ä¸ªé€‚åˆæ¡Œé¢æœºä»¥åŠç¬”è®°æœ¬ç­‰ä¸æ˜¯ç»å¸¸è”ç½‘çš„æœºå™¨ï¼Œä»¥åŠè™šæ‹Ÿæœºè¿™ç§æ—¶å·®æ¼‚ç§»ä¸¥é‡çš„ç¯å¢ƒï¼Œå› ä¸ºåé—¨  ntp å®ç°çš„æœºåˆ¶æ¯”è¾ƒæ…¢è…¾è…¾ï¼Œç¬”è®°æœ¬ç­‰è”ç½‘ã€è¿è¡Œã€å…³æœºè¿™ä¹ˆå‡ ä¸ªå°æ—¶è¿˜ä¸å¤Ÿ ntp æœåŠ¡å™¨åŒæ­¥å®Œæ—¶é—´çš„ï¼ˆntp  æ˜¯é€æ­¥å¾®è°ƒæ—¶é—´çš„ï¼Œé¿å…å› æ—¶é—´è·¨åº¦å¤ªå¤§å½±å“æŸäº›å¯¹æ—¶é—´ç‰¹åˆ«æ•æ„Ÿçš„åº”ç”¨ï¼‰ã€‚Chrony ç‰¹æ„è€ƒè™‘äº†æ¡Œé¢ç”¨æˆ·ï¼ŒAnacron ä¹Ÿæ˜¯ï¼Œæ€ªä¸å¾—æœ€æ–°çš„  Federa 16 æŠŠ  Chrony è®¾ä¸ºé»˜è®¤çš„ NTP æœåŠ¡å™¨ç¨‹åºäº†ï¼š<a href=\"https://link.zhihu.com/?target=https%3A//fedoraproject.org/wiki/Features/ChronyDefaultNTP%23Current_status\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">fedoraproject.org/wiki/</span><span class=\"invisible\">Features/ChronyDefaultNTP#Current_status</span><span class=\"ellipsis\"></span></a></p><p>çœ‹è¿‡ MIT Kerberos ä¸»é¡µä¸Šçš„ç®¡ç†å‘˜å’Œç”¨æˆ·æ‰‹å†Œåï¼Œé…ç½® Kerberos æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯æ˜¯å¾ˆç®€å•çš„äº‹æƒ…ï¼Œæˆ‘å°±ä¸ç½—å—¦é‡å¤äº†ï¼Œå·æ‡’çš„åŒå­¦å¯ä»¥å»çœ‹çœ‹ kerberos.sh è„šæœ¬ï¼Œæˆ–è€…è¿™ç¯‡é€Ÿæˆæ•™ç¨‹ï¼š<a href=\"https://link.zhihu.com/?target=http%3A//techpubs.spinlocksolutions.com/dklar/kerberos.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">techpubs.spinlocksolutions.com</span><span class=\"invisible\">/dklar/kerberos.html</span><span class=\"ellipsis\"></span></a>  ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ Kerberos æœåŠ¡å™¨åœ¨å¯»æ‰¾ service principal æ—¶æ˜¯æŒ‰ç…§å®¢æˆ·ç«¯è¿æ¥çš„æœåŠ¡ç«¯ IP  åœ°å€åå‘è§£æåŸŸååˆ¤æ–­çš„ï¼Œæ¯”å¦‚ä½ ç”¨ ssh localhost æˆ–è€… ssh 127.0.0.1ï¼Œé‚£ä¹ˆ æ”¯æŒ kerberos çš„ ssh  æœåŠ¡å™¨ä¼šå»æ‰¾  host@localhostï¼Œè€Œä¸æ˜¯æˆ‘æœŸæœ›çš„ host@gold.corp.example.comï¼Œå› ä¸ºæ‰¾ä¸åˆ°è¿™ä¸ª  principal è€ŒæœåŠ¡ç«¯æŠ¥é”™ã€‚</p><p>é…ç½®å®Œ Kerberos åï¼ŒåŒæ ·ä¹Ÿä¸è¦å¿˜è®°ä¿®æ”¹ Shorewall  é…ç½®æ–‡ä»¶å¼€æ”¾ç«¯å£ï¼ŒKerberos è¿™å®å¼€çš„ç«¯å£æ¯”è¾ƒå¤šã€‚å®¢æˆ·æœºæä¸ºå®¹æ˜“é…ç½®ï¼ŒæŠŠ libpam-krb5 å’Œ krb5-user  è£…ä¸Šå°±æå®šï¼Œæœ€å¥½ä¹ŸæŠŠ libpam-ccreds è£…ä¸Šï¼Œè¿™ä¸ªæ¨¡å—ä¼šç¼“å­˜è®¤è¯ä¿¡æ¯ï¼Œä¸‡ä¸€ kerberos æœåŠ¡æŒ‚äº†ï¼Œæˆ‘ä»¬è¿˜æ˜¯æœ‰æœºä¼šç™»å½•æˆåŠŸã€‚</p><p>æ¥ä¸‹æ¥é…ç½®  ssh serverï¼Œå¦åˆ™è¦æ˜¯åœ¨çœŸæœºä¸Šï¼Œæˆ‘å°±å¾—ä¸€ç›´è¶´æœºæˆ¿é‡Œæ“ä½œäº†ã€‚è‡ªç„¶ï¼Œssh server å®ç°ä¹Ÿé¢‡æœ‰ä¸€äº›ï¼Œdropbear  åˆé€‚åµŒå…¥å¼ç³»ç»Ÿï¼Œlsh-server æ˜¯ GNU å‡ºå“ï¼Œæ®è¯´ç»´æŠ¤ä¸æ˜¯å¾ˆæ´»è·ƒï¼Œå‰©ä¸‹çš„è‡ªç„¶æ˜¯å¦‚æ—¥ä¸­å¤©çš„ openssh-server  äº†ï¼Œå¯æƒœè¿™ç©æ„æœ€è¿‘å‡ å¹´ä¹Ÿé¢‘ç¹æŠ¥å‘Šå®‰å…¨æ¼æ´ï¼Œ<a href=\"https://link.zhihu.com/?target=http%3A//solidot.org\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">solidot.org</span><span class=\"invisible\"></span></a> éƒ½æœ‰æ–°é—»è¯´ cracker æ”»ç ´ç³»ç»Ÿåç¬¬ä¸€ä»¶äº‹å°±æ˜¯å‡çº§ opensshã€‚ã€‚ã€‚ã€‚</p><p>Debian  Wheezy é‡Œçš„ openssh è£…å®Œåéœ€è¦é…ç½®æ‰èƒ½å¼€å¯ Kerberos æ”¯æŒã€‚/etc/ssh/sshd_config é‡Œï¼ŒæŠŠ  PasswordAuthentication å’Œ ChallengeResponseAuthentication éƒ½è®¾ç½®æˆ  noï¼Œå› ä¸ºæˆ‘ä»¬ä¸ç›´æ¥ç”¨ pam_unix çš„å¯†ç è®¤è¯ï¼Œä¹Ÿä¸ç”¨ S/KEYã€OPIE  ä¹‹ç±»çš„ä¸€æ¬¡ä¸€å¯†è®¤è¯æ–¹æ¡ˆï¼Œå¼€ç€å®ƒä»¬æœ‰é£é™©ã€‚KerberosAuthentication ä¹Ÿè¦æ˜¯ noï¼Œè¿™ä¸ªé€‰é¡¹çš„æ„æ€æ˜¯ ssh client  æŠŠå¯†ç ä¼ ç»™ ssh serverï¼Œssh server ä½œä¸º kerberos client å‘ kerberos server  è®¤è¯ï¼Œè¿™ä¸ªå¯†ç ä¼ è¾“æ˜¾ç„¶å¤ªä¸é è°±ã€‚GSSAPIAuthentication è®¾ç½®æˆ yes å°±èƒ½æ”¯æŒ kerberos v5 è®¤è¯äº†ï¼ŒGSSAPI  æœ¬æ¥æ˜¯æƒ³è®¾è®¡ä¸ºé€šç”¨å®‰å…¨æ¥å£çš„ï¼Œä¸è¿‡å®‰å…¨ç•Œå¥½åƒä¸æ€ä¹ˆé¸Ÿå®ƒï¼Œæçš„å®ƒæˆäº† Kerberos v5 çš„ä»£åè¯ã€‚<br/>æœ€åï¼ŒUsePAM è®¾ç½®æˆ yesï¼Œå› ä¸º pam çš„ account å’Œ session æ£€æŸ¥è¿˜æ˜¯éœ€è¦çš„ã€‚</p><p>åœ¨  kerberos æœåŠ¡ç«¯è®¾ç½®å¥½ host@gold.corp.example.com è¿™ä¸ª service principal å¹¶æŠŠå…¶åŠ å…¥  /etc/krb5.keytab åï¼Œå°±å¯ä»¥è¯•è¯• kinit å† ssh http://gold.corp.example.comï¼Œä¸è¦ç”¨ ssh  localhostï¼ŒåŸå› åœ¨ä¸Šé¢è¯´äº†ã€‚SSO çš„ç¬¬ä¸€ä¸ªæ— å¯†ç ç™»å½•æœåŠ¡å°±è¯ç”Ÿäº†ï¼</p><p>ç”±äº kerberos ticket è¿‡æœŸåè¦é‡æ–°  kinit ç”³è¯·ï¼Œå¯èƒ½ä¼šè§‰å¾—æœ‰ç‚¹éº»çƒ¦ï¼Œå¦å¤–ä¸ºäº†é¿å… kerberos æœåŠ¡æŒ‚æ‰æ— æ³•ç™»å½•ï¼Œå¯ä»¥ç”¨ ssh-keygen ç”Ÿæˆä¸€å¯¹å…¬é’¥ã€ç§é’¥ï¼Œé…ç½®å¥½  ssh server çš„å…¬é’¥è®¤è¯ï¼Œç»™è‡ªå·±ç•™æ¡åè·¯ï¼Œçœçš„å‡ºé—®é¢˜äº†å°±è¦è¶´æœºæˆ¿çƒ­èº«ã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50771604", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "æœåŠ¡é…ç½®æµ‹è¯•ç¯å¢ƒï¼Œlocale, etckeeperï¼Œshorewall", 
            "content": "<p>ã€è¿ç§»ã€‘æœåŠ¡é…ç½®æµ‹è¯•ç¯å¢ƒï¼Œlocale, etckeeperï¼Œshorewall</p><p>é…ç½®æœåŠ¡éœ€è¦ä¸€ä¸ªç¯å¢ƒåå¤å®‰è£…æµ‹è¯•ï¼Œç”¨è™šæ‹Ÿæœºå’Œ chroot éƒ½æ˜¯å¾ˆæ–¹ä¾¿çš„æ³•å­ï¼ŒLinux çš„ container  æ”¯æŒçœ‹èµ·æ¥ä¸é”™ï¼Œä¸è¿‡è¿˜ä¸ä¼šç”¨ã€‚Debian æ‰“åŒ…äº†ä¸€ä¸ª multistrap ç¨‹åºï¼Œå¯ä»¥ç”¨æ¥å¿«é€Ÿå»ºç«‹ä¸€ä¸ª Debian chroot  ç¯å¢ƒï¼Œä½¿ç”¨å¾ˆç®€å•ï¼Œå®ƒè¿˜æœ‰ä¸ªè®¾è®¡ç†å¿µä¸æˆ‘å¿ƒé¢‡æœ‰æˆšæˆšç„‰ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">$ man multistrap\n...\nState\n       multistrap is stateless - if the directory exists, it will simply proceed as normal and\napt will try to pick up where it left off.\n</code></pre></div><p>è¿™ä¸å°±æ˜¯å®ç°äº†ä¸€ä¸ªç¨³å®šçŠ¶æ€ä¹ˆ:-)</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ä¸ºäº†å†çœç‚¹äº‹ï¼Œæˆ‘å†™ä¸ªå‡ è¡Œè„šæœ¬å°è£…äº†ä¸‹ multistrapï¼Œè®©å®ƒè‡ªåŠ¨ mount å¿…éœ€çš„ä¸€äº›æ–‡ä»¶ç³»ç»Ÿå¦‚ /proc, /sysï¼Œè„šæœ¬æ”¾åœ¨ <a href=\"https://link.zhihu.com/?target=https%3A//github.com/Dieken/jff/tree/master/sysadmin\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">github.com/Dieken/jff/t</span><span class=\"invisible\">ree/master/sysadmin</span><span class=\"ellipsis\"></span></a>ï¼Œä½¿ç”¨åŠæ³•ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">$ ./bootstrap-wheezy.sh /path/to/wheezy/chroot/root</code></pre></div><p>è¿™ä¸ªå‘½ä»¤è‡ªç„¶ä¹Ÿæ˜¯å¯ä»¥åœ¨ä¸€æ¬¡ä¼šè¯é‡Œé‡å¤è°ƒç”¨çš„:-)   æœ‰å…´è¶£å°è¯•è¿™ä¸ªæ¥æ­å»ºç¯å¢ƒçš„åŒå­¦ï¼Œæ³¨æ„æ£€æŸ¥ multistrap-wheezy.conf é‡Œçš„ arch é€‰é¡¹æ˜¯ä¸æ˜¯è¦æ”¹æˆ amd64ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ç”±äºè¿™ä¸ª chroot æ²¡æœ‰å»ºç«‹è™šæ‹Ÿç½‘ç»œæ¥å£ï¼Œæ‰€ä»¥ chroot å†…å¤–çš„æœåŠ¡å…±ç”¨ç½‘ç»œç«¯å£åŒºé—´ï¼Œåé¢è¯•éªŒæœåŠ¡æ­å»ºæ—¶è¦å°å¿ƒï¼Œæ¯”å¦‚ä¸è¦å†…å¤–éƒ½åŒæ—¶å¯åŠ¨ ssh server å’Œ dns serverã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä¼šæŠŠæ‰€æœ‰æœåŠ¡éƒ½æ”¾åœ¨ä¸€å°æœºå™¨ä¸Šï¼Œè¿™å°æœºå™¨çš„ä¸»æœºåæ˜¯ goldï¼Œå†…éƒ¨ç½‘ç»œçš„åŸŸåæ˜¯ http://corp.example.comã€‚è¯•éªŒçš„æ—¶å€™å¯ä»¥ç”¨ &#34;hostname gold&#34; ä¸´æ—¶æŠŠä¸»æœºåä¿®æ”¹æˆ gold. å¦å¤–æ£€æŸ¥ chroot é‡Œçš„ /etc/hostname åªåŒ…å« goldï¼Œ/etc/hosts æœ‰è¿™æ ·ä¸€è¡Œï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">127.0.1.1   gold.corp.example.com gold kerberos.corp.example.com kerberos krb ldap.corp.example.com ldap www.corp.example.com www corp.example.com\n</code></pre></div><p>è¿™ä¸ªè®¾ç½®çš„ç”¨æ„æ˜¯å°½é‡ä¸ä¾èµ– DNS serverï¼Œä»¥å… DNS server å¤±è´¥æ—¶ï¼Œè¿™å°æœåŠ¡å™¨ä¸Šçš„æœåŠ¡è§£æåˆ°å¤–éƒ¨æœºå™¨å‡ºç°å®‰å…¨é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æé«˜åŸŸåè§£æé€Ÿåº¦ï¼Œæ¯•ç«Ÿæ‰€æœ‰æœåŠ¡éƒ½åœ¨ä¸€å°æœºå™¨ä¸Šã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>æ¥ä¸‹æ¥ç»™è¿™ä¸ªæµ‹è¯•æœåŠ¡å™¨ç¯å¢ƒåšäº›åŸºæœ¬è®¾ç½®ï¼Œè¿™äº›è®¾ç½®æˆ‘å·²ç»å†™æˆè„šæœ¬ï¼Œæ”¾åœ¨ <a href=\"https://link.zhihu.com/?target=https%3A//github.com/Dieken/jff/tree/master/sysadmin/shell\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">github.com/Dieken/jff/t</span><span class=\"invisible\">ree/master/sysadmin/shell</span><span class=\"ellipsis\"></span></a>  ä¸‹ï¼Œå…¶ä¸­ run.sh æ˜¯ä¸ªæ±‡æ€»çš„è„šæœ¬ï¼Œå…¶å®ƒ .sh è„šæœ¬é™¤äº† lib.sh  éƒ½æ˜¯å¯ä»¥ç›´æ¥æ‰§è¡Œçš„ï¼Œå½“ç„¶å®ƒä»¬ä¹‹é—´æœ‰ä¾èµ–é¡ºåºï¼Œè¿™ä¸ªé¡ºåºè®°å½•åœ¨  run.sh ä¸­ï¼Œéå¸¸ç²—ç³™ï¼Œå•çº¿ç¨‹çš„é¡ºåºæ‰§è¡Œï¼Œæ‰€å¹¸é™¤äº† apitude update/installï¼Œå®ƒæ‰§è¡Œçš„è¿˜å¾ˆå¿«ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>(1) localeï¼Œæˆ‘é€‰æ‹©ç³»ç»Ÿé»˜è®¤ locale æ˜¯ en_US.UTF-8ï¼Œé€‰æ‹© UTF-8 æ²¡å•¥å¥½è¯´çš„ï¼ŒLinux ä¸‹çš„ä¸»æµï¼Œé€‰æ‹©  en_US è€Œé zh_CN æ˜¯é¿å…ä¸€äº›å‘½ä»¤è¡Œå·¥å…·è¾“å‡ºä¸­æ–‡ä¿¡æ¯ï¼Œå¹²æ‰°è‡ªåŠ¨é…ç½®è„šæœ¬è§£æå…¶å®ƒç¨‹åºçš„è¾“å‡ºã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>(2)  etckeeperï¼Œè¿™æ˜¯ä¸ªå°† /etc çº³å…¥ GIT ç‰ˆæœ¬æ§åˆ¶çš„æ–¹ä¾¿å·¥å…·ï¼Œè£…å®Œåæ— éœ€é…ç½®ï¼Œæœ‰  cron ä»»åŠ¡ä»¥åŠ apt hook è‡ªåŠ¨è°ƒç”¨  etckeeperï¼Œä½ èƒ½å¾ˆå®¹æ˜“çœ‹åˆ° /etc çš„å˜è¿æƒ…å†µï¼Œç”¨ etckeeper vcs CMD OPTIONS å¯ä»¥ç›´æ¥è°ƒç”¨åº•å±‚ VCS  å·¥å…·ã€‚å¼ºçƒˆæ¨èæ¡Œé¢ç”¨æˆ·ä¹Ÿç”¨ç”¨è¿™ä¸ªå·¥å…·ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>(3) firewallï¼Œæˆ‘é€‰æ‹©äº†è€å°‘å’¸å®œå±…å®¶å¿…å¤‡çš„ Shorewall (<a href=\"https://link.zhihu.com/?target=http%3A//shorewall.net/GettingStarted.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">shorewall.net/GettingSt</span><span class=\"invisible\">arted.html</span><span class=\"ellipsis\"></span></a>)ï¼Œæˆ‘åœ¨ä¸ªäºº  PC ä¸Šä¹Ÿå®‰è£…è¿™ä¸ªï¼Œéå¸¸å®¹æ˜“ä½¿ç”¨ï¼Œå…¶æ–°ç‰ˆæœ¬æ”¯æŒ Universal é…ç½®ï¼Œå¯¹äºå•ç‹¬ä¸»æœºçš„ä¿æŠ¤ï¼Œé…ç½®èµ·æ¥å°¤ä¸ºæ–¹ä¾¿ï¼Œæˆ‘ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªåŸå› é€‰æ‹©ä»¥  Debian testing ä½œä¸ºåŸºç¡€åšè¯•éªŒï¼ŒDebian stable ä¸­çš„ shorewall åŒ…ä¸æ”¯æŒè¿™ä¸ªç‰¹æ€§ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>ç®€å•æ¥è¯´ï¼Œshorewall  å°è£… iptables æä¾›äº†é«˜çº§æŠ½è±¡ï¼Œè®©é˜²ç«å¢™é…ç½®æ›´ç®€å•æ›´ä¸å®¹æ˜“å‡ºé”™ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¸“ä¸šäººå£«æ‰“é€ çš„ï¼Œæˆ‘ç­‰æ‹¿æ¥å°±ç”¨å¥½äº†ã€‚Shorewall  åˆ†æˆä¸‰éƒ¨åˆ†ï¼šshorewall-init, shorewall,  shorewall6ï¼Œç¬¬ä¸€ä¸ªæä¾›äº†åœ¨ç½‘å¡é…ç½®è¿‡ç¨‹ä¸­çš„ä¿æŠ¤ï¼Œåä¸¤ä¸ªæ˜¯çœŸæ­£çš„é˜²ç«å¢™è®¾ç½®ç¨‹åºã€‚å®‰è£…è¿‡ç¨‹å¾ˆç®€å•ï¼Œå¤åˆ¶ä¸‹ Universal  æ ·ä¾‹é…ç½®æ–‡ä»¶åˆ° /etc/shorewall, /etc/shorewall6ï¼Œåœ¨ /etc/default ä¸‹ä¿®æ”¹  shorewall-init, shorewall, shorwall6 å¯åŠ¨å®ƒä»¬ï¼Œé¢å¤–çš„ä¸€ç‚¹ä¿®æ”¹æ¶‰åŠæ—¥å¿—è®¾ç½®ï¼Œè¿™ä¸ªåœ¨  /usr/share/doc/shorewall/README.Debian.gz  ä¸­æœ‰è¯´æ˜ã€‚å½“ä½ èŠ±ä¸ªååˆ†é’Ÿé…ç½®è¿‡ä¸€æ¬¡åï¼Œä»¥åå†é…ç½®ä¹Ÿå°±æ˜¯ç§’ç§’ä¸­çš„äº‹æƒ…ï¼Œç„¶åä½ å°±å¯ä»¥è§‚æ‘©ä¸‹ sudo iptables -L  çš„è¾“å‡ºäº†ã€‚å¯¹ç«¯å£çš„æ‰“å¼€å…³é—­å¯ä»¥åœ¨ /etc/shorewall*/rules ä¸­è®¾ç½®ã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50771542", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "Debianã€ç³»ç»Ÿé…ç½®ç®¡ç†å·¥å…·", 
            "content": "<p>ã€è¿ç§»ã€‘Debianã€ç³»ç»Ÿé…ç½®ç®¡ç†å·¥å…·</p><p>ä½œä¸º Debian çˆ±å¥½è€…ï¼Œé€‰æ‹©ä¸€ä¸ª OS é…ç½®æœåŠ¡ï¼Œè‡ªç„¶é€‰æ‹© Debian Linux äº†ã€‚å°±æˆ‘æ‰€çŸ¥ï¼ŒDebian æ˜¯ç¤¾åŒº Linux å‘è¡Œç‰ˆä¸­ç®¡ç†æœ€ä¸ºæœ‰æ¡ç†æœ€ä¸ºè§„èŒƒçš„ï¼Œè½¯ä»¶åŒ…ä¿¡æ¯é¡µé¢ <a href=\"https://link.zhihu.com/?target=http%3A//packages.debian.org/sid/vim-nox\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">packages.debian.org/sid</span><span class=\"invisible\">/vim-nox</span><span class=\"ellipsis\"></span></a> å¾ˆè§„æ•´ï¼Œå³è¾¹ Bug Reports å’Œ Developer Information æ˜¯æˆ‘åœ¨è¿™ä¸ªé¡µé¢æœ€å–œæ¬¢çš„é“¾æ¥ï¼Œå¦å¤–é€éœ²ä¸€ä¸ªå°æŠ€å·§ï¼Œç”¨ dget å‘½ä»¤ä¸‹è½½é¡µé¢å³è¾¹çš„ .dsc æ–‡ä»¶é“¾æ¥ï¼Œå¯ä»¥å¿«é€Ÿçš„ä¸‹è½½å¯¹åº”çš„ Debian æºç åŒ…ã€‚å¼€å‘è€…ä¿¡æ¯é¡µé¢ <a href=\"https://link.zhihu.com/?target=http%3A//packages.qa.debian.org/v/vim.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">packages.qa.debian.org/</span><span class=\"invisible\">v/vim.html</span><span class=\"ellipsis\"></span></a> åˆ—å‡ºäº†æ‰“åŒ…å¼€å‘è¿‡ç¨‹çš„é‡è¦ä¿¡æ¯ï¼Œæˆ‘å°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ï¼Œå„ä½çœ‹å®¢å¯ä»¥æ…¢æ…¢æµè§ˆã€‚æˆ‘æ—¶å¸¸æ„Ÿå¹ä¸€ä¸ªæ¾æ•£çš„ Debian ç»„ç»‡ï¼Œèƒ½æŠŠå¼€å‘è¿‡ç¨‹æ•´ç†çš„å¦‚æ­¤è§„æ•´ï¼Œé€æ˜ï¼Œå¯Œå«ä¿¡æ¯é‡ï¼Œæ¯”æ— æ•°å•†ä¸šå…¬å¸éƒ½å¼ºäº†ä¸€ä¸ªæ•°é‡çº§ã€‚</p><p>é¼“å¹å®Œ  Debian  åï¼Œå†èŠèŠç³»ç»Ÿé…ç½®ç®¡ç†å·¥å…·ã€‚ä¸ºäº†è®©é…ç½®å¯é‡å¤ï¼Œå¯å¿«é€Ÿé‡å¤ï¼Œç²¾å‡†é‡å¤ï¼Œç¬¬ä¸€è¦ä¹‰æ˜¯æŠŠé…ç½®è¿‡ç¨‹è„šæœ¬åŒ–ï¼Œä»¥æ­¤æ€æƒ³æå‡ä¸€çº§ï¼ŒæŠŠå„ç§é…ç½®ä»»åŠ¡ã€èµ„æºæŠ½è±¡å‡ºæ¥ï¼Œå½¢æˆä¸€ä¸ªä»£ç åº“å’Œé©±åŠ¨ç¨‹åºï¼ŒåŠ ä¸Šç”¨æˆ·è‡ªå®šä¹‰è§„åˆ™ï¼Œç¼–å†™å‡ºç®€ç»ƒå¯ç§»æ¤çš„ç®¡ç†è‡ªåŠ¨åŒ–è„šæœ¬ï¼Œè¿™ç§æ€è·¯å‚¬ç”Ÿäº†å¤§é‡ç³»ç»Ÿé…ç½®ç®¡ç†å·¥å…·ã€‚è¿™æ–¹é¢æ¯”è¾ƒå‡ºåçš„æœ‰  cfengine å’Œ puppetã€‚æˆ‘æµ…æµ…å°è¯•äº†ä¸‹ cfengine æœ€æ–°æ”¹å†™ç‰ˆ cfengine 3 å’Œ  puppetï¼Œæ„Ÿè§‰éƒ½ä¸å¤§å¥½ã€‚cfengine3 çš„ bug  ç°åœ¨è¿˜æ¯”è¾ƒå¤šï¼Œè€Œæœ€éƒé—·çš„æ˜¯è¿™ä¸œè¥¿ç¨å¾®ä¸€ç‚¹é«˜çº§åŠŸèƒ½å°±æ”¾åœ¨æ”¶è´¹ç‰ˆæœ¬é‡Œï¼Œè®©æˆ‘éå¸¸æ¼ç«ï¼Œå¼€æºç‰ˆæœ¬éå¸¸é¸¡è‚‹ï¼Œå¦å¤–æˆ‘ä¹Ÿå¾ˆæ‹…å¿ƒ cfengine  çš„é™åˆ¶ç‰ˆç¼–ç¨‹åŠŸèƒ½ä¸å¤Ÿçµæ´»ï¼Œå®ç°å¤æ‚é€»è¾‘å¤ªè´¹åŠ›ï¼Œç»å¸¸éœ€è¦è°ƒç”¨å¤–éƒ¨è„šæœ¬ã€‚æ‰€è°“ç‰›åˆ€å¯æ€é¸¡ï¼Œé¸¡åˆ€ä¸å¯å± ç‰›ï¼Œå¦‚æœä¸€å®šè¦æˆ‘é€‰æ‹©ï¼Œè¿˜æ˜¯ç»™æˆ‘ç‰›åˆ€å§ã€‚ã€‚ã€‚ã€‚puppet   çš„å¼€æºåšçš„ä¸é”™ï¼Œæ–‡æ¡£ã€ç¤¾åŒºã€è§„åˆ™åº“éƒ½å‘å±•çš„ç›¸å½“å¥½ï¼Œæˆ‘æŠŠå…¶æ‰‹å†Œæ‰“å°å‡ºæ¥å¥½å¥½æ‹œè¯»äº†ä¸€ç•ªï¼Œä½†åœ¨è·Œè·Œæ’æ’å­¦ä¹ äº†ä¹‹åï¼Œæˆ‘ä¹ŸåŒæ ·è§‰å¾—å¾ˆéƒé—·ã€‚è¿™æ˜¯æˆ‘ä¹‹å‰åœ¨æ°´æœ¨ç¤¾åŒºå‘çš„ä¸€ç‰‡æŠ±æ€¨æ–‡ï¼š<br/><a href=\"https://link.zhihu.com/?target=http%3A//www.newsmth.net/nForum/article/LinuxApp/819076\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">newsmth.net/nForum/arti</span><span class=\"invisible\">cle/LinuxApp/819076</span><span class=\"ellipsis\"></span></a></p><p>â€œä¾èµ–å¤ªå¤šäº†ï¼Œè¯­æ³•ä¸æ–­æ‰©å±•å·²ç„¶åŸºæœ¬æ˜¯æ–°çš„ç¼–ç¨‹è¯­è¨€äº†â€ï¼Œ</p><p>â€œpuppet master æœ€é˜³æ˜¥çš„æ˜¯ç”¨ webbrickï¼Œæ–‡æ¡£è¯´è¿™ä¸ªæ€§èƒ½å¾ˆå·®ï¼Œæ¨è <br/> ç”¨ mongrel ç”šè‡³æ›´å¥½çš„ mod_passengerï¼Œå‰è€…éœ€è¦ä¸€ä¸ª web serverï¼Œ <br/> åš proxy å› ä¸º mongrel ä¸æ”¯æŒ sslï¼Œåè€…éœ€è¦ apacheã€‚ <br/> <br/> puppet master ä¼¼ä¹åŒ…å«äº†ä¸€ä¸ª rails åº”ç”¨ï¼Œæ‰€ä»¥ä¾èµ–äº† railsã€‚ <br/> æ“ä½œæ–‡ä»¶å†…å®¹ä¾èµ–äº†augeas åº“ï¼Œpuppet agent å‘  puppet master <br/> æ±‡æŠ¥æ—¶ï¼Œä¸ºäº†æé«˜ puppet master å“åº”èƒ½åŠ›ï¼Œè¿™ä¸ª report è¢«å¼‚æ­¥ <br/> å¤„ç†ï¼Œä¾èµ– stompserverã€‚ <br/> <br/> storeconfigs ç‰¹æ€§éœ€è¦ puppet master ç”¨ä¸€ä¸ªæ•°æ®åº“ï¼Œé˜³æ˜¥çš„æ˜¯ <br/> sqlite3ï¼Œé«˜ç«¯ç‚¹è¦ç”¨ mysqlã€postgresqlã€‚ <br/> <br/> å¦‚æœç”¨é¢„ç¼–è¯‘é…ç½®çš„åŠæ³•ï¼Œéœ€è¦ memcachedã€‚ <br/> <br/> æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°è¿™ä¸€å¤§å †ä¾èµ–æœ‰ç‚¹ææ€–å§ã€‚ <br/> <br/> æ€§èƒ½å·®å¯èƒ½æ˜¯ ruby è§£é‡Šå™¨å¤ªæ…¢ã€èµ° http åè®®çš„ç¼˜æ•…ã€‚å¦å¤–é…ç½®çš„ <br/> ç”Ÿæˆï¼ˆä¸æ˜¯è¯´æ‰§è¡Œï¼‰æ˜¯åœ¨ puppet master é‡Œè€Œé agentï¼Œä¼¼ä¹ cfengine <br/> é‡Œé…ç½®çš„ç”Ÿæˆæ˜¯åœ¨ agent é‡Œã€‚ <br/> <br/> å†…å­˜å ç”¨ puppet 100 MB å·¦å³ï¼Œè¿˜ä¸ç®— stompserver/mysql/memcached è¿™äº›ï¼Œç›¸æ¯” <br/> ä¸‹ cfengine çš„å†…å­˜å ç”¨å°ä¸€ä¸ªæ•°é‡çº§ã€‚ â€</p><p>å¯èƒ½æŠ±æ€¨çš„å¤ªæŠ½è±¡ï¼Œæ€»ä¹‹ï¼Œç”¨ Puppet å·²ç»ä¸æ˜¯ä¸€ä¸ªé—®é¢˜å˜æˆä¸¤ä¸ªé—®é¢˜ï¼Œè€Œæ˜¯ä¸€ä¸ªé—®é¢˜å˜æˆ N ä¸ªé—®é¢˜ï¼Œåœ¨æˆ‘æŠ•å…¥ç²¾åŠ›æŠ˜è…¾å·¥ä½œæ‰€éœ€æœåŠ¡ä¹‹å‰ï¼Œæˆ‘å°±å¾—èŠ±å¥½å¤šç²¾åŠ›é…ç½® puppet è¿™ä¸ªæœåŠ¡ï¼Œä¼Šè¿˜æ¶ˆè€—ç›¸å½“å¤šå†…å­˜å’Œ CPU èµ„æºï¼Œå¤ªè›‹ç–¼äº†ã€‚</p><p>ä¸€å¼€å§‹æˆ‘å°è¯•å†™ä¸ªè‡ªå·±çš„é…ç½®ç®¡ç†å·¥å…·ï¼Œç²—ç•¥æœ‰ä¸‰ä¸ªç›®æ ‡ï¼Œç¬¬ä¸€ï¼Œå®ƒå°±æ˜¯è¦æ”¯æŒè„šæœ¬è¯­è¨€ï¼Œæˆ‘æ„¤æ€’æä¾›é˜‰å‰²ç‰ˆç¼–ç¨‹åŠŸèƒ½çš„ä¸œè¥¿ï¼Œå°¤å…¶æ˜¯åœ¨å‘ç°ä¸å¤Ÿçµæ´»ä¹‹ååŠ å…¥æ›´å¤šä¼ ç»Ÿç¼–ç¨‹è¯­è¨€å…ƒç´ çš„ä¸œè¥¿ï¼›ç¬¬äºŒï¼Œç±»ä¼¼  Make  æ”¯æŒå¹¶å‘æ‰§è¡Œé…ç½®è§„åˆ™ï¼›ç¬¬ä¸‰ï¼Œè§„åˆ™çš„æ‰§è¡Œæ˜¯äº‹åŠ¡æ€§çš„ï¼Œè¦ä¹ˆæˆåŠŸï¼Œæ”¹åŠ¨äº†ç³»ç»Ÿï¼Œè¦ä¹ˆå¤±è´¥ï¼Œæ²¡æœ‰æ”¹åŠ¨ç³»ç»Ÿï¼Œä¸è¦ç•™ç€çƒ‚æ‘Šå­ç­‰ä¸‹æ¬¡è¿è¡Œå†æ¸…ç†ï¼Œå› ä¸ºåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ç³»ç»Ÿå¤„äºä¸ç¨³å®šçŠ¶æ€ï¼Œå®¹æ˜“å‡ºé—®é¢˜ã€‚</p><p>æœ‰è¿™ç§é‡é€ è½®å­çš„æƒ³æ³•ç»å¯¹ä¸åªæˆ‘ä¸€ä¸ªäººï¼Œå°±æˆ‘æ‰€çŸ¥çš„ï¼Œé„™å…¬å¸çš„å¤§ç‰›ä»¬å·²ç„¶é€ äº†ä¸‰ä»£å¹¿ä¸ºä½¿ç”¨çš„å†…éƒ¨ç³»ç»Ÿç®¡ç†å·¥å…·ï¼Œç”¨æ¥ç»´æŠ¤å¤§é‡çš„æœåŠ¡å™¨ï¼Œå¯¼è‡´ä¸€ä¸ªç¬‘è¯å°±æ˜¯æ–°äººå…¥èŒæ—¶çœ‹åˆ°ä¸€ä¸ªå·¥å…·è¯´å“‡ï¼Œå¥½é«˜çº§å•Šï¼Œå¥½å¤æ‚å•Šï¼Œå¥½å¥½å•Šï¼Œç„¶åè¢«äººæ‰“å‡»ï¼šæ‹œæ‰˜ï¼Œé‚£ç©æ„çš„ä¸‹ä¸€ä»£éƒ½å·²ç»ä¸æ¨èä½¿ç”¨äº†ï¼</p><p>å¯æƒœæˆ‘è¿˜æ˜¯å¤ªå¼±è€Œä¸”å¤ªæ‡’ï¼Œä¸€ç›´æ²¡åŠªåŠ›æŠŠè½®å­é€ å‡ºæ¥ï¼Œç—›å®šæ€ç—›ï¼Œæˆ‘è¿˜æ˜¯å›å½’åˆ°æˆ‘æ‰€æƒ³åšçš„äº‹æƒ…å§ï¼šé…ç½®ä¸€å¥— IT åŸºç¡€è®¾æ–½ï¼Œè‡³äºé…ç½®å·¥å…·ï¼Œworse is betterï¼Œç²—å¿«çŒ›æ˜¯æˆ‘ coder æœ¬è‰²ï¼Œå…ˆæŠŠæ­£ç»ä¸œè¥¿é¼“æ£å‡ºæ¥ç»™äºº show showï¼Œlafã€‚ã€‚ã€‚</p><p>æµ…å°  cfengine è¿˜æ˜¯å¯¹æˆ‘æœ‰æ·±è¿œå½±å“çš„ï¼Œcfengine æä¸ºæå€¡ promiseï¼Œæˆ‘ä¸ªäººç†è§£å°±æ˜¯ ruleï¼Œä¸€ä¸ª rule  è§„å®šäº†ä¸€ä¸ªè§„åˆ™è®©ç³»ç»Ÿæ”¶æ•›åˆ°æœŸæœ›çš„ç¨³å®šçŠ¶æ€ï¼Œå¦‚æœç³»ç»Ÿå·²ç»å¤„åœ¨é‚£ä¸ªçŠ¶æ€äº†ï¼Œé‚£ä¹ˆ rule  å°±åº”è¯¥æ²¡æœ‰ä»»ä½•å®é™…åŠ¨ä½œã€‚è¿™ä¸ªæ€æƒ³æœ‰ç‚¹å¤šçº¿ç¨‹ç¼–ç¨‹çš„å¯é‡å…¥çš„æ„æ€ï¼Œå¤šæ¬¡æ‰§è¡ŒåŒä¸€ä¸ªè§„åˆ™åº”è¯¥æ˜¯å®‰å…¨çš„ï¼Œä¸ä¼šæœ‰æ°¸è¿œçš„å‰¯ä½œç”¨ã€‚è­¬å¦‚ä¸€ä¸ª rule  è§„å®šäº†æŸä¸ªæ–‡ä»¶æ˜¯ 0644ï¼Œé‚£ä¹ˆä¸€æ¡ chmod æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºå®ƒè¾¾ä¸åˆ°ç¨³å®šçŠ¶æ€ï¼Œæ–‡ä»¶çš„ ctime  æ€»æ˜¯åœ¨å˜ï¼Œè¿™ä¼šå½±å“å¤‡ä»½ç¨‹åºã€‚é¢†ä¼šè¿™ä¸ªæ€æƒ³åï¼Œæˆ‘å°±è§‰å¾—ç”¨ä»€ä¹ˆå·¥å…·éƒ½æ— æ‰€è°“äº†ï¼Œåªè¦å†™è„šæœ¬æ—¶èƒ½æ³¨æ„ç¨³å®šçŠ¶æ€è¿™ä¸ªç›®æ ‡ï¼Œå…¼é¡¾ coding  ä¸€è´¯å‡†åˆ™â€œå¯ç»´æŠ¤æ€§â€ï¼Œå°±èƒ½å†™å‡ºç¬¦åˆ cfengine promise æ€æƒ³çš„å¯ç»´æŠ¤çš„å®šåˆ¶é…ç½®ç³»ç»Ÿã€‚</p><p>æ­¤ä¸ºç³»åˆ—å¼€ç¯‡ï¼Œä¸ºå•¥æˆ‘ç”¨ Debianï¼Œä»¥åŠç³™å¿«çŒ›çš„ç”¨ shell è„šæœ¬åšé…ç½®è‡ªåŠ¨åŒ–ã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }, 
        {
            "url": "https://zhuanlan.zhihu.com/p/50771354", 
            "userName": "çº¤å¤«å¼ ", 
            "userLink": "https://www.zhihu.com/people/f70fdf87f24b7bc7238878bf456d1b4b", 
            "upvote": 0, 
            "title": "é€›ä¹¦åº—è§‚ç³»ç»Ÿç®¡ç†æœåŠ¡é…ç½®ä¹¦ç±å½’æ¥", 
            "content": "<p>ã€è¿ç§»ã€‘é€›ä¹¦åº—è§‚ç³»ç»Ÿç®¡ç†æœåŠ¡é…ç½®ä¹¦ç±å½’æ¥   (2011 å¹´çš„æ–‡å­—ğŸ˜„ï¼‰</p><p>å»äºšè¿æ‘å›¾ä¹¦å¤§å¦è·‘äº†è¶Ÿï¼Œå‘ç°æœ‰åå‡ æœ¬è¿™æ–¹é¢çš„ä¹¦ï¼Œç²—ç•¥çœ‹äº†ä¸‹ï¼Œ<br/>å†™çš„ç¨å¥½çš„åªæœ‰ä¸¤ä¸‰æœ¬ï¼Œå¤§éƒ¨åˆ†ä¹¦çš„åºŸè¯å ä¸‰åˆ†ä¹‹ä¸€ç¯‡å¹…ã€‚æ‰€æœ‰çš„<br/>ä¹¦éƒ½æ²¡æœ‰æ•´ä½“æ„Ÿï¼ŒæŠŠå„ä¸ªæœåŠ¡æ‹†å¼€æ¥è®²ï¼Œæ²¡æœ‰ä¸€æœ¬æåˆ° kerberosï¼Œ<br/>pam-ldap/nss-ldap å•ç‚¹ç™»å½•çš„ã€‚</p><p>æœ‰ä¸¤æœ¬å›½å®¶è§„åˆ’æ•™æå•¥çš„ï¼Œå…¶ä¸­ä¸€æœ¬è¿˜åœ¨è®²å®‰è£… QQ for linuxï¼ŒFlashGet<br/>for Linuxã€‚ æœ‰ä¸€æœ¬é“é“éƒ¨ 2010 å¹´ 6 æœˆå‡ºçš„ï¼Œdovecotã€cyrus-imapd<br/>ç« èŠ‚è²Œä¼¼æŠ„è¢­äº†äººé‚®ä¸€æœ¬ 2009 å¹´å‡ºçš„ä¹¦ï¼Œæ–‡å­—ä¸€æ ·ï¼Œå›¾ç‰‡ä¸€æ ·ï¼Œæ’ç‰ˆç¨æœ‰å·®åˆ«ï¼Œ<br/>ä¸çŸ¥é“æ˜¯æŠ„è¢­è¿˜æ˜¯ä½œè€…æ¢äº†ä¸ªåå­—ä¸€ç¨¿å¤šæŠ•ã€‚</p><p>ä¸€ç›´å¯¹ç³»ç»Ÿç®¡ç†æœ‰å…´è¶£ï¼Œèµ·å› æ˜¯ä»¥å‰å·¥ä½œä¸­ç»å¸¸è¢«å¼ºè¿«å…¼ä»»ç³»ç»Ÿç®¡ç†å‘˜ï¼Œ<br/>é…ç½®ä¸ª svnã€gitã€sambaã€bugzillaã€wordpress å•¥å•¥çš„ï¼Œç»å¸¸è§‰å¾—<br/>ç£¨æªä¸Šé˜µï¼Œä¸€å›¢ç¨€æ³¥ï¼Œæ²¡æœ‰å¯å›æº¯æ€§ã€‚ å‰ä¸¤å¹´è·Ÿ JulyClyde@newsmth<br/>èŠè¿‡ä¸€äº›æœ‰å…³ç³»ç»Ÿç®¡ç†çš„è¯é¢˜ï¼Œä¼Šæå‡ºè§„èŒƒåŒ–ç®¡ç†ï¼Œä¸æˆ‘å¿ƒé¢‡æœ‰æˆšæˆšç„‰ï¼Œ<br/>å¯æƒœé‚£åªæ‡’è™«å¿™äºå‘æ˜¥ï¼Œç–äºæ’°æ–‡ï¼Œæˆ‘åŸè¿˜æœŸå¾…ä¼Šèƒ½æ•´ä¸€æœ¬ç³»ç»Ÿç®¡ç†ç»å…¸<br/>ä¹¦ç±å‡ºæ¥ã€‚ã€‚ã€‚ã€‚å†™ä¹¦æˆ‘æ˜¯æ²¡è€å¿ƒçš„ï¼Œéº»çƒ¦ï¼Œç´¯ï¼Œèµšä¸äº†å‡ ä¸ªå­ï¼Œå¤ªä¸¥è‚ƒï¼Œ<br/>å®¹æ˜“è¢«äººéª‚ï¼Œä¿®è®¢å›°éš¾ï¼Œç­‰ç­‰ç­‰ç­‰ï¼Œè¿˜æ˜¯æ—¶ä¸æ—¶ç ä¸ªä¸‰è¨€ä¸¤è¯­ç¬¦åˆæˆ‘<br/>Perl coder çš„ä¼˜è‰¯ä¼ ç»Ÿï¼šæ‡’æƒ°:-)</p><p>é—²è¯å°‘è¯´ï¼Œåˆ‡å…¥æ­£é¢˜ï¼Œå…ˆèŠèŠæˆ‘å¯¹ IT è¡Œä¸šå°è§„æ¨¡åŸºç¡€è®¾æ–½ç®¡ç†æ–¹é¢çš„æƒ³æ³•ã€‚</p><p>(0.1) é…ç½®å¯é‡å¤æ€§</p><p>å°½é‡è‡ªåŠ¨åŒ–é…ç½®ï¼ŒæŠŠé…ç½®è¿‡ç¨‹è®°å½•æˆè„šæœ¬ï¼Œå‡å°‘ ad hoc çš„ä¸œæ”¹è¥¿æ”¹ã€‚</p><p>(0.2) å¯¹ç³»ç»Ÿç®¡ç†å‘˜ç‹ ä¸€ç‚¹ï¼Œå°½é‡ä¸æä¾›å›¾å½¢ç•Œé¢</p><p>æ™®é€šç”¨æˆ·æ˜¯åº”è¯¥äº«å—å›¾å½¢ç•Œé¢çš„ä¾¿åˆ©çš„ï¼Œè€Œå¯¹äºç³»ç»Ÿç®¡ç†ï¼Œå¾€å¾€è„šæœ¬<br/>æ–¹å¼æ›´ä¾¿åˆ©ï¼Œæ›´å®¹æ˜“å®šåˆ¶ï¼Œæ›´å®¹æ˜“æ¥è§¦åˆ°æ ¸å¿ƒï¼Œå¯ä»¥å¼ºè¿«äººå­¦ä¹ ï¼Œè€Œä¸”<br/>å›¾å½¢ç•Œé¢çš„ä¸œè¥¿å¾€å¾€å®¹æ˜“ç»™ç³»ç»Ÿç®¡ç†å¼•å…¥å®‰å…¨é—®é¢˜ã€‚ </p><p>(1) å•ç‚¹ç™»å½•ï¼Œè´¦æˆ·ç»Ÿä¸€ç®¡ç†ï¼Œæƒé™è®¾ç½®åˆ†å¼€</p><p>å•ç‚¹ç™»å½•æ˜¯æä¸ºé‡è¦çš„ï¼Œæ¯ä¸ªæœåŠ¡ä¸€ä¸ªå¯†ç çš„åšæ³•å¤ªä¸æ–¹ä¾¿äº†ã€‚åœ¨å†…éƒ¨ç³»ç»Ÿ<br/>å•ç‚¹ç™»å½•æ–¹é¢ï¼ŒKerberos + LDAP æ˜¯å¾ˆä¼ ç»Ÿçš„åšæ³•ï¼ŒMicrosoft çš„ Active<br/>Directory å°±æ˜¯ä¸ªé›†æˆäº†Kerberos(å¸¦ç§æœ‰æ‰©å±•) å’Œç›®å½•æœåŠ¡çš„é›†æˆæœåŠ¡ã€‚<br/>Windows, Linux, Unix, MacOS å‡å¯¹ Kerberos + LDAP æœ‰è¾ƒå¥½æ”¯æŒã€‚</p><p>é€šè¿‡ Kerberos + LDAPï¼Œè´¦æˆ·å¯ä»¥ç»Ÿä¸€ç®¡ç†äº†ï¼ˆå¾ˆå¤šæœåŠ¡éƒ½æ”¯æŒä» LDAP<br/>è¯»å–è´¦æˆ·ä¿¡æ¯)ï¼Œä½†æƒé™ç®¡ç†ç”±äºå„ä¸ªæœåŠ¡æƒé™å®šä¹‰æ–¹å¼ä¸ä¸€æ ·ï¼Œéš¾ä»¥<br/>é›†ä¸­å­˜æ”¾ï¼Œæ‰€ä»¥æƒé™è®¾ç½®åˆ†å¼€åœ¨å„ä¸ªæœåŠ¡ç‰¹å®šçš„å­˜å‚¨æ–¹å¼é‡Œã€‚</p><p>å•ç‚¹ç™»å½•åœ¨ Web ä¸Šç¨å¾®å¤æ‚ç‚¹ï¼Œä¼¼ä¹ Kerberos ç”¨äº Web åº”ç”¨ä¸æ˜¯é‚£ä¹ˆ<br/>è‡ªå¦‚ï¼ŒWeb SSO æœ‰è®¸å¤šç‹¬æœ‰çš„æ–¹æ¡ˆï¼Œæ¯”å¦‚ CAS, SAML, OpenIDï¼Œè¿˜æœ‰ç”¨äº<br/>Web app ä¹‹é—´æˆæƒçš„ OAUTHã€‚</p><p>æ€»ä¹‹ï¼Œæˆ‘æœŸæœ›çš„å•ç‚¹ç™»å½•ç³»ç»Ÿè¦è¾¾åˆ°çš„æ•ˆæœï¼š<br/>  * ä» PC ç™»å½•åï¼Œä¸ç”¨å†è¾“å…¥å¯†ç å³å¯è®¿é—®æ‰€æœ‰æˆæƒçš„æœåŠ¡<br/>  * å¯ä»¥æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢å…¶åœ¨æ‰€æœ‰æœåŠ¡ä¸­çš„åˆ†ç»„ã€æˆæƒæƒ…å†µ<br/>  * å¯ä»¥æ³¨é”€ä¸€ä¸ªè´¦æˆ·å³å¯æ³¨é”€å…¶ä¹‹å‰æˆæƒçš„æ‰€æœ‰æœåŠ¡</p><p>æˆ‘ç°åœ¨æ‰€åœ¨çš„å…¬å¸æ²¡æœ‰ç”¨ Kerberos + LDAPï¼Œä¸çŸ¥é“å‡ºäºä»€ä¹ˆè€ƒè™‘ï¼Œ<br/>Linux/Unix ä¸»æœºä¸Šç”¨è´¦æˆ·ä¿¡æ¯åŒæ­¥å¾—åˆ°ç»Ÿä¸€è´¦æˆ·æ•ˆæœï¼ŒWindows æ¡Œé¢æœº<br/>ç”¨ Windows åŸŸï¼Œå¤§å®¶ç”¨ ssh å…¬é’¥è®¤è¯ å¾—åˆ° Linux/Unix å¤šä¸»æœºæ— å¯†ç <br/>ç™»å½•æ•ˆæœã€‚Web SSO æ–¹é¢å…¬å¸åšçš„éå¸¸å¥½ï¼Œå¯èƒ½è·Ÿäº’è”ç½‘èƒŒæ™¯æœ‰å…³ç³»ã€‚</p><p class=\"ztext-empty-paragraph\"><br/></p><p>(2) å·¥ä½œæ¶‰åŠçš„ IT åŸºç¡€è®¾æ–½è¶Šå°‘è¶Šå¥½ï¼Œç‰¹åˆ«æ˜¯æ–‡æ¡£ä¸è¦ç”¨å¤šç§å­˜å‚¨é€”å¾„</p><p>åœ¨å‰å…¬å¸æ›¾ç»å†è¿‡æ–‡æ¡£åˆ†æ•£çš„ä¸è‰¯ä½“éªŒï¼Œä¸€å¼€å§‹æˆ‘ä»¬ç”¨ svn ç®¡ç†æ–‡æ¡£ï¼Œ<br/>åˆ†ç›®å½•ï¼Œéå¸¸æ¸…æ™°ï¼Œä½†è¿™ç§æ–¹å¼ç¼–è¾‘ä½“éªŒä¸å¥½ï¼Œåæ¥æˆ‘ä»¬å°è¯• wikiã€<br/>drupalã€wordpressï¼Œå¤šä¸ªç³»ç»Ÿå¹¶ç”¨ï¼Œç„¶åå°±ä¹±å¥—äº†ï¼Œè™½ç„¶å¤§å®¶å„æœ‰æ‰€å¥½<br/>å„å¾—å…¶æ‰€ï¼Œä½†æ‰¾ä¸ªèµ„æ–™å¤ªéº»çƒ¦äº†ï¼Œå¤§å®¶é˜…è¯»æ—¶éœ€è¦å…³æ³¨çš„åœ°æ–¹å¤ªæ‚ã€‚</p><p>å…³äº bug ç®¡ç†å’Œé¡¹ç›®è·Ÿè¸ªï¼Œä¹Ÿæœ‰ç±»ä¼¼çš„é—®é¢˜ï¼Œbugzilla, twiki, trac éƒ½<br/>æè¿‡ï¼Œå¤§å®¶å„æœ‰æ‰€å¥½ï¼Œè¦æ‰¾ä¸ªä¸œè¥¿ï¼Œæˆ–è€…å›æº¯å†å²ï¼Œå¤´ç»ªçº·æ‚ã€‚</p><p>å¦å¤–å¤§å®¶å¾ˆå¯èƒ½åŒæ—¶åœ¨ç”¨ bug è·Ÿè¸ªç³»ç»Ÿã€å·¥ä½œæµç³»ç»Ÿã€è¯·å‡ç³»ç»Ÿï¼Œ<br/>æŠ¥é”€ç³»ç»Ÿï¼Œå…¶å®è¿™ä¸‰è€…å®Œå…¨å¯ä»¥æ”¾åœ¨ä¸€èµ·ï¼Œæœ€åœŸé³–çš„åŠæ³•æ˜¯ç”¨<br/>bugzillaï¼Œæˆ‘ç°åœ¨æ‰€åœ¨å…¬å¸å°±ç”¨ bugzilla åšå·¥ä½œæµç³»ç»Ÿï¼Œç°åœ¨<br/>å·²æœ‰äº”ç™¾ä¸‡ tickets äº†ï¼ˆèµ bugzilla ä¹‹å¼ºå¤§ï¼)ã€‚</p><p>åœ¨æˆ‘æ‰€åœ¨å…¬å¸é‡Œï¼Œå¼€å‘äººå‘˜éœ€è¦é¢‘ç¹é¢å¯¹çš„ç³»ç»Ÿå¾ˆç²¾ç®€ï¼Œéƒ½æ˜¯å¿…ä¸å¯å°‘çš„ï¼š<br/>svn ç”¨äºæºç ç®¡ç†, bugzilla ç”¨äº bug ç®¡ç†ä»¥åŠå·¥ä½œæµè·Ÿè¸ª,<br/>twiki ç”¨äºæ–‡æ¡£ç®¡ç†, hudson ç”¨äºè‡ªåŠ¨æ„å»º, package repository<br/>ç”¨äºå­˜æ”¾æ‰“åŒ…ç»“æœï¼Œè¿™ç§å·¥å…·é“¾ï¼Œè¯´å¤¸å¼ ç‚¹ï¼Œå·²ç»å½¢æˆäº†ç»Ÿä¸€ç¨³å®šçš„<br/>ä¸»æµå¼€å‘æ–‡åŒ–ã€‚å…¬å¸ä¹Ÿæœ‰ blog æœåŠ¡ï¼Œä½†ä¸æ˜¯ä¸»æµã€‚</p><p>(3) ä¿¡æ¯çš„è‰¯å¥½åˆ†ç±»ä»¥åŠçº§åˆ«å¾ˆé‡è¦</p><p>åœ¨ Web 2.0 æ—¶ä»£ï¼Œå¤§å®¶å¾ˆä¹ æƒ¯ç”¨æ ‡ç­¾ã€æœç´¢æ¥æ ‡è®°æ–‡ç« ï¼ŒçŸ¥è¯†åº“å¾€å¾€æˆäº†<br/>å¹³é“ºçš„ç½‘çŠ¶ç»“æ„ï¼Œä¸€ä¸ªåƒåœ¾åœºã€‚ä¸ªäººéå¸¸ä¸å–œæ¬¢è¿™ç‚¹ï¼Œæˆ‘è§‰å¾—è‰¯å¥½çš„æ ‘çŠ¶<br/>åˆ†ç±»å¦‚åŒç½‘ç«™å¯¼èˆªï¼Œå¿…é¡»æ˜¯ä¸»è¦çš„ç´¢å¼•åŠæ³•ï¼Œè€Œæ ‡ç­¾ã€æœç´¢åªæ˜¯è¾…åŠ©ï¼Œ<br/>æ ‘çŠ¶åˆ†ç±»å°¤å…¶å¯¹æ–°äººæœ‰åˆ©ã€‚</p><p>å¦å¤–ï¼Œä¿¡æ¯éœ€è¦æœ‰çº§åˆ«ä¹‹åˆ†ï¼Œè­¬å¦‚æœ‰ä¸ªæ‰“åˆ†çš„æœºåˆ¶ï¼Œè®©é‡è¦çš„æ–‡æ¡£è‡ªåŠ¨<br/>æµ®ç°å‡ºæ¥ï¼Œä¸è¦ä¸€çœ¼æœ›å»ï¼Œå¯†å¯†éº»éº»éƒ½æ˜¯æ–‡æ¡£é“¾æ¥ã€‚æ–‡æ¡£å¯ä»¥å¾ˆå¤šï¼Œä½†æ˜¯<br/>é‡è¦çš„ã€æƒå¨çš„æ–‡æ¡£åº”å½“å¾ˆå°‘ã€å¾ˆæ­£å¼ã€å¾ˆå®¹æ˜“æ‰¾åˆ°ã€‚</p><p>è¿™ç‚¹å…¬å¸åšçš„å¾ˆä¸å¥½ï¼Œtwiki æ˜¯ä¸ªè•´å«æ— æ•°å®è—çš„åƒåœ¾åœºï¼Œå¹¸å¥½å®ƒçš„<br/>æœç´¢æ”¯æŒçš„å¾ˆå¥½ã€‚</p><p>(4) å»ºç«‹å†…éƒ¨æœç´¢å¼•æ“</p><p>äººæ€»æ˜¯æ‡’æƒ°å’Œå¥å¿˜çš„ï¼Œä¿¡æ¯æ€»æ˜¯å¤šçš„æ•°ä¸è¿‡æ¥çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªå†…éƒ¨æœç´¢å¼•æ“æ˜¯å¾ˆæœ‰<br/>å¿…è¦çš„ï¼Œè¿™æ–¹é¢ apache solr è²Œä¼¼é¢‡å ªé‡ä»»ã€‚</p><p>æˆ‘æ‰€åœ¨å…¬å¸å†…éƒ¨æœ‰æœç´¢å¼•æ“ï¼Œå¯ä»¥æœç´¢æ–‡æ¡£ã€äººå‘˜è”ç³»æ–¹å¼ç­‰ç­‰ï¼Œè¿˜æ¯”è¾ƒå¥½ç”¨ã€‚</p><p>(5) è½¯ä»¶åŒ…å‘½åï¼Œç‰ˆæœ¬å·ï¼Œä¾èµ–å…³ç³»çš„è§„èŒƒåŒ–</p><p>åœ¨ IT å…¬å¸ï¼Œå¾€å¾€ä¼šå†…éƒ¨äº§ç”Ÿå¤§é‡è½¯ä»¶åŒ…ï¼Œå¦‚ä½•æœ‰æ•ˆç»´æŠ¤å®ƒä»¬æ˜¯å¾ˆå¤´ç–¼çš„é—®é¢˜ï¼Œ<br/>è¿™æ–¹é¢ Linux å‘è¡Œç‰ˆåšçš„å¾ˆå¥½ï¼Œå°¤å…¶æ˜¯æˆ‘å–œçˆ±çš„ Debianï¼Œå…¶è½¯ä»¶åŒ…ç®¡ç†ç»´æŠ¤<br/>çš„æœ‰æ¡ä¸ç´Šã€‚å¦å¤– APR å…³äºç‰ˆæœ¬å·è®°æ³•çš„æ–‡ç« éå¸¸å€¼å¾—å‚è€ƒï¼š</p><p>    <a href=\"https://link.zhihu.com/?target=http%3A//apr.apache.org/versioning.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://</span><span class=\"visible\">apr.apache.org/versioni</span><span class=\"invisible\">ng.html</span><span class=\"ellipsis\"></span></a></p><p>è¿™ç‚¹å…¬å¸åšçš„ä¸å¥½ï¼Œç°åœ¨å¤§å®¶æœ‰ç‚¹è§‰æ‚Ÿï¼Œä½†ç§¯é‡éš¾è¿”ï¼Œè½¯ä»¶åŒ…ç®¡ç†è¿˜<br/>æ˜¯æ¯”è¾ƒæ··ä¹±çš„ï¼Œç»å¸¸å®‰è£…ã€ç¼–è¯‘å‡ºé—®é¢˜ã€‚</p><p>(6) å¼€å‘äººå‘˜æ‰‹å†Œï¼Œä¸€ä¸ªç³»ç»Ÿä¸Šæ‰‹çš„ç¬¬ä¸€æ‰‹ä¿¡æ¯ï¼Œå¯¹äºæ–°äººéå¸¸é‡è¦</p><p>åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¤§å®¶å¾€å¾€ä¸æ³¨æ„è¿™æ–¹é¢ä¿¡æ¯çš„ç§¯ç´¯å’Œè§„èŒƒåŒ–ï¼Œ<br/>æ¯”å¦‚ç¼–è¯‘ä¸€ä¸ªäº§å“ï¼Œä¸œä¸€å¸–è¥¿ä¸€å¸–ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯ä¸æ—¶ä¿±è¿›ã€‚<br/>å¦‚æœæ–°å‘˜å·¥å…¥èŒï¼Œèƒ½æ”¶åˆ°ä¸€ä»½ developer handbookï¼Œä»‹ç»å…¬å¸çš„<br/>IT åŸºç¡€è®¾ç½®ï¼ŒåŸºæœ¬å¼€å‘ç¯å¢ƒï¼Œèƒ½æ”¶åˆ°ä¸€ä»½æ‰€åœ¨é¡¹ç›®çš„ newbie kickstartï¼Œ<br/>ç»™äººçš„æ„Ÿè§‰æ˜¯æ— ä¸ä¼¦æ¯”çš„ã€‚</p><p>è¿™ç‚¹å…¬å¸åšçš„å¾ˆå¥½ï¼Œå†…éƒ¨éå¸¸é‡è§†æ–‡æ¡£çš„è§„èŒƒåŒ–ç®¡ç†ï¼Œæœ‰é›†ä¸­çš„<br/>æ–‡æ¡£ç½‘ç«™ï¼Œå¾ˆæ­£å¼ï¼Œå¾ˆæ¼‚äº®ï¼Œå¼€ç¯‡ç¬¬ä¸€ä¸ªæ–‡æ¡£å°±æ˜¯ developer handbookï¼Œ<br/>æˆ‘è¿å¤œçœ‹å®Œï¼Œå¾ˆæœ‰æ„Ÿè§¦ã€‚</p><p>(7) å®¹å™¨ã€è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œæ–¹ä¾¿å¿«é€Ÿå»ºç«‹ç»Ÿä¸€çš„å¼€å‘ã€æµ‹è¯•ã€è¿è¡Œç¯å¢ƒ</p><p>è½¯ä»¶å¼€å‘äººå‘˜æœ€å¸¸æ‰¯çš®çš„äº‹æƒ…æ˜¯â€œæˆ‘è¿™é‡Œå¥½å¥½çš„å•Šâ€ï¼Œå¦‚æœä½¿ç”¨å®¹å™¨ã€è™šæ‹ŸåŒ–<br/>æŠ€æœ¯ï¼Œé‚£ä¹ˆå¤§å®¶èƒ½éå¸¸å®¹æ˜“çš„å»ºç«‹ç»Ÿä¸€ç¯å¢ƒï¼Œåšäº‹æƒ…å¯é‡å¤ï¼Œä¼šè®©å¼€å‘<br/>è¿‡ç¨‹æ›´ä¸ºæµç•…ã€‚</p><p>æˆ‘æ‰€åœ¨å…¬å¸æœ‰ç»Ÿä¸€çš„ chroot å’Œ vm å·¥å…·ï¼Œå»ºç«‹ç¯å¢ƒéå¸¸å¿«é€Ÿæ–¹ä¾¿ã€‚</p>", 
            "topic": [
                {
                    "tag": "Linux", 
                    "tagLink": "https://api.zhihu.com/topics/19554300"
                }
            ], 
            "comments": []
        }
    ], 
    "url": "https://zhuanlan.zhihu.com/c_1049252916510142464"
}
